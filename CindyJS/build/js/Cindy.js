/* CindyJS - (C) 2014-2016  The CindyJS Project
 * Mostly licensed under the Apache License 2.0, but subprojects may use different licensing.
 * See https://github.com/CindyJS/CindyJS/tree/$gitid$
 * for corresponding sources and their respective licensing conditions.
 */
/*
 npm.im/iphone-inline-video 2.2.2  npm.im/intervalometer  https://github.com/paulmillr/es6-shim
 @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
   and contributors,  MIT License
 es6-shim: v0.35.4
 see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 Details and documentation:
 https://github.com/paulmillr/es6-shim/
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(C){var H=0;return function(){return H<C.length?{done:!1,value:C[H++]}:{done:!0}}};$jscomp.arrayIterator=function(C){return{next:$jscomp.arrayIteratorImpl(C)}};$jscomp.makeIterator=function(C){var H="undefined"!=typeof Symbol&&Symbol.iterator&&C[Symbol.iterator];return H?H.call(C):$jscomp.arrayIterator(C)};$jscomp.arrayFromIterator=function(C){for(var H,T=[];!(H=C.next()).done;)T.push(H.value);return T};
$jscomp.arrayFromIterable=function(C){return C instanceof Array?C:$jscomp.arrayFromIterator($jscomp.makeIterator(C))};$jscomp.owns=function(C,H){return Object.prototype.hasOwnProperty.call(C,H)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(C,H,T){if(C==Array.prototype||C==Object.prototype)return C;C[H]=T.value;return C};$jscomp.getGlobal=function(C){C=["object"==typeof globalThis&&globalThis,C,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var H=0;H<C.length;++H){var T=C[H];if(T&&T.Math==Math)return T}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(C,H){var T=$jscomp.propertyToPolyfillSymbol[H];if(null==T)return C[H];T=C[T];return void 0!==T?T:C[H]};
$jscomp.polyfill=function(C,H,T,aa){H&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(C,H,T,aa):$jscomp.polyfillUnisolated(C,H,T,aa))};$jscomp.polyfillUnisolated=function(C,H,T,aa){T=$jscomp.global;C=C.split(".");for(aa=0;aa<C.length-1;aa++){var ba=C[aa];if(!(ba in T))return;T=T[ba]}C=C[C.length-1];aa=T[C];H=H(aa);H!=aa&&null!=H&&$jscomp.defineProperty(T,C,{configurable:!0,writable:!0,value:H})};
$jscomp.polyfillIsolated=function(C,H,T,aa){var ba=C.split(".");C=1===ba.length;aa=ba[0];aa=!C&&aa in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var na=0;na<ba.length-1;na++){var da=ba[na];if(!(da in aa))return;aa=aa[da]}ba=ba[ba.length-1];T=$jscomp.IS_SYMBOL_NATIVE&&"es6"===T?aa[ba]:null;H=H(T);null!=H&&(C?$jscomp.defineProperty($jscomp.polyfills,ba,{configurable:!0,writable:!0,value:H}):H!==T&&(void 0===$jscomp.propertyToPolyfillSymbol[ba]&&(T=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[ba]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(ba):$jscomp.POLYFILL_PREFIX+T+"$"+ba),$jscomp.defineProperty(aa,$jscomp.propertyToPolyfillSymbol[ba],{configurable:!0,writable:!0,value:H})))};$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(C,H){for(var T=1;T<arguments.length;T++){var aa=arguments[T];if(aa)for(var ba in aa)$jscomp.owns(aa,ba)&&(C[ba]=aa[ba])}return C};$jscomp.polyfill("Object.assign",function(C){return C||$jscomp.assign},"es6","es3");
$jscomp.underscoreProtoCanBeSet=function(){var C={a:!0},H={};try{return H.__proto__=C,H.a}catch(T){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(C,H){C.__proto__=H;if(C.__proto__!==H)throw new TypeError(C+" is not extensible");return C}:null;$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(C){if(!(C instanceof Object))throw new TypeError("Iterator result "+C+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(C){this.yieldResult=C};
$jscomp.generator.Context.prototype.throw_=function(C){this.abruptCompletion_={exception:C,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(C){this.abruptCompletion_={return:C};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(C){this.abruptCompletion_={jumpTo:C};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(C,H){this.nextAddress=H;return{value:C}};
$jscomp.generator.Context.prototype.yieldAll=function(C,H){C=$jscomp.makeIterator(C);var T=C.next();$jscomp.generator.ensureIteratorResultIsObject_(T);if(T.done)this.yieldResult=T.value,this.nextAddress=H;else return this.yieldAllIterator_=C,this.yield(T.value,H)};$jscomp.generator.Context.prototype.jumpTo=function(C){this.nextAddress=C};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(C,H){this.catchAddress_=C;void 0!=H&&(this.finallyAddress_=H)};$jscomp.generator.Context.prototype.setFinallyBlock=function(C){this.catchAddress_=0;this.finallyAddress_=C||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(C,H){this.nextAddress=C;this.catchAddress_=H||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(C){this.catchAddress_=C||0;C=this.abruptCompletion_.exception;this.abruptCompletion_=null;return C};$jscomp.generator.Context.prototype.enterFinallyBlock=function(C,H,T){T?this.finallyContexts_[T]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=C||0;this.finallyAddress_=H||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(C,H){H=this.finallyContexts_.splice(H||0)[0];if(H=this.abruptCompletion_=this.abruptCompletion_||H){if(H.isException)return this.jumpToErrorHandler_();void 0!=H.jumpTo&&this.finallyAddress_<H.jumpTo?(this.nextAddress=H.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=C};$jscomp.generator.Context.prototype.forIn=function(C){return new $jscomp.generator.Context.PropertyIterator(C)};
$jscomp.generator.Context.PropertyIterator=function(C){this.object_=C;this.properties_=[];for(var H in C)this.properties_.push(H);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var C=this.properties_.pop();if(C in this.object_)return C}return null};$jscomp.generator.Engine_=function(C){this.context_=new $jscomp.generator.Context;this.program_=C};
$jscomp.generator.Engine_.prototype.next_=function(C){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,C,this.context_.next_);this.context_.next_(C);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(C){this.context_.start_();var H=this.context_.yieldAllIterator_;if(H)return this.yieldAllStep_("return"in H?H["return"]:function(T){return{value:T,done:!0}},C,this.context_.return);this.context_.return(C);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(C){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],C,this.context_.next_);this.context_.throw_(C);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(C,H,T){try{var aa=C.call(this.context_.yieldAllIterator_,H);$jscomp.generator.ensureIteratorResultIsObject_(aa);if(!aa.done)return this.context_.stop_(),aa;var ba=aa.value}catch(na){return this.context_.yieldAllIterator_=null,this.context_.throw_(na),this.nextStep_()}this.context_.yieldAllIterator_=null;T.call(this.context_,ba);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var C=this.program_(this.context_);if(C)return this.context_.stop_(),{value:C.value,done:!1}}catch(H){this.context_.yieldResult=void 0,this.context_.throw_(H)}this.context_.stop_();if(this.context_.abruptCompletion_){C=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(C.isException)throw C.exception;return{value:C.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(C){this.next=function(H){return C.next_(H)};this.throw=function(H){return C.throw_(H)};this.return=function(H){return C.return_(H)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(C,H){H=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(H));$jscomp.setPrototypeOf&&C.prototype&&$jscomp.setPrototypeOf(H,C.prototype);return H};
$jscomp.asyncExecutePromiseGenerator=function(C){function H(aa){return C.next(aa)}function T(aa){return C.throw(aa)}return new Promise(function(aa,ba){function na(da){da.done?aa(da.value):Promise.resolve(da.value).then(H,T).then(na,ba)}na(C.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(C){return $jscomp.asyncExecutePromiseGenerator(C())};$jscomp.asyncExecutePromiseGeneratorProgram=function(C){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(C)))};
$jscomp.initSymbol=function(){};$jscomp.polyfill("Symbol",function(C){if(C)return C;var H=function(na,da){this.$jscomp$symbol$id_=na;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:da})};H.prototype.toString=function(){return this.$jscomp$symbol$id_};var T="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",aa=0,ba=function(na){if(this instanceof ba)throw new TypeError("Symbol is not a constructor");return new H(T+(na||"")+"_"+aa++,na)};return ba},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(C){if(C)return C;C=Symbol("Symbol.iterator");for(var H="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),T=0;T<H.length;T++){var aa=$jscomp.global[H[T]];"function"===typeof aa&&"function"!=typeof aa.prototype[C]&&$jscomp.defineProperty(aa.prototype,C,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return C},"es6",
"es3");$jscomp.iteratorPrototype=function(C){C={next:C};C[Symbol.iterator]=function(){return this};return C};
$jscomp.polyfill("Promise",function(C){function H(){this.batch_=null}function T(da){return da instanceof ba?da:new ba(function(A,fa){A(da)})}if(C&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return C;H.prototype.asyncExecute=function(da){if(null==this.batch_){this.batch_=[];var A=this;this.asyncExecuteFunction(function(){A.executeBatch_()})}this.batch_.push(da)};
var aa=$jscomp.global.setTimeout;H.prototype.asyncExecuteFunction=function(da){aa(da,0)};H.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var da=this.batch_;this.batch_=[];for(var A=0;A<da.length;++A){var fa=da[A];da[A]=null;try{fa()}catch(Z){this.asyncThrow_(Z)}}}this.batch_=null};H.prototype.asyncThrow_=function(da){this.asyncExecuteFunction(function(){throw da;})};var ba=function(da){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=
!1;var A=this.createResolveAndReject_();try{da(A.resolve,A.reject)}catch(fa){A.reject(fa)}};ba.prototype.createResolveAndReject_=function(){function da(Z){return function(ha){fa||(fa=!0,Z.call(A,ha))}}var A=this,fa=!1;return{resolve:da(this.resolveTo_),reject:da(this.reject_)}};ba.prototype.resolveTo_=function(da){if(da===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(da instanceof ba)this.settleSameAsPromise_(da);else{a:switch(typeof da){case "object":var A=null!=
da;break a;case "function":A=!0;break a;default:A=!1}A?this.resolveToNonPromiseObj_(da):this.fulfill_(da)}};ba.prototype.resolveToNonPromiseObj_=function(da){var A=void 0;try{A=da.then}catch(fa){this.reject_(fa);return}"function"==typeof A?this.settleSameAsThenable_(A,da):this.fulfill_(da)};ba.prototype.reject_=function(da){this.settle_(2,da)};ba.prototype.fulfill_=function(da){this.settle_(1,da)};ba.prototype.settle_=function(da,A){if(0!=this.state_)throw Error("Cannot settle("+da+", "+A+"): Promise already settled in state"+
this.state_);this.state_=da;this.result_=A;2===this.state_&&this.scheduleUnhandledRejectionCheck_();this.executeOnSettledCallbacks_()};ba.prototype.scheduleUnhandledRejectionCheck_=function(){var da=this;aa(function(){if(da.notifyUnhandledRejection_()){var A=$jscomp.global.console;"undefined"!==typeof A&&A.error(da.result_)}},1)};ba.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var da=$jscomp.global.CustomEvent,A=$jscomp.global.Event,fa=$jscomp.global.dispatchEvent;
if("undefined"===typeof fa)return!0;"function"===typeof da?da=new da("unhandledrejection",{cancelable:!0}):"function"===typeof A?da=new A("unhandledrejection",{cancelable:!0}):(da=$jscomp.global.document.createEvent("CustomEvent"),da.initCustomEvent("unhandledrejection",!1,!0,da));da.promise=this;da.reason=this.result_;return fa(da)};ba.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var da=0;da<this.onSettledCallbacks_.length;++da)na.asyncExecute(this.onSettledCallbacks_[da]);
this.onSettledCallbacks_=null}};var na=new H;ba.prototype.settleSameAsPromise_=function(da){var A=this.createResolveAndReject_();da.callWhenSettled_(A.resolve,A.reject)};ba.prototype.settleSameAsThenable_=function(da,A){var fa=this.createResolveAndReject_();try{da.call(A,fa.resolve,fa.reject)}catch(Z){fa.reject(Z)}};ba.prototype.then=function(da,A){function fa(Pa,Ya){return"function"==typeof Pa?function(za){try{Z(Pa(za))}catch(cb){ha(cb)}}:Ya}var Z,ha,ra=new ba(function(Pa,Ya){Z=Pa;ha=Ya});this.callWhenSettled_(fa(da,
Z),fa(A,ha));return ra};ba.prototype.catch=function(da){return this.then(void 0,da)};ba.prototype.callWhenSettled_=function(da,A){function fa(){switch(Z.state_){case 1:da(Z.result_);break;case 2:A(Z.result_);break;default:throw Error("Unexpected state: "+Z.state_);}}var Z=this;null==this.onSettledCallbacks_?na.asyncExecute(fa):this.onSettledCallbacks_.push(fa);this.isRejectionHandled_=!0};ba.resolve=T;ba.reject=function(da){return new ba(function(A,fa){fa(da)})};ba.race=function(da){return new ba(function(A,
fa){for(var Z=$jscomp.makeIterator(da),ha=Z.next();!ha.done;ha=Z.next())T(ha.value).callWhenSettled_(A,fa)})};ba.all=function(da){var A=$jscomp.makeIterator(da),fa=A.next();return fa.done?T([]):new ba(function(Z,ha){function ra(za){return function(cb){Pa[za]=cb;Ya--;0==Ya&&Z(Pa)}}var Pa=[],Ya=0;do Pa.push(void 0),Ya++,T(fa.value).callWhenSettled_(ra(Pa.length-1),ha),fa=A.next();while(!fa.done)})};return ba},"es6","es3");
$jscomp.iteratorFromArray=function(C,H){C instanceof String&&(C+="");var T=0,aa=!1,ba={next:function(){if(!aa&&T<C.length){var na=T++;return{value:H(na,C[na]),done:!1}}aa=!0;return{done:!0,value:void 0}}};ba[Symbol.iterator]=function(){return ba};return ba};$jscomp.polyfill("Array.prototype.keys",function(C){return C?C:function(){return $jscomp.iteratorFromArray(this,function(H){return H})}},"es6","es3");
$jscomp.polyfill("Number.isNaN",function(C){return C?C:function(H){return"number"===typeof H&&isNaN(H)}},"es6","es3");$jscomp.polyfill("Number.isFinite",function(C){return C?C:function(H){return"number"!==typeof H?!1:!isNaN(H)&&Infinity!==H&&-Infinity!==H}},"es6","es3");$jscomp.polyfill("Math.sign",function(C){return C?C:function(H){H=Number(H);return 0===H||isNaN(H)?H:0<H?1:-1}},"es6","es3");$jscomp.polyfill("Number.EPSILON",function(C){return Math.pow(2,-52)},"es6","es3");
$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");$jscomp.checkStringArgs=function(C,H,T){if(null==C)throw new TypeError("The 'this' value for String.prototype."+T+" must not be null or undefined");if(H instanceof RegExp)throw new TypeError("First argument to String.prototype."+T+" must not be a regular expression");return C+""};
$jscomp.polyfill("String.prototype.startsWith",function(C){return C?C:function(H,T){var aa=$jscomp.checkStringArgs(this,H,"startsWith");H+="";var ba=aa.length,na=H.length;T=Math.max(0,Math.min(T|0,aa.length));for(var da=0;da<na&&T<ba;)if(aa[T++]!=H[da++])return!1;return da>=na}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(C){return C?C:function(H,T){var aa=$jscomp.checkStringArgs(this,H,"endsWith");H+="";void 0===T&&(T=aa.length);T=Math.max(0,Math.min(T|0,aa.length));for(var ba=H.length;0<ba&&0<T;)if(aa[--T]!=H[--ba])return!1;return 0>=ba}},"es6","es3");$jscomp.polyfill("Object.is",function(C){return C?C:function(H,T){return H===T?0!==H||1/H===1/T:H!==H&&T!==T}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(C){return C?C:function(H,T){var aa=this;aa instanceof String&&(aa=String(aa));var ba=aa.length;T=T||0;for(0>T&&(T=Math.max(T+ba,0));T<ba;T++){var na=aa[T];if(na===H||Object.is(na,H))return!0}return!1}},"es7","es3");$jscomp.polyfill("String.prototype.includes",function(C){return C?C:function(H,T){return-1!==$jscomp.checkStringArgs(this,H,"includes").indexOf(H,T||0)}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(C){return C?C:function(){return $jscomp.iteratorFromArray(this,function(H,T){return T})}},"es8","es3");
$jscomp.polyfill("Array.from",function(C){return C?C:function(H,T,aa){T=null!=T?T:function(A){return A};var ba=[],na="undefined"!=typeof Symbol&&Symbol.iterator&&H[Symbol.iterator];if("function"==typeof na){H=na.call(H);for(var da=0;!(na=H.next()).done;)ba.push(T.call(aa,na.value,da++))}else for(na=H.length,da=0;da<na;da++)ba.push(T.call(aa,H[da],da));return ba}},"es6","es3");
$jscomp.polyfill("Array.prototype.entries",function(C){return C?C:function(){return $jscomp.iteratorFromArray(this,function(H,T){return[H,T]})}},"es6","es3");$jscomp.polyfill("Number.isInteger",function(C){return C?C:function(H){return Number.isFinite(H)?H===Math.floor(H):!1}},"es6","es3");$jscomp.findInternal=function(C,H,T){C instanceof String&&(C=String(C));for(var aa=C.length,ba=0;ba<aa;ba++){var na=C[ba];if(H.call(T,na,ba,C))return{i:ba,v:na}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(C){return C?C:function(H,T){return $jscomp.findInternal(this,H,T).v}},"es6","es3");$jscomp.polyfill("Array.prototype.findIndex",function(C){return C?C:function(H,T){return $jscomp.findInternal(this,H,T).i}},"es6","es3");$jscomp.polyfill("Object.getOwnPropertySymbols",function(C){return C?C:function(){return[]}},"es6","es5");
$jscomp.polyfill("Math.expm1",function(C){return C?C:function(H){H=Number(H);if(.25>H&&-.25<H){for(var T=H,aa=1,ba=H,na=0;na!=ba;)T*=H/++aa,ba=(na=ba)+T;return ba}return Math.exp(H)-1}},"es6","es3");$jscomp.polyfill("Math.sinh",function(C){if(C)return C;var H=Math.exp;return function(T){T=Number(T);return 0===T?T:(H(T)-H(-T))/2}},"es6","es3");$jscomp.polyfill("Math.cosh",function(C){if(C)return C;var H=Math.exp;return function(T){T=Number(T);return(H(T)+H(-T))/2}},"es6","es3");
$jscomp.polyfill("Math.log1p",function(C){return C?C:function(H){H=Number(H);if(.25>H&&-.25<H){for(var T=H,aa=1,ba=H,na=0,da=1;na!=ba;)T*=H,da*=-1,ba=(na=ba)+da*T/++aa;return ba}return Math.log(1+H)}},"es6","es3");$jscomp.polyfill("Math.asinh",function(C){return C?C:function(H){H=Number(H);if(0===H)return H;var T=Math.log(Math.abs(H)+Math.sqrt(H*H+1));return 0>H?-T:T}},"es6","es3");
$jscomp.polyfill("Math.atanh",function(C){if(C)return C;var H=Math.log1p;return function(T){T=Number(T);return(H(T)-H(-T))/2}},"es6","es3");$jscomp.polyfill("Math.tanh",function(C){return C?C:function(H){H=Number(H);if(0===H)return H;var T=Math.exp(-2*Math.abs(H));T=(1-T)/(1+T);return 0>H?-T:T}},"es6","es3");$jscomp.polyfill("Math.acosh",function(C){return C?C:function(H){H=Number(H);return Math.log(H+Math.sqrt(H*H-1))}},"es6","es3");
$jscomp.polyfill("Math.cbrt",function(C){return C?C:function(H){if(0===H)return H;H=Number(H);var T=Math.pow(Math.abs(H),1/3);return 0>H?-T:T}},"es6","es3");
$jscomp.polyfill("Math.hypot",function(C){return C?C:function(H){if(2>arguments.length)return arguments.length?Math.abs(arguments[0]):0;var T,aa,ba;for(T=ba=0;T<arguments.length;T++)ba=Math.max(ba,Math.abs(arguments[T]));if(1E100<ba||1E-100>ba){if(!ba)return ba;for(T=aa=0;T<arguments.length;T++){var na=Number(arguments[T])/ba;aa+=na*na}return Math.sqrt(aa)*ba}for(T=aa=0;T<arguments.length;T++)na=Number(arguments[T]),aa+=na*na;return Math.sqrt(aa)}},"es6","es3");
$jscomp.polyfill("Math.imul",function(C){return C?C:function(H,T){H=Number(H);T=Number(T);var aa=H&65535,ba=T&65535;return aa*ba+((H>>>16&65535)*ba+aa*(T>>>16&65535)<<16>>>0)|0}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var C={},H=Object.create(new $jscomp.global.Proxy(C,{get:function(T,aa,ba){return T==C&&"q"==aa&&ba==H}}));return!0===H.q}catch(T){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();
$jscomp.polyfill("WeakMap",function(C){function H(){if(!C||!Object.seal)return!1;try{var Z=Object.seal({}),ha=Object.seal({}),ra=new C([[Z,2],[ha,3]]);if(2!=ra.get(Z)||3!=ra.get(ha))return!1;ra.delete(Z);ra.set(ha,4);return!ra.has(Z)&&4==ra.get(ha)}catch(Pa){return!1}}function T(){}function aa(Z){var ha=typeof Z;return"object"===ha&&null!==Z||"function"===ha}function ba(Z){if(!$jscomp.owns(Z,da)){var ha=new T;$jscomp.defineProperty(Z,da,{value:ha})}}function na(Z){if(!$jscomp.ISOLATE_POLYFILLS){var ha=
Object[Z];ha&&(Object[Z]=function(ra){if(ra instanceof T)return ra;Object.isExtensible(ra)&&ba(ra);return ha(ra)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(C&&$jscomp.ES6_CONFORMANCE)return C}else if(H())return C;var da="$jscomp_hidden_"+Math.random();na("freeze");na("preventExtensions");na("seal");var A=0,fa=function(Z){this.id_=(A+=Math.random()+1).toString();if(Z){Z=$jscomp.makeIterator(Z);for(var ha;!(ha=Z.next()).done;)ha=ha.value,this.set(ha[0],ha[1])}};fa.prototype.set=function(Z,
ha){if(!aa(Z))throw Error("Invalid WeakMap key");ba(Z);if(!$jscomp.owns(Z,da))throw Error("WeakMap key fail: "+Z);Z[da][this.id_]=ha;return this};fa.prototype.get=function(Z){return aa(Z)&&$jscomp.owns(Z,da)?Z[da][this.id_]:void 0};fa.prototype.has=function(Z){return aa(Z)&&$jscomp.owns(Z,da)&&$jscomp.owns(Z[da],this.id_)};fa.prototype.delete=function(Z){return aa(Z)&&$jscomp.owns(Z,da)&&$jscomp.owns(Z[da],this.id_)?delete Z[da][this.id_]:!1};return fa},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(C){function H(){if($jscomp.ASSUME_NO_NATIVE_MAP||!C||"function"!=typeof C||!C.prototype.entries||"function"!=typeof Object.seal)return!1;try{var fa=Object.seal({x:4}),Z=new C($jscomp.makeIterator([[fa,"s"]]));if("s"!=Z.get(fa)||1!=Z.size||Z.get({x:4})||Z.set({x:4},"t")!=Z||2!=Z.size)return!1;var ha=Z.entries(),ra=ha.next();if(ra.done||ra.value[0]!=fa||"s"!=ra.value[1])return!1;ra=ha.next();return ra.done||4!=ra.value[0].x||"t"!=ra.value[1]||!ha.next().done?!1:!0}catch(Pa){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(C&&$jscomp.ES6_CONFORMANCE)return C}else if(H())return C;var T=new WeakMap,aa=function(fa){this.data_={};this.head_=da();this.size=0;if(fa){fa=$jscomp.makeIterator(fa);for(var Z;!(Z=fa.next()).done;)Z=Z.value,this.set(Z[0],Z[1])}};aa.prototype.set=function(fa,Z){fa=0===fa?0:fa;var ha=ba(this,fa);ha.list||(ha.list=this.data_[ha.id]=[]);ha.entry?ha.entry.value=Z:(ha.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:fa,value:Z},
ha.list.push(ha.entry),this.head_.previous.next=ha.entry,this.head_.previous=ha.entry,this.size++);return this};aa.prototype.delete=function(fa){fa=ba(this,fa);return fa.entry&&fa.list?(fa.list.splice(fa.index,1),fa.list.length||delete this.data_[fa.id],fa.entry.previous.next=fa.entry.next,fa.entry.next.previous=fa.entry.previous,fa.entry.head=null,this.size--,!0):!1};aa.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=da();this.size=0};aa.prototype.has=function(fa){return!!ba(this,
fa).entry};aa.prototype.get=function(fa){return(fa=ba(this,fa).entry)&&fa.value};aa.prototype.entries=function(){return na(this,function(fa){return[fa.key,fa.value]})};aa.prototype.keys=function(){return na(this,function(fa){return fa.key})};aa.prototype.values=function(){return na(this,function(fa){return fa.value})};aa.prototype.forEach=function(fa,Z){for(var ha=this.entries(),ra;!(ra=ha.next()).done;)ra=ra.value,fa.call(Z,ra[1],ra[0],this)};aa.prototype[Symbol.iterator]=aa.prototype.entries;var ba=
function(fa,Z){var ha=Z&&typeof Z;"object"==ha||"function"==ha?T.has(Z)?ha=T.get(Z):(ha=""+ ++A,T.set(Z,ha)):ha="p_"+Z;var ra=fa.data_[ha];if(ra&&$jscomp.owns(fa.data_,ha))for(fa=0;fa<ra.length;fa++){var Pa=ra[fa];if(Z!==Z&&Pa.key!==Pa.key||Z===Pa.key)return{id:ha,list:ra,index:fa,entry:Pa}}return{id:ha,list:ra,index:-1,entry:void 0}},na=function(fa,Z){var ha=fa.head_;return $jscomp.iteratorPrototype(function(){if(ha){for(;ha.head!=fa.head_;)ha=ha.previous;for(;ha.next!=ha.head;)return ha=ha.next,
{done:!1,value:Z(ha)};ha=null}return{done:!0,value:void 0}})},da=function(){var fa={};return fa.previous=fa.next=fa.head=fa},A=0;return aa},"es6","es3");
$jscomp.polyfill("Set",function(C){function H(){if($jscomp.ASSUME_NO_NATIVE_SET||!C||"function"!=typeof C||!C.prototype.entries||"function"!=typeof Object.seal)return!1;try{var aa=Object.seal({x:4}),ba=new C($jscomp.makeIterator([aa]));if(!ba.has(aa)||1!=ba.size||ba.add(aa)!=ba||1!=ba.size||ba.add({x:4})!=ba||2!=ba.size)return!1;var na=ba.entries(),da=na.next();if(da.done||da.value[0]!=aa||da.value[1]!=aa)return!1;da=na.next();return da.done||da.value[0]==aa||4!=da.value[0].x||da.value[1]!=da.value[0]?
!1:na.next().done}catch(A){return!1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(C&&$jscomp.ES6_CONFORMANCE)return C}else if(H())return C;var T=function(aa){this.map_=new Map;if(aa){aa=$jscomp.makeIterator(aa);for(var ba;!(ba=aa.next()).done;)this.add(ba.value)}this.size=this.map_.size};T.prototype.add=function(aa){aa=0===aa?0:aa;this.map_.set(aa,aa);this.size=this.map_.size;return this};T.prototype.delete=function(aa){aa=this.map_.delete(aa);this.size=this.map_.size;return aa};T.prototype.clear=
function(){this.map_.clear();this.size=0};T.prototype.has=function(aa){return this.map_.has(aa)};T.prototype.entries=function(){return this.map_.entries()};T.prototype.values=function(){return this.map_.values()};T.prototype.keys=T.prototype.values;T.prototype[Symbol.iterator]=T.prototype.values;T.prototype.forEach=function(aa,ba){var na=this;this.map_.forEach(function(da){return aa.call(ba,da,da,na)})};return T},"es6","es3");
$jscomp.polyfill("Object.setPrototypeOf",function(C){return C||$jscomp.setPrototypeOf},"es6","es5");$jscomp.polyfill("Object.values",function(C){return C?C:function(H){var T=[],aa;for(aa in H)$jscomp.owns(H,aa)&&T.push(H[aa]);return T}},"es8","es3");$jscomp.polyfill("Object.entries",function(C){return C?C:function(H){var T=[],aa;for(aa in H)$jscomp.owns(H,aa)&&T.push([aa,H[aa]]);return T}},"es8","es3");
$jscomp.polyfill("Array.prototype.fill",function(C){return C?C:function(H,T,aa){var ba=this.length||0;0>T&&(T=Math.max(0,ba+T));if(null==aa||aa>ba)aa=ba;aa=Number(aa);0>aa&&(aa=Math.max(0,ba+aa));for(T=Number(T||0);T<aa;T++)this[T]=H;return this}},"es6","es3");$jscomp.typedArrayFill=function(C){return C?C:Array.prototype.fill};$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
var enableInlineVideo=function(){function C(U,Aa,Ia,Ob){function Sb(Jb){Kb=Aa(Sb,Ob);U(Jb-(Pb||Jb));Pb=Jb}var Kb,Pb;return{start:function(){Kb||Sb(0)},stop:function(){Ia(Kb);Kb=null;Pb=0}}}function H(U,Aa,Ia){function Ob(Sb){Ia&&!Ia(U,Aa)||Sb.stopImmediatePropagation()}return U.addEventListener(Aa,Ob),Ob}function T(U,Aa,Ia,Ob){function Sb(Kb){Ia[Aa]=Kb}Ob&&Sb(U[Aa]);Object.defineProperty(U,Aa,{get:function(){return Ia[Aa]},set:Sb})}function aa(U,Aa,Ia){Ia.addEventListener(Aa,function(){return U.dispatchEvent(new Event(Aa))})}
function ba(U,Aa){Promise.resolve().then(function(){U.dispatchEvent(new Event(Aa))})}function na(U){var Aa=new Audio;return aa(U,"play",Aa),aa(U,"playing",Aa),aa(U,"pause",Aa),Aa.crossOrigin=U.crossOrigin,Aa.src=U.src||U.currentSrc||"data:",Aa}function da(U,Aa,Ia){(Ya||0)+200<Date.now()&&(U[vb]=!0,Ya=Date.now());Ia||(U.currentTime=Aa);db[++kb%3]=100*Aa|0}function A(U){this.video.readyState>=this.video.HAVE_FUTURE_DATA?(this.hasAudio||(this.driver.currentTime=this.video.currentTime+U*this.video.playbackRate/
1E3,this.video.loop&&this.driver.currentTime>=this.video.duration&&(this.driver.currentTime=0)),da(this.video,this.driver.currentTime)):this.video.networkState===this.video.NETWORK_IDLE&&0===this.video.buffered.length&&this.video.load();this.video.ended&&(delete this.video[vb],this.video.pause(!0))}function fa(){var U=this[cb];if(this.webkitDisplayingFullscreen)return void this[t]();"data:"!==U.driver.src&&U.driver.src!==this.src&&(da(this,0,!0),U.driver.src=this.src);this.paused&&(U.paused=!1,0===
this.buffered.length&&this.load(),U.driver.play(),U.updater.start(),U.hasAudio||(ba(this,"play"),U.video.readyState>=U.video.HAVE_ENOUGH_DATA&&ba(this,"playing")))}function Z(U){var Aa=this[cb];Aa.driver.pause();Aa.updater.stop();this.webkitDisplayingFullscreen&&this[Za]();Aa.paused&&!U||(Aa.paused=!0,Aa.hasAudio||ba(this,"pause"),this.ended&&!this.webkitDisplayingFullscreen&&(this[vb]=!0,ba(this,"ended")))}function ha(U,Aa){var Ia={};U[cb]=Ia;Ia.paused=!0;Ia.hasAudio=Aa;Ia.video=U;Ia.updater=C(A.bind(Ia),
requestAnimationFrame,cancelAnimationFrame);Aa?Ia.driver=na(U):(U.addEventListener("canplay",function(){U.paused||ba(U,"playing")}),Ia.driver={src:U.src||U.currentSrc||"data:",muted:!0,paused:!0,pause:function(){Ia.driver.paused=!0},play:function(){Ia.driver.paused=!1;Ia.driver.currentTime>=Ia.video.duration&&da(U,0)},get ended(){return Ia.driver.currentTime>=Ia.video.duration}});U.addEventListener("emptied",function(){var Ob=!Ia.driver.src||"data:"===Ia.driver.src;Ia.driver.src&&Ia.driver.src!==
U.src&&(da(U,0,!0),Ia.driver.src=U.src,Ob||!Aa&&U.autoplay?Ia.driver.play():Ia.updater.stop())},!1);U.addEventListener("webkitbeginfullscreen",function(){U.paused?Aa&&0===Ia.driver.buffered.length&&Ia.driver.load():(U.pause(),U[t]())});Aa&&(U.addEventListener("webkitendfullscreen",function(){Ia.driver.currentTime=U.currentTime}),U.addEventListener("seeking",function(){0>db.indexOf(100*U.currentTime|0)&&(Ia.driver.currentTime=U.currentTime)}))}function ra(U){var Aa=U[vb];return delete U[vb],!U.webkitDisplayingFullscreen&&
!Aa}function Pa(U){var Aa=U[cb];U[t]=U.play;U[Za]=U.pause;U.play=fa;U.pause=Z;T(U,"paused",Aa.driver);T(U,"muted",Aa.driver,!0);T(U,"playbackRate",Aa.driver,!0);T(U,"ended",Aa.driver);T(U,"loop",Aa.driver,!0);H(U,"seeking",function(Ia){return!Ia.webkitDisplayingFullscreen});H(U,"seeked",function(Ia){return!Ia.webkitDisplayingFullscreen});H(U,"timeupdate",ra);H(U,"ended",ra)}var Ya,za="object"==typeof document&&"object-fit"in document.head.style&&!matchMedia("(-webkit-video-playable-inline)").matches,
cb="bfred-it:iphone-inline-video",vb="bfred-it:iphone-inline-video:event",t="bfred-it:iphone-inline-video:nativeplay",Za="bfred-it:iphone-inline-video:nativepause",db=[],kb=0;return function(U,Aa){if(void 0===Aa&&(Aa={}),!U[cb])if(Aa.everywhere||za&&(Aa.iPad||Aa.ipad?/iPhone|iPod|iPad/:/iPhone|iPod/).test(navigator.userAgent))U.pause(),Aa=U.autoplay,U.autoplay=!1,ha(U,!U.muted),Pa(U),U.classList.add("IIV"),U.muted&&Aa&&(U.play(),U.addEventListener("playing",function Ob(){U.autoplay=!0;U.removeEventListener("playing",
Ob)})),/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments")}}();
(function(){function C(e,g,l){t.biginteger_used=1;null!=e&&("number"==typeof e&&"undefined"==typeof g?this.fromInt(e):"number"==typeof e?this.fromNumber(e,g,l):null==g&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,g))}function H(){return new C(null,void 0,void 0)}function T(e,g,l,r,y,F){for(;0<=--F;){var K=g*this[e++]+l[r]+y;y=Math.floor(K/67108864);l[r++]=K&67108863}return y}function aa(e,g,l,r,y,F){var K=g&32767;for(g>>=15;0<=--F;){var ca=this[e]&32767,ka=this[e++]>>15,pa=g*ca+ka*
K;ca=K*ca+((pa&32767)<<15)+l[r]+(y&1073741823);y=(ca>>>30)+(pa>>>15)+g*ka+(y>>>30);l[r++]=ca&1073741823}return y}function ba(e,g,l,r,y,F){var K=g&16383;for(g>>=14;0<=--F;){var ca=this[e]&16383,ka=this[e++]>>14,pa=g*ca+ka*K;ca=K*ca+((pa&16383)<<14)+l[r]+y;y=(ca>>28)+(pa>>14)+g*ka;l[r++]=ca&268435455}return y}function na(e,g){e=Pb[e.charCodeAt(g)];return null==e?-1:e}function da(e){var g=H();g.fromInt(e);return g}function A(e){var g=1,l;0!=(l=e>>>16)&&(e=l,g+=16);0!=(l=e>>8)&&(e=l,g+=8);0!=(l=e>>4)&&
(e=l,g+=4);0!=(l=e>>2)&&(e=l,g+=2);0!=e>>1&&(g+=1);return g}function fa(e){this.m=e}function Z(e){this.m=e;this.mp=e.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<e.DB-15)-1;this.mt2=2*e.t}function ha(e,g){return e&g}function ra(e,g){return e|g}function Pa(e,g){return e^g}function Ya(e,g){return e&~g}function za(){}function cb(e){return e}function vb(e){this.r2=H();this.q3=H();C.ONE.dlShiftTo(2*e.t,this.r2);this.mu=this.r2.divide(e);this.m=e}var t={use_lines:!0,use_xyz:!1},Za=
!1;"undefined"!==typeof module&&module.exports?(module.exports=t,Za=!0):"undefined"!==typeof document?window.ClipperLib=t:self.ClipperLib=t;if(Za){kb="chrome";var db="Netscape"}else{var kb=navigator.userAgent.toString().toLowerCase();db=navigator.appName}var U=-1!=kb.indexOf("chrome")&&-1==kb.indexOf("chromium")?1:0;Za=-1!=kb.indexOf("chromium")?1:0;var Aa=-1!=kb.indexOf("safari")&&-1==kb.indexOf("chrome")&&-1==kb.indexOf("chromium")?1:0;var Ia=-1!=kb.indexOf("firefox")?1:0;kb.indexOf("firefox/17");
kb.indexOf("firefox/15");kb.indexOf("firefox/3");var Ob=-1!=kb.indexOf("opera")?1:0;kb.indexOf("msie 10");kb.indexOf("msie 9");var Sb=-1!=kb.indexOf("msie 8")?1:0;var Kb=-1!=kb.indexOf("msie 7")?1:0;kb=-1!=kb.indexOf("msie ")?1:0;t.biginteger_used=null;"Microsoft Internet Explorer"==db?(C.prototype.am=aa,db=30):"Netscape"!=db?(C.prototype.am=T,db=26):(C.prototype.am=ba,db=28);C.prototype.DB=db;C.prototype.DM=(1<<db)-1;C.prototype.DV=1<<db;C.prototype.FV=Math.pow(2,52);C.prototype.F1=52-db;C.prototype.F2=
2*db-52;var Pb=[],Jb;db=48;for(Jb=0;9>=Jb;++Jb)Pb[db++]=Jb;db=97;for(Jb=10;36>Jb;++Jb)Pb[db++]=Jb;db=65;for(Jb=10;36>Jb;++Jb)Pb[db++]=Jb;fa.prototype.convert=function(e){return 0>e.s||0<=e.compareTo(this.m)?e.mod(this.m):e};fa.prototype.revert=function(e){return e};fa.prototype.reduce=function(e){e.divRemTo(this.m,null,e)};fa.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};fa.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};Z.prototype.convert=function(e){var g=H();e.abs().dlShiftTo(this.m.t,
g);g.divRemTo(this.m,null,g);0>e.s&&0<g.compareTo(C.ZERO)&&this.m.subTo(g,g);return g};Z.prototype.revert=function(e){var g=H();e.copyTo(g);this.reduce(g);return g};Z.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var g=0;g<this.m.t;++g){var l=e[g]&32767,r=l*this.mpl+((l*this.mph+(e[g]>>15)*this.mpl&this.um)<<15)&e.DM;l=g+this.m.t;for(e[l]+=this.m.am(0,r,e,g,0,this.m.t);e[l]>=e.DV;)e[l]-=e.DV,e[++l]++}e.clamp();e.drShiftTo(this.m.t,e);0<=e.compareTo(this.m)&&e.subTo(this.m,e)};Z.prototype.mulTo=
function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};Z.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};C.prototype.copyTo=function(e){for(var g=this.t-1;0<=g;--g)e[g]=this[g];e.t=this.t;e.s=this.s};C.prototype.fromInt=function(e){this.t=1;this.s=0>e?-1:0;0<e?this[0]=e:-1>e?this[0]=e+this.DV:this.t=0};C.prototype.fromString=function(e,g){if(16==g)g=4;else if(8==g)g=3;else if(256==g)g=8;else if(2==g)g=1;else if(32==g)g=5;else if(4==g)g=2;else{this.fromRadix(e,g);return}this.s=this.t=0;for(var l=
e.length,r=!1,y=0;0<=--l;){var F=8==g?e[l]&255:na(e,l);0>F?"-"==e.charAt(l)&&(r=!0):(r=!1,0==y?this[this.t++]=F:y+g>this.DB?(this[this.t-1]|=(F&(1<<this.DB-y)-1)<<y,this[this.t++]=F>>this.DB-y):this[this.t-1]|=F<<y,y+=g,y>=this.DB&&(y-=this.DB))}8==g&&0!=(e[0]&128)&&(this.s=-1,0<y&&(this[this.t-1]|=(1<<this.DB-y)-1<<y));this.clamp();r&&C.ZERO.subTo(this,this)};C.prototype.clamp=function(){for(var e=this.s&this.DM;0<this.t&&this[this.t-1]==e;)--this.t};C.prototype.dlShiftTo=function(e,g){var l;for(l=
this.t-1;0<=l;--l)g[l+e]=this[l];for(l=e-1;0<=l;--l)g[l]=0;g.t=this.t+e;g.s=this.s};C.prototype.drShiftTo=function(e,g){for(var l=e;l<this.t;++l)g[l-e]=this[l];g.t=Math.max(this.t-e,0);g.s=this.s};C.prototype.lShiftTo=function(e,g){var l=e%this.DB,r=this.DB-l,y=(1<<r)-1;e=Math.floor(e/this.DB);var F=this.s<<l&this.DM,K;for(K=this.t-1;0<=K;--K)g[K+e+1]=this[K]>>r|F,F=(this[K]&y)<<l;for(K=e-1;0<=K;--K)g[K]=0;g[e]=F;g.t=this.t+e+1;g.s=this.s;g.clamp()};C.prototype.rShiftTo=function(e,g){g.s=this.s;var l=
Math.floor(e/this.DB);if(l>=this.t)g.t=0;else{e%=this.DB;var r=this.DB-e,y=(1<<e)-1;g[0]=this[l]>>e;for(var F=l+1;F<this.t;++F)g[F-l-1]|=(this[F]&y)<<r,g[F-l]=this[F]>>e;0<e&&(g[this.t-l-1]|=(this.s&y)<<r);g.t=this.t-l;g.clamp()}};C.prototype.subTo=function(e,g){for(var l=0,r=0,y=Math.min(e.t,this.t);l<y;)r+=this[l]-e[l],g[l++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;l<this.t;)r+=this[l],g[l++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;l<e.t;)r-=e[l],g[l++]=r&this.DM,r>>=this.DB;
r-=e.s}g.s=0>r?-1:0;-1>r?g[l++]=this.DV+r:0<r&&(g[l++]=r);g.t=l;g.clamp()};C.prototype.multiplyTo=function(e,g){var l=this.abs(),r=e.abs(),y=l.t;for(g.t=y+r.t;0<=--y;)g[y]=0;for(y=0;y<r.t;++y)g[y+l.t]=l.am(0,r[y],g,y,0,l.t);g.s=0;g.clamp();this.s!=e.s&&C.ZERO.subTo(g,g)};C.prototype.squareTo=function(e){for(var g=this.abs(),l=e.t=2*g.t;0<=--l;)e[l]=0;for(l=0;l<g.t-1;++l){var r=g.am(l,g[l],e,2*l,0,1);(e[l+g.t]+=g.am(l+1,2*g[l],e,2*l+1,r,g.t-l-1))>=g.DV&&(e[l+g.t]-=g.DV,e[l+g.t+1]=1)}0<e.t&&(e[e.t-
1]+=g.am(l,g[l],e,2*l,0,1));e.s=0;e.clamp()};C.prototype.divRemTo=function(e,g,l){var r=e.abs();if(!(0>=r.t)){var y=this.abs();if(y.t<r.t)null!=g&&g.fromInt(0),null!=l&&this.copyTo(l);else{null==l&&(l=H());var F=H(),K=this.s;e=e.s;var ca=this.DB-A(r[r.t-1]);0<ca?(r.lShiftTo(ca,F),y.lShiftTo(ca,l)):(r.copyTo(F),y.copyTo(l));r=F.t;y=F[r-1];if(0!=y){var ka=y*(1<<this.F1)+(1<r?F[r-2]>>this.F2:0),pa=this.FV/ka;ka=(1<<this.F1)/ka;var La=1<<this.F2,eb=l.t,Va=eb-r,Ea=null==g?H():g;F.dlShiftTo(Va,Ea);0<=l.compareTo(Ea)&&
(l[l.t++]=1,l.subTo(Ea,l));C.ONE.dlShiftTo(r,Ea);for(Ea.subTo(F,F);F.t<r;)F[F.t++]=0;for(;0<=--Va;){var Sa=l[--eb]==y?this.DM:Math.floor(l[eb]*pa+(l[eb-1]+La)*ka);if((l[eb]+=F.am(0,Sa,l,Va,0,r))<Sa)for(F.dlShiftTo(Va,Ea),l.subTo(Ea,l);l[eb]<--Sa;)l.subTo(Ea,l)}null!=g&&(l.drShiftTo(r,g),K!=e&&C.ZERO.subTo(g,g));l.t=r;l.clamp();0<ca&&l.rShiftTo(ca,l);0>K&&C.ZERO.subTo(l,l)}}}};C.prototype.invDigit=function(){if(1>this.t)return 0;var e=this[0];if(0==(e&1))return 0;var g=e&3;g=g*(2-(e&15)*g)&15;g=g*
(2-(e&255)*g)&255;g=g*(2-((e&65535)*g&65535))&65535;g=g*(2-e*g%this.DV)%this.DV;return 0<g?this.DV-g:-g};C.prototype.isEven=function(){return 0==(0<this.t?this[0]&1:this.s)};C.prototype.exp=function(e,g){if(4294967295<e||1>e)return C.ONE;var l=H(),r=H(),y=g.convert(this),F=A(e)-1;for(y.copyTo(l);0<=--F;)if(g.sqrTo(l,r),0<(e&1<<F))g.mulTo(r,y,l);else{var K=l;l=r;r=K}return g.revert(l)};C.prototype.toString=function(e){if(0>this.s)return"-"+this.negate().toString(e);if(16==e)e=4;else if(8==e)e=3;else if(2==
e)e=1;else if(32==e)e=5;else if(4==e)e=2;else return this.toRadix(e);var g=(1<<e)-1,l,r=!1,y="",F=this.t,K=this.DB-F*this.DB%e;if(0<F--)for(K<this.DB&&0<(l=this[F]>>K)&&(r=!0,y="0123456789abcdefghijklmnopqrstuvwxyz".charAt(l));0<=F;)K<e?(l=(this[F]&(1<<K)-1)<<e-K,l|=this[--F]>>(K+=this.DB-e)):(l=this[F]>>(K-=e)&g,0>=K&&(K+=this.DB,--F)),0<l&&(r=!0),r&&(y+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(l));return r?y:"0"};C.prototype.negate=function(){var e=H();C.ZERO.subTo(this,e);return e};C.prototype.abs=
function(){return 0>this.s?this.negate():this};C.prototype.compareTo=function(e){var g=this.s-e.s;if(0!=g)return g;var l=this.t;g=l-e.t;if(0!=g)return 0>this.s?-g:g;for(;0<=--l;)if(0!=(g=this[l]-e[l]))return g;return 0};C.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+A(this[this.t-1]^this.s&this.DM)};C.prototype.mod=function(e){var g=H();this.abs().divRemTo(e,null,g);0>this.s&&0<g.compareTo(C.ZERO)&&e.subTo(g,g);return g};C.prototype.modPowInt=function(e,g){g=256>e||g.isEven()?
new fa(g):new Z(g);return this.exp(e,g)};C.ZERO=da(0);C.ONE=da(1);za.prototype.convert=cb;za.prototype.revert=cb;za.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l)};za.prototype.sqrTo=function(e,g){e.squareTo(g)};vb.prototype.convert=function(e){if(0>e.s||e.t>2*this.m.t)return e.mod(this.m);if(0>e.compareTo(this.m))return e;var g=H();e.copyTo(g);this.reduce(g);return g};vb.prototype.revert=function(e){return e};vb.prototype.reduce=function(e){e.drShiftTo(this.m.t-1,this.r2);e.t>this.m.t+1&&(e.t=
this.m.t+1,e.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>e.compareTo(this.r2);)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);0<=e.compareTo(this.m);)e.subTo(this.m,e)};vb.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};vb.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};var Gb=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,
157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,
967,971,977,983,991,997],ud=67108864/Gb[Gb.length-1];C.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))};C.prototype.toRadix=function(e){null==e&&(e=10);if(0==this.signum()||2>e||36<e)return"0";var g=this.chunkSize(e);g=Math.pow(e,g);var l=da(g),r=H(),y=H(),F="";for(this.divRemTo(l,r,y);0<r.signum();)F=(g+y.intValue()).toString(e).substr(1)+F,r.divRemTo(l,r,y);return y.intValue().toString(e)+F};C.prototype.fromRadix=function(e,g){this.fromInt(0);null==g&&(g=10);for(var l=
this.chunkSize(g),r=Math.pow(g,l),y=!1,F=0,K=0,ca=0;ca<e.length;++ca){var ka=na(e,ca);0>ka?"-"==e.charAt(ca)&&0==this.signum()&&(y=!0):(K=g*K+ka,++F>=l&&(this.dMultiply(r),this.dAddOffset(K,0),K=F=0))}0<F&&(this.dMultiply(Math.pow(g,F)),this.dAddOffset(K,0));y&&C.ZERO.subTo(this,this)};C.prototype.fromNumber=function(e,g,l){if("number"==typeof g)if(2>e)this.fromInt(1);else for(this.fromNumber(e,l),this.testBit(e-1)||this.bitwiseTo(C.ONE.shiftLeft(e-1),ra,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(g);)this.dAddOffset(2,
0),this.bitLength()>e&&this.subTo(C.ONE.shiftLeft(e-1),this);else{l=[];var r=e&7;l.length=(e>>3)+1;g.nextBytes(l);l[0]=0<r?l[0]&(1<<r)-1:0;this.fromString(l,256)}};C.prototype.bitwiseTo=function(e,g,l){var r,y=Math.min(e.t,this.t);for(r=0;r<y;++r)l[r]=g(this[r],e[r]);if(e.t<this.t){var F=e.s&this.DM;for(r=y;r<this.t;++r)l[r]=g(this[r],F);l.t=this.t}else{F=this.s&this.DM;for(r=y;r<e.t;++r)l[r]=g(F,e[r]);l.t=e.t}l.s=g(this.s,e.s);l.clamp()};C.prototype.changeBit=function(e,g){e=C.ONE.shiftLeft(e);this.bitwiseTo(e,
g,e);return e};C.prototype.addTo=function(e,g){for(var l=0,r=0,y=Math.min(e.t,this.t);l<y;)r+=this[l]+e[l],g[l++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;l<this.t;)r+=this[l],g[l++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;l<e.t;)r+=e[l],g[l++]=r&this.DM,r>>=this.DB;r+=e.s}g.s=0>r?-1:0;0<r?g[l++]=r:-1>r&&(g[l++]=this.DV+r);g.t=l;g.clamp()};C.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t);++this.t;this.clamp()};C.prototype.dAddOffset=function(e,g){if(0!=
e){for(;this.t<=g;)this[this.t++]=0;for(this[g]+=e;this[g]>=this.DV;)this[g]-=this.DV,++g>=this.t&&(this[this.t++]=0),++this[g]}};C.prototype.multiplyLowerTo=function(e,g,l){var r=Math.min(this.t+e.t,g);l.s=0;for(l.t=r;0<r;)l[--r]=0;var y;for(y=l.t-this.t;r<y;++r)l[r+this.t]=this.am(0,e[r],l,r,0,this.t);for(y=Math.min(e.t,g);r<y;++r)this.am(0,e[r],l,r,0,g-r);l.clamp()};C.prototype.multiplyUpperTo=function(e,g,l){--g;var r=l.t=this.t+e.t-g;for(l.s=0;0<=--r;)l[r]=0;for(r=Math.max(g-this.t,0);r<e.t;++r)l[this.t+
r-g]=this.am(g-r,e[r],l,0,0,this.t+r-g);l.clamp();l.drShiftTo(1,l)};C.prototype.modInt=function(e){if(0>=e)return 0;var g=this.DV%e,l=0>this.s?e-1:0;if(0<this.t)if(0==g)l=this[0]%e;else for(var r=this.t-1;0<=r;--r)l=(g*l+this[r])%e;return l};C.prototype.millerRabin=function(e){var g=this.subtract(C.ONE),l=g.getLowestSetBit();if(0>=l)return!1;var r=g.shiftRight(l);e=e+1>>1;e>Gb.length&&(e=Gb.length);for(var y=H(),F=0;F<e;++F){y.fromInt(Gb[Math.floor(Math.random()*Gb.length)]);var K=y.modPow(r,this);
if(0!=K.compareTo(C.ONE)&&0!=K.compareTo(g)){for(var ca=1;ca++<l&&0!=K.compareTo(g);)if(K=K.modPowInt(2,this),0==K.compareTo(C.ONE))return!1;if(0!=K.compareTo(g))return!1}}return!0};C.prototype.clone=function(){var e=H();this.copyTo(e);return e};C.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};C.prototype.byteValue=function(){return 0==this.t?
this.s:this[0]<<24>>24};C.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};C.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1};C.prototype.toByteArray=function(){var e=this.t,g=[];g[0]=this.s;var l=this.DB-e*this.DB%8,r,y=0;if(0<e--)for(l<this.DB&&(r=this[e]>>l)!=(this.s&this.DM)>>l&&(g[y++]=r|this.s<<this.DB-l);0<=e;)if(8>l?(r=(this[e]&(1<<l)-1)<<8-l,r|=this[--e]>>(l+=this.DB-8)):(r=this[e]>>(l-=8)&255,0>=l&&(l+=this.DB,--e)),0!=(r&128)&&
(r|=-256),0==y&&(this.s&128)!=(r&128)&&++y,0<y||r!=this.s)g[y++]=r;return g};C.prototype.equals=function(e){return 0==this.compareTo(e)};C.prototype.min=function(e){return 0>this.compareTo(e)?this:e};C.prototype.max=function(e){return 0<this.compareTo(e)?this:e};C.prototype.and=function(e){var g=H();this.bitwiseTo(e,ha,g);return g};C.prototype.or=function(e){var g=H();this.bitwiseTo(e,ra,g);return g};C.prototype.xor=function(e){var g=H();this.bitwiseTo(e,Pa,g);return g};C.prototype.andNot=function(e){var g=
H();this.bitwiseTo(e,Ya,g);return g};C.prototype.not=function(){for(var e=H(),g=0;g<this.t;++g)e[g]=this.DM&~this[g];e.t=this.t;e.s=~this.s;return e};C.prototype.shiftLeft=function(e){var g=H();0>e?this.rShiftTo(-e,g):this.lShiftTo(e,g);return g};C.prototype.shiftRight=function(e){var g=H();0>e?this.lShiftTo(-e,g):this.rShiftTo(e,g);return g};C.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e]){var g=e*this.DB;e=this[e];if(0==e)e=-1;else{var l=0;0==(e&65535)&&(e>>=16,l+=
16);0==(e&255)&&(e>>=8,l+=8);0==(e&15)&&(e>>=4,l+=4);0==(e&3)&&(e>>=2,l+=2);0==(e&1)&&++l;e=l}return g+e}return 0>this.s?this.t*this.DB:-1};C.prototype.bitCount=function(){for(var e=0,g=this.s&this.DM,l=0;l<this.t;++l){for(var r=this[l]^g,y=0;0!=r;)r&=r-1,++y;e+=y}return e};C.prototype.testBit=function(e){var g=Math.floor(e/this.DB);return g>=this.t?0!=this.s:0!=(this[g]&1<<e%this.DB)};C.prototype.setBit=function(e){return this.changeBit(e,ra)};C.prototype.clearBit=function(e){return this.changeBit(e,
Ya)};C.prototype.flipBit=function(e){return this.changeBit(e,Pa)};C.prototype.add=function(e){var g=H();this.addTo(e,g);return g};C.prototype.subtract=function(e){var g=H();this.subTo(e,g);return g};C.prototype.multiply=function(e){var g=H();this.multiplyTo(e,g);return g};C.prototype.divide=function(e){var g=H();this.divRemTo(e,g,null);return g};C.prototype.remainder=function(e){var g=H();this.divRemTo(e,null,g);return g};C.prototype.divideAndRemainder=function(e){var g=H(),l=H();this.divRemTo(e,
g,l);return[g,l]};C.prototype.modPow=function(e,g){var l=e.bitLength(),r=da(1);if(0>=l)return r;var y=18>l?1:48>l?3:144>l?4:768>l?5:6;g=8>l?new fa(g):g.isEven()?new vb(g):new Z(g);var F=[],K=3,ca=y-1,ka=(1<<y)-1;F[1]=g.convert(this);if(1<y)for(l=H(),g.sqrTo(F[1],l);K<=ka;)F[K]=H(),g.mulTo(l,F[K-2],F[K]),K+=2;var pa=e.t-1,La,eb=!0,Va=H();for(l=A(e[pa])-1;0<=pa;){l>=ca?La=e[pa]>>l-ca&ka:(La=(e[pa]&(1<<l+1)-1)<<ca-l,0<pa&&(La|=e[pa-1]>>this.DB+l-ca));for(K=y;0==(La&1);)La>>=1,--K;0>(l-=K)&&(l+=this.DB,
--pa);if(eb)F[La].copyTo(r),eb=!1;else{for(;1<K;)g.sqrTo(r,Va),g.sqrTo(Va,r),K-=2;0<K?g.sqrTo(r,Va):(K=r,r=Va,Va=K);g.mulTo(Va,F[La],r)}for(;0<=pa&&0==(e[pa]&1<<l);)g.sqrTo(r,Va),K=r,r=Va,Va=K,0>--l&&(l=this.DB-1,--pa)}return g.revert(r)};C.prototype.modInverse=function(e){var g=e.isEven();if(this.isEven()&&g||0==e.signum())return C.ZERO;for(var l=e.clone(),r=this.clone(),y=da(1),F=da(0),K=da(0),ca=da(1);0!=l.signum();){for(;l.isEven();)l.rShiftTo(1,l),g?(y.isEven()&&F.isEven()||(y.addTo(this,y),
F.subTo(e,F)),y.rShiftTo(1,y)):F.isEven()||F.subTo(e,F),F.rShiftTo(1,F);for(;r.isEven();)r.rShiftTo(1,r),g?(K.isEven()&&ca.isEven()||(K.addTo(this,K),ca.subTo(e,ca)),K.rShiftTo(1,K)):ca.isEven()||ca.subTo(e,ca),ca.rShiftTo(1,ca);0<=l.compareTo(r)?(l.subTo(r,l),g&&y.subTo(K,y),F.subTo(ca,F)):(r.subTo(l,r),g&&K.subTo(y,K),ca.subTo(F,ca))}if(0!=r.compareTo(C.ONE))return C.ZERO;if(0<=ca.compareTo(e))return ca.subtract(e);if(0>ca.signum())ca.addTo(e,ca);else return ca;return 0>ca.signum()?ca.add(e):ca};
C.prototype.pow=function(e){return this.exp(e,new za)};C.prototype.gcd=function(e){var g=0>this.s?this.negate():this.clone();e=0>e.s?e.negate():e.clone();if(0>g.compareTo(e)){var l=g;g=e;e=l}l=g.getLowestSetBit();var r=e.getLowestSetBit();if(0>r)return g;l<r&&(r=l);for(0<r&&(g.rShiftTo(r,g),e.rShiftTo(r,e));0<g.signum();)0<(l=g.getLowestSetBit())&&g.rShiftTo(l,g),0<(l=e.getLowestSetBit())&&e.rShiftTo(l,e),0<=g.compareTo(e)?(g.subTo(e,g),g.rShiftTo(1,g)):(e.subTo(g,e),e.rShiftTo(1,e));0<r&&e.lShiftTo(r,
e);return e};C.prototype.isProbablePrime=function(e){var g,l=this.abs();if(1==l.t&&l[0]<=Gb[Gb.length-1]){for(g=0;g<Gb.length;++g)if(l[0]==Gb[g])return!0;return!1}if(l.isEven())return!1;for(g=1;g<Gb.length;){for(var r=Gb[g],y=g+1;y<Gb.length&&r<ud;)r*=Gb[y++];for(r=l.modInt(r);g<y;)if(0==r%Gb[g++])return!1}return l.millerRabin(e)};C.prototype.square=function(){var e=H();this.squareTo(e);return e};C.prototype.IsNegative=function(){return-1==this.compareTo(C.ZERO)?!0:!1};C.op_Equality=function(e,g){return 0==
e.compareTo(g)?!0:!1};C.op_Inequality=function(e,g){return 0!=e.compareTo(g)?!0:!1};C.op_GreaterThan=function(e,g){return 0<e.compareTo(g)?!0:!1};C.op_LessThan=function(e,g){return 0>e.compareTo(g)?!0:!1};C.op_Addition=function(e,g){return(new C(e)).add(new C(g))};C.op_Subtraction=function(e,g){return(new C(e)).subtract(new C(g))};C.Int128Mul=function(e,g){return(new C(e)).multiply(new C(g))};C.op_Division=function(e,g){return e.divide(g)};C.prototype.ToDouble=function(){return parseFloat(this.toString())};
db=function(e,g){var l;if("undefined"==typeof Object.getOwnPropertyNames)for(l in g.prototype){if("undefined"==typeof e.prototype[l]||e.prototype[l]==Object.prototype[l])e.prototype[l]=g.prototype[l]}else for(var r=Object.getOwnPropertyNames(g.prototype),y=0;y<r.length;y++)"undefined"==typeof Object.getOwnPropertyDescriptor(e.prototype,r[y])&&Object.defineProperty(e.prototype,r[y],Object.getOwnPropertyDescriptor(g.prototype,r[y]));for(l in g)"undefined"==typeof e[l]&&(e[l]=g[l]);e.$baseCtor=g};t.Path=
function(){return[]};t.Paths=function(){return[]};t.DoublePoint=function(){var e=arguments;this.Y=this.X=0;1==e.length?(this.X=e[0].X,this.Y=e[0].Y):2==e.length&&(this.X=e[0],this.Y=e[1])};t.DoublePoint0=function(){this.Y=this.X=0};t.DoublePoint1=function(e){this.X=e.X;this.Y=e.Y};t.DoublePoint2=function(e,g){this.X=e;this.Y=g};t.PolyNode=function(){this.m_Parent=null;this.m_polygon=new t.Path;this.m_endtype=this.m_jointype=this.m_Index=0;this.m_Childs=[];this.IsOpen=!1};t.PolyNode.prototype.IsHoleNode=
function(){for(var e=!0,g=this.m_Parent;null!==g;)e=!e,g=g.m_Parent;return e};t.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length};t.PolyNode.prototype.Contour=function(){return this.m_polygon};t.PolyNode.prototype.AddChild=function(e){var g=this.m_Childs.length;this.m_Childs.push(e);e.m_Parent=this;e.m_Index=g};t.PolyNode.prototype.GetNext=function(){return 0<this.m_Childs.length?this.m_Childs[0]:this.GetNextSiblingUp()};t.PolyNode.prototype.GetNextSiblingUp=function(){return null===
this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]};t.PolyNode.prototype.Childs=function(){return this.m_Childs};t.PolyNode.prototype.Parent=function(){return this.m_Parent};t.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()};t.PolyTree=function(){this.m_AllPolys=[];t.PolyNode.call(this)};t.PolyTree.prototype.Clear=function(){for(var e=0,g=this.m_AllPolys.length;e<g;e++)this.m_AllPolys[e]=null;this.m_AllPolys.length=
0;this.m_Childs.length=0};t.PolyTree.prototype.GetFirst=function(){return 0<this.m_Childs.length?this.m_Childs[0]:null};t.PolyTree.prototype.Total=function(){var e=this.m_AllPolys.length;0<e&&this.m_Childs[0]!=this.m_AllPolys[0]&&e--;return e};db(t.PolyTree,t.PolyNode);t.Math_Abs_Int64=t.Math_Abs_Int32=t.Math_Abs_Double=function(e){return Math.abs(e)};t.Math_Max_Int32_Int32=function(e,g){return Math.max(e,g)};t.Cast_Int32=kb||Ob||Aa?function(e){return e|0}:function(e){return~~e};t.Cast_Int64=U?function(e){return-2147483648>
e||2147483647<e?0>e?Math.ceil(e):Math.floor(e):~~e}:Ia&&"function"==typeof Number.toInteger?function(e){return Number.toInteger(e)}:Kb||Sb?function(e){return parseInt(e,10)}:kb?function(e){return-2147483648>e||2147483647<e?0>e?Math.ceil(e):Math.floor(e):e|0}:function(e){return 0>e?Math.ceil(e):Math.floor(e)};t.Clear=function(e){e.length=0};t.PI=3.141592653589793;t.PI2=6.283185307179586;t.IntPoint=function(){var e=arguments,g=e.length;this.Y=this.X=0;t.use_xyz?(this.Z=0,3==g?(this.X=e[0],this.Y=e[1],
this.Z=e[2]):2==g?(this.X=e[0],this.Y=e[1],this.Z=0):1==g?e[0]instanceof t.DoublePoint?(e=e[0],this.X=t.Clipper.Round(e.X),this.Y=t.Clipper.Round(e.Y),this.Z=0):(e=e[0],"undefined"==typeof e.Z&&(e.Z=0),this.X=e.X,this.Y=e.Y,this.Z=e.Z):this.Z=this.Y=this.X=0):2==g?(this.X=e[0],this.Y=e[1]):1==g?e[0]instanceof t.DoublePoint?(e=e[0],this.X=t.Clipper.Round(e.X),this.Y=t.Clipper.Round(e.Y)):(e=e[0],this.X=e.X,this.Y=e.Y):this.Y=this.X=0};t.IntPoint.op_Equality=function(e,g){return e.X==g.X&&e.Y==g.Y};
t.IntPoint.op_Inequality=function(e,g){return e.X!=g.X||e.Y!=g.Y};t.use_xyz?(t.IntPoint0=function(){this.Z=this.Y=this.X=0},t.IntPoint1=function(e){this.X=e.X;this.Y=e.Y;this.Z=e.Z},t.IntPoint1dp=function(e){this.X=t.Clipper.Round(e.X);this.Y=t.Clipper.Round(e.Y);this.Z=0},t.IntPoint2=function(e,g){this.X=e;this.Y=g;this.Z=0},t.IntPoint3=function(e,g,l){this.X=e;this.Y=g;this.Z=l}):(t.IntPoint0=function(){this.Y=this.X=0},t.IntPoint1=function(e){this.X=e.X;this.Y=e.Y},t.IntPoint1dp=function(e){this.X=
t.Clipper.Round(e.X);this.Y=t.Clipper.Round(e.Y)},t.IntPoint2=function(e,g){this.X=e;this.Y=g});t.IntRect=function(){var e=arguments,g=e.length;4==g?(this.left=e[0],this.top=e[1],this.right=e[2],this.bottom=e[3]):1==g?(this.left=e[0].left,this.top=e[0].top,this.right=e[0].right,this.bottom=e[0].bottom):this.bottom=this.right=this.top=this.left=0};t.IntRect0=function(){this.bottom=this.right=this.top=this.left=0};t.IntRect1=function(e){this.left=e.left;this.top=e.top;this.right=e.right;this.bottom=
e.bottom};t.IntRect4=function(e,g,l,r){this.left=e;this.top=g;this.right=l;this.bottom=r};t.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3};t.PolyType={ptSubject:0,ptClip:1};t.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};t.JoinType={jtSquare:0,jtRound:1,jtMiter:2};t.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4};t.EdgeSide={esLeft:0,esRight:1};t.Direction={dRightToLeft:0,dLeftToRight:1};t.TEdge=function(){this.Bot=new t.IntPoint;
this.Curr=new t.IntPoint;this.Top=new t.IntPoint;this.Delta=new t.IntPoint;this.Dx=0;this.PolyTyp=t.PolyType.ptSubject;this.Side=t.EdgeSide.esLeft;this.OutIdx=this.WindCnt2=this.WindCnt=this.WindDelta=0;this.PrevInSEL=this.NextInSEL=this.PrevInAEL=this.NextInAEL=this.NextInLML=this.Prev=this.Next=null};t.IntersectNode=function(){this.Edge2=this.Edge1=null;this.Pt=new t.IntPoint};t.MyIntersectNodeSort=function(){};t.MyIntersectNodeSort.Compare=function(e,g){e=g.Pt.Y-e.Pt.Y;return 0<e?1:0>e?-1:0};t.LocalMinima=
function(){this.Y=0;this.Next=this.RightBound=this.LeftBound=null};t.Scanbeam=function(){this.Y=0;this.Next=null};t.OutRec=function(){this.Idx=0;this.IsOpen=this.IsHole=!1;this.PolyNode=this.BottomPt=this.Pts=this.FirstLeft=null};t.OutPt=function(){this.Idx=0;this.Pt=new t.IntPoint;this.Prev=this.Next=null};t.Join=function(){this.OutPt2=this.OutPt1=null;this.OffPt=new t.IntPoint};t.ClipperBase=function(){this.m_edges=[];this.PreserveCollinear=!1;this.m_CurrentLM=this.m_MinimaList=null;this.m_HasOpenPaths=
this.m_UseFullRange=!1};t.ClipperBase.horizontal=-9007199254740992;t.ClipperBase.Skip=-2;t.ClipperBase.Unassigned=-1;t.ClipperBase.tolerance=1E-20;t.ClipperBase.loRange=47453132;t.ClipperBase.hiRange=0xfffffffffffff;t.ClipperBase.near_zero=function(e){return e>-t.ClipperBase.tolerance&&e<t.ClipperBase.tolerance};t.ClipperBase.IsHorizontal=function(e){return 0===e.Delta.Y};t.ClipperBase.prototype.PointIsVertex=function(e,g){var l=g;do{if(t.IntPoint.op_Equality(l.Pt,e))return!0;l=l.Next}while(l!=g);
return!1};t.ClipperBase.prototype.PointOnLineSegment=function(e,g,l,r){return r?e.X==g.X&&e.Y==g.Y||e.X==l.X&&e.Y==l.Y||e.X>g.X==e.X<l.X&&e.Y>g.Y==e.Y<l.Y&&C.op_Equality(C.Int128Mul(e.X-g.X,l.Y-g.Y),C.Int128Mul(l.X-g.X,e.Y-g.Y)):e.X==g.X&&e.Y==g.Y||e.X==l.X&&e.Y==l.Y||e.X>g.X==e.X<l.X&&e.Y>g.Y==e.Y<l.Y&&(e.X-g.X)*(l.Y-g.Y)==(l.X-g.X)*(e.Y-g.Y)};t.ClipperBase.prototype.PointOnPolygon=function(e,g,l){for(var r=g;;){if(this.PointOnLineSegment(e,r.Pt,r.Next.Pt,l))return!0;r=r.Next;if(r==g)break}return!1};
t.ClipperBase.prototype.SlopesEqual=t.ClipperBase.SlopesEqual=function(){var e=arguments,g=e.length,l,r;if(3==g)return g=e[0],l=e[1],e[2]?C.op_Equality(C.Int128Mul(g.Delta.Y,l.Delta.X),C.Int128Mul(g.Delta.X,l.Delta.Y)):t.Cast_Int64(g.Delta.Y*l.Delta.X)==t.Cast_Int64(g.Delta.X*l.Delta.Y);if(4==g)return g=e[0],l=e[1],r=e[2],e[3]?C.op_Equality(C.Int128Mul(g.Y-l.Y,l.X-r.X),C.Int128Mul(g.X-l.X,l.Y-r.Y)):0===t.Cast_Int64((g.Y-l.Y)*(l.X-r.X))-t.Cast_Int64((g.X-l.X)*(l.Y-r.Y));g=e[0];l=e[1];r=e[2];var y=
e[3];return e[4]?C.op_Equality(C.Int128Mul(g.Y-l.Y,r.X-y.X),C.Int128Mul(g.X-l.X,r.Y-y.Y)):0===t.Cast_Int64((g.Y-l.Y)*(r.X-y.X))-t.Cast_Int64((g.X-l.X)*(r.Y-y.Y))};t.ClipperBase.SlopesEqual3=function(e,g,l){return l?C.op_Equality(C.Int128Mul(e.Delta.Y,g.Delta.X),C.Int128Mul(e.Delta.X,g.Delta.Y)):t.Cast_Int64(e.Delta.Y*g.Delta.X)==t.Cast_Int64(e.Delta.X*g.Delta.Y)};t.ClipperBase.SlopesEqual4=function(e,g,l,r){return r?C.op_Equality(C.Int128Mul(e.Y-g.Y,g.X-l.X),C.Int128Mul(e.X-g.X,g.Y-l.Y)):0===t.Cast_Int64((e.Y-
g.Y)*(g.X-l.X))-t.Cast_Int64((e.X-g.X)*(g.Y-l.Y))};t.ClipperBase.SlopesEqual5=function(e,g,l,r,y){return y?C.op_Equality(C.Int128Mul(e.Y-g.Y,l.X-r.X),C.Int128Mul(e.X-g.X,l.Y-r.Y)):0===t.Cast_Int64((e.Y-g.Y)*(l.X-r.X))-t.Cast_Int64((e.X-g.X)*(l.Y-r.Y))};t.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var e=0,g=this.m_edges.length;e<g;++e){for(var l=0,r=this.m_edges[e].length;l<r;++l)this.m_edges[e][l]=null;t.Clear(this.m_edges[e])}t.Clear(this.m_edges);this.m_HasOpenPaths=
this.m_UseFullRange=!1};t.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var e=this.m_MinimaList.Next;this.m_MinimaList=null;this.m_MinimaList=e}this.m_CurrentLM=null};t.ClipperBase.prototype.RangeTest=function(e,g){if(g.Value)(e.X>t.ClipperBase.hiRange||e.Y>t.ClipperBase.hiRange||-e.X>t.ClipperBase.hiRange||-e.Y>t.ClipperBase.hiRange)&&t.Error("Coordinate outside allowed range in RangeTest().");else if(e.X>t.ClipperBase.loRange||e.Y>t.ClipperBase.loRange||
-e.X>t.ClipperBase.loRange||-e.Y>t.ClipperBase.loRange)g.Value=!0,this.RangeTest(e,g)};t.ClipperBase.prototype.InitEdge=function(e,g,l,r){e.Next=g;e.Prev=l;e.Curr.X=r.X;e.Curr.Y=r.Y;t.use_xyz&&(e.Curr.Z=r.Z);e.OutIdx=-1};t.ClipperBase.prototype.InitEdge2=function(e,g){e.Curr.Y>=e.Next.Curr.Y?(e.Bot.X=e.Curr.X,e.Bot.Y=e.Curr.Y,t.use_xyz&&(e.Bot.Z=e.Curr.Z),e.Top.X=e.Next.Curr.X,e.Top.Y=e.Next.Curr.Y,t.use_xyz&&(e.Top.Z=e.Next.Curr.Z)):(e.Top.X=e.Curr.X,e.Top.Y=e.Curr.Y,t.use_xyz&&(e.Top.Z=e.Curr.Z),
e.Bot.X=e.Next.Curr.X,e.Bot.Y=e.Next.Curr.Y,t.use_xyz&&(e.Bot.Z=e.Next.Curr.Z));this.SetDx(e);e.PolyTyp=g};t.ClipperBase.prototype.FindNextLocMin=function(e){for(var g;;){for(;t.IntPoint.op_Inequality(e.Bot,e.Prev.Bot)||t.IntPoint.op_Equality(e.Curr,e.Top);)e=e.Next;if(e.Dx!=t.ClipperBase.horizontal&&e.Prev.Dx!=t.ClipperBase.horizontal)break;for(;e.Prev.Dx==t.ClipperBase.horizontal;)e=e.Prev;for(g=e;e.Dx==t.ClipperBase.horizontal;)e=e.Next;if(e.Top.Y!=e.Prev.Bot.Y){g.Prev.Bot.X<e.Bot.X&&(e=g);break}}return e};
t.ClipperBase.prototype.ProcessBound=function(e,g){var l,r=e,y;if(r.OutIdx==t.ClipperBase.Skip){e=r;if(g){for(;e.Top.Y==e.Next.Bot.Y;)e=e.Next;for(;e!=r&&e.Dx==t.ClipperBase.horizontal;)e=e.Prev}else{for(;e.Top.Y==e.Prev.Bot.Y;)e=e.Prev;for(;e!=r&&e.Dx==t.ClipperBase.horizontal;)e=e.Next}e==r?r=g?e.Next:e.Prev:(e=g?r.Next:r.Prev,l=new t.LocalMinima,l.Next=null,l.Y=e.Bot.Y,l.LeftBound=null,l.RightBound=e,e.WindDelta=0,r=this.ProcessBound(e,g),this.InsertLocalMinima(l));return r}e.Dx==t.ClipperBase.horizontal&&
(l=g?e.Prev:e.Next,l.OutIdx!=t.ClipperBase.Skip&&(l.Dx==t.ClipperBase.horizontal?l.Bot.X!=e.Bot.X&&l.Top.X!=e.Bot.X&&this.ReverseHorizontal(e):l.Bot.X!=e.Bot.X&&this.ReverseHorizontal(e)));l=e;if(g){for(;r.Top.Y==r.Next.Bot.Y&&r.Next.OutIdx!=t.ClipperBase.Skip;)r=r.Next;if(r.Dx==t.ClipperBase.horizontal&&r.Next.OutIdx!=t.ClipperBase.Skip){for(y=r;y.Prev.Dx==t.ClipperBase.horizontal;)y=y.Prev;y.Prev.Top.X==r.Next.Top.X?g||(r=y.Prev):y.Prev.Top.X>r.Next.Top.X&&(r=y.Prev)}for(;e!=r;)e.NextInLML=e.Next,
e.Dx==t.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e),e=e.Next;e.Dx==t.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e);r=r.Next}else{for(;r.Top.Y==r.Prev.Bot.Y&&r.Prev.OutIdx!=t.ClipperBase.Skip;)r=r.Prev;if(r.Dx==t.ClipperBase.horizontal&&r.Prev.OutIdx!=t.ClipperBase.Skip){for(y=r;y.Next.Dx==t.ClipperBase.horizontal;)y=y.Next;y.Next.Top.X==r.Prev.Top.X?g||(r=y.Next):y.Next.Top.X>r.Prev.Top.X&&(r=y.Next)}for(;e!=r;)e.NextInLML=e.Prev,
e.Dx==t.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Next.Top.X&&this.ReverseHorizontal(e),e=e.Prev;e.Dx==t.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Next.Top.X&&this.ReverseHorizontal(e);r=r.Prev}return r};t.ClipperBase.prototype.AddPath=function(e,g,l){t.use_lines?l||g!=t.PolyType.ptClip||t.Error("AddPath: Open paths must be subject."):l||t.Error("AddPath: Open paths have been disabled.");var r=e.length-1;if(l)for(;0<r&&t.IntPoint.op_Equality(e[r],e[0]);)--r;for(;0<r&&t.IntPoint.op_Equality(e[r],e[r-
1]);)--r;if(l&&2>r||!l&&1>r)return!1;for(var y=[],F=0;F<=r;F++)y.push(new t.TEdge);var K=!0;y[1].Curr.X=e[1].X;y[1].Curr.Y=e[1].Y;t.use_xyz&&(y[1].Curr.Z=e[1].Z);var ca={Value:this.m_UseFullRange};this.RangeTest(e[0],ca);this.m_UseFullRange=ca.Value;ca.Value=this.m_UseFullRange;this.RangeTest(e[r],ca);this.m_UseFullRange=ca.Value;this.InitEdge(y[0],y[1],y[r],e[0]);this.InitEdge(y[r],y[0],y[r-1],e[r]);for(F=r-1;1<=F;--F)ca.Value=this.m_UseFullRange,this.RangeTest(e[F],ca),this.m_UseFullRange=ca.Value,
this.InitEdge(y[F],y[F+1],y[F-1],e[F]);for(F=e=r=y[0];;)if(e.Curr!=e.Next.Curr||!l&&e.Next==r){if(e.Prev==e.Next)break;else if(l&&t.ClipperBase.SlopesEqual(e.Prev.Curr,e.Curr,e.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(e.Prev.Curr,e.Curr,e.Next.Curr))){e==r&&(r=e.Next);e=this.RemoveEdge(e);F=e=e.Prev;continue}e=e.Next;if(e==F||!l&&e.Next==r)break}else{if(e==e.Next)break;e==r&&(r=e.Next);F=e=this.RemoveEdge(e)}if(!l&&e==e.Next||l&&e.Prev==e.Next)return!1;
l||(this.m_HasOpenPaths=!0,r.Prev.OutIdx=t.ClipperBase.Skip);e=r;do this.InitEdge2(e,g),e=e.Next,K&&e.Curr.Y!=r.Curr.Y&&(K=!1);while(e!=r);if(K){if(l)return!1;e.Prev.OutIdx=t.ClipperBase.Skip;e.Prev.Bot.X<e.Prev.Top.X&&this.ReverseHorizontal(e.Prev);g=new t.LocalMinima;g.Next=null;g.Y=e.Bot.Y;g.LeftBound=null;g.RightBound=e;g.RightBound.Side=t.EdgeSide.esRight;for(g.RightBound.WindDelta=0;e.Next.OutIdx!=t.ClipperBase.Skip;)e.NextInLML=e.Next,e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e),e=e.Next;
this.InsertLocalMinima(g);this.m_edges.push(y);return!0}this.m_edges.push(y);K=null;for(t.IntPoint.op_Equality(e.Prev.Bot,e.Prev.Top)&&(e=e.Next);;){e=this.FindNextLocMin(e);if(e==K)break;else null==K&&(K=e);g=new t.LocalMinima;g.Next=null;g.Y=e.Bot.Y;e.Dx<e.Prev.Dx?(g.LeftBound=e.Prev,g.RightBound=e,y=!1):(g.LeftBound=e,g.RightBound=e.Prev,y=!0);g.LeftBound.Side=t.EdgeSide.esLeft;g.RightBound.Side=t.EdgeSide.esRight;g.LeftBound.WindDelta=l?g.LeftBound.Next==g.RightBound?-1:1:0;g.RightBound.WindDelta=
-g.LeftBound.WindDelta;e=this.ProcessBound(g.LeftBound,y);e.OutIdx==t.ClipperBase.Skip&&(e=this.ProcessBound(e,y));r=this.ProcessBound(g.RightBound,!y);r.OutIdx==t.ClipperBase.Skip&&(r=this.ProcessBound(r,!y));g.LeftBound.OutIdx==t.ClipperBase.Skip?g.LeftBound=null:g.RightBound.OutIdx==t.ClipperBase.Skip&&(g.RightBound=null);this.InsertLocalMinima(g);y||(e=r)}return!0};t.ClipperBase.prototype.AddPaths=function(e,g,l){for(var r=!1,y=0,F=e.length;y<F;++y)this.AddPath(e[y],g,l)&&(r=!0);return r};t.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=
function(e,g,l){return t.IntPoint.op_Equality(e,l)||t.IntPoint.op_Equality(e,g)||t.IntPoint.op_Equality(l,g)?!1:e.X!=l.X?g.X>e.X==g.X<l.X:g.Y>e.Y==g.Y<l.Y};t.ClipperBase.prototype.RemoveEdge=function(e){e.Prev.Next=e.Next;e.Next.Prev=e.Prev;var g=e.Next;e.Prev=null;return g};t.ClipperBase.prototype.SetDx=function(e){e.Delta.X=e.Top.X-e.Bot.X;e.Delta.Y=e.Top.Y-e.Bot.Y;e.Dx=0===e.Delta.Y?t.ClipperBase.horizontal:e.Delta.X/e.Delta.Y};t.ClipperBase.prototype.InsertLocalMinima=function(e){if(null===this.m_MinimaList)this.m_MinimaList=
e;else if(e.Y>=this.m_MinimaList.Y)e.Next=this.m_MinimaList,this.m_MinimaList=e;else{for(var g=this.m_MinimaList;null!==g.Next&&e.Y<g.Next.Y;)g=g.Next;e.Next=g.Next;g.Next=e}};t.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)};t.ClipperBase.prototype.ReverseHorizontal=function(e){var g=e.Top.X;e.Top.X=e.Bot.X;e.Bot.X=g;t.use_xyz&&(g=e.Top.Z,e.Top.Z=e.Bot.Z,e.Bot.Z=g)};t.ClipperBase.prototype.Reset=function(){this.m_CurrentLM=this.m_MinimaList;
if(null!=this.m_CurrentLM)for(var e=this.m_MinimaList;null!=e;){var g=e.LeftBound;null!=g&&(g.Curr.X=g.Bot.X,g.Curr.Y=g.Bot.Y,t.use_xyz&&(g.Curr.Z=g.Bot.Z),g.Side=t.EdgeSide.esLeft,g.OutIdx=t.ClipperBase.Unassigned);g=e.RightBound;null!=g&&(g.Curr.X=g.Bot.X,g.Curr.Y=g.Bot.Y,t.use_xyz&&(g.Curr.Z=g.Bot.Z),g.Side=t.EdgeSide.esRight,g.OutIdx=t.ClipperBase.Unassigned);e=e.Next}};t.Clipper=function(e){"undefined"==typeof e&&(e=0);this.m_PolyOuts=null;this.m_ClipType=t.ClipType.ctIntersection;this.m_IntersectNodeComparer=
this.m_IntersectList=this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_ExecuteLocked=!1;this.m_SubjFillType=this.m_ClipFillType=t.PolyFillType.pftEvenOdd;this.m_GhostJoins=this.m_Joins=null;this.StrictlySimple=this.ReverseSolution=this.m_UsingPolyTree=!1;t.ClipperBase.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_IntersectList=[];this.m_IntersectNodeComparer=t.MyIntersectNodeSort.Compare;this.m_UsingPolyTree=this.m_ExecuteLocked=!1;this.m_PolyOuts=[];
this.m_Joins=[];this.m_GhostJoins=[];this.ReverseSolution=0!==(1&e);this.StrictlySimple=0!==(2&e);this.PreserveCollinear=0!==(4&e);t.use_xyz&&(this.ZFillFunction=null)};t.Clipper.ioReverseSolution=1;t.Clipper.ioStrictlySimple=2;t.Clipper.ioPreserveCollinear=4;t.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),t.ClipperBase.prototype.Clear.call(this))};t.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var e=this.m_Scanbeam.Next;this.m_Scanbeam=
null;this.m_Scanbeam=e}};t.Clipper.prototype.Reset=function(){t.ClipperBase.prototype.Reset.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;for(var e=this.m_MinimaList;null!==e;)this.InsertScanbeam(e.Y),e=e.Next};t.Clipper.prototype.InsertScanbeam=function(e){if(null===this.m_Scanbeam)this.m_Scanbeam=new t.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=e;else if(e>this.m_Scanbeam.Y){var g=new t.Scanbeam;g.Y=e;g.Next=this.m_Scanbeam;this.m_Scanbeam=g}else{for(var l=this.m_Scanbeam;null!==
l.Next&&e<=l.Next.Y;)l=l.Next;e!=l.Y&&(g=new t.Scanbeam,g.Y=e,g.Next=l.Next,l.Next=g)}};t.Clipper.prototype.Execute=function(){var e=arguments,g=e.length,l=e[1]instanceof t.PolyTree;if(4!=g||l){if(4==g&&l){g=e[0];var r=e[1];l=e[2];e=e[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0;this.m_SubjFillType=l;this.m_ClipFillType=e;this.m_ClipType=g;this.m_UsingPolyTree=!0;try{(y=this.ExecuteInternal())&&this.BuildResult2(r)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return y}if(2==
g&&!l||2==g&&l)return g=e[0],r=e[1],this.Execute(g,r,t.PolyFillType.pftEvenOdd,t.PolyFillType.pftEvenOdd)}else{g=e[0];r=e[1];l=e[2];e=e[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&t.Error("Error: PolyTree struct is need for open path clipping.");this.m_ExecuteLocked=!0;t.Clear(r);this.m_SubjFillType=l;this.m_ClipFillType=e;this.m_ClipType=g;this.m_UsingPolyTree=!1;try{var y=this.ExecuteInternal();y&&this.BuildResult(r)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return y}};
t.Clipper.prototype.FixHoleLinkage=function(e){if(null!==e.FirstLeft&&(e.IsHole==e.FirstLeft.IsHole||null===e.FirstLeft.Pts)){for(var g=e.FirstLeft;null!==g&&(g.IsHole==e.IsHole||null===g.Pts);)g=g.FirstLeft;e.FirstLeft=g}};t.Clipper.prototype.ExecuteInternal=function(){try{this.Reset();if(null===this.m_CurrentLM)return!1;var e=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(e);t.Clear(this.m_GhostJoins);this.ProcessHorizontals(!1);if(null===this.m_Scanbeam)break;var g=this.PopScanbeam();if(!this.ProcessIntersections(g))return!1;
this.ProcessEdgesAtTopOfScanbeam(g);e=g}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);e=0;for(var l=this.m_PolyOuts.length;e<l;e++){var r=this.m_PolyOuts[e];null===r.Pts||r.IsOpen||(r.IsHole^this.ReverseSolution)==0<this.Area(r)&&this.ReversePolyPtLinks(r.Pts)}this.JoinCommonEdges();e=0;for(l=this.m_PolyOuts.length;e<l;e++)r=this.m_PolyOuts[e],null===r.Pts||r.IsOpen||this.FixupOutPolygon(r);this.StrictlySimple&&this.DoSimplePolygons();return!0}finally{t.Clear(this.m_Joins),t.Clear(this.m_GhostJoins)}};
t.Clipper.prototype.PopScanbeam=function(){var e=this.m_Scanbeam.Y;this.m_Scanbeam=this.m_Scanbeam.Next;return e};t.Clipper.prototype.DisposeAllPolyPts=function(){for(var e=0,g=this.m_PolyOuts.length;e<g;++e)this.DisposeOutRec(e);t.Clear(this.m_PolyOuts)};t.Clipper.prototype.DisposeOutRec=function(e){this.m_PolyOuts[e].Pts=null;this.m_PolyOuts[e]=null};t.Clipper.prototype.AddJoin=function(e,g,l){var r=new t.Join;r.OutPt1=e;r.OutPt2=g;r.OffPt.X=l.X;r.OffPt.Y=l.Y;t.use_xyz&&(r.OffPt.Z=l.Z);this.m_Joins.push(r)};
t.Clipper.prototype.AddGhostJoin=function(e,g){var l=new t.Join;l.OutPt1=e;l.OffPt.X=g.X;l.OffPt.Y=g.Y;t.use_xyz&&(l.OffPt.Z=g.Z);this.m_GhostJoins.push(l)};t.Clipper.prototype.SetZ=function(e,g,l){null!==this.ZFillFunction&&0==e.Z&&null!==this.ZFillFunction&&(t.IntPoint.op_Equality(e,g.Bot)?e.Z=g.Bot.Z:t.IntPoint.op_Equality(e,g.Top)?e.Z=g.Top.Z:t.IntPoint.op_Equality(e,l.Bot)?e.Z=l.Bot.Z:t.IntPoint.op_Equality(e,l.Top)?e.Z=l.Top.Z:this.ZFillFunction(g.Bot,g.Top,l.Bot,l.Top,e))};t.Clipper.prototype.InsertLocalMinimaIntoAEL=
function(e){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==e;){var g=this.m_CurrentLM.LeftBound,l=this.m_CurrentLM.RightBound;this.PopLocalMinima();var r=null;null===g?(this.InsertEdgeIntoAEL(l,null),this.SetWindingCount(l),this.IsContributing(l)&&(r=this.AddOutPt(l,l.Bot))):(null==l?(this.InsertEdgeIntoAEL(g,null),this.SetWindingCount(g),this.IsContributing(g)&&(r=this.AddOutPt(g,g.Bot))):(this.InsertEdgeIntoAEL(g,null),this.InsertEdgeIntoAEL(l,g),this.SetWindingCount(g),l.WindCnt=g.WindCnt,l.WindCnt2=
g.WindCnt2,this.IsContributing(g)&&(r=this.AddLocalMinPoly(g,l,g.Bot))),this.InsertScanbeam(g.Top.Y));null!=l&&(t.ClipperBase.IsHorizontal(l)?this.AddEdgeToSEL(l):this.InsertScanbeam(l.Top.Y));if(null!=g&&null!=l){if(null!==r&&t.ClipperBase.IsHorizontal(l)&&0<this.m_GhostJoins.length&&0!==l.WindDelta)for(var y=0,F=this.m_GhostJoins.length;y<F;y++){var K=this.m_GhostJoins[y];this.HorzSegmentsOverlap(K.OutPt1.Pt.X,K.OffPt.X,l.Bot.X,l.Top.X)&&this.AddJoin(K.OutPt1,r,K.OffPt)}0<=g.OutIdx&&null!==g.PrevInAEL&&
g.PrevInAEL.Curr.X==g.Bot.X&&0<=g.PrevInAEL.OutIdx&&t.ClipperBase.SlopesEqual(g.PrevInAEL,g,this.m_UseFullRange)&&0!==g.WindDelta&&0!==g.PrevInAEL.WindDelta&&(y=this.AddOutPt(g.PrevInAEL,g.Bot),this.AddJoin(r,y,g.Top));if(g.NextInAEL!=l&&(0<=l.OutIdx&&0<=l.PrevInAEL.OutIdx&&t.ClipperBase.SlopesEqual(l.PrevInAEL,l,this.m_UseFullRange)&&0!==l.WindDelta&&0!==l.PrevInAEL.WindDelta&&(y=this.AddOutPt(l.PrevInAEL,l.Bot),this.AddJoin(r,y,l.Top)),r=g.NextInAEL,null!==r))for(;r!=l;)this.IntersectEdges(l,r,
g.Curr,!1),r=r.NextInAEL}}};t.Clipper.prototype.InsertEdgeIntoAEL=function(e,g){if(null===this.m_ActiveEdges)e.PrevInAEL=null,e.NextInAEL=null,this.m_ActiveEdges=e;else if(null===g&&this.E2InsertsBeforeE1(this.m_ActiveEdges,e))e.PrevInAEL=null,e.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges=this.m_ActiveEdges.PrevInAEL=e;else{for(null===g&&(g=this.m_ActiveEdges);null!==g.NextInAEL&&!this.E2InsertsBeforeE1(g.NextInAEL,e);)g=g.NextInAEL;e.NextInAEL=g.NextInAEL;null!==g.NextInAEL&&(g.NextInAEL.PrevInAEL=
e);e.PrevInAEL=g;g.NextInAEL=e}};t.Clipper.prototype.E2InsertsBeforeE1=function(e,g){return g.Curr.X==e.Curr.X?g.Top.Y>e.Top.Y?g.Top.X<t.Clipper.TopX(e,g.Top.Y):e.Top.X>t.Clipper.TopX(g,e.Top.Y):g.Curr.X<e.Curr.X};t.Clipper.prototype.IsEvenOddFillType=function(e){return e.PolyTyp==t.PolyType.ptSubject?this.m_SubjFillType==t.PolyFillType.pftEvenOdd:this.m_ClipFillType==t.PolyFillType.pftEvenOdd};t.Clipper.prototype.IsEvenOddAltFillType=function(e){return e.PolyTyp==t.PolyType.ptSubject?this.m_ClipFillType==
t.PolyFillType.pftEvenOdd:this.m_SubjFillType==t.PolyFillType.pftEvenOdd};t.Clipper.prototype.IsContributing=function(e){var g,l;e.PolyTyp==t.PolyType.ptSubject?(g=this.m_SubjFillType,l=this.m_ClipFillType):(g=this.m_ClipFillType,l=this.m_SubjFillType);switch(g){case t.PolyFillType.pftEvenOdd:if(0===e.WindDelta&&1!=e.WindCnt)return!1;break;case t.PolyFillType.pftNonZero:if(1!=Math.abs(e.WindCnt))return!1;break;case t.PolyFillType.pftPositive:if(1!=e.WindCnt)return!1;break;default:if(-1!=e.WindCnt)return!1}switch(this.m_ClipType){case t.ClipType.ctIntersection:switch(l){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return 0!==
e.WindCnt2;case t.PolyFillType.pftPositive:return 0<e.WindCnt2;default:return 0>e.WindCnt2}case t.ClipType.ctUnion:switch(l){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return 0===e.WindCnt2;case t.PolyFillType.pftPositive:return 0>=e.WindCnt2;default:return 0<=e.WindCnt2}case t.ClipType.ctDifference:if(e.PolyTyp==t.PolyType.ptSubject)switch(l){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return 0===e.WindCnt2;case t.PolyFillType.pftPositive:return 0>=e.WindCnt2;
default:return 0<=e.WindCnt2}else switch(l){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return 0!==e.WindCnt2;case t.PolyFillType.pftPositive:return 0<e.WindCnt2;default:return 0>e.WindCnt2}case t.ClipType.ctXor:if(0===e.WindDelta)switch(l){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return 0===e.WindCnt2;case t.PolyFillType.pftPositive:return 0>=e.WindCnt2;default:return 0<=e.WindCnt2}}return!0};t.Clipper.prototype.SetWindingCount=function(e){for(var g=e.PrevInAEL;null!==
g&&(g.PolyTyp!=e.PolyTyp||0===g.WindDelta);)g=g.PrevInAEL;if(null===g)e.WindCnt=0===e.WindDelta?1:e.WindDelta,e.WindCnt2=0,g=this.m_ActiveEdges;else{if(0===e.WindDelta&&this.m_ClipType!=t.ClipType.ctUnion)e.WindCnt=1;else if(this.IsEvenOddFillType(e))if(0===e.WindDelta){for(var l=!0,r=g.PrevInAEL;null!==r;)r.PolyTyp==g.PolyTyp&&0!==r.WindDelta&&(l=!l),r=r.PrevInAEL;e.WindCnt=l?0:1}else e.WindCnt=e.WindDelta;else e.WindCnt=0>g.WindCnt*g.WindDelta?1<Math.abs(g.WindCnt)?0>g.WindDelta*e.WindDelta?g.WindCnt:
g.WindCnt+e.WindDelta:0===e.WindDelta?1:e.WindDelta:0===e.WindDelta?0>g.WindCnt?g.WindCnt-1:g.WindCnt+1:0>g.WindDelta*e.WindDelta?g.WindCnt:g.WindCnt+e.WindDelta;e.WindCnt2=g.WindCnt2;g=g.NextInAEL}if(this.IsEvenOddAltFillType(e))for(;g!=e;)0!==g.WindDelta&&(e.WindCnt2=0===e.WindCnt2?1:0),g=g.NextInAEL;else for(;g!=e;)e.WindCnt2+=g.WindDelta,g=g.NextInAEL};t.Clipper.prototype.AddEdgeToSEL=function(e){null===this.m_SortedEdges?(this.m_SortedEdges=e,e.PrevInSEL=null,e.NextInSEL=null):(e.NextInSEL=this.m_SortedEdges,
e.PrevInSEL=null,this.m_SortedEdges=this.m_SortedEdges.PrevInSEL=e)};t.Clipper.prototype.CopyAELToSEL=function(){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;null!==e;)e.PrevInSEL=e.PrevInAEL,e=e.NextInSEL=e.NextInAEL};t.Clipper.prototype.SwapPositionsInAEL=function(e,g){if(e.NextInAEL!=e.PrevInAEL&&g.NextInAEL!=g.PrevInAEL){if(e.NextInAEL==g){var l=g.NextInAEL;null!==l&&(l.PrevInAEL=e);var r=e.PrevInAEL;null!==r&&(r.NextInAEL=g);g.PrevInAEL=r;g.NextInAEL=e;e.PrevInAEL=g;e.NextInAEL=l}else g.NextInAEL==
e?(l=e.NextInAEL,null!==l&&(l.PrevInAEL=g),r=g.PrevInAEL,null!==r&&(r.NextInAEL=e),e.PrevInAEL=r,e.NextInAEL=g,g.PrevInAEL=e,g.NextInAEL=l):(l=e.NextInAEL,r=e.PrevInAEL,e.NextInAEL=g.NextInAEL,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=g.PrevInAEL,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e),g.NextInAEL=l,null!==g.NextInAEL&&(g.NextInAEL.PrevInAEL=g),g.PrevInAEL=r,null!==g.PrevInAEL&&(g.PrevInAEL.NextInAEL=g));null===e.PrevInAEL?this.m_ActiveEdges=e:null===g.PrevInAEL&&(this.m_ActiveEdges=
g)}};t.Clipper.prototype.SwapPositionsInSEL=function(e,g){if(null!==e.NextInSEL||null!==e.PrevInSEL)if(null!==g.NextInSEL||null!==g.PrevInSEL){if(e.NextInSEL==g){var l=g.NextInSEL;null!==l&&(l.PrevInSEL=e);var r=e.PrevInSEL;null!==r&&(r.NextInSEL=g);g.PrevInSEL=r;g.NextInSEL=e;e.PrevInSEL=g;e.NextInSEL=l}else g.NextInSEL==e?(l=e.NextInSEL,null!==l&&(l.PrevInSEL=g),r=g.PrevInSEL,null!==r&&(r.NextInSEL=e),e.PrevInSEL=r,e.NextInSEL=g,g.PrevInSEL=e,g.NextInSEL=l):(l=e.NextInSEL,r=e.PrevInSEL,e.NextInSEL=
g.NextInSEL,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=g.PrevInSEL,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e),g.NextInSEL=l,null!==g.NextInSEL&&(g.NextInSEL.PrevInSEL=g),g.PrevInSEL=r,null!==g.PrevInSEL&&(g.PrevInSEL.NextInSEL=g));null===e.PrevInSEL?this.m_SortedEdges=e:null===g.PrevInSEL&&(this.m_SortedEdges=g)}};t.Clipper.prototype.AddLocalMaxPoly=function(e,g,l){this.AddOutPt(e,l);0==g.WindDelta&&this.AddOutPt(g,l);e.OutIdx==g.OutIdx?(e.OutIdx=-1,g.OutIdx=-1):e.OutIdx<g.OutIdx?
this.AppendPolygon(e,g):this.AppendPolygon(g,e)};t.Clipper.prototype.AddLocalMinPoly=function(e,g,l){var r,y;t.ClipperBase.IsHorizontal(g)||e.Dx>g.Dx?(r=this.AddOutPt(e,l),g.OutIdx=e.OutIdx,e.Side=t.EdgeSide.esLeft,g.Side=t.EdgeSide.esRight,y=e,e=y.PrevInAEL==g?g.PrevInAEL:y.PrevInAEL):(r=this.AddOutPt(g,l),e.OutIdx=g.OutIdx,e.Side=t.EdgeSide.esRight,g.Side=t.EdgeSide.esLeft,y=g,e=y.PrevInAEL==e?e.PrevInAEL:y.PrevInAEL);null!==e&&0<=e.OutIdx&&t.Clipper.TopX(e,l.Y)==t.Clipper.TopX(y,l.Y)&&t.ClipperBase.SlopesEqual(y,
e,this.m_UseFullRange)&&0!==y.WindDelta&&0!==e.WindDelta&&(l=this.AddOutPt(e,l),this.AddJoin(r,l,y.Top));return r};t.Clipper.prototype.CreateOutRec=function(){var e=new t.OutRec;e.Idx=-1;e.IsHole=!1;e.IsOpen=!1;e.FirstLeft=null;e.Pts=null;e.BottomPt=null;e.PolyNode=null;this.m_PolyOuts.push(e);e.Idx=this.m_PolyOuts.length-1;return e};t.Clipper.prototype.AddOutPt=function(e,g){var l=e.Side==t.EdgeSide.esLeft;if(0>e.OutIdx){var r=this.CreateOutRec();r.IsOpen=0===e.WindDelta;var y=new t.OutPt;r.Pts=
y;y.Idx=r.Idx;y.Pt.X=g.X;y.Pt.Y=g.Y;t.use_xyz&&(y.Pt.Z=g.Z);y.Next=y;y.Prev=y;r.IsOpen||this.SetHoleState(e,r);e.OutIdx=r.Idx}else{r=this.m_PolyOuts[e.OutIdx];e=r.Pts;if(l&&t.IntPoint.op_Equality(g,e.Pt))return e;if(!l&&t.IntPoint.op_Equality(g,e.Prev.Pt))return e.Prev;y=new t.OutPt;y.Idx=r.Idx;y.Pt.X=g.X;y.Pt.Y=g.Y;t.use_xyz&&(y.Pt.Z=g.Z);y.Next=e;y.Prev=e.Prev;y.Prev.Next=y;e.Prev=y;l&&(r.Pts=y)}return y};t.Clipper.prototype.SwapPoints=function(e,g){var l=new t.IntPoint(e.Value);e.Value.X=g.Value.X;
e.Value.Y=g.Value.Y;t.use_xyz&&(e.Value.Z=g.Value.Z);g.Value.X=l.X;g.Value.Y=l.Y;t.use_xyz&&(g.Value.Z=l.Z)};t.Clipper.prototype.HorzSegmentsOverlap=function(e,g,l,r){var y;e>g&&(y=e,e=g,g=y);l>r&&(y=l,l=r,r=y);return e<r&&l<g};t.Clipper.prototype.SetHoleState=function(e,g){var l=!1;for(e=e.PrevInAEL;null!==e;)0<=e.OutIdx&&0!=e.WindDelta&&(l=!l,null===g.FirstLeft&&(g.FirstLeft=this.m_PolyOuts[e.OutIdx])),e=e.PrevInAEL;l&&(g.IsHole=!0)};t.Clipper.prototype.GetDx=function(e,g){return e.Y==g.Y?t.ClipperBase.horizontal:
(g.X-e.X)/(g.Y-e.Y)};t.Clipper.prototype.FirstIsBottomPt=function(e,g){for(var l=e.Prev;t.IntPoint.op_Equality(l.Pt,e.Pt)&&l!=e;)l=l.Prev;var r=Math.abs(this.GetDx(e.Pt,l.Pt));for(l=e.Next;t.IntPoint.op_Equality(l.Pt,e.Pt)&&l!=e;)l=l.Next;e=Math.abs(this.GetDx(e.Pt,l.Pt));for(l=g.Prev;t.IntPoint.op_Equality(l.Pt,g.Pt)&&l!=g;)l=l.Prev;var y=Math.abs(this.GetDx(g.Pt,l.Pt));for(l=g.Next;t.IntPoint.op_Equality(l.Pt,g.Pt)&&l!=g;)l=l.Next;l=Math.abs(this.GetDx(g.Pt,l.Pt));return r>=y&&r>=l||e>=y&&e>=l};
t.Clipper.prototype.GetBottomPt=function(e){for(var g=null,l=e.Next;l!=e;)l.Pt.Y>e.Pt.Y?(e=l,g=null):l.Pt.Y==e.Pt.Y&&l.Pt.X<=e.Pt.X&&(l.Pt.X<e.Pt.X?(g=null,e=l):l.Next!=e&&l.Prev!=e&&(g=l)),l=l.Next;if(null!==g)for(;g!=l;)for(this.FirstIsBottomPt(l,g)||(e=g),g=g.Next;t.IntPoint.op_Inequality(g.Pt,e.Pt);)g=g.Next;return e};t.Clipper.prototype.GetLowermostRec=function(e,g){null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts));null===g.BottomPt&&(g.BottomPt=this.GetBottomPt(g.Pts));var l=e.BottomPt,
r=g.BottomPt;return l.Pt.Y>r.Pt.Y?e:l.Pt.Y<r.Pt.Y?g:l.Pt.X<r.Pt.X?e:l.Pt.X>r.Pt.X?g:l.Next==l?g:r.Next==r?e:this.FirstIsBottomPt(l,r)?e:g};t.Clipper.prototype.Param1RightOfParam2=function(e,g){do if(e=e.FirstLeft,e==g)return!0;while(null!==e);return!1};t.Clipper.prototype.GetOutRec=function(e){for(e=this.m_PolyOuts[e];e!=this.m_PolyOuts[e.Idx];)e=this.m_PolyOuts[e.Idx];return e};t.Clipper.prototype.AppendPolygon=function(e,g){var l=this.m_PolyOuts[e.OutIdx],r=this.m_PolyOuts[g.OutIdx];var y=this.Param1RightOfParam2(l,
r)?r:this.Param1RightOfParam2(r,l)?l:this.GetLowermostRec(l,r);var F=l.Pts,K=F.Prev,ca=r.Pts,ka=ca.Prev;e.Side==t.EdgeSide.esLeft?(g.Side==t.EdgeSide.esLeft?(this.ReversePolyPtLinks(ca),ca.Next=F,F.Prev=ca,K.Next=ka,ka.Prev=K,l.Pts=ka):(ka.Next=F,F.Prev=ka,ca.Prev=K,K.Next=ca,l.Pts=ca),F=t.EdgeSide.esLeft):(g.Side==t.EdgeSide.esRight?(this.ReversePolyPtLinks(ca),K.Next=ka,ka.Prev=K,ca.Next=F,F.Prev=ca):(K.Next=ca,ca.Prev=K,F.Prev=ka,ka.Next=F),F=t.EdgeSide.esRight);l.BottomPt=null;y==r&&(r.FirstLeft!=
l&&(l.FirstLeft=r.FirstLeft),l.IsHole=r.IsHole);r.Pts=null;r.BottomPt=null;r.FirstLeft=l;y=e.OutIdx;K=g.OutIdx;e.OutIdx=-1;g.OutIdx=-1;for(ca=this.m_ActiveEdges;null!==ca;){if(ca.OutIdx==K){ca.OutIdx=y;ca.Side=F;break}ca=ca.NextInAEL}r.Idx=l.Idx};t.Clipper.prototype.ReversePolyPtLinks=function(e){if(null!==e){var g=e;do{var l=g.Next;g.Next=g.Prev;g=g.Prev=l}while(g!=e)}};t.Clipper.SwapSides=function(e,g){var l=e.Side;e.Side=g.Side;g.Side=l};t.Clipper.SwapPolyIndexes=function(e,g){var l=e.OutIdx;e.OutIdx=
g.OutIdx;g.OutIdx=l};t.Clipper.prototype.IntersectEdges=function(e,g,l){var r=0<=e.OutIdx,y=0<=g.OutIdx;t.use_xyz&&this.SetZ(l,e,g);if(!t.use_lines||0!==e.WindDelta&&0!==g.WindDelta){if(e.PolyTyp==g.PolyTyp)if(this.IsEvenOddFillType(e)){var F=e.WindCnt;e.WindCnt=g.WindCnt;g.WindCnt=F}else e.WindCnt=0===e.WindCnt+g.WindDelta?-e.WindCnt:e.WindCnt+g.WindDelta,g.WindCnt=0===g.WindCnt-e.WindDelta?-g.WindCnt:g.WindCnt-e.WindDelta;else this.IsEvenOddFillType(g)?e.WindCnt2=0===e.WindCnt2?1:0:e.WindCnt2+=
g.WindDelta,this.IsEvenOddFillType(e)?g.WindCnt2=0===g.WindCnt2?1:0:g.WindCnt2-=e.WindDelta;var K,ca,ka;e.PolyTyp==t.PolyType.ptSubject?(K=this.m_SubjFillType,ka=this.m_ClipFillType):(K=this.m_ClipFillType,ka=this.m_SubjFillType);g.PolyTyp==t.PolyType.ptSubject?(ca=this.m_SubjFillType,F=this.m_ClipFillType):(ca=this.m_ClipFillType,F=this.m_SubjFillType);switch(K){case t.PolyFillType.pftPositive:K=e.WindCnt;break;case t.PolyFillType.pftNegative:K=-e.WindCnt;break;default:K=Math.abs(e.WindCnt)}switch(ca){case t.PolyFillType.pftPositive:ca=
g.WindCnt;break;case t.PolyFillType.pftNegative:ca=-g.WindCnt;break;default:ca=Math.abs(g.WindCnt)}if(r&&y)0!=K&&1!=K||0!=ca&&1!=ca||e.PolyTyp!=g.PolyTyp&&this.m_ClipType!=t.ClipType.ctXor?this.AddLocalMaxPoly(e,g,l):(this.AddOutPt(e,l),this.AddOutPt(g,l),t.Clipper.SwapSides(e,g),t.Clipper.SwapPolyIndexes(e,g));else if(r){if(0===ca||1==ca)this.AddOutPt(e,l),t.Clipper.SwapSides(e,g),t.Clipper.SwapPolyIndexes(e,g)}else if(y){if(0===K||1==K)this.AddOutPt(g,l),t.Clipper.SwapSides(e,g),t.Clipper.SwapPolyIndexes(e,
g)}else if(!(0!=K&&1!=K||0!=ca&&1!=ca)){switch(ka){case t.PolyFillType.pftPositive:r=e.WindCnt2;break;case t.PolyFillType.pftNegative:r=-e.WindCnt2;break;default:r=Math.abs(e.WindCnt2)}switch(F){case t.PolyFillType.pftPositive:y=g.WindCnt2;break;case t.PolyFillType.pftNegative:y=-g.WindCnt2;break;default:y=Math.abs(g.WindCnt2)}if(e.PolyTyp!=g.PolyTyp)this.AddLocalMinPoly(e,g,l);else if(1==K&&1==ca)switch(this.m_ClipType){case t.ClipType.ctIntersection:0<r&&0<y&&this.AddLocalMinPoly(e,g,l);break;case t.ClipType.ctUnion:0>=
r&&0>=y&&this.AddLocalMinPoly(e,g,l);break;case t.ClipType.ctDifference:(e.PolyTyp==t.PolyType.ptClip&&0<r&&0<y||e.PolyTyp==t.PolyType.ptSubject&&0>=r&&0>=y)&&this.AddLocalMinPoly(e,g,l);break;case t.ClipType.ctXor:this.AddLocalMinPoly(e,g,l)}else t.Clipper.SwapSides(e,g)}}else if(0!=e.WindDelta||0!=g.WindDelta)e.PolyTyp==g.PolyTyp&&e.WindDelta!=g.WindDelta&&this.m_ClipType==t.ClipType.ctUnion?0===e.WindDelta?y&&(this.AddOutPt(e,l),r&&(e.OutIdx=-1)):r&&(this.AddOutPt(g,l),y&&(g.OutIdx=-1)):e.PolyTyp!=
g.PolyTyp&&(0!==e.WindDelta||1!=Math.abs(g.WindCnt)||this.m_ClipType==t.ClipType.ctUnion&&0!==g.WindCnt2?0!==g.WindDelta||1!=Math.abs(e.WindCnt)||this.m_ClipType==t.ClipType.ctUnion&&0!==e.WindCnt2||(this.AddOutPt(g,l),y&&(g.OutIdx=-1)):(this.AddOutPt(e,l),r&&(e.OutIdx=-1)))};t.Clipper.prototype.DeleteFromAEL=function(e){var g=e.PrevInAEL,l=e.NextInAEL;if(null!==g||null!==l||e==this.m_ActiveEdges)null!==g?g.NextInAEL=l:this.m_ActiveEdges=l,null!==l&&(l.PrevInAEL=g),e.NextInAEL=null,e.PrevInAEL=null};
t.Clipper.prototype.DeleteFromSEL=function(e){var g=e.PrevInSEL,l=e.NextInSEL;if(null!==g||null!==l||e==this.m_SortedEdges)null!==g?g.NextInSEL=l:this.m_SortedEdges=l,null!==l&&(l.PrevInSEL=g),e.NextInSEL=null,e.PrevInSEL=null};t.Clipper.prototype.UpdateEdgeIntoAEL=function(e){null===e.NextInLML&&t.Error("UpdateEdgeIntoAEL: invalid call");var g=e.PrevInAEL,l=e.NextInAEL;e.NextInLML.OutIdx=e.OutIdx;null!==g?g.NextInAEL=e.NextInLML:this.m_ActiveEdges=e.NextInLML;null!==l&&(l.PrevInAEL=e.NextInLML);
e.NextInLML.Side=e.Side;e.NextInLML.WindDelta=e.WindDelta;e.NextInLML.WindCnt=e.WindCnt;e.NextInLML.WindCnt2=e.WindCnt2;e=e.NextInLML;e.Curr.X=e.Bot.X;e.Curr.Y=e.Bot.Y;t.use_xyz&&(e.Curr.Z=e.Bot.Z);e.PrevInAEL=g;e.NextInAEL=l;t.ClipperBase.IsHorizontal(e)||this.InsertScanbeam(e.Top.Y);return e};t.Clipper.prototype.ProcessHorizontals=function(e){for(var g=this.m_SortedEdges;null!==g;)this.DeleteFromSEL(g),this.ProcessHorizontal(g,e),g=this.m_SortedEdges};t.Clipper.prototype.GetHorzDirection=function(e,
g){e.Bot.X<e.Top.X?(g.Left=e.Bot.X,g.Right=e.Top.X,g.Dir=t.Direction.dLeftToRight):(g.Left=e.Top.X,g.Right=e.Bot.X,g.Dir=t.Direction.dRightToLeft)};t.Clipper.prototype.ProcessHorizontal=function(e,g){var l={Dir:null,Left:null,Right:null};this.GetHorzDirection(e,l);for(var r=l.Dir,y=l.Left,F=l.Right,K=e,ca=null;null!==K.NextInLML&&t.ClipperBase.IsHorizontal(K.NextInLML);)K=K.NextInLML;for(null===K.NextInLML&&(ca=this.GetMaximaPair(K));;){for(var ka=e==K,pa=this.GetNextInAEL(e,r);null!==pa&&!(pa.Curr.X==
e.Top.X&&null!==e.NextInLML&&pa.Dx<e.NextInLML.Dx);){l=this.GetNextInAEL(pa,r);if(r==t.Direction.dLeftToRight&&pa.Curr.X<=F||r==t.Direction.dRightToLeft&&pa.Curr.X>=y){if(pa==ca&&ka){if(0<=e.OutIdx){r=this.AddOutPt(e,e.Top);for(l=this.m_SortedEdges;null!==l;)0<=l.OutIdx&&this.HorzSegmentsOverlap(e.Bot.X,e.Top.X,l.Bot.X,l.Top.X)&&(y=this.AddOutPt(l,l.Bot),this.AddJoin(y,r,l.Top)),l=l.NextInSEL;this.AddGhostJoin(r,e.Bot);this.AddLocalMaxPoly(e,ca,e.Top)}this.DeleteFromAEL(e);this.DeleteFromAEL(ca);
return}if(r==t.Direction.dLeftToRight){var La=new t.IntPoint(pa.Curr.X,e.Curr.Y);this.IntersectEdges(e,pa,La)}else La=new t.IntPoint(pa.Curr.X,e.Curr.Y),this.IntersectEdges(pa,e,La);this.SwapPositionsInAEL(e,pa)}else if(r==t.Direction.dLeftToRight&&pa.Curr.X>=F||r==t.Direction.dRightToLeft&&pa.Curr.X<=y)break;pa=l}if(null!==e.NextInLML&&t.ClipperBase.IsHorizontal(e.NextInLML))e=this.UpdateEdgeIntoAEL(e),0<=e.OutIdx&&this.AddOutPt(e,e.Bot),l={Dir:r,Left:y,Right:F},this.GetHorzDirection(e,l),r=l.Dir,
y=l.Left,F=l.Right;else break}null!==e.NextInLML?0<=e.OutIdx?(r=this.AddOutPt(e,e.Top),g&&this.AddGhostJoin(r,e.Bot),e=this.UpdateEdgeIntoAEL(e),0!==e.WindDelta&&(ca=e.PrevInAEL,l=e.NextInAEL,null!==ca&&ca.Curr.X==e.Bot.X&&ca.Curr.Y==e.Bot.Y&&0!==ca.WindDelta&&0<=ca.OutIdx&&ca.Curr.Y>ca.Top.Y&&t.ClipperBase.SlopesEqual(e,ca,this.m_UseFullRange)?(y=this.AddOutPt(ca,e.Bot),this.AddJoin(r,y,e.Top)):null!==l&&l.Curr.X==e.Bot.X&&l.Curr.Y==e.Bot.Y&&0!==l.WindDelta&&0<=l.OutIdx&&l.Curr.Y>l.Top.Y&&t.ClipperBase.SlopesEqual(e,
l,this.m_UseFullRange)&&(y=this.AddOutPt(l,e.Bot),this.AddJoin(r,y,e.Top)))):this.UpdateEdgeIntoAEL(e):(0<=e.OutIdx&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e))};t.Clipper.prototype.GetNextInAEL=function(e,g){return g==t.Direction.dLeftToRight?e.NextInAEL:e.PrevInAEL};t.Clipper.prototype.IsMinima=function(e){return null!==e&&e.Prev.NextInLML!=e&&e.Next.NextInLML!=e};t.Clipper.prototype.IsMaxima=function(e,g){return null!==e&&e.Top.Y==g&&null===e.NextInLML};t.Clipper.prototype.IsIntermediate=function(e,
g){return e.Top.Y==g&&null!==e.NextInLML};t.Clipper.prototype.GetMaximaPair=function(e){var g=null;t.IntPoint.op_Equality(e.Next.Top,e.Top)&&null===e.Next.NextInLML?g=e.Next:t.IntPoint.op_Equality(e.Prev.Top,e.Top)&&null===e.Prev.NextInLML&&(g=e.Prev);return null===g||-2!=g.OutIdx&&(g.NextInAEL!=g.PrevInAEL||t.ClipperBase.IsHorizontal(g))?g:null};t.Clipper.prototype.ProcessIntersections=function(e){if(null==this.m_ActiveEdges)return!0;try{this.BuildIntersectList(e);if(0==this.m_IntersectList.length)return!0;
if(1==this.m_IntersectList.length||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch(g){this.m_SortedEdges=null,this.m_IntersectList.length=0,t.Error("ProcessIntersections error")}this.m_SortedEdges=null;return!0};t.Clipper.prototype.BuildIntersectList=function(e){if(null!==this.m_ActiveEdges){var g=this.m_ActiveEdges;for(this.m_SortedEdges=g;null!==g;)g.PrevInSEL=g.PrevInAEL,g.NextInSEL=g.NextInAEL,g.Curr.X=t.Clipper.TopX(g,e),g=g.NextInAEL;for(var l=!0;l&&null!==this.m_SortedEdges;){l=
!1;for(g=this.m_SortedEdges;null!==g.NextInSEL;){e=g.NextInSEL;var r=new t.IntPoint;g.Curr.X>e.Curr.X?(this.IntersectPoint(g,e,r),l=new t.IntersectNode,l.Edge1=g,l.Edge2=e,l.Pt.X=r.X,l.Pt.Y=r.Y,t.use_xyz&&(l.Pt.Z=r.Z),this.m_IntersectList.push(l),this.SwapPositionsInSEL(g,e),l=!0):g=e}if(null!==g.PrevInSEL)g.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}};t.Clipper.prototype.EdgesAdjacent=function(e){return e.Edge1.NextInSEL==e.Edge2||e.Edge1.PrevInSEL==e.Edge2};t.Clipper.IntersectNodeSort=
function(e,g){return g.Pt.Y-e.Pt.Y};t.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer);this.CopyAELToSEL();for(var e=this.m_IntersectList.length,g=0;g<e;g++){if(!this.EdgesAdjacent(this.m_IntersectList[g])){for(var l=g+1;l<e&&!this.EdgesAdjacent(this.m_IntersectList[l]);)l++;if(l==e)return!1;var r=this.m_IntersectList[g];this.m_IntersectList[g]=this.m_IntersectList[l];this.m_IntersectList[l]=r}this.SwapPositionsInSEL(this.m_IntersectList[g].Edge1,
this.m_IntersectList[g].Edge2)}return!0};t.Clipper.prototype.ProcessIntersectList=function(){for(var e=0,g=this.m_IntersectList.length;e<g;e++){var l=this.m_IntersectList[e];this.IntersectEdges(l.Edge1,l.Edge2,l.Pt);this.SwapPositionsInAEL(l.Edge1,l.Edge2)}this.m_IntersectList.length=0};U=function(e){return 0>e?Math.ceil(e-.5):Math.round(e)};Ia=function(e){return 0>e?Math.ceil(e-.5):Math.floor(e+.5)};Ob=function(e){return 0>e?-Math.round(Math.abs(e)):Math.round(e)};Sb=function(e){if(0>e)return e-=
.5,-2147483648>e?Math.ceil(e):e|0;e+=.5;return 2147483647<e?Math.floor(e):e|0};t.Clipper.Round=kb?U:Za?Ob:Aa?Sb:Ia;t.Clipper.TopX=function(e,g){return g==e.Top.Y?e.Top.X:e.Bot.X+t.Clipper.Round(e.Dx*(g-e.Bot.Y))};t.Clipper.prototype.IntersectPoint=function(e,g,l){l.X=0;l.Y=0;var r,y;if(e.Dx==g.Dx)l.Y=e.Curr.Y,l.X=t.Clipper.TopX(e,l.Y);else{if(0===e.Delta.X)l.X=e.Bot.X,t.ClipperBase.IsHorizontal(g)?l.Y=g.Bot.Y:(y=g.Bot.Y-g.Bot.X/g.Dx,l.Y=t.Clipper.Round(l.X/g.Dx+y));else if(0===g.Delta.X)l.X=g.Bot.X,
t.ClipperBase.IsHorizontal(e)?l.Y=e.Bot.Y:(r=e.Bot.Y-e.Bot.X/e.Dx,l.Y=t.Clipper.Round(l.X/e.Dx+r));else{r=e.Bot.X-e.Bot.Y*e.Dx;y=g.Bot.X-g.Bot.Y*g.Dx;var F=(y-r)/(e.Dx-g.Dx);l.Y=t.Clipper.Round(F);l.X=Math.abs(e.Dx)<Math.abs(g.Dx)?t.Clipper.Round(e.Dx*F+r):t.Clipper.Round(g.Dx*F+y)}if(l.Y<e.Top.Y||l.Y<g.Top.Y){if(e.Top.Y>g.Top.Y)return l.Y=e.Top.Y,l.X=t.Clipper.TopX(g,e.Top.Y),l.X<e.Top.X;l.Y=g.Top.Y;l.X=Math.abs(e.Dx)<Math.abs(g.Dx)?t.Clipper.TopX(e,l.Y):t.Clipper.TopX(g,l.Y)}l.Y>e.Curr.Y&&(l.Y=
e.Curr.Y,l.X=Math.abs(e.Dx)>Math.abs(g.Dx)?t.Clipper.TopX(g,l.Y):t.Clipper.TopX(e,l.Y))}};t.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(e){for(var g=this.m_ActiveEdges;null!==g;){var l=this.IsMaxima(g,e);l&&(l=this.GetMaximaPair(g),l=null===l||!t.ClipperBase.IsHorizontal(l));if(l){var r=g.PrevInAEL;this.DoMaxima(g);g=null===r?this.m_ActiveEdges:r.NextInAEL}else{this.IsIntermediate(g,e)&&t.ClipperBase.IsHorizontal(g.NextInLML)?(g=this.UpdateEdgeIntoAEL(g),0<=g.OutIdx&&this.AddOutPt(g,g.Bot),
this.AddEdgeToSEL(g)):(g.Curr.X=t.Clipper.TopX(g,e),g.Curr.Y=e);if(this.StrictlySimple&&(r=g.PrevInAEL,0<=g.OutIdx&&0!==g.WindDelta&&null!==r&&0<=r.OutIdx&&r.Curr.X==g.Curr.X&&0!==r.WindDelta)){var y=new t.IntPoint(g.Curr);t.use_xyz&&this.SetZ(y,r,g);l=this.AddOutPt(r,y);r=this.AddOutPt(g,y);this.AddJoin(l,r,y)}g=g.NextInAEL}}this.ProcessHorizontals(!0);for(g=this.m_ActiveEdges;null!==g;)this.IsIntermediate(g,e)&&(l=null,0<=g.OutIdx&&(l=this.AddOutPt(g,g.Top)),g=this.UpdateEdgeIntoAEL(g),r=g.PrevInAEL,
y=g.NextInAEL,null!==r&&r.Curr.X==g.Bot.X&&r.Curr.Y==g.Bot.Y&&null!==l&&0<=r.OutIdx&&r.Curr.Y>r.Top.Y&&t.ClipperBase.SlopesEqual(g,r,this.m_UseFullRange)&&0!==g.WindDelta&&0!==r.WindDelta?(r=this.AddOutPt(r,g.Bot),this.AddJoin(l,r,g.Top)):null!==y&&y.Curr.X==g.Bot.X&&y.Curr.Y==g.Bot.Y&&null!==l&&0<=y.OutIdx&&y.Curr.Y>y.Top.Y&&t.ClipperBase.SlopesEqual(g,y,this.m_UseFullRange)&&0!==g.WindDelta&&0!==y.WindDelta&&(r=this.AddOutPt(y,g.Bot),this.AddJoin(l,r,g.Top))),g=g.NextInAEL};t.Clipper.prototype.DoMaxima=
function(e){var g=this.GetMaximaPair(e);if(null===g)0<=e.OutIdx&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e);else{for(var l=e.NextInAEL;null!==l&&l!=g;)this.IntersectEdges(e,l,e.Top),this.SwapPositionsInAEL(e,l),l=e.NextInAEL;-1==e.OutIdx&&-1==g.OutIdx?(this.DeleteFromAEL(e),this.DeleteFromAEL(g)):0<=e.OutIdx&&0<=g.OutIdx?(0<=e.OutIdx&&this.AddLocalMaxPoly(e,g,e.Top),this.DeleteFromAEL(e),this.DeleteFromAEL(g)):t.use_lines&&0===e.WindDelta?(0<=e.OutIdx&&(this.AddOutPt(e,e.Top),e.OutIdx=-1),this.DeleteFromAEL(e),
0<=g.OutIdx&&(this.AddOutPt(g,e.Top),g.OutIdx=-1),this.DeleteFromAEL(g)):t.Error("DoMaxima error")}};t.Clipper.ReversePaths=function(e){for(var g=0,l=e.length;g<l;g++)e[g].reverse()};t.Clipper.Orientation=function(e){return 0<=t.Clipper.Area(e)};t.Clipper.prototype.PointCount=function(e){if(null===e)return 0;var g=0,l=e;do g++,l=l.Next;while(l!=e);return g};t.Clipper.prototype.BuildResult=function(e){t.Clear(e);for(var g=0,l=this.m_PolyOuts.length;g<l;g++){var r=this.m_PolyOuts[g];if(null!==r.Pts){r=
r.Pts.Prev;var y=this.PointCount(r);if(!(2>y)){for(var F=Array(y),K=0;K<y;K++)F[K]=r.Pt,r=r.Prev;e.push(F)}}}};t.Clipper.prototype.BuildResult2=function(e){e.Clear();for(var g=0,l=this.m_PolyOuts.length;g<l;g++){var r=this.m_PolyOuts[g],y=this.PointCount(r.Pts);if(!(r.IsOpen&&2>y||!r.IsOpen&&3>y)){this.FixHoleLinkage(r);var F=new t.PolyNode;e.m_AllPolys.push(F);r.PolyNode=F;F.m_polygon.length=y;r=r.Pts.Prev;for(var K=0;K<y;K++)F.m_polygon[K]=r.Pt,r=r.Prev}}g=0;for(l=this.m_PolyOuts.length;g<l;g++)r=
this.m_PolyOuts[g],null!==r.PolyNode&&(r.IsOpen?(r.PolyNode.IsOpen=!0,e.AddChild(r.PolyNode)):null!==r.FirstLeft&&null!=r.FirstLeft.PolyNode?r.FirstLeft.PolyNode.AddChild(r.PolyNode):e.AddChild(r.PolyNode))};t.Clipper.prototype.FixupOutPolygon=function(e){var g=null;e.BottomPt=null;for(var l=e.Pts;;){if(l.Prev==l||l.Prev==l.Next){e.Pts=null;return}if(t.IntPoint.op_Equality(l.Pt,l.Next.Pt)||t.IntPoint.op_Equality(l.Pt,l.Prev.Pt)||t.ClipperBase.SlopesEqual(l.Prev.Pt,l.Pt,l.Next.Pt,this.m_UseFullRange)&&
(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(l.Prev.Pt,l.Pt,l.Next.Pt)))g=null,l.Prev.Next=l.Next,l=l.Next.Prev=l.Prev;else if(l==g)break;else null===g&&(g=l),l=l.Next}e.Pts=l};t.Clipper.prototype.DupOutPt=function(e,g){var l=new t.OutPt;l.Pt.X=e.Pt.X;l.Pt.Y=e.Pt.Y;t.use_xyz&&(l.Pt.Z=e.Pt.Z);l.Idx=e.Idx;g?(l.Next=e.Next,l.Prev=e,e.Next.Prev=l,e.Next=l):(l.Prev=e.Prev,l.Next=e,e.Prev.Next=l,e.Prev=l);return l};t.Clipper.prototype.GetOverlap=function(e,g,l,r,y){e<g?l<r?(y.Left=Math.max(e,l),
y.Right=Math.min(g,r)):(y.Left=Math.max(e,r),y.Right=Math.min(g,l)):l<r?(y.Left=Math.max(g,l),y.Right=Math.min(e,r)):(y.Left=Math.max(g,r),y.Right=Math.min(e,l));return y.Left<y.Right};t.Clipper.prototype.JoinHorz=function(e,g,l,r,y,F){var K=e.Pt.X>g.Pt.X?t.Direction.dRightToLeft:t.Direction.dLeftToRight;r=l.Pt.X>r.Pt.X?t.Direction.dRightToLeft:t.Direction.dLeftToRight;if(K==r)return!1;if(K==t.Direction.dLeftToRight){for(;e.Next.Pt.X<=y.X&&e.Next.Pt.X>=e.Pt.X&&e.Next.Pt.Y==y.Y;)e=e.Next;F&&e.Pt.X!=
y.X&&(e=e.Next);g=this.DupOutPt(e,!F);t.IntPoint.op_Inequality(g.Pt,y)&&(e=g,e.Pt.X=y.X,e.Pt.Y=y.Y,t.use_xyz&&(e.Pt.Z=y.Z),g=this.DupOutPt(e,!F))}else{for(;e.Next.Pt.X>=y.X&&e.Next.Pt.X<=e.Pt.X&&e.Next.Pt.Y==y.Y;)e=e.Next;F||e.Pt.X==y.X||(e=e.Next);g=this.DupOutPt(e,F);t.IntPoint.op_Inequality(g.Pt,y)&&(e=g,e.Pt.X=y.X,e.Pt.Y=y.Y,t.use_xyz&&(e.Pt.Z=y.Z),g=this.DupOutPt(e,F))}if(r==t.Direction.dLeftToRight){for(;l.Next.Pt.X<=y.X&&l.Next.Pt.X>=l.Pt.X&&l.Next.Pt.Y==y.Y;)l=l.Next;F&&l.Pt.X!=y.X&&(l=l.Next);
r=this.DupOutPt(l,!F);t.IntPoint.op_Inequality(r.Pt,y)&&(l=r,l.Pt.X=y.X,l.Pt.Y=y.Y,t.use_xyz&&(l.Pt.Z=y.Z),r=this.DupOutPt(l,!F))}else{for(;l.Next.Pt.X>=y.X&&l.Next.Pt.X<=l.Pt.X&&l.Next.Pt.Y==y.Y;)l=l.Next;F||l.Pt.X==y.X||(l=l.Next);r=this.DupOutPt(l,F);t.IntPoint.op_Inequality(r.Pt,y)&&(l=r,l.Pt.X=y.X,l.Pt.Y=y.Y,t.use_xyz&&(l.Pt.Z=y.Z),r=this.DupOutPt(l,F))}K==t.Direction.dLeftToRight==F?(e.Prev=l,l.Next=e,g.Next=r,r.Prev=g):(e.Next=l,l.Prev=e,g.Prev=r,r.Next=g);return!0};t.Clipper.prototype.JoinPoints=
function(e,g,l){var r=e.OutPt1,y;new t.OutPt;var F=e.OutPt2,K;new t.OutPt;if((K=e.OutPt1.Pt.Y==e.OffPt.Y)&&t.IntPoint.op_Equality(e.OffPt,e.OutPt1.Pt)&&t.IntPoint.op_Equality(e.OffPt,e.OutPt2.Pt)){if(g!=l)return!1;for(y=e.OutPt1.Next;y!=r&&t.IntPoint.op_Equality(y.Pt,e.OffPt);)y=y.Next;y=y.Pt.Y>e.OffPt.Y;for(K=e.OutPt2.Next;K!=F&&t.IntPoint.op_Equality(K.Pt,e.OffPt);)K=K.Next;if(y==K.Pt.Y>e.OffPt.Y)return!1;y?(y=this.DupOutPt(r,!1),K=this.DupOutPt(F,!0),r.Prev=F,F.Next=r,y.Next=K,K.Prev=y):(y=this.DupOutPt(r,
!0),K=this.DupOutPt(F,!1),r.Next=F,F.Prev=r,y.Prev=K,K.Next=y);e.OutPt1=r;e.OutPt2=y;return!0}if(K){for(y=r;r.Prev.Pt.Y==r.Pt.Y&&r.Prev!=y&&r.Prev!=F;)r=r.Prev;for(;y.Next.Pt.Y==y.Pt.Y&&y.Next!=r&&y.Next!=F;)y=y.Next;if(y.Next==r||y.Next==F)return!1;for(K=F;F.Prev.Pt.Y==F.Pt.Y&&F.Prev!=K&&F.Prev!=y;)F=F.Prev;for(;K.Next.Pt.Y==K.Pt.Y&&K.Next!=F&&K.Next!=r;)K=K.Next;if(K.Next==F||K.Next==r)return!1;l={Left:null,Right:null};if(!this.GetOverlap(r.Pt.X,y.Pt.X,F.Pt.X,K.Pt.X,l))return!1;g=l.Left;var ca=
l.Right;l=new t.IntPoint;r.Pt.X>=g&&r.Pt.X<=ca?(l.X=r.Pt.X,l.Y=r.Pt.Y,t.use_xyz&&(l.Z=r.Pt.Z),g=r.Pt.X>y.Pt.X):F.Pt.X>=g&&F.Pt.X<=ca?(l.X=F.Pt.X,l.Y=F.Pt.Y,t.use_xyz&&(l.Z=F.Pt.Z),g=F.Pt.X>K.Pt.X):y.Pt.X>=g&&y.Pt.X<=ca?(l.X=y.Pt.X,l.Y=y.Pt.Y,t.use_xyz&&(l.Z=y.Pt.Z),g=y.Pt.X>r.Pt.X):(l.X=K.Pt.X,l.Y=K.Pt.Y,t.use_xyz&&(l.Z=K.Pt.Z),g=K.Pt.X>F.Pt.X);e.OutPt1=r;e.OutPt2=F;return this.JoinHorz(r,y,F,K,l,g)}for(y=r.Next;t.IntPoint.op_Equality(y.Pt,r.Pt)&&y!=r;)y=y.Next;if(ca=y.Pt.Y>r.Pt.Y||!t.ClipperBase.SlopesEqual(r.Pt,
y.Pt,e.OffPt,this.m_UseFullRange)){for(y=r.Prev;t.IntPoint.op_Equality(y.Pt,r.Pt)&&y!=r;)y=y.Prev;if(y.Pt.Y>r.Pt.Y||!t.ClipperBase.SlopesEqual(r.Pt,y.Pt,e.OffPt,this.m_UseFullRange))return!1}for(K=F.Next;t.IntPoint.op_Equality(K.Pt,F.Pt)&&K!=F;)K=K.Next;var ka=K.Pt.Y>F.Pt.Y||!t.ClipperBase.SlopesEqual(F.Pt,K.Pt,e.OffPt,this.m_UseFullRange);if(ka){for(K=F.Prev;t.IntPoint.op_Equality(K.Pt,F.Pt)&&K!=F;)K=K.Prev;if(K.Pt.Y>F.Pt.Y||!t.ClipperBase.SlopesEqual(F.Pt,K.Pt,e.OffPt,this.m_UseFullRange))return!1}if(y==
r||K==F||y==K||g==l&&ca==ka)return!1;ca?(y=this.DupOutPt(r,!1),K=this.DupOutPt(F,!0),r.Prev=F,F.Next=r,y.Next=K,K.Prev=y):(y=this.DupOutPt(r,!0),K=this.DupOutPt(F,!1),r.Next=F,F.Prev=r,y.Prev=K,K.Next=y);e.OutPt1=r;e.OutPt2=y;return!0};t.Clipper.GetBounds=function(e){for(var g=0,l=e.length;g<l&&0==e[g].length;)g++;if(g==l)return new t.IntRect(0,0,0,0);var r=new t.IntRect;r.left=e[g][0].X;r.right=r.left;r.top=e[g][0].Y;for(r.bottom=r.top;g<l;g++)for(var y=0,F=e[g].length;y<F;y++)e[g][y].X<r.left?r.left=
e[g][y].X:e[g][y].X>r.right&&(r.right=e[g][y].X),e[g][y].Y<r.top?r.top=e[g][y].Y:e[g][y].Y>r.bottom&&(r.bottom=e[g][y].Y);return r};t.Clipper.prototype.GetBounds2=function(e){var g=e,l=new t.IntRect;l.left=e.Pt.X;l.right=e.Pt.X;l.top=e.Pt.Y;l.bottom=e.Pt.Y;for(e=e.Next;e!=g;)e.Pt.X<l.left&&(l.left=e.Pt.X),e.Pt.X>l.right&&(l.right=e.Pt.X),e.Pt.Y<l.top&&(l.top=e.Pt.Y),e.Pt.Y>l.bottom&&(l.bottom=e.Pt.Y),e=e.Next;return l};t.Clipper.PointInPolygon=function(e,g){var l=0,r=g.length;if(3>r)return 0;for(var y=
g[0],F=1;F<=r;++F){var K=F==r?g[0]:g[F];if(K.Y==e.Y&&(K.X==e.X||y.Y==e.Y&&K.X>e.X==y.X<e.X))return-1;if(y.Y<e.Y!=K.Y<e.Y)if(y.X>=e.X)if(K.X>e.X)l=1-l;else{var ca=(y.X-e.X)*(K.Y-e.Y)-(K.X-e.X)*(y.Y-e.Y);if(0==ca)return-1;0<ca==K.Y>y.Y&&(l=1-l)}else if(K.X>e.X){ca=(y.X-e.X)*(K.Y-e.Y)-(K.X-e.X)*(y.Y-e.Y);if(0==ca)return-1;0<ca==K.Y>y.Y&&(l=1-l)}y=K}return l};t.Clipper.prototype.PointInPolygon=function(e,g){var l=0,r=g,y=e.X;e=e.Y;var F=g.Pt.X,K=g.Pt.Y;do{g=g.Next;var ca=g.Pt.X,ka=g.Pt.Y;if(ka==e&&(ca==
y||K==e&&ca>y==F<y))return-1;if(K<e!=ka<e)if(F>=y)if(ca>y)l=1-l;else{F=(F-y)*(ka-e)-(ca-y)*(K-e);if(0==F)return-1;0<F==ka>K&&(l=1-l)}else if(ca>y){F=(F-y)*(ka-e)-(ca-y)*(K-e);if(0==F)return-1;0<F==ka>K&&(l=1-l)}F=ca;K=ka}while(r!=g);return l};t.Clipper.prototype.Poly2ContainsPoly1=function(e,g){var l=e;do{var r=this.PointInPolygon(l.Pt,g);if(0<=r)return 0<r;l=l.Next}while(l!=e);return!0};t.Clipper.prototype.FixupFirstLefts1=function(e,g){for(var l=0,r=this.m_PolyOuts.length;l<r;l++){var y=this.m_PolyOuts[l];
null!=y.Pts&&null!=y.FirstLeft&&this.ParseFirstLeft(y.FirstLeft)==e&&this.Poly2ContainsPoly1(y.Pts,g.Pts)&&(y.FirstLeft=g)}};t.Clipper.prototype.FixupFirstLefts2=function(e,g){for(var l=0,r=this.m_PolyOuts,y=r.length,F=r[l];l<y;l++,F=r[l])F.FirstLeft==e&&(F.FirstLeft=g)};t.Clipper.ParseFirstLeft=function(e){for(;null!=e&&null==e.Pts;)e=e.FirstLeft;return e};t.Clipper.prototype.JoinCommonEdges=function(){for(var e=0,g=this.m_Joins.length;e<g;e++){var l=this.m_Joins[e],r=this.GetOutRec(l.OutPt1.Idx),
y=this.GetOutRec(l.OutPt2.Idx);if(null!=r.Pts&&null!=y.Pts){var F=r==y?r:this.Param1RightOfParam2(r,y)?y:this.Param1RightOfParam2(y,r)?r:this.GetLowermostRec(r,y);if(this.JoinPoints(l,r,y))if(r==y){r.Pts=l.OutPt1;r.BottomPt=null;y=this.CreateOutRec();y.Pts=l.OutPt2;this.UpdateOutPtIdxs(y);if(this.m_UsingPolyTree){F=0;for(var K=this.m_PolyOuts.length;F<K-1;F++){var ca=this.m_PolyOuts[F];null!=ca.Pts&&t.Clipper.ParseFirstLeft(ca.FirstLeft)==r&&ca.IsHole!=r.IsHole&&this.Poly2ContainsPoly1(ca.Pts,l.OutPt2)&&
(ca.FirstLeft=y)}}this.Poly2ContainsPoly1(y.Pts,r.Pts)?(y.IsHole=!r.IsHole,y.FirstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(y,r),(y.IsHole^this.ReverseSolution)==0<this.Area(y)&&this.ReversePolyPtLinks(y.Pts)):this.Poly2ContainsPoly1(r.Pts,y.Pts)?(y.IsHole=r.IsHole,r.IsHole=!y.IsHole,y.FirstLeft=r.FirstLeft,r.FirstLeft=y,this.m_UsingPolyTree&&this.FixupFirstLefts2(r,y),(r.IsHole^this.ReverseSolution)==0<this.Area(r)&&this.ReversePolyPtLinks(r.Pts)):(y.IsHole=r.IsHole,y.FirstLeft=r.FirstLeft,
this.m_UsingPolyTree&&this.FixupFirstLefts1(r,y))}else y.Pts=null,y.BottomPt=null,y.Idx=r.Idx,r.IsHole=F.IsHole,F==y&&(r.FirstLeft=y.FirstLeft),y.FirstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(y,r)}}};t.Clipper.prototype.UpdateOutPtIdxs=function(e){var g=e.Pts;do g.Idx=e.Idx,g=g.Prev;while(g!=e.Pts)};t.Clipper.prototype.DoSimplePolygons=function(){for(var e=0;e<this.m_PolyOuts.length;){var g=this.m_PolyOuts[e++],l=g.Pts;if(null!=l&&!g.IsOpen){do{for(var r=l.Next;r!=g.Pts;){if(t.IntPoint.op_Equality(l.Pt,
r.Pt)&&r.Next!=l&&r.Prev!=l){var y=l.Prev,F=r.Prev;l.Prev=F;F.Next=l;r.Prev=y;y.Next=r;g.Pts=l;y=this.CreateOutRec();y.Pts=r;this.UpdateOutPtIdxs(y);this.Poly2ContainsPoly1(y.Pts,g.Pts)?(y.IsHole=!g.IsHole,y.FirstLeft=g,this.m_UsingPolyTree&&this.FixupFirstLefts2(y,g)):this.Poly2ContainsPoly1(g.Pts,y.Pts)?(y.IsHole=g.IsHole,g.IsHole=!y.IsHole,y.FirstLeft=g.FirstLeft,g.FirstLeft=y,this.m_UsingPolyTree&&this.FixupFirstLefts2(g,y)):(y.IsHole=g.IsHole,y.FirstLeft=g.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(g,
y));r=l}r=r.Next}l=l.Next}while(l!=g.Pts)}}};t.Clipper.Area=function(e){var g=e.length;if(3>g)return 0;for(var l=0,r=0,y=g-1;r<g;++r)l+=(e[y].X+e[r].X)*(e[y].Y-e[r].Y),y=r;return.5*-l};t.Clipper.prototype.Area=function(e){var g=e.Pts;if(null==g)return 0;var l=0;do l+=(g.Prev.Pt.X+g.Pt.X)*(g.Prev.Pt.Y-g.Pt.Y),g=g.Next;while(g!=e.Pts);return.5*l};t.Clipper.SimplifyPolygon=function(e,g){var l=[],r=new t.Clipper(0);r.StrictlySimple=!0;r.AddPath(e,t.PolyType.ptSubject,!0);r.Execute(t.ClipType.ctUnion,
l,g,g);return l};t.Clipper.SimplifyPolygons=function(e,g){"undefined"==typeof g&&(g=t.PolyFillType.pftEvenOdd);var l=[],r=new t.Clipper(0);r.StrictlySimple=!0;r.AddPaths(e,t.PolyType.ptSubject,!0);r.Execute(t.ClipType.ctUnion,l,g,g);return l};t.Clipper.DistanceSqrd=function(e,g){var l=e.X-g.X;e=e.Y-g.Y;return l*l+e*e};t.Clipper.DistanceFromLineSqrd=function(e,g,l){var r=g.Y-l.Y;l=l.X-g.X;g=r*g.X+l*g.Y;g=r*e.X+l*e.Y-g;return g*g/(r*r+l*l)};t.Clipper.SlopesNearCollinear=function(e,g,l,r){return Math.abs(e.X-
g.X)>Math.abs(e.Y-g.Y)?e.X>g.X==e.X<l.X?t.Clipper.DistanceFromLineSqrd(e,g,l)<r:g.X>e.X==g.X<l.X?t.Clipper.DistanceFromLineSqrd(g,e,l)<r:t.Clipper.DistanceFromLineSqrd(l,e,g)<r:e.Y>g.Y==e.Y<l.Y?t.Clipper.DistanceFromLineSqrd(e,g,l)<r:g.Y>e.Y==g.Y<l.Y?t.Clipper.DistanceFromLineSqrd(g,e,l)<r:t.Clipper.DistanceFromLineSqrd(l,e,g)<r};t.Clipper.PointsAreClose=function(e,g,l){var r=e.X-g.X;e=e.Y-g.Y;return r*r+e*e<=l};t.Clipper.ExcludeOp=function(e){var g=e.Prev;g.Next=e.Next;e.Next.Prev=g;g.Idx=0;return g};
t.Clipper.CleanPolygon=function(e,g){"undefined"==typeof g&&(g=1.415);var l=e.length;if(0==l)return[];for(var r=Array(l),y=0;y<l;++y)r[y]=new t.OutPt;for(y=0;y<l;++y)r[y].Pt=e[y],r[y].Next=r[(y+1)%l],r[y].Next.Prev=r[y],r[y].Idx=0;y=g*g;for(r=r[0];0==r.Idx&&r.Next!=r.Prev;)t.Clipper.PointsAreClose(r.Pt,r.Prev.Pt,y)?(r=t.Clipper.ExcludeOp(r),l--):t.Clipper.PointsAreClose(r.Prev.Pt,r.Next.Pt,y)?(t.Clipper.ExcludeOp(r.Next),r=t.Clipper.ExcludeOp(r),l-=2):t.Clipper.SlopesNearCollinear(r.Prev.Pt,r.Pt,
r.Next.Pt,y)?(r=t.Clipper.ExcludeOp(r),l--):(r.Idx=1,r=r.Next);3>l&&(l=0);e=Array(l);for(y=0;y<l;++y)e[y]=new t.IntPoint(r.Pt),r=r.Next;return e};t.Clipper.CleanPolygons=function(e,g){for(var l=Array(e.length),r=0,y=e.length;r<y;r++)l[r]=t.Clipper.CleanPolygon(e[r],g);return l};t.Clipper.Minkowski=function(e,g,l,r){r=r?1:0;var y=e.length,F=g.length,K=[];if(l)for(l=0;l<F;l++){for(var ca=Array(y),ka=0,pa=e.length,La=e[ka];ka<pa;ka++,La=e[ka])ca[ka]=new t.IntPoint(g[l].X+La.X,g[l].Y+La.Y);K.push(ca)}else for(l=
0;l<F;l++){ca=Array(y);ka=0;pa=e.length;for(La=e[ka];ka<pa;ka++,La=e[ka])ca[ka]=new t.IntPoint(g[l].X-La.X,g[l].Y-La.Y);K.push(ca)}e=[];for(l=0;l<F-1+r;l++)for(ka=0;ka<y;ka++)g=[],g.push(K[l%F][ka%y]),g.push(K[(l+1)%F][ka%y]),g.push(K[(l+1)%F][(ka+1)%y]),g.push(K[l%F][(ka+1)%y]),t.Clipper.Orientation(g)||g.reverse(),e.push(g);return e};t.Clipper.MinkowskiSum=function(e,g,l){if(g[0]instanceof Array){K=g;g=new t.Paths;for(var r=new t.Clipper,y=0;y<K.length;++y){var F=t.Clipper.Minkowski(e,K[y],!0,l);
r.AddPaths(F,t.PolyType.ptSubject,!0);l&&(F=t.Clipper.TranslatePath(K[y],e[0]),r.AddPath(F,t.PolyType.ptClip,!0))}r.Execute(t.ClipType.ctUnion,g,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero);return g}var K=t.Clipper.Minkowski(e,g,!0,l);r=new t.Clipper;r.AddPaths(K,t.PolyType.ptSubject,!0);r.Execute(t.ClipType.ctUnion,K,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero);return K};t.Clipper.TranslatePath=function(e,g){for(var l=new t.Path,r=0;r<e.length;r++)l.push(new t.IntPoint(e[r].X+g.X,
e[r].Y+g.Y));return l};t.Clipper.MinkowskiDiff=function(e,g){e=t.Clipper.Minkowski(e,g,!1,!0);g=new t.Clipper;g.AddPaths(e,t.PolyType.ptSubject,!0);g.Execute(t.ClipType.ctUnion,e,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero);return e};t.Clipper.PolyTreeToPaths=function(e){var g=[];t.Clipper.AddPolyNodeToPaths(e,t.Clipper.NodeType.ntAny,g);return g};t.Clipper.AddPolyNodeToPaths=function(e,g,l){var r=!0;switch(g){case t.Clipper.NodeType.ntOpen:return;case t.Clipper.NodeType.ntClosed:r=!e.IsOpen}0<
e.m_polygon.length&&r&&l.push(e.m_polygon);r=0;e=e.Childs();for(var y=e.length,F=e[r];r<y;r++,F=e[r])t.Clipper.AddPolyNodeToPaths(F,g,l)};t.Clipper.OpenPathsFromPolyTree=function(e){for(var g=new t.Paths,l=0,r=e.ChildCount();l<r;l++)e.Childs()[l].IsOpen&&g.push(e.Childs()[l].m_polygon);return g};t.Clipper.ClosedPathsFromPolyTree=function(e){var g=new t.Paths;t.Clipper.AddPolyNodeToPaths(e,t.Clipper.NodeType.ntClosed,g);return g};db(t.Clipper,t.ClipperBase);t.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2};
t.ClipperOffset=function(e,g){"undefined"==typeof e&&(e=2);"undefined"==typeof g&&(g=t.ClipperOffset.def_arc_tolerance);this.m_destPolys=new t.Paths;this.m_srcPoly=new t.Path;this.m_destPoly=new t.Path;this.m_normals=[];this.m_StepsPerRad=this.m_miterLim=this.m_cos=this.m_sin=this.m_sinA=this.m_delta=0;this.m_lowest=new t.IntPoint;this.m_polyNodes=new t.PolyNode;this.MiterLimit=e;this.ArcTolerance=g;this.m_lowest.X=-1};t.ClipperOffset.two_pi=6.28318530717959;t.ClipperOffset.def_arc_tolerance=.25;
t.ClipperOffset.prototype.Clear=function(){t.Clear(this.m_polyNodes.Childs());this.m_lowest.X=-1};t.ClipperOffset.Round=t.Clipper.Round;t.ClipperOffset.prototype.AddPath=function(e,g,l){var r=e.length-1;if(!(0>r)){var y=new t.PolyNode;y.m_jointype=g;y.m_endtype=l;if(l==t.EndType.etClosedLine||l==t.EndType.etClosedPolygon)for(;0<r&&t.IntPoint.op_Equality(e[0],e[r]);)r--;y.m_polygon.push(e[0]);var F=0;g=0;for(var K=1;K<=r;K++)t.IntPoint.op_Inequality(y.m_polygon[F],e[K])&&(F++,y.m_polygon.push(e[K]),
e[K].Y>y.m_polygon[g].Y||e[K].Y==y.m_polygon[g].Y&&e[K].X<y.m_polygon[g].X)&&(g=F);if(!(l==t.EndType.etClosedPolygon&&2>F)&&(this.m_polyNodes.AddChild(y),l==t.EndType.etClosedPolygon))if(0>this.m_lowest.X)this.m_lowest=new t.IntPoint(this.m_polyNodes.ChildCount()-1,g);else if(e=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y],y.m_polygon[g].Y>e.Y||y.m_polygon[g].Y==e.Y&&y.m_polygon[g].X<e.X)this.m_lowest=new t.IntPoint(this.m_polyNodes.ChildCount()-1,g)}};t.ClipperOffset.prototype.AddPaths=
function(e,g,l){for(var r=0,y=e.length;r<y;r++)this.AddPath(e[r],g,l)};t.ClipperOffset.prototype.FixOrientations=function(){if(0<=this.m_lowest.X&&!t.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var e=0;e<this.m_polyNodes.ChildCount();e++){var g=this.m_polyNodes.Childs()[e];(g.m_endtype==t.EndType.etClosedPolygon||g.m_endtype==t.EndType.etClosedLine&&t.Clipper.Orientation(g.m_polygon))&&g.m_polygon.reverse()}else for(e=0;e<this.m_polyNodes.ChildCount();e++)g=this.m_polyNodes.Childs()[e],
g.m_endtype!=t.EndType.etClosedLine||t.Clipper.Orientation(g.m_polygon)||g.m_polygon.reverse()};t.ClipperOffset.GetUnitNormal=function(e,g){var l=g.X-e.X;e=g.Y-e.Y;if(0==l&&0==e)return new t.DoublePoint(0,0);g=1/Math.sqrt(l*l+e*e);return new t.DoublePoint(e*g,-(l*g))};t.ClipperOffset.prototype.DoOffset=function(e){this.m_destPolys=[];this.m_delta=e;if(t.ClipperBase.near_zero(e))for(var g=0;g<this.m_polyNodes.ChildCount();g++){var l=this.m_polyNodes.Childs()[g];l.m_endtype==t.EndType.etClosedPolygon&&
this.m_destPolys.push(l.m_polygon)}else{this.m_miterLim=2<this.MiterLimit?2/(this.MiterLimit*this.MiterLimit):.5;var r=3.14159265358979/Math.acos(1-(0>=this.ArcTolerance?t.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(e)*t.ClipperOffset.def_arc_tolerance?Math.abs(e)*t.ClipperOffset.def_arc_tolerance:this.ArcTolerance)/Math.abs(e));this.m_sin=Math.sin(t.ClipperOffset.two_pi/r);this.m_cos=Math.cos(t.ClipperOffset.two_pi/r);this.m_StepsPerRad=r/t.ClipperOffset.two_pi;0>e&&(this.m_sin=-this.m_sin);
for(g=0;g<this.m_polyNodes.ChildCount();g++){l=this.m_polyNodes.Childs()[g];this.m_srcPoly=l.m_polygon;var y=this.m_srcPoly.length;if(!(0==y||0>=e&&(3>y||l.m_endtype!=t.EndType.etClosedPolygon))){this.m_destPoly=[];if(1==y)if(l.m_jointype==t.JoinType.jtRound){l=1;y=0;for(var F=1;F<=r;F++){this.m_destPoly.push(new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[0].X+l*e),t.ClipperOffset.Round(this.m_srcPoly[0].Y+y*e)));var K=l;l=l*this.m_cos-this.m_sin*y;y=K*this.m_sin+y*this.m_cos}}else for(y=l=-1,
F=0;4>F;++F)this.m_destPoly.push(new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[0].X+l*e),t.ClipperOffset.Round(this.m_srcPoly[0].Y+y*e))),0>l?l=1:0>y?y=1:l=-1;else{for(F=this.m_normals.length=0;F<y-1;F++)this.m_normals.push(t.ClipperOffset.GetUnitNormal(this.m_srcPoly[F],this.m_srcPoly[F+1]));l.m_endtype==t.EndType.etClosedLine||l.m_endtype==t.EndType.etClosedPolygon?this.m_normals.push(t.ClipperOffset.GetUnitNormal(this.m_srcPoly[y-1],this.m_srcPoly[0])):this.m_normals.push(new t.DoublePoint(this.m_normals[y-
2]));if(l.m_endtype==t.EndType.etClosedPolygon)for(K=y-1,F=0;F<y;F++)K=this.OffsetPoint(F,K,l.m_jointype);else if(l.m_endtype==t.EndType.etClosedLine){K=y-1;for(F=0;F<y;F++)K=this.OffsetPoint(F,K,l.m_jointype);this.m_destPolys.push(this.m_destPoly);this.m_destPoly=[];K=this.m_normals[y-1];for(F=y-1;0<F;F--)this.m_normals[F]=new t.DoublePoint(-this.m_normals[F-1].X,-this.m_normals[F-1].Y);this.m_normals[0]=new t.DoublePoint(-K.X,-K.Y);K=0;for(F=y-1;0<=F;F--)K=this.OffsetPoint(F,K,l.m_jointype)}else{K=
0;for(F=1;F<y-1;++F)K=this.OffsetPoint(F,K,l.m_jointype);l.m_endtype==t.EndType.etOpenButt?(F=y-1,K=new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[F].X+this.m_normals[F].X*e),t.ClipperOffset.Round(this.m_srcPoly[F].Y+this.m_normals[F].Y*e)),this.m_destPoly.push(K),K=new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[F].X-this.m_normals[F].X*e),t.ClipperOffset.Round(this.m_srcPoly[F].Y-this.m_normals[F].Y*e)),this.m_destPoly.push(K)):(F=y-1,K=y-2,this.m_sinA=0,this.m_normals[F]=new t.DoublePoint(-this.m_normals[F].X,
-this.m_normals[F].Y),l.m_endtype==t.EndType.etOpenSquare?this.DoSquare(F,K):this.DoRound(F,K));for(F=y-1;0<F;F--)this.m_normals[F]=new t.DoublePoint(-this.m_normals[F-1].X,-this.m_normals[F-1].Y);this.m_normals[0]=new t.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y);K=y-1;for(F=K-1;0<F;--F)K=this.OffsetPoint(F,K,l.m_jointype);l.m_endtype==t.EndType.etOpenButt?(K=new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*e),t.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*
e)),this.m_destPoly.push(K),K=new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*e),t.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*e)),this.m_destPoly.push(K)):(this.m_sinA=0,l.m_endtype==t.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1))}}this.m_destPolys.push(this.m_destPoly)}}}};t.ClipperOffset.prototype.Execute=function(){var e=arguments;if(e[0]instanceof t.PolyTree)if(g=e[0],l=e[1],g.Clear(),this.FixOrientations(),this.DoOffset(l),e=new t.Clipper(0),
e.AddPaths(this.m_destPolys,t.PolyType.ptSubject,!0),0<l)e.Execute(t.ClipType.ctUnion,g,t.PolyFillType.pftPositive,t.PolyFillType.pftPositive);else if(l=t.Clipper.GetBounds(this.m_destPolys),r=new t.Path,r.push(new t.IntPoint(l.left-10,l.bottom+10)),r.push(new t.IntPoint(l.right+10,l.bottom+10)),r.push(new t.IntPoint(l.right+10,l.top-10)),r.push(new t.IntPoint(l.left-10,l.top-10)),e.AddPath(r,t.PolyType.ptSubject,!0),e.ReverseSolution=!0,e.Execute(t.ClipType.ctUnion,g,t.PolyFillType.pftNegative,t.PolyFillType.pftNegative),
1==g.ChildCount()&&0<g.Childs()[0].ChildCount())for(e=g.Childs()[0],g.Childs()[0]=e.Childs()[0],g.Childs()[0].m_Parent=g,l=1;l<e.ChildCount();l++)g.AddChild(e.Childs()[l]);else g.Clear();else{var g=e[0],l=e[1];t.Clear(g);this.FixOrientations();this.DoOffset(l);e=new t.Clipper(0);e.AddPaths(this.m_destPolys,t.PolyType.ptSubject,!0);if(0<l)e.Execute(t.ClipType.ctUnion,g,t.PolyFillType.pftPositive,t.PolyFillType.pftPositive);else{l=t.Clipper.GetBounds(this.m_destPolys);var r=new t.Path;r.push(new t.IntPoint(l.left-
10,l.bottom+10));r.push(new t.IntPoint(l.right+10,l.bottom+10));r.push(new t.IntPoint(l.right+10,l.top-10));r.push(new t.IntPoint(l.left-10,l.top-10));e.AddPath(r,t.PolyType.ptSubject,!0);e.ReverseSolution=!0;e.Execute(t.ClipType.ctUnion,g,t.PolyFillType.pftNegative,t.PolyFillType.pftNegative);0<g.length&&g.splice(0,1)}}};t.ClipperOffset.prototype.OffsetPoint=function(e,g,l){this.m_sinA=this.m_normals[g].X*this.m_normals[e].Y-this.m_normals[e].X*this.m_normals[g].Y;if(1>Math.abs(this.m_sinA*this.m_delta)){if(0<
this.m_normals[g].X*this.m_normals[e].X+this.m_normals[e].Y*this.m_normals[g].Y)return this.m_destPoly.push(new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[g].X*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[g].Y*this.m_delta))),g}else 1<this.m_sinA?this.m_sinA=1:-1>this.m_sinA&&(this.m_sinA=-1);if(0>this.m_sinA*this.m_delta)this.m_destPoly.push(new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[g].X*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[e].Y+
this.m_normals[g].Y*this.m_delta))),this.m_destPoly.push(new t.IntPoint(this.m_srcPoly[e])),this.m_destPoly.push(new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)));else switch(l){case t.JoinType.jtMiter:l=1+(this.m_normals[e].X*this.m_normals[g].X+this.m_normals[e].Y*this.m_normals[g].Y);l>=this.m_miterLim?this.DoMiter(e,g,l):this.DoSquare(e,g);break;case t.JoinType.jtSquare:this.DoSquare(e,
g);break;case t.JoinType.jtRound:this.DoRound(e,g)}return e};t.ClipperOffset.prototype.DoSquare=function(e,g){var l=Math.tan(Math.atan2(this.m_sinA,this.m_normals[g].X*this.m_normals[e].X+this.m_normals[g].Y*this.m_normals[e].Y)/4);this.m_destPoly.push(new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*(this.m_normals[g].X-this.m_normals[g].Y*l)),t.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[g].Y+this.m_normals[g].X*l))));this.m_destPoly.push(new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[e].X+
this.m_delta*(this.m_normals[e].X+this.m_normals[e].Y*l)),t.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[e].Y-this.m_normals[e].X*l))))};t.ClipperOffset.prototype.DoMiter=function(e,g,l){l=this.m_delta/l;this.m_destPoly.push(new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[e].X+(this.m_normals[g].X+this.m_normals[e].X)*l),t.ClipperOffset.Round(this.m_srcPoly[e].Y+(this.m_normals[g].Y+this.m_normals[e].Y)*l)))};t.ClipperOffset.prototype.DoRound=function(e,g){var l=Math.max(t.Cast_Int32(t.ClipperOffset.Round(this.m_StepsPerRad*
Math.abs(Math.atan2(this.m_sinA,this.m_normals[g].X*this.m_normals[e].X+this.m_normals[g].Y*this.m_normals[e].Y)))),1),r=this.m_normals[g].X;g=this.m_normals[g].Y;for(var y,F=0;F<l;++F)this.m_destPoly.push(new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[e].X+r*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[e].Y+g*this.m_delta))),y=r,r=r*this.m_cos-this.m_sin*g,g=y*this.m_sin+g*this.m_cos;this.m_destPoly.push(new t.IntPoint(t.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),
t.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)))};t.Error=function(e){try{throw Error(e);}catch(g){alert(g.message)}};t.JS={};t.JS.AreaOfPolygon=function(e,g){g||(g=1);return t.Clipper.Area(e)/(g*g)};t.JS.AreaOfPolygons=function(e,g){g||(g=1);for(var l=0,r=0;r<e.length;r++)l+=t.Clipper.Area(e[r]);return l/(g*g)};t.JS.BoundsOfPath=function(e,g){return t.JS.BoundsOfPaths([e],g)};t.JS.BoundsOfPaths=function(e,g){g||(g=1);e=t.Clipper.GetBounds(e);e.left/=g;e.bottom/=g;e.right/=
g;e.top/=g;return e};t.JS.Clean=function(e,g){if(!(e instanceof Array))return[];var l=e[0]instanceof Array;e=t.JS.Clone(e);if("number"!=typeof g||null===g)return t.Error("Delta is not a number in Clean()."),e;if(0===e.length||1==e.length&&0===e[0].length||0>g)return e;l||(e=[e]);for(var r=e.length,y,F,K,ca,ka,pa,La,eb=[],Va=0;Va<r;Va++)if(F=e[Va],y=F.length,0!==y)if(3>y)K=F,eb.push(K);else{K=F;ca=g*g;ka=F[0];for(La=pa=1;La<y;La++)(F[La].X-ka.X)*(F[La].X-ka.X)+(F[La].Y-ka.Y)*(F[La].Y-ka.Y)<=ca||(K[pa]=
F[La],ka=F[La],pa++);ka=F[pa-1];(F[0].X-ka.X)*(F[0].X-ka.X)+(F[0].Y-ka.Y)*(F[0].Y-ka.Y)<=ca&&pa--;pa<y&&K.splice(pa,y-pa);K.length&&eb.push(K)}!l&&eb.length?eb=eb[0]:l||0!==eb.length?l&&0===eb.length&&(eb=[[]]):eb=[];return eb};t.JS.Clone=function(e){if(!(e instanceof Array)||0===e.length)return[];if(1==e.length&&0===e[0].length)return[[]];var g=e[0]instanceof Array;g||(e=[e]);var l=e.length,r,y,F=Array(l);for(r=0;r<l;r++){var K=e[r].length;var ca=Array(K);for(y=0;y<K;y++)ca[y]={X:e[r][y].X,Y:e[r][y].Y};
F[r]=ca}g||(F=F[0]);return F};t.JS.Lighten=function(e,g){if(!(e instanceof Array))return[];if("number"!=typeof g||null===g)return t.Error("Tolerance is not a number in Lighten()."),t.JS.Clone(e);if(0===e.length||1==e.length&&0===e[0].length||0>g)return t.JS.Clone(e);e[0]instanceof Array||(e=[e]);var l,r,y,F,K,ca=e.length,ka=g*g,pa=[];for(g=0;g<ca;g++)if(r=e[g],F=r.length,0!=F){for(y=0;1E6>y;y++){var La=[];F=r.length;r[F-1].X!=r[0].X||r[F-1].Y!=r[0].Y?(K=1,r.push({X:r[0].X,Y:r[0].Y}),F=r.length):K=
0;var eb=[];for(l=0;l<F-2;l++){var Va=r[l];var Ea=r[l+1];var Sa=r[l+2];var fc=Va.X;var Ab=Va.Y;Va=Sa.X-fc;var gc=Sa.Y-Ab;if(0!==Va||0!==gc){var hc=((Ea.X-fc)*Va+(Ea.Y-Ab)*gc)/(Va*Va+gc*gc);1<hc?(fc=Sa.X,Ab=Sa.Y):0<hc&&(fc+=Va*hc,Ab+=gc*hc)}Va=Ea.X-fc;gc=Ea.Y-Ab;Sa=Va*Va+gc*gc;Sa<=ka&&(eb[l+1]=1,l++)}La.push({X:r[0].X,Y:r[0].Y});for(l=1;l<F-1;l++)eb[l]||La.push({X:r[l].X,Y:r[l].Y});La.push({X:r[F-1].X,Y:r[F-1].Y});K&&r.pop();if(eb.length)r=La;else break}F=La.length;La[F-1].X==La[0].X&&La[F-1].Y==La[0].Y&&
La.pop();2<La.length&&pa.push(La)}e[0]instanceof Array||(pa=pa[0]);"undefined"==typeof pa&&(pa=[[]]);return pa};t.JS.PerimeterOfPath=function(e,g,l){if("undefined"==typeof e)return 0;var r=Math.sqrt,y=0,F=e.length;if(2>F)return 0;for(g&&(e[F]=e[0],F++);--F;){var K=e[F];var ca=K.X;K=K.Y;var ka=e[F-1];var pa=ka.X;ka=ka.Y;y+=r((ca-pa)*(ca-pa)+(K-ka)*(K-ka))}g&&e.pop();return y/l};t.JS.PerimeterOfPaths=function(e,g,l){l||(l=1);for(var r=0,y=0;y<e.length;y++)r+=t.JS.PerimeterOfPath(e[y],g,l);return r};
t.JS.ScaleDownPath=function(e,g){var l;g||(g=1);for(l=e.length;l--;){var r=e[l];r.X/=g;r.Y/=g}};t.JS.ScaleDownPaths=function(e,g){var l,r;g||(g=1);for(l=e.length;l--;)for(r=e[l].length;r--;){var y=e[l][r];y.X/=g;y.Y/=g}};t.JS.ScaleUpPath=function(e,g){var l,r=Math.round;g||(g=1);for(l=e.length;l--;){var y=e[l];y.X=r(y.X*g);y.Y=r(y.Y*g)}};t.JS.ScaleUpPaths=function(e,g){var l,r,y=Math.round;g||(g=1);for(l=e.length;l--;)for(r=e[l].length;r--;){var F=e[l][r];F.X=y(F.X*g);F.Y=y(F.Y*g)}};t.ExPolygons=
function(){return[]};t.ExPolygon=function(){this.holes=this.outer=null};t.JS.AddOuterPolyNodeToExPolygons=function(e,g){var l=new t.ExPolygon;l.outer=e.Contour();e=e.Childs();var r=e.length;l.holes=Array(r);var y,F;for(y=0;y<r;y++){var K=e[y];l.holes[y]=K.Contour();var ca=0;var ka=K.Childs();for(F=ka.length;ca<F;ca++)K=ka[ca],t.JS.AddOuterPolyNodeToExPolygons(K,g)}g.push(l)};t.JS.ExPolygonsToPaths=function(e){var g,l,r=new t.Paths;var y=0;for(g=e.length;y<g;y++){r.push(e[y].outer);var F=0;for(l=e[y].holes.length;F<
l;F++)r.push(e[y].holes[F])}return r};t.JS.PolyTreeToExPolygons=function(e){var g=new t.ExPolygons,l;var r=0;var y=e.Childs();for(l=y.length;r<l;r++)e=y[r],t.JS.AddOuterPolyNodeToExPolygons(e,g);return g}})();
(function(C,H){"function"===typeof define&&define.amd?define(H):"object"===typeof exports?module.exports=H():C.returnExports=H()})(this,function(){var C=Function.call.bind(Function.apply),H=Function.call.bind(Function.call),T=Array.isArray,aa=Object.keys,ba=function(O){try{return O(),!1}catch(p){return!0}},na=function(O){try{return O()}catch(p){return!1}},da=function(O){return function(){return!C(O,this,arguments)}}(ba),A=function(){return!ba(function(){return Object.defineProperty({},"x",{get:function(){}})})},
fa=!!Object.defineProperty&&A(),Z="foo"===function(){}.name,ha=Function.call.bind(Array.prototype.forEach),ra=Function.call.bind(Array.prototype.reduce),Pa=Function.call.bind(Array.prototype.filter),Ya=Function.call.bind(Array.prototype.some),za=function(O,p,D,I){!I&&p in O||(fa?Object.defineProperty(O,p,{configurable:!0,enumerable:!1,writable:!0,value:D}):O[p]=D)},cb=function(O,p,D){ha(aa(p),function(I){za(O,I,p[I],!!D)})},vb=Function.call.bind(Object.prototype.toString),t="function"===typeof/abc/?
function(O){return"function"===typeof O&&"[object Function]"===vb(O)}:function(O){return"function"===typeof O},Za={getter:function(O,p,D){if(!fa)throw new TypeError("getters require true ES5 support");Object.defineProperty(O,p,{configurable:!0,enumerable:!1,get:D})},proxy:function(O,p,D){if(!fa)throw new TypeError("getters require true ES5 support");var I=Object.getOwnPropertyDescriptor(O,p);Object.defineProperty(D,p,{configurable:I.configurable,enumerable:I.enumerable,get:function(){return O[p]},
set:function(z){O[p]=z}})},redefine:function(O,p,D){if(fa){var I=Object.getOwnPropertyDescriptor(O,p);I.value=D;Object.defineProperty(O,p,I)}else O[p]=D},defineByDescriptor:function(O,p,D){fa?Object.defineProperty(O,p,D):"value"in D&&(O[p]=D.value)},preserveToString:function(O,p){p&&t(p.toString)&&za(O,"toString",p.toString.bind(p),!0)}},db=Object.create||function(O,p){var D=function(){};D.prototype=O;var I=new D;"undefined"!==typeof p&&aa(p).forEach(function(z){Za.defineByDescriptor(I,z,p[z])});
return I},kb=function(O,p){return Object.setPrototypeOf?na(function(){var D=function M(z){z=new O(z);Object.setPrototypeOf(z,M.prototype);return z};Object.setPrototypeOf(D,O);D.prototype=db(O.prototype,{constructor:{value:D}});return p(D)}):!1},U=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}(),Aa=U.isFinite,Ia=Function.call.bind(String.prototype.indexOf),
Ob=Function.apply.bind(Array.prototype.indexOf),Sb=Function.call.bind(Array.prototype.concat),Kb=Function.call.bind(String.prototype.slice),Pb=Function.call.bind(Array.prototype.push),Jb=Function.apply.bind(Array.prototype.push),Gb=Function.call.bind(Array.prototype.join),ud=Function.call.bind(Array.prototype.shift),e=Math.max,g=Math.min,l=Math.floor,r=Math.abs,y=Math.exp,F=Math.log,K=Math.sqrt,ca=Function.call.bind(Object.prototype.hasOwnProperty),ka=function(){},pa=U.Map,La=pa&&pa.prototype["delete"],
eb=pa&&pa.prototype.get,Va=pa&&pa.prototype.has,Ea=pa&&pa.prototype.set,Sa=U.Symbol||{},fc=Sa.species||"@@species",Ab=Number.isNaN||function(O){return O!==O},gc=Number.isFinite||function(O){return"number"===typeof O&&Aa(O)},hc=t(Math.sign)?Math.sign:function(O){O=Number(O);return 0===O||Ab(O)?O:0>O?-1:1},Wc=function(O){O=Number(O);return-1>O||Ab(O)?NaN:0===O||Infinity===O?O:-1===O?-Infinity:0===1+O-1?O:O*(F(1+O)/(1+O-1))},ke=function(O){return"[object Arguments]"===vb(O)},Ne=function(O){return null!==
O&&"object"===typeof O&&"number"===typeof O.length&&0<=O.length&&"[object Array]"!==vb(O)&&"[object Function]"===vb(O.callee)},Id=ke(arguments)?ke:Ne,Hb={primitive:function(O){return null===O||"function"!==typeof O&&"object"!==typeof O},string:function(O){return"[object String]"===vb(O)},regex:function(O){return"[object RegExp]"===vb(O)},symbol:function(O){return"function"===typeof U.Symbol&&"symbol"===typeof O}},Ga=function(O,p,D){var I=O[p];za(O,p,D,!0);Za.preserveToString(O[p],I)},Pc="function"===
typeof Sa&&"function"===typeof Sa["for"]&&Hb.symbol(Sa()),vc=Hb.symbol(Sa.iterator)?Sa.iterator:"_es6-shim iterator_";U.Set&&"function"===typeof(new U.Set)["@@iterator"]&&(vc="@@iterator");U.Reflect||za(U,"Reflect",{},!0);var Lc=U.Reflect,le=String,vd="undefined"!==typeof document&&document?document.all:null,wc=null==vd?function(O){return null==O}:function(O){return null==O&&O!==vd},S={Call:function(O,p){var D=2<arguments.length?arguments[2]:[];if(!S.IsCallable(O))throw new TypeError(O+" is not a function");
return C(O,p,D)},RequireObjectCoercible:function(O,p){if(wc(O))throw new TypeError(p||"Cannot call method on "+O);return O},TypeIsObject:function(O){return void 0===O||null===O||!0===O||!1===O?!1:"function"===typeof O||"object"===typeof O||O===vd},ToObject:function(O,p){return Object(S.RequireObjectCoercible(O,p))},IsCallable:t,IsConstructor:function(O){return S.IsCallable(O)},ToInt32:function(O){return S.ToNumber(O)>>0},ToUint32:function(O){return S.ToNumber(O)>>>0},ToNumber:function(O){if(Pc&&"[object Symbol]"===
vb(O))throw new TypeError("Cannot convert a Symbol value to a number");return+O},ToInteger:function(O){O=S.ToNumber(O);return Ab(O)?0:0!==O&&gc(O)?(0<O?1:-1)*l(r(O)):O},ToLength:function(O){O=S.ToInteger(O);return 0>=O?0:O>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:O},SameValue:function(O,p){return O===p?0===O?1/O===1/p:!0:Ab(O)&&Ab(p)},SameValueZero:function(O,p){return O===p||Ab(O)&&Ab(p)},GetIterator:function(O){if(Id(O))return new Qc(O,"value");var p=S.GetMethod(O,vc);if(!S.IsCallable(p))throw new TypeError("value is not an iterable");
O=S.Call(p,O);if(!S.TypeIsObject(O))throw new TypeError("bad iterator");return O},GetMethod:function(O,p){O=S.ToObject(O)[p];if(!wc(O)){if(!S.IsCallable(O))throw new TypeError("Method not callable: "+p);return O}},IteratorComplete:function(O){return!!O.done},IteratorClose:function(O,p){var D=S.GetMethod(O,"return");if(void 0!==D){try{var I=S.Call(D,O)}catch(M){var z=M}if(!p){if(z)throw z;if(!S.TypeIsObject(I))throw new TypeError("Iterator's return method returned a non-object.");}}},IteratorNext:function(O){var p=
1<arguments.length?O.next(arguments[1]):O.next();if(!S.TypeIsObject(p))throw new TypeError("bad iterator");return p},IteratorStep:function(O){O=S.IteratorNext(O);return S.IteratorComplete(O)?!1:O},Construct:function(O,p,D,I){D="undefined"===typeof D?O:D;if(!I&&Lc.construct)return Lc.construct(O,p,D);I=D.prototype;S.TypeIsObject(I)||(I=Object.prototype);I=db(I);O=S.Call(O,I,p);return S.TypeIsObject(O)?O:I},SpeciesConstructor:function(O,p){O=O.constructor;if(void 0===O)return p;if(!S.TypeIsObject(O))throw new TypeError("Bad constructor");
O=O[fc];if(wc(O))return p;if(!S.IsConstructor(O))throw new TypeError("Bad @@species");return O},CreateHTML:function(O,p,D,I){O=S.ToString(O);var z="<"+p;""!==D&&(I=S.ToString(I).replace(/"/g,"&quot;"),z+=" "+D+'="'+I+'"');return z+">"+O+"</"+p+">"},IsRegExp:function(O){if(!S.TypeIsObject(O))return!1;var p=O[Sa.match];return"undefined"!==typeof p?!!p:Hb.regex(O)},ToString:function(O){if(Pc&&"[object Symbol]"===vb(O))throw new TypeError("Cannot convert a Symbol value to a number");return le(O)}};if(fa&&
Pc){var wd=function(O){if(Hb.symbol(Sa[O]))return Sa[O];var p=Sa["for"]("Symbol."+O);Object.defineProperty(Sa,O,{configurable:!1,enumerable:!1,writable:!1,value:p});return p};if(!Hb.symbol(Sa.search)){var me=wd("search"),ne=String.prototype.search;za(RegExp.prototype,me,function(O){return S.Call(ne,O,[this])});Ga(String.prototype,"search",function(O){var p=S.RequireObjectCoercible(this);if(!wc(O)){var D=S.GetMethod(O,me);if("undefined"!==typeof D)return S.Call(D,O,[p])}return S.Call(ne,p,[S.ToString(O)])})}if(!Hb.symbol(Sa.replace)){var xd=
wd("replace"),Oe=String.prototype.replace;za(RegExp.prototype,xd,function(O,p){return S.Call(Oe,O,[this,p])});Ga(String.prototype,"replace",function(O,p){var D=S.RequireObjectCoercible(this);if(!wc(O)){var I=S.GetMethod(O,xd);if("undefined"!==typeof I)return S.Call(I,O,[D,p])}return S.Call(Oe,D,[S.ToString(O),p])})}if(!Hb.symbol(Sa.split)){var cd=wd("split"),oe=String.prototype.split;za(RegExp.prototype,cd,function(O,p){return S.Call(oe,O,[this,p])});Ga(String.prototype,"split",function(O,p){var D=
S.RequireObjectCoercible(this);if(!wc(O)){var I=S.GetMethod(O,cd);if("undefined"!==typeof I)return S.Call(I,O,[D,p])}return S.Call(oe,D,[S.ToString(O),p])})}var bc=Hb.symbol(Sa.match),Xc=bc&&function(){var O={};O[Sa.match]=function(){return 42};return 42!=="a".match(O)}();if(!bc||Xc){var pe=wd("match"),Bb=String.prototype.match;za(RegExp.prototype,pe,function(O){return S.Call(Bb,O,[this])});Ga(String.prototype,"match",function(O){var p=S.RequireObjectCoercible(this);if(!wc(O)){var D=S.GetMethod(O,
pe);if("undefined"!==typeof D)return S.Call(D,O,[p])}return S.Call(Bb,p,[S.ToString(O)])})}}var Rc=function(O,p,D){Za.preserveToString(p,O);Object.setPrototypeOf&&Object.setPrototypeOf(O,p);fa?ha(Object.getOwnPropertyNames(O),function(I){I in ka||D[I]||Za.proxy(O,I,p)}):ha(Object.keys(O),function(I){I in ka||D[I]||(p[I]=O[I])});p.prototype=O.prototype;Za.redefine(O.prototype,"constructor",p)},Jd=function(){return this},dd=function(O){fa&&!ca(O,fc)&&Za.getter(O,fc,Jd)},oc=function(O,p){p=p||function(){return this};
za(O,vc,p);!O[vc]&&Hb.symbol(vc)&&(O[vc]=p)},ed=function(O,p,D){fa?Object.defineProperty(O,p,{configurable:!0,enumerable:!0,writable:!0,value:D}):O[p]=D;if(!S.SameValue(O[p],D))throw new TypeError("property is nonconfigurable");},L=function(O,p,D,I){if(!S.TypeIsObject(O))throw new TypeError("Constructor requires `new`: "+p.name);O=p.prototype;S.TypeIsObject(O)||(O=D);D=db(O);for(var z in I)ca(I,z)&&za(D,z,I[z],!0);return D};if(String.fromCodePoint&&1!==String.fromCodePoint.length){var Y=String.fromCodePoint;
Ga(String,"fromCodePoint",function(O){return S.Call(Y,this,arguments)})}var Fa={fromCodePoint:function(O){for(var p=[],D,I=0,z=arguments.length;I<z;I++){D=Number(arguments[I]);if(!S.SameValue(D,S.ToInteger(D))||0>D||1114111<D)throw new RangeError("Invalid code point "+D);65536>D?Pb(p,String.fromCharCode(D)):(D-=65536,Pb(p,String.fromCharCode((D>>10)+55296)),Pb(p,String.fromCharCode(D%1024+56320)))}return Gb(p,"")},raw:function(O){var p=S.ToObject(O,"bad template");p=S.ToObject(p.raw,"bad raw value");
var D=S.ToLength(p.length);if(0>=D)return"";for(var I=[],z=0,M;z<D;){M=S.ToString(z);M=S.ToString(p[M]);Pb(I,M);if(z+1>=D)break;M=z+1<arguments.length?arguments[z+1]:"";M=S.ToString(M);Pb(I,M);z+=1}return Gb(I,"")}};String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&Ga(String,"raw",Fa.raw);cb(String,Fa);var Bc=function I(p,D){if(1>D)return"";if(D%2)return I(p,D-1)+p;p=I(p,D/2);return p+p},Yc={repeat:function(p){var D=S.ToString(S.RequireObjectCoercible(this));p=S.ToInteger(p);if(0>p||Infinity<=
p)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");return Bc(D,p)},startsWith:function(p){var D=S.ToString(S.RequireObjectCoercible(this));if(S.IsRegExp(p))throw new TypeError('Cannot call method "startsWith" with a regex');var I=S.ToString(p),z;1<arguments.length&&(z=arguments[1]);z=e(S.ToInteger(z),0);return Kb(D,z,z+I.length)===I},endsWith:function(p){var D=S.ToString(S.RequireObjectCoercible(this));if(S.IsRegExp(p))throw new TypeError('Cannot call method "endsWith" with a regex');
var I=S.ToString(p),z=D.length,M;1<arguments.length&&(M=arguments[1]);M="undefined"===typeof M?z:S.ToInteger(M);z=g(e(M,0),z);return Kb(D,z-I.length,z)===I},includes:function(p){if(S.IsRegExp(p))throw new TypeError('"includes" does not accept a RegExp');var D=S.ToString(p),I;1<arguments.length&&(I=arguments[1]);return-1!==Ia(this,D,I)},codePointAt:function(p){var D=S.ToString(S.RequireObjectCoercible(this)),I=S.ToInteger(p),z=D.length;if(0<=I&&I<z){p=D.charCodeAt(I);if(55296>p||56319<p||I+1===z)return p;
D=D.charCodeAt(I+1);return 56320>D||57343<D?p:1024*(p-55296)+(D-56320)+65536}}};String.prototype.includes&&!1!=="a".includes("a",Infinity)&&Ga(String.prototype,"includes",Yc.includes);if(String.prototype.startsWith&&String.prototype.endsWith){var xb=ba(function(){return"/a/".startsWith(/a/)}),Pe=na(function(){return!1==="abc".startsWith("a",Infinity)});xb&&Pe||(Ga(String.prototype,"startsWith",Yc.startsWith),Ga(String.prototype,"endsWith",Yc.endsWith))}Pc&&(na(function(){var p=/a/;p[Sa.match]=!1;
return"/a/".startsWith(p)})||Ga(String.prototype,"startsWith",Yc.startsWith),na(function(){var p=/a/;p[Sa.match]=!1;return"/a/".endsWith(p)})||Ga(String.prototype,"endsWith",Yc.endsWith),na(function(){var p=/a/;p[Sa.match]=!1;return"/a/".includes(p)})||Ga(String.prototype,"includes",Yc.includes));cb(String.prototype,Yc);var Qe=RegExp("(^[\t\n\v\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+)|([\t\n\v\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+$)",
"g"),qe=function(){return S.ToString(S.RequireObjectCoercible(this)).replace(Qe,"")},Re=RegExp("[\u0085\u200b\ufffe]","g"),Se=/^[-+]0x[0-9a-f]+$/i;za(String.prototype,"trim",qe,!0);var Cc=function(p){return{value:p,done:0===arguments.length}},re=function(p){S.RequireObjectCoercible(p);za(this,"_s",S.ToString(p));za(this,"_i",0)};re.prototype.next=function(){var p=this._s,D=this._i;if("undefined"===typeof p||D>=p.length)return this._s=void 0,Cc();var I=p.charCodeAt(D);55296>I||56319<I||D+1===p.length?
I=1:(I=p.charCodeAt(D+1),I=56320>I||57343<I?1:2);this._i=D+I;return Cc(p.substr(D,I))};oc(re.prototype);oc(String.prototype,function(){return new re(this)});var Dc={from:function(p){var D;1<arguments.length&&(D=arguments[1]);var I;if("undefined"===typeof D)var z=!1;else{if(!S.IsCallable(D))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(I=arguments[2]);z=!0}var M;if("undefined"!==typeof(Id(p)||S.GetMethod(p,vc))){var V=S.IsConstructor(this)?
Object(new this):[];var la=S.GetIterator(p);for(M=0;;){var ma=S.IteratorStep(la);if(!1===ma)break;ma=ma.value;try{z&&(ma="undefined"===typeof I?D(ma,M):H(D,I,ma,M)),V[M]=ma}catch(Ma){throw S.IteratorClose(la,!0),Ma;}M+=1}la=M}else for(ma=S.ToObject(p),la=S.ToLength(ma.length),V=S.IsConstructor(this)?Object(new this(la)):Array(la),M=0;M<la;++M){var xa=ma[M];z&&(xa="undefined"===typeof I?D(xa,M):H(D,I,xa,M));ed(V,M,xa)}V.length=la;return V},of:function(){for(var p=arguments.length,D=T(this)||!S.IsCallable(this)?
Array(p):S.Construct(this,[p]),I=0;I<p;++I)ed(D,I,arguments[I]);D.length=p;return D}};cb(Array,Dc);dd(Array);var Qc=function(p,D){za(this,"i",0);za(this,"array",p);za(this,"kind",D)};cb(Qc.prototype,{next:function(){var p=this.i,D=this.array;if(!(this instanceof Qc))throw new TypeError("Not an ArrayIterator");if("undefined"!==typeof D){var I=S.ToLength(D.length);if(p<I){I=this.kind;var z;"key"===I?z=p:"value"===I?z=D[p]:"entry"===I&&(z=[p,D[p]]);this.i=p+1;return Cc(z)}}this.array=void 0;return Cc()}});
oc(Qc.prototype);Array.of===Dc.of||function(){var p=function(I){this.length=I};p.prototype=[];var D=Array.of.apply(p,[1,2]);return D instanceof p&&2===D.length}()||Ga(Array,"of",Dc.of);var Kd={copyWithin:function(p,D){var I=S.ToObject(this),z=S.ToLength(I.length),M=S.ToInteger(p),V=S.ToInteger(D);M=0>M?e(z+M,0):g(M,z);V=0>V?e(z+V,0):g(V,z);var la;2<arguments.length&&(la=arguments[2]);la="undefined"===typeof la?z:S.ToInteger(la);la=0>la?e(z+la,0):g(la,z);z=g(la-V,z-M);la=1;V<M&&M<V+z&&(la=-1,V+=z-
1,M+=z-1);for(;0<z;)V in I?I[M]=I[V]:delete I[M],V+=la,M+=la,--z;return I},fill:function(p){var D;1<arguments.length&&(D=arguments[1]);var I;2<arguments.length&&(I=arguments[2]);var z=S.ToObject(this),M=S.ToLength(z.length);D=S.ToInteger("undefined"===typeof D?0:D);I=S.ToInteger("undefined"===typeof I?M:I);D=0>D?e(M+D,0):g(D,M);for(I=0>I?M+I:I;D<M&&D<I;++D)z[D]=p;return z},find:function(p){var D=S.ToObject(this),I=S.ToLength(D.length);if(!S.IsCallable(p))throw new TypeError("Array#find: predicate must be a function");
for(var z=1<arguments.length?arguments[1]:null,M=0,V;M<I;M++)if(V=D[M],z){if(H(p,z,V,M,D))return V}else if(p(V,M,D))return V},findIndex:function(p){var D=S.ToObject(this),I=S.ToLength(D.length);if(!S.IsCallable(p))throw new TypeError("Array#findIndex: predicate must be a function");for(var z=1<arguments.length?arguments[1]:null,M=0;M<I;M++)if(z){if(H(p,z,D[M],M,D))return M}else if(p(D[M],M,D))return M;return-1},keys:function(){return new Qc(this,"key")},values:function(){return new Qc(this,"value")},
entries:function(){return new Qc(this,"entry")}};Array.prototype.keys&&!S.IsCallable([1].keys().next)&&delete Array.prototype.keys;Array.prototype.entries&&!S.IsCallable([1].entries().next)&&delete Array.prototype.entries;Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[vc]&&(cb(Array.prototype,{values:Array.prototype[vc]}),Hb.symbol(Sa.unscopables)&&(Array.prototype[Sa.unscopables].values=!0));if(Z&&Array.prototype.values&&"values"!==Array.prototype.values.name){var yd=
Array.prototype.values;Ga(Array.prototype,"values",function(){return S.Call(yd,this,arguments)});za(Array.prototype,vc,Array.prototype.values,!0)}cb(Array.prototype,Kd);0>1/[!0].indexOf(!0,-0)&&za(Array.prototype,"indexOf",function(p){var D=Ob(this,arguments);return 0===D&&0>1/D?0:D},!0);oc(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){var xc=Object.getPrototypeOf([].values());xc&&oc(xc)}var fd=function(){return na(function(){return 0===Array.from({length:-1}).length})}(),
Ld=function(){var p=Array.from([0].entries());return 1===p.length&&T(p[0])&&0===p[0][0]&&0===p[0][1]}();fd&&Ld||Ga(Array,"from",Dc.from);if(!function(){return na(function(){return Array.from([0],void 0)})}()){var se=Array.from;Ga(Array,"from",function(p){return 1<arguments.length&&"undefined"!==typeof arguments[1]?S.Call(se,this,arguments):H(se,this,p)})}var te=-(Math.pow(2,32)-1),ic=function(p,D){var I={length:te};I[D?(I.length>>>0)-1:0]=!0;return na(function(){H(p,I,function(){throw new RangeError("should not reach here");
},[]);return!0})};if(!ic(Array.prototype.forEach)){var Te=Array.prototype.forEach;Ga(Array.prototype,"forEach",function(p){return S.Call(Te,0<=this.length?this:[],arguments)})}if(!ic(Array.prototype.map)){var Ue=Array.prototype.map;Ga(Array.prototype,"map",function(p){return S.Call(Ue,0<=this.length?this:[],arguments)})}if(!ic(Array.prototype.filter)){var gd=Array.prototype.filter;Ga(Array.prototype,"filter",function(p){return S.Call(gd,0<=this.length?this:[],arguments)})}if(!ic(Array.prototype.some)){var Md=
Array.prototype.some;Ga(Array.prototype,"some",function(p){return S.Call(Md,0<=this.length?this:[],arguments)})}if(!ic(Array.prototype.every)){var qf=Array.prototype.every;Ga(Array.prototype,"every",function(p){return S.Call(qf,0<=this.length?this:[],arguments)})}if(!ic(Array.prototype.reduce)){var rf=Array.prototype.reduce;Ga(Array.prototype,"reduce",function(p){return S.Call(rf,0<=this.length?this:[],arguments)})}if(!ic(Array.prototype.reduceRight,!0)){var Ve=Array.prototype.reduceRight;Ga(Array.prototype,
"reduceRight",function(p){return S.Call(Ve,0<=this.length?this:[],arguments)})}var We=8!==Number("0o10"),hd=2!==Number("0b10"),Xe=Ya("\u0085\u200b\ufffe",function(p){return 0===Number(p+0+p)});if(We||hd||Xe){var Ec=Number,ue=/^0b[01]+$/i,jc=/^0o[0-7]+$/i,ve=ue.test.bind(ue),Nd=jc.test.bind(jc),sf=function(p,D){if("function"===typeof p.valueOf&&(D=p.valueOf(),Hb.primitive(D))||"function"===typeof p.toString&&(D=p.toString(),Hb.primitive(D)))return D;throw new TypeError("No default value");},Ye=Re.test.bind(Re),
we=Se.test.bind(Se),zd=function(){var p=function(D){var I=0<arguments.length?Hb.primitive(D)?D:sf(D,"number"):0;if("string"===typeof I)if(I=S.Call(qe,I),ve(I))I=parseInt(Kb(I,2),2);else if(Nd(I))I=parseInt(Kb(I,2),8);else if(Ye(I)||we(I))I=NaN;var z=this,M=na(function(){Ec.prototype.valueOf.call(z);return!0});return z instanceof p&&!M?new Ec(I):Ec(I)};return p}();Rc(Ec,zd,{});cb(zd,{NaN:Ec.NaN,MAX_VALUE:Ec.MAX_VALUE,MIN_VALUE:Ec.MIN_VALUE,NEGATIVE_INFINITY:Ec.NEGATIVE_INFINITY,POSITIVE_INFINITY:Ec.POSITIVE_INFINITY});
Number=zd;Za.redefine(U,"Number",zd)}var Ze=Math.pow(2,53)-1;cb(Number,{MAX_SAFE_INTEGER:Ze,MIN_SAFE_INTEGER:-Ze,EPSILON:2.220446049250313E-16,parseInt:U.parseInt,parseFloat:U.parseFloat,isFinite:gc,isInteger:function(p){return gc(p)&&S.ToInteger(p)===p},isSafeInteger:function(p){return Number.isInteger(p)&&r(p)<=Number.MAX_SAFE_INTEGER},isNaN:Ab});za(Number,"parseInt",U.parseInt,Number.parseInt!==U.parseInt);1===[,1].find(function(){return!0})&&Ga(Array.prototype,"find",Kd.find);0!==[,1].findIndex(function(){return!0})&&
Ga(Array.prototype,"findIndex",Kd.findIndex);var $e=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),yc=function(p,D){fa&&$e(p,D)&&Object.defineProperty(p,D,{enumerable:!1})},tf=function(){var p=Number(this),D=arguments.length,I=D-p;I=Array(0>I?0:I);for(var z=p;z<D;++z)I[z-p]=arguments[z];return I},Zc=function(p){return function(D,I){D[I]=p[I];return D}},Od=function(p,D){var I=aa(Object(D)),z;S.IsCallable(Object.getOwnPropertySymbols)&&(z=Pa(Object.getOwnPropertySymbols(Object(D)),
$e(D)));return ra(Sb(I,z||[]),Zc(D),p)},xe={assign:function(p,D){var I=S.ToObject(p,"Cannot convert undefined or null to object");return ra(S.Call(tf,1,arguments),Od,I)},is:function(p,D){return S.SameValue(p,D)}};Object.assign&&Object.preventExtensions&&function(){var p=Object.preventExtensions({1:2});try{Object.assign(p,"xy")}catch(D){return"y"===p[1]}}()&&Ga(Object,"assign",xe.assign);cb(Object,xe);if(fa){var uf={setPrototypeOf:function(p){var D=function(z,M){if(!S.TypeIsObject(z))throw new TypeError("cannot set prototype on a non-object");
if(null!==M&&!S.TypeIsObject(M))throw new TypeError("can only set prototype to an object or null"+M);H(I,z,M);return z};try{var I=p.getOwnPropertyDescriptor(p.prototype,"__proto__").set;H(I,{},null)}catch(z){if(p.prototype!=={}.__proto__)return;I=function(M){this.__proto__=M};D.polyfill=D(D({},null),p.prototype)instanceof p}return D}(Object)};cb(Object,uf)}Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&
function(){var p=Object.create(null),D=Object.getPrototypeOf,I=Object.setPrototypeOf;Object.getPrototypeOf=function(z){z=D(z);return z===p?null:z};Object.setPrototypeOf=function(z,M){return I(z,null===M?p:M)};Object.setPrototypeOf.polyfill=!1}();if(ba(function(){return Object.keys("foo")})){var Zb=Object.keys;Ga(Object,"keys",function(p){return Zb(S.ToObject(p))});aa=Object.keys}if(ba(function(){return Object.keys(/a/g)})){var af=Object.keys;Ga(Object,"keys",function(p){if(Hb.regex(p)){var D=[],I;
for(I in p)ca(p,I)&&Pb(D,I);return D}return af(p)});aa=Object.keys}if(Object.getOwnPropertyNames&&ba(function(){return Object.getOwnPropertyNames("foo")})){var bf="object"===typeof window?Object.getOwnPropertyNames(window):[],ye=Object.getOwnPropertyNames;Ga(Object,"getOwnPropertyNames",function(p){p=S.ToObject(p);if("[object Window]"===vb(p))try{return ye(p)}catch(D){return Sb([],bf)}return ye(p)})}if(Object.getOwnPropertyDescriptor&&ba(function(){return Object.getOwnPropertyDescriptor("foo","bar")})){var vf=
Object.getOwnPropertyDescriptor;Ga(Object,"getOwnPropertyDescriptor",function(p,D){return vf(S.ToObject(p),D)})}if(Object.seal&&ba(function(){return Object.seal("foo")})){var wf=Object.seal;Ga(Object,"seal",function(p){return S.TypeIsObject(p)?wf(p):p})}if(Object.isSealed&&ba(function(){return Object.isSealed("foo")})){var id=Object.isSealed;Ga(Object,"isSealed",function(p){return S.TypeIsObject(p)?id(p):!0})}if(Object.freeze&&ba(function(){return Object.freeze("foo")})){var fb=Object.freeze;Ga(Object,
"freeze",function(p){return S.TypeIsObject(p)?fb(p):p})}if(Object.isFrozen&&ba(function(){return Object.isFrozen("foo")})){var Fc=Object.isFrozen;Ga(Object,"isFrozen",function(p){return S.TypeIsObject(p)?Fc(p):!0})}if(Object.preventExtensions&&ba(function(){return Object.preventExtensions("foo")})){var Ta=Object.preventExtensions;Ga(Object,"preventExtensions",function(p){return S.TypeIsObject(p)?Ta(p):p})}if(Object.isExtensible&&ba(function(){return Object.isExtensible("foo")})){var pc=Object.isExtensible;
Ga(Object,"isExtensible",function(p){return S.TypeIsObject(p)?pc(p):!1})}if(Object.getPrototypeOf&&ba(function(){return Object.getPrototypeOf("foo")})){var ze=Object.getPrototypeOf;Ga(Object,"getPrototypeOf",function(p){return ze(S.ToObject(p))})}var Ae=fa&&function(){var p=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return p&&S.IsCallable(p.get)}();fa&&!Ae&&Za.getter(RegExp.prototype,"flags",function(){if(!S.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");
var p="";this.global&&(p+="g");this.ignoreCase&&(p+="i");this.multiline&&(p+="m");this.unicode&&(p+="u");this.sticky&&(p+="y");return p});var xf=fa&&na(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),cf=Pc&&fa&&function(){var p=/./;p[Sa.match]=!1;return RegExp(p)===p}(),jd=na(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),sb=jd&&na(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!jd||!sb){var Gc=RegExp.prototype.toString;
za(RegExp.prototype,"toString",function(){var p=S.RequireObjectCoercible(this);if(Hb.regex(p))return H(Gc,p);var D=le(p.source);p=le(p.flags);return"/"+D+"/"+p},!0);Za.preserveToString(RegExp.prototype.toString,Gc);RegExp.prototype.toString.prototype=void 0}if(fa&&(!xf||cf)){var df=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,kd=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},ef=function(){return this.source},ff=S.IsCallable(kd.get)?kd.get:ef,Be=RegExp,Ad=function(){return function z(D,
I){var M=S.IsRegExp(D);return this instanceof z||!M||"undefined"!==typeof I||D.constructor!==z?Hb.regex(D)?(M=S.Call(ff,D),D="undefined"===typeof I?S.Call(df,D):I,new z(M,D)):new Be(D,I):D}}();Rc(Be,Ad,{$input:!0});RegExp=Ad;Za.redefine(U,"RegExp",Ad)}if(fa){var kc={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};ha(aa(kc),function(p){p in RegExp&&!(kc[p]in RegExp)&&Za.getter(RegExp,kc[p],function(){return RegExp[p]})})}dd(RegExp);var Pd=1/Number.EPSILON,Qd=Math.pow(2,
-23),yf=Math.pow(2,127)*(2-Qd),Ce=Math.pow(2,-126),ld=Math.E,md=Math.LOG2E,Tb=Math.LOG10E,Qb=Number.prototype.clz;delete Number.prototype.clz;var Ba={acosh:function(p){var D=Number(p);if(Ab(D)||1>p)return NaN;if(1===D)return 0;if(Infinity===D)return D;p=1/(D*D);if(2>D)return Wc(D-1+K(1-p)*D);D/=2;return Wc(D+K(1-p)*D-1)+1/md},asinh:function(p){var D=Number(p);if(0===D||!Aa(D))return D;p=r(D);var I=p*p;D=hc(D);return 1>p?D*Wc(p+I/(K(I+1)+1)):D*(Wc(p/2+K(1+1/I)*p/2-1)+1/md)},atanh:function(p){p=Number(p);
if(0===p)return p;if(-1===p)return-Infinity;if(1===p)return Infinity;if(Ab(p)||-1>p||1<p)return NaN;var D=r(p);return hc(p)*Wc(2*D/(1-D))/2},cbrt:function(p){p=Number(p);if(0===p)return p;var D=0>p;D&&(p=-p);if(Infinity===p)var I=Infinity;else I=y(F(p)/3),I=(p/(I*I)+2*I)/3;return D?-I:I},clz32:function(p){p=S.ToUint32(Number(p));return 0===p?32:Qb?S.Call(Qb,p):31-l(F(p+.5)*md)},cosh:function(p){p=Number(p);if(0===p)return 1;if(Ab(p))return NaN;if(!Aa(p))return Infinity;p=y(r(p)-1);return ld/2*(p+
1/(p*ld*ld))},expm1:function(p){p=Number(p);if(-Infinity===p)return-1;if(!Aa(p)||0===p)return p;if(.5<r(p))return y(p)-1;for(var D=p,I=0,z=1;I+D!==I;)I+=D,z+=1,D*=p/z;return I},hypot:function(p,D){for(var I=0,z=0,M=0;M<arguments.length;++M){var V=r(Number(arguments[M]));z<V?(I*=z/V*(z/V),I+=1,z=V):I+=0<V?V/z*(V/z):V}return Infinity===z?Infinity:z*K(I)},log2:function(p){return F(p)*md},log10:function(p){return F(p)*Tb},log1p:Wc,sign:hc,sinh:function(p){p=Number(p);if(!Aa(p)||0===p)return p;var D=r(p);
if(1>D)return D=Math.expm1(D),hc(p)*D*(1+1/(D+1))/2;D=y(D-1);return hc(p)*(D-1/(D*ld*ld))*(ld/2)},tanh:function(p){p=Number(p);return Ab(p)||0===p?p:20<=p?1:-20>=p?-1:(Math.expm1(p)-Math.expm1(-p))/(y(p)+y(-p))},trunc:function(p){p=Number(p);return 0>p?-l(-p):l(p)},imul:function(p,D){p=S.ToUint32(p);D=S.ToUint32(D);var I=p&65535,z=D&65535;return I*z+((p>>>16&65535)*z+I*(D>>>16&65535)<<16>>>0)|0},fround:function(p){var D=Number(p);if(0===D||Infinity===D||-Infinity===D||Ab(D))return D;p=hc(D);D=r(D);
if(D<Ce)return p*(D/Ce/Qd+Pd-Pd)*Ce*Qd;var I=(1+Qd/Number.EPSILON)*D;D=I-(I-D);return D>yf||Ab(D)?Infinity*p:p*D}};cb(Math,Ba);za(Math,"sinh",Ba.sinh,Infinity===Math.sinh(710));za(Math,"cosh",Ba.cosh,Infinity===Math.cosh(710));za(Math,"log1p",Ba.log1p,-1E-17!==Math.log1p(-1E-17));za(Math,"asinh",Ba.asinh,Math.asinh(-1E7)!==-Math.asinh(1E7));za(Math,"asinh",Ba.asinh,Infinity===Math.asinh(1E300));za(Math,"atanh",Ba.atanh,0===Math.atanh(1E-300));za(Math,"tanh",Ba.tanh,-2E-17!==Math.tanh(-2E-17));za(Math,
"acosh",Ba.acosh,Infinity===Math.acosh(Number.MAX_VALUE));za(Math,"acosh",Ba.acosh,!(8>r(1-Math.acosh(1+Number.EPSILON)/Math.sqrt(2*Number.EPSILON))/Number.EPSILON));za(Math,"cbrt",Ba.cbrt,!(8>r(1-Math.cbrt(1E-300)/1E-100)/Number.EPSILON));za(Math,"sinh",Ba.sinh,-2E-17!==Math.sinh(-2E-17));var Hc=Math.expm1(10);za(Math,"expm1",Ba.expm1,22025.465794806718<Hc||22025.465794806718>Hc);za(Math,"hypot",Ba.hypot,Infinity!==Math.hypot(Infinity,NaN));var Rd=Math.round,nd=0===Math.round(.5-Number.EPSILON/4)&&
1===Math.round(-.5+Number.EPSILON/3.99),gf=[Pd+1,2*Pd-1].every(function(p){return Math.round(p)===p});za(Math,"round",function(p){var D=l(p);return.5>p-D?D:-1===D?-0:D+1},!nd||!gf);Za.preserveToString(Math.round,Rd);var hf=Math.imul;2!==Math.imul.length&&Ga(Math,"imul",function(p,D){return S.Call(hf,Math,arguments)});var $c=function(){var p=U.setTimeout;if("function"===typeof p||"object"===typeof p){S.IsPromise=function(qa){return S.TypeIsObject(qa)&&"undefined"!==typeof qa._promise?!0:!1};var D=
function(qa){if(!S.IsConstructor(qa))throw new TypeError("Bad promise constructor");var va=this;va.resolve=void 0;va.reject=void 0;va.promise=new qa(function(ta,Wa){if(void 0!==va.resolve||void 0!==va.reject)throw new TypeError("Bad Promise implementation!");va.resolve=ta;va.reject=Wa});if(!S.IsCallable(va.resolve)||!S.IsCallable(va.reject))throw new TypeError("Bad promise constructor");},I;"undefined"!==typeof window&&S.IsCallable(window.postMessage)&&(I=function(){var qa=[];window.addEventListener("message",
function(va){va.source===window&&"zero-timeout-message"===va.data&&(va.stopPropagation(),0!==qa.length&&ud(qa)())},!0);return function(va){Pb(qa,va);window.postMessage("zero-timeout-message","*")}});var z=function(){var qa=U.Promise,va=qa&&qa.resolve&&qa.resolve();return va&&function(ta){return va.then(ta)}},M=S.IsCallable(U.setImmediate)?U.setImmediate:"object"===typeof process&&process.nextTick?process.nextTick:z()||(S.IsCallable(I)?I():function(qa){p(qa,0)}),V=function(qa){return qa},la=function(qa){throw qa;
},ma={},xa=function(qa,va,ta){M(function(){if(va===ma)qa(ta);else{try{var Wa=qa(ta);var gb=va.resolve}catch(Da){Wa=Da,gb=va.reject}gb(Wa)}})},Ma=function(qa,va){var ta=qa._promise,Wa=ta.reactionLength;if(0<Wa&&(xa(ta.fulfillReactionHandler0,ta.reactionCapability0,va),ta.fulfillReactionHandler0=void 0,ta.rejectReactions0=void 0,ta.reactionCapability0=void 0,1<Wa))for(var gb=1,Da=0;gb<Wa;gb++,Da+=3)xa(ta[Da+0],ta[Da+2],va),qa[Da+0]=void 0,qa[Da+1]=void 0,qa[Da+2]=void 0;ta.result=va;ta.state=1;ta.reactionLength=
0},mb=function(qa,va){var ta=qa._promise,Wa=ta.reactionLength;if(0<Wa&&(xa(ta.rejectReactionHandler0,ta.reactionCapability0,va),ta.fulfillReactionHandler0=void 0,ta.rejectReactions0=void 0,ta.reactionCapability0=void 0,1<Wa))for(var gb=1,Da=0;gb<Wa;gb++,Da+=3)xa(ta[Da+1],ta[Da+2],va),qa[Da+0]=void 0,qa[Da+1]=void 0,qa[Da+2]=void 0;ta.result=va;ta.state=2;ta.reactionLength=0},Mc=function(qa){var va=!1;return{resolve:function(ta){if(!va){va=!0;if(ta===qa)return mb(qa,new TypeError("Self resolution"));
if(!S.TypeIsObject(ta))return Ma(qa,ta);try{var Wa=ta.then}catch(gb){return mb(qa,gb)}if(!S.IsCallable(Wa))return Ma(qa,ta);M(function(){var gb=Wa,Da=Mc(qa),tb=Da.resolve;Da=Da.reject;try{Ub(gb,ta,tb,Da)}catch(Ic){Da(Ic)}})}},reject:function(ta){if(!va)return va=!0,mb(qa,ta)}}},Ub=function(qa,va,ta,Wa){qa===Bd?H(qa,va,ta,Wa,ma):H(qa,va,ta,Wa)},Sc=function(){var qa=function(va){if(!(this instanceof qa))throw new TypeError('Constructor Promise requires "new"');if(this&&this._promise)throw new TypeError("Bad construction");
if(!S.IsCallable(va))throw new TypeError("not a valid resolver");var ta=L(this,qa,Sd,{_promise:{result:void 0,state:0,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),Wa=Mc(ta),gb=Wa.reject;try{va(Wa.resolve,gb)}catch(Da){gb(Da)}return ta};return qa}();var Sd=Sc.prototype;var Cd=function(qa,va,ta,Wa){var gb=!1;return function(Da){gb||(gb=!0,va[qa]=Da,0===--Wa.count&&(Da=ta.resolve,Da(va)))}};cb(Sc,{all:function(qa){if(!S.TypeIsObject(this))throw new TypeError("Promise is not object");
var va=new D(this),ta;try{var Wa=S.GetIterator(qa);qa=ta={iterator:Wa,done:!1};for(var gb=qa.iterator,Da=[],tb={count:1},Ic,od,Dd=0;;){try{Ic=S.IteratorStep(gb);if(!1===Ic){qa.done=!0;break}od=Ic.value}catch(De){throw qa.done=!0,De;}Da[Dd]=void 0;var Td=this.resolve(od),jf=Cd(Dd,Da,va,tb);tb.count+=1;Ub(Td.then,Td,jf,va.reject);Dd+=1}if(0===--tb.count){var kf=va.resolve;kf(Da)}return va.promise}catch(De){gb=De;if(ta&&!ta.done)try{S.IteratorClose(Wa,!0)}catch(Ee){gb=Ee}Wa=va.reject;Wa(gb);return va.promise}},
race:function(qa){if(!S.TypeIsObject(this))throw new TypeError("Promise is not object");var va=new D(this),ta;try{var Wa=S.GetIterator(qa);qa=ta={iterator:Wa,done:!1};for(var gb=qa.iterator,Da,tb,Ic;;){try{Da=S.IteratorStep(gb);if(!1===Da){qa.done=!0;break}tb=Da.value}catch(od){throw qa.done=!0,od;}Ic=this.resolve(tb);Ub(Ic.then,Ic,va.resolve,va.reject)}return va.promise}catch(od){gb=od;if(ta&&!ta.done)try{S.IteratorClose(Wa,!0)}catch(Dd){gb=Dd}Wa=va.reject;Wa(gb);return va.promise}},reject:function(qa){if(!S.TypeIsObject(this))throw new TypeError("Bad promise constructor");
var va=new D(this),ta=va.reject;ta(qa);return va.promise},resolve:function(qa){if(!S.TypeIsObject(this))throw new TypeError("Bad promise constructor");if(S.IsPromise(qa)&&qa.constructor===this)return qa;var va=new D(this),ta=va.resolve;ta(qa);return va.promise}});cb(Sd,{"catch":function(qa){return this.then(null,qa)},then:function(qa,va){if(!S.IsPromise(this))throw new TypeError("not a promise");var ta=S.SpeciesConstructor(this,Sc);ta=2<arguments.length&&arguments[2]===ma&&ta===Sc?ma:new D(ta);var Wa=
S.IsCallable(qa)?qa:V,gb=S.IsCallable(va)?va:la,Da=this._promise;if(0===Da.state){if(0===Da.reactionLength)Da.fulfillReactionHandler0=Wa,Da.rejectReactionHandler0=gb,Da.reactionCapability0=ta;else{var tb=3*(Da.reactionLength-1);Da[tb+0]=Wa;Da[tb+1]=gb;Da[tb+2]=ta}Da.reactionLength+=1}else if(1===Da.state)Da=Da.result,xa(Wa,ta,Da);else if(2===Da.state)Da=Da.result,xa(gb,ta,Da);else throw new TypeError("unexpected Promise state");return ta.promise}});ma=new D(Sc);var Bd=Sd.then;return Sc}}();U.Promise&&
(delete U.Promise.accept,delete U.Promise.defer,delete U.Promise.prototype.chain);if("function"===typeof $c){cb(U,{Promise:$c});var lf=kb(U.Promise,function(p){return p.resolve(42).then(function(){})instanceof p}),zf=!ba(function(){return U.Promise.reject(42).then(null,5).then(null,ka)}),Ud=ba(function(){return U.Promise.call(3,ka)}),$b=function(p){var D=p.resolve(5);D.constructor={};p=p.resolve(D);try{p.then(null,ka).then(null,ka)}catch(I){return!0}return D===p}(U.Promise),Fe=fa&&function(){var p=
0,D=Object.defineProperty({},"then",{get:function(){p+=1}});Promise.resolve(D);return 1===p}(),ad=function I(D){var z=new Promise(D);D(3,function(){});this.then=z.then;this.constructor=I};ad.prototype=Promise.prototype;ad.all=Promise.all;var pd=na(function(){return!!ad.all([1,2])});lf&&zf&&Ud&&!$b&&Fe&&!pd||(Promise=$c,Ga(U,"Promise",$c));if(1!==Promise.all.length){var Ed=Promise.all;Ga(Promise,"all",function(D){return S.Call(Ed,this,arguments)})}if(1!==Promise.race.length){var Vd=Promise.race;Ga(Promise,
"race",function(D){return S.Call(Vd,this,arguments)})}if(1!==Promise.resolve.length){var Wd=Promise.resolve;Ga(Promise,"resolve",function(D){return S.Call(Wd,this,arguments)})}if(1!==Promise.reject.length){var yb=Promise.reject;Ga(Promise,"reject",function(D){return S.Call(yb,this,arguments)})}yc(Promise,"all");yc(Promise,"race");yc(Promise,"resolve");yc(Promise,"reject");dd(Promise)}var ob=function(p){var D=aa(ra(p,function(I,z){I[z]=!0;return I},{}));return p.join(":")===D.join(":")},Xd=ob(["z",
"a","bb"]),cc=ob(["z",1,"a","3",2]);if(fa){var Cb=function(p,D){return D||Xd?wc(p)?"^"+S.ToString(p):"string"===typeof p?"$"+p:"number"===typeof p?cc?p:"n"+p:"boolean"===typeof p?"b"+p:null:null},Q=function(){return Object.create?Object.create(null):{}},pb=function(p,D,I){if(T(I)||Hb.string(I))ha(I,function(V){if(!S.TypeIsObject(V))throw new TypeError("Iterator value "+V+" is not an entry object");D.set(V[0],V[1])});else if(I instanceof p)H(p.prototype.forEach,I,function(V,la){D.set(la,V)});else{if(!wc(I)){var z=
D.set;if(!S.IsCallable(z))throw new TypeError("bad map");var M=S.GetIterator(I)}if("undefined"!==typeof M)for(;;){p=S.IteratorStep(M);if(!1===p)break;p=p.value;try{if(!S.TypeIsObject(p))throw new TypeError("Iterator value "+p+" is not an entry object");H(z,D,p[0],p[1])}catch(V){throw S.IteratorClose(M,!0),V;}}}},rb=function(p,D,I){if(T(I)||Hb.string(I))ha(I,function(V){D.add(V)});else if(I instanceof p)H(p.prototype.forEach,I,function(V){D.add(V)});else{if(!wc(I)){var z=D.add;if(!S.IsCallable(z))throw new TypeError("bad set");
var M=S.GetIterator(I)}if("undefined"!==typeof M)for(;;){p=S.IteratorStep(M);if(!1===p)break;p=p.value;try{H(z,D,p)}catch(V){throw S.IteratorClose(M,!0),V;}}}},G={Map:function(){var p={},D=function(la,ma){this.key=la;this.value=ma;this.prev=this.next=null};D.prototype.isRemoved=function(){return this.key===p};var I=function(la,ma){if(!S.TypeIsObject(la)||!la._es6map)throw new TypeError("Method Map.prototype."+ma+" called on incompatible receiver "+S.ToString(la));},z=function(la,ma){I(la,"[[MapIterator]]");
za(this,"head",la._head);za(this,"i",this.head);za(this,"kind",ma)};z.prototype={isMapIterator:!0,next:function(){if(!this.isMapIterator)throw new TypeError("Not a MapIterator");var la=this.i,ma=this.kind,xa=this.head;if("undefined"===typeof this.i)return Cc();for(;la.isRemoved()&&la!==xa;)la=la.prev;for(;la.next!==xa;)if(la=la.next,!la.isRemoved())return ma="key"===ma?la.key:"value"===ma?la.value:[la.key,la.value],this.i=la,Cc(ma);this.i=void 0;return Cc()}};oc(z.prototype);var M=function ma(){if(!(this instanceof
ma))throw new TypeError('Constructor Map requires "new"');if(this&&this._es6map)throw new TypeError("Bad construction");var xa=L(this,ma,V,{_es6map:!0,_head:null,_map:pa?new pa:null,_size:0,_storage:Q()}),Ma=new D(null,null);Ma.next=Ma.prev=Ma;xa._head=Ma;0<arguments.length&&pb(ma,xa,arguments[0]);return xa};var V=M.prototype;Za.getter(V,"size",function(){if("undefined"===typeof this._size)throw new TypeError("size method called on incompatible Map");return this._size});cb(V,{get:function(ma){I(this,
"get");var xa=Cb(ma,!0);if(null!==xa){if(ma=this._storage[xa])return ma.value}else if(this._map){if(ma=eb.call(this._map,ma))return ma.value}else for(var Ma=xa=this._head;(Ma=Ma.next)!==xa;)if(S.SameValueZero(Ma.key,ma))return Ma.value},has:function(ma){I(this,"has");var xa=Cb(ma,!0);if(null!==xa)return"undefined"!==typeof this._storage[xa];if(this._map)return Va.call(this._map,ma);for(var Ma=xa=this._head;(Ma=Ma.next)!==xa;)if(S.SameValueZero(Ma.key,ma))return!0;return!1},set:function(ma,xa){I(this,
"set");var Ma=this._head,mb=Ma,Mc=Cb(ma,!0);if(null!==Mc){if("undefined"!==typeof this._storage[Mc])return this._storage[Mc].value=xa,this;var Ub=this._storage[Mc]=new D(ma,xa);mb=Ma.prev}else this._map&&(Va.call(this._map,ma)?eb.call(this._map,ma).value=xa:(Ub=new D(ma,xa),Ea.call(this._map,ma,Ub),mb=Ma.prev));for(;(mb=mb.next)!==Ma;)if(S.SameValueZero(mb.key,ma))return mb.value=xa,this;Ub=Ub||new D(ma,xa);S.SameValue(-0,ma)&&(Ub.key=0);Ub.next=this._head;Ub.prev=this._head.prev;Ub.prev.next=Ub;
Ub.next.prev=Ub;this._size+=1;return this},"delete":function(ma){I(this,"delete");var xa=this._head,Ma=xa,mb=Cb(ma,!0);if(null!==mb){if("undefined"===typeof this._storage[mb])return!1;Ma=this._storage[mb].prev;delete this._storage[mb]}else if(this._map){if(!Va.call(this._map,ma))return!1;Ma=eb.call(this._map,ma).prev;La.call(this._map,ma)}for(;(Ma=Ma.next)!==xa;)if(S.SameValueZero(Ma.key,ma))return Ma.key=p,Ma.value=p,Ma.prev.next=Ma.next,Ma.next.prev=Ma.prev,--this._size,!0;return!1},clear:function(){I(this,
"clear");this._map=pa?new pa:null;this._size=0;this._storage=Q();for(var ma=this._head,xa,Ma=ma.next;(xa=Ma)!==ma;)xa.key=p,xa.value=p,Ma=xa.next,xa.next=xa.prev=ma;ma.next=ma.prev=ma},keys:function(){I(this,"keys");return new z(this,"key")},values:function(){I(this,"values");return new z(this,"value")},entries:function(){I(this,"entries");return new z(this,"key+value")},forEach:function(ma){I(this,"forEach");for(var xa=1<arguments.length?arguments[1]:null,Ma=this.entries(),mb=Ma.next();!mb.done;mb=
Ma.next())xa?H(ma,xa,mb.value[1],mb.value[0],this):ma(mb.value[1],mb.value[0],this)}});oc(V,V.entries);return M}(),Set:function(){var p=function(V,la){if(!S.TypeIsObject(V)||!V._es6set||"undefined"===typeof V._storage)throw new TypeError("Set.prototype."+la+" called on incompatible receiver "+S.ToString(V));},D=function la(){if(!(this instanceof la))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var ma=L(this,la,I,{_es6set:!0,"[[SetData]]":null,
_storage:Q()});if(!ma._es6set)throw new TypeError("bad set");0<arguments.length&&rb(la,ma,arguments[0]);return ma};var I=D.prototype;var z=function(la){if(!la["[[SetData]]"]){var ma=new G.Map;la["[[SetData]]"]=ma;ha(aa(la._storage),function(xa){if("^null"===xa)xa=null;else if("^undefined"!==xa){var Ma=xa.charAt(0);xa="$"===Ma?Kb(xa,1):"n"===Ma?+Kb(xa,1):"b"===Ma?"btrue"===xa:+xa}else xa=void 0;ma.set(xa,xa)});la["[[SetData]]"]=ma}la._storage=null};Za.getter(D.prototype,"size",function(){p(this,"size");
if(this._storage)return aa(this._storage).length;z(this);return this["[[SetData]]"].size});cb(D.prototype,{has:function(la){p(this,"has");var ma;if(this._storage&&null!==(ma=Cb(la)))return!!this._storage[ma];z(this);return this["[[SetData]]"].has(la)},add:function(la){p(this,"add");var ma;if(this._storage&&null!==(ma=Cb(la)))return this._storage[ma]=!0,this;z(this);this["[[SetData]]"].set(la,la);return this},"delete":function(la){p(this,"delete");var ma;if(this._storage&&null!==(ma=Cb(la)))return la=
ca(this._storage,ma),delete this._storage[ma]&&la;z(this);return this["[[SetData]]"]["delete"](la)},clear:function(){p(this,"clear");this._storage&&(this._storage=Q());this["[[SetData]]"]&&this["[[SetData]]"].clear()},values:function(){p(this,"values");z(this);return new M(this["[[SetData]]"].values())},entries:function(){p(this,"entries");z(this);return new M(this["[[SetData]]"].entries())},forEach:function(la){p(this,"forEach");var ma=1<arguments.length?arguments[1]:null,xa=this;z(xa);this["[[SetData]]"].forEach(function(Ma,
mb){ma?H(la,ma,mb,mb,xa):la(mb,mb,xa)})}});za(D.prototype,"keys",D.prototype.values,!0);oc(D.prototype,D.prototype.values);var M=function(la){za(this,"it",la)};M.prototype={isSetIterator:!0,next:function(){if(!this.isSetIterator)throw new TypeError("Not a SetIterator");return this.it.next()}};oc(M.prototype);return D}()};U.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys)&&(U.Set=G.Set);if(U.Map||U.Set){na(function(){return 2===
(new Map([[1,2]])).get(1)})||(U.Map=function D(){if(!(this instanceof D))throw new TypeError('Constructor Map requires "new"');var I=new pa;0<arguments.length&&pb(D,I,arguments[0]);delete I.constructor;Object.setPrototypeOf(I,U.Map.prototype);return I},U.Map.prototype=db(pa.prototype),za(U.Map.prototype,"constructor",U.Map,!0),Za.preserveToString(U.Map,pa));var Jc=new Map,Yd=function(){var p=new Map([[1,0],[2,0],[3,0],[4,0]]);p.set(-0,p);return p.get(0)===p&&p.get(-0)===p&&p.has(0)&&p.has(-0)}(),
Ge=Jc.set(1,2)===Jc;Yd&&Ge||Ga(Map.prototype,"set",function(p,D){H(Ea,this,0===p?0:p,D);return this});Yd||(cb(Map.prototype,{get:function(p){return H(eb,this,0===p?0:p)},has:function(p){return H(Va,this,0===p?0:p)}},!0),Za.preserveToString(Map.prototype.get,eb),Za.preserveToString(Map.prototype.has,Va));var qc=new Set,Zd=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(p){p["delete"](0);p.add(-0);return!p.has(0)}(qc),Fd=qc.add(1)===qc;if(!Zd||!Fd){var He=Set.prototype.add;Set.prototype.add=
function(p){H(He,this,0===p?0:p);return this};Za.preserveToString(Set.prototype.add,He)}if(!Zd){var qd=Set.prototype.has;Set.prototype.has=function(p){return H(qd,this,0===p?0:p)};Za.preserveToString(Set.prototype.has,qd);var Nc=Set.prototype["delete"];Set.prototype["delete"]=function(p){return H(Nc,this,0===p?0:p)};Za.preserveToString(Set.prototype["delete"],Nc)}var Gd=kb(U.Map,function(p){var D=new p([]);D.set(42,42);return D instanceof p}),Vb=Object.setPrototypeOf&&!Gd;try{var $d=!(U.Map()instanceof
U.Map)}catch(p){$d=p instanceof TypeError}if(0!==U.Map.length||Vb||!$d)U.Map=function D(){if(!(this instanceof D))throw new TypeError('Constructor Map requires "new"');var I=new pa;0<arguments.length&&pb(D,I,arguments[0]);delete I.constructor;Object.setPrototypeOf(I,D.prototype);return I},U.Map.prototype=pa.prototype,za(U.Map.prototype,"constructor",U.Map,!0),Za.preserveToString(U.Map,pa);var ae=kb(U.Set,function(p){var D=new p([]);D.add(42,42);return D instanceof p}),hb=Object.setPrototypeOf&&!ae;
try{var wb=!(U.Set()instanceof U.Set)}catch(p){wb=p instanceof TypeError}if(0!==U.Set.length||hb||!wb){var be=U.Set;U.Set=function D(){if(!(this instanceof D))throw new TypeError('Constructor Set requires "new"');var I=new be;0<arguments.length&&rb(D,I,arguments[0]);delete I.constructor;Object.setPrototypeOf(I,D.prototype);return I};U.Set.prototype=be.prototype;za(U.Set.prototype,"constructor",U.Set,!0);Za.preserveToString(U.Set,be)}var ce=new U.Map,rc=!na(function(){return ce.keys().next().done});
("function"!==typeof U.Map.prototype.clear||0!==(new U.Set).size||0!==ce.size||"function"!==typeof U.Map.prototype.keys||"function"!==typeof U.Set.prototype.keys||"function"!==typeof U.Map.prototype.forEach||"function"!==typeof U.Set.prototype.forEach||da(U.Map)||da(U.Set)||"function"!==typeof ce.keys().next||rc||!Gd)&&cb(U,{Map:G.Map,Set:G.Set},!0);U.Set.prototype.keys!==U.Set.prototype.values&&za(U.Set.prototype,"keys",U.Set.prototype.values,!0);oc(Object.getPrototypeOf((new U.Map).keys()));oc(Object.getPrototypeOf((new U.Set).keys()));
if(Z&&"has"!==U.Set.prototype.has.name){var Tc=U.Set.prototype.has;Ga(U.Set.prototype,"has",function(p){return H(Tc,this,p)})}}cb(U,G);dd(U.Map);dd(U.Set)}var Wb=function(p){if(!S.TypeIsObject(p))throw new TypeError("target must be an object");},dc={apply:function(){return S.Call(S.Call,null,arguments)},construct:function(p,D){if(!S.IsConstructor(p))throw new TypeError("First argument must be a constructor.");var I=2<arguments.length?arguments[2]:p;if(!S.IsConstructor(I))throw new TypeError("new.target must be a constructor.");
return S.Construct(p,D,I,"internal")},deleteProperty:function(p,D){Wb(p);if(fa){var I=Object.getOwnPropertyDescriptor(p,D);if(I&&!I.configurable)return!1}return delete p[D]},has:function(p,D){Wb(p);return D in p}};Object.getOwnPropertyNames&&Object.assign(dc,{ownKeys:function(p){Wb(p);var D=Object.getOwnPropertyNames(p);S.IsCallable(Object.getOwnPropertySymbols)&&Jb(D,Object.getOwnPropertySymbols(p));return D}});Object.preventExtensions&&Object.assign(dc,{isExtensible:function(p){Wb(p);return Object.isExtensible(p)},
preventExtensions:function(p){Wb(p);return!ba(function(){return Object.preventExtensions(p)})}});if(fa){var de=function(p,D,I){var z=Object.getOwnPropertyDescriptor(p,D);if(!z)return p=Object.getPrototypeOf(p),null===p?void 0:de(p,D,I);if("value"in z)return z.value;if(z.get)return S.Call(z.get,I)},mf=function(p,D,I,z){var M=Object.getOwnPropertyDescriptor(p,D);if(!M){p=Object.getPrototypeOf(p);if(null!==p)return mf(p,D,I,z);M={value:void 0,writable:!0,enumerable:!0,configurable:!0}}return"value"in
M?M.writable&&S.TypeIsObject(z)?Object.getOwnPropertyDescriptor(z,D)?Lc.defineProperty(z,D,{value:I}):Lc.defineProperty(z,D,{value:I,writable:!0,enumerable:!0,configurable:!0}):!1:M.set?(H(M.set,z,I),!0):!1};Object.assign(dc,{defineProperty:function(p,D,I){Wb(p);return!ba(function(){return Object.defineProperty(p,D,I)})},getOwnPropertyDescriptor:function(p,D){Wb(p);return Object.getOwnPropertyDescriptor(p,D)},get:function(p,D){Wb(p);return de(p,D,2<arguments.length?arguments[2]:p)},set:function(p,
D,I){Wb(p);return mf(p,D,I,3<arguments.length?arguments[3]:p)}})}if(Object.getPrototypeOf){var Ie=Object.getPrototypeOf;dc.getPrototypeOf=function(p){Wb(p);return Ie(p)}}Object.setPrototypeOf&&dc.getPrototypeOf&&Object.assign(dc,{setPrototypeOf:function(p,D){Wb(p);if(null!==D&&!S.TypeIsObject(D))throw new TypeError("proto must be an object or null");if(D===Lc.getPrototypeOf(p))return!0;if(Lc.isExtensible&&!Lc.isExtensible(p))return!1;var I;a:{for(I=D;I;){if(p===I){I=!0;break a}I=dc.getPrototypeOf(I)}I=
!1}if(I)return!1;Object.setPrototypeOf(p,D);return!0}});var ee=function(p,D){S.IsCallable(U.Reflect[p])?na(function(){U.Reflect[p](1);U.Reflect[p](NaN);U.Reflect[p](!0);return!0})&&Ga(U.Reflect,p,D):za(U.Reflect,p,D)};Object.keys(dc).forEach(function(p){ee(p,dc[p])});var Je=U.Reflect.getPrototypeOf;Z&&Je&&"getPrototypeOf"!==Je.name&&Ga(U.Reflect,"getPrototypeOf",function(p){return H(Je,U.Reflect,p)});U.Reflect.setPrototypeOf&&na(function(){U.Reflect.setPrototypeOf(1,{});return!0})&&Ga(U.Reflect,"setPrototypeOf",
dc.setPrototypeOf);U.Reflect.defineProperty&&(na(function(){var p=!U.Reflect.defineProperty(1,"test",{value:1}),D="function"!==typeof Object.preventExtensions||!U.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return p&&D})||Ga(U.Reflect,"defineProperty",dc.defineProperty));U.Reflect.construct&&(na(function(){var p=function(){};return U.Reflect.construct(function(){},[],p)instanceof p})||Ga(U.Reflect,"construct",dc.construct));if("Invalid Date"!==String(new Date(NaN))){var Af=Date.prototype.toString;
Ga(Date.prototype,"toString",function(){var p=+this;return p!==p?"Invalid Date":S.Call(Af,this)})}var nf={anchor:function(p){return S.CreateHTML(this,"a","name",p)},big:function(){return S.CreateHTML(this,"big","","")},blink:function(){return S.CreateHTML(this,"blink","","")},bold:function(){return S.CreateHTML(this,"b","","")},fixed:function(){return S.CreateHTML(this,"tt","","")},fontcolor:function(p){return S.CreateHTML(this,"font","color",p)},fontsize:function(p){return S.CreateHTML(this,"font",
"size",p)},italics:function(){return S.CreateHTML(this,"i","","")},link:function(p){return S.CreateHTML(this,"a","href",p)},small:function(){return S.CreateHTML(this,"small","","")},strike:function(){return S.CreateHTML(this,"strike","","")},sub:function(){return S.CreateHTML(this,"sub","","")},sup:function(){return S.CreateHTML(this,"sup","","")}};ha(Object.keys(nf),function(p){var D=String.prototype[p];if(S.IsCallable(D)){D=H(D,"",' " ');var I=Sb([],D.match(/"/g)).length;D=D!==D.toLowerCase()||
2<I}else D=!0;D&&Ga(String.prototype,p,nf[p])});var n=function(){if(!Pc)return!1;var p="object"===typeof JSON&&"function"===typeof JSON.stringify?JSON.stringify:null;if(!p)return!1;if("undefined"!==typeof p(Sa())||"[null]"!==p([Sa()]))return!0;var D={a:Sa()};D[Sa()]=!0;return"{}"!==p(D)?!0:!1}(),h=na(function(){return Pc?"{}"===JSON.stringify(Object(Sa()))&&"[{}]"===JSON.stringify([Object(Sa())]):!0});if(n||!h){var $a=JSON.stringify;Ga(JSON,"stringify",function(p){if("symbol"!==typeof p){var D;1<
arguments.length&&(D=arguments[1]);var I=[p];if(T(D))I.push(D);else{var z=S.IsCallable(D)?D:null;I.push(function(M,V){M=z?H(z,this,M,V):V;if("symbol"!==typeof M)return Hb.symbol(M)?Zc({})(M):M})}2<arguments.length&&I.push(arguments[2]);return $a.apply(this,I)}})}return U});
var CindyJS=function(){function C(Z){if(0===T)return console.error("Waiting for "+Z+" after we finished waiting."),function(){};0>T&&(T=0);++T;return function(){--T;0>T&&console.error("Wait count mismatch: "+Z);if(0===T)for(var ha=0,ra=aa.length;ha<ra;)aa[ha++].startup()}}function H(Z){var ha=H.newInstance(Z);0>=T?ha.startup():!1!==Z.autostart&&aa.push(ha);return ha}var T=-1,aa=[];Math.sign||(Math.sign=function(Z){return(0<Z)-(0>Z)||+Z});"undefined"===typeof document||"undefined"===typeof window||
"undefined"===typeof document.addEventListener||"undefined"!==typeof window.cindyDontWait&&!0===window.cindyDontWait||document.addEventListener("DOMContentLoaded",C("DOMContentLoaded"));var ba=null,na=null,da={};H.getBaseDir=function(){if(null!==ba)return ba;for(var Z=document.getElementsByTagName("script"),ha=0;ha<Z.length;++ha){var ra=Z[ha],Pa=ra.src;if(Pa){var Ya=/\/Cindy\.js$/.exec(Pa);if(Ya)return ba=Pa.substr(0,Ya.index+1),console.log("Will load extensions from "+ba),na=ra,ba}}console.error("Could not find <script> tag for Cindy.js");
return ba=na=!1};H.addNewScript=function(Z,ha){ha||console.error.bind(console);var ra=H.getBaseDir();if(!1===ra)return!1;ha=document.createElement("script");ha.src=ra+Z;Z=na.nextSibling;ra=na.parentElement;Z?ra.insertBefore(ha,Z):ra.appendChild(ha);return ha};H.loadScript=function(Z,ha,ra,Pa){for(var Ya=String(Z).split("."),za=window;Ya.length&&"object"===typeof za&&null!==za;)za=za[Ya.shift()];if(za&&!Ya.length)return ra(),!0;Pa||(Pa=console.error.bind(console));Ya=da[Z];if(!Ya){Ya=H.addNewScript(ha,
Pa);if(!1===Ya)return Pa("Can't load additional components."),!1;da[Z]=Ya}Ya.addEventListener("load",ra);Ya.addEventListener("error",Pa);return null};H._autoLoadingPlugin={};H.autoLoadPlugin=function(Z,ha,ra){if(H._pluginRegistry[Z])return ra(),!0;var Pa=H._autoLoadingPlugin[Z];if(!Pa){ha||(ha=Z+"-plugin.js");Pa=H._autoLoadingPlugin[Z]=[];Z=H.addNewScript(ha);if(!1===Z)return!1;Z.addEventListener("error",console.error.bind(console))}Pa.push(ra);return null};var A={ctype:"undefined"};H.waitFor=C;H._pluginRegistry=
{};H.instances=[];H.registerPlugin=function(Z,ha,ra){if(1!==Z)return console.error("Plugin API version "+Z+" not supported"),!1;H._pluginRegistry[ha]=ra;(H._autoLoadingPlugin[ha]||[]).forEach(function(Pa){Pa()})};var fa=0;H.dumpState=function(Z){Z=H.instances[Z||0].saveState();console.log(JSON.stringify(Z))};H.debugState=function(Z){H.instances.map(function(ha){var ra=ha.config;ra=JSON.parse(JSON.stringify(ra));var Pa=ha.saveState();console.log(JSON.stringify(Pa));for(var Ya in Pa)ra[Ya]=Pa[Ya];ha.shutdown();
return ra}).forEach(function(ha){H(ha)})};H.newInstance=function(Z){function ha(){ob.width=pb=ob.clientWidth;ob.height=rb=ob.clientHeight;yb=1;if(Vd||Wd)yb=Math.max(Vd?Vd/ob.width:0,Wd?Wd/ob.height:0),pb=yb*ob.clientWidth,rb=yb*ob.clientHeight;Q.setTransform(1/yb,0,0,1/yb,0,0);P.setMat(25,0,0,25,250.5,250.5);if(Xd)for(var a=$jscomp.makeIterator(Xd),b=a.next();!b.done;b=a.next()){b=b.value;var c=Object.keys(b)[0];"scale"===c&&(Ud=b.scale,P[c](b.scale));if("translate"===c)P[c](b.translate[0],b.translate[1]);
"scaleAndOrigin"===c&&(Ud=b[c][0]/25,P[c].apply(null,b[c]));"visibleRect"===c&&(P[c].apply(null,b[c]),Ud=P.drawingstate.initialmatrix.a/25)}P.createnewbackup();P.greset();a=1;"undefined"!==typeof window&&window.devicePixelRatio&&(a=window.devicePixelRatio);b=Q.webkitBackingStorePixelRatio||Q.mozBackingStorePixelRatio||Q.msBackingStorePixelRatio||Q.oBackingStorePixelRatio||Q.backingStorePixelRatio||1;a!==b&&(a/=b,ob.width=pb*a,ob.height=rb*a,Q.scale(a,a))}function ra(a){if("canvas"!==a.tagName.toLowerCase()){var b=
a;for(ob=document.createElement("canvas");b.firstChild;)b.removeChild(b.firstChild)}else{ob=a;b=document.createElement("div");var c=null,d=null;Array.prototype.slice.call(ob.attributes).forEach(function(f){"width"===f.name?c=f.value:"height"===f.name?d=f.value:b.setAttributeNodeNS(ob.removeAttributeNode(f))});null===c||b.style.width||(b.style.width=c+"px");null===d||b.style.height||(b.style.height=d+"px");ob.parentNode.replaceChild(b,ob)}b.classList.add("CindyJS-widget");a=ob.style;a.position="absolute";
a.border="none";a.margin=a.padding=a.left=a.top="0px";a.width=a.height="100%";a="static";window.getComputedStyle&&(a=window.getComputedStyle(b).getPropertyValue("position"),a=String(a||"static"));"static"===a&&(b.style.position="relative");b.appendChild(ob);return ob}function Pa(){var a=Z.cinderella;if(!a||!a.version)return!1;for(var b=0;b<arguments.length;++b){var c=a.version[b],d=arguments[b];if(c!==d)return typeof c===typeof d&&c<d}return!1}function Ya(){var a,b,c,d,f,k,m,q,v,w,x,B,E,J,W,R,ea,
X,oa,ja,Ca,Na,ua,Ha,Ua,Ra,Ja,Ka,Xa,ab,bb,ya,nb,qb,Fb,Db,ib,ub,Xb,Lb,Oc,ac,fe,Hd,ge;return $jscomp.asyncExecutePromiseGeneratorProgram(function(jb){switch(jb.nextAddress){case 1:$d=!0;if(0!==ae)return jb.return();a=Z;if(a.exclusive)for(Oc=Tb.instances.length;0<Oc;)Tb.instances[--Oc].shutdown();void 0!==a.csconsole&&(Qb=a.csconsole);Qb=null===Qb?new ud:!0===Qb?new Jb:"string"===typeof Qb?new Gb(Qb):"object"===typeof Qb&&"function"===typeof Qb.appendChild?new Gb(Qb):new ud;Cb=[100,100];b=null;Xd=a.transform;
a.ports&&0<a.ports.length&&(c=a.ports[0],(b=c.element)||(b=document.getElementById(c.id)),b=ra(b),d=b.parentNode.style,"window"===c.fill?(d.width="100vw",d.height="100vh"):"parent"===c.fill?(d.width="100%",d.height="100%"):c.width&&c.height&&(d.width=c.width+"px",d.height=c.height+"px"),c.virtualwidth&&(Vd=c.virtualwidth),c.virtualheight&&(Wd=c.virtualheight),c.background&&(b.style.backgroundColor=c.background),void 0!==c.transform&&(Xd=c.transform),cc(c.grid)&&0<c.grid&&($b=c.grid),cc(c.tgrid)&&
0<c.tgrid&&(Fe=c.tgrid),c.snap&&(ad=!0),Number.isFinite(c.snapdistance)&&(pd=Math.max(c.snapdistance,0)),c.axes&&(Ed=!0));b||(b=a.canvas,b||"undefined"===typeof document||(b=document.getElementById(a.canvasname))&&(b=ra(b)));b&&(ob=b,Q=b.getContext("2d"),ha(),Q.setLineDash||(Q.setLineDash=function(){}),(a.animation?a.animation.controls:a.animcontrols)&&t(a),a.animation&&cc(a.animation.speed)&&(void 0===a.animation.accuracy&&Pa(2,9,1875)?Za(.5*a.animation.speed):Za(a.animation.speed)),a.animation&&
cc(a.animation.accuracy)&&($c=a.animation.accuracy));a.statusbar&&(Mc="string"===typeof a.statusbar?document.getElementById(a.statusbar):a.statusbar);f="move keydown keyup keytyped keytype mousedown mouseup mousedrag mousemove mouseclick multidown multiup multidrag init tick draw simulationstep simulationstart simulationstop ondrop xrdraw xrinputsourceschange xrselectstart xrselectend xrselect xrselecthold xrsqueezestart xrsqueezeend xrsqueeze xrsqueezehold".split(" ");k=a.scripts;m=null;"string"===
typeof k&&0<=k.search(/\*/)&&(m=k);"object"!==typeof k&&(k=null);if(!(a.import&&0<Object.keys(a.import).length)){jb.jumpTo(2);break}if(!(a.import.hasOwnProperty("packages")&&Array.isArray(a.import.packages)&&0<a.import.packages.length)){jb.jumpTo(3);break}console.log("===== Processing CindyScript packages =====");q=$jscomp.makeIterator(a.import.packages.reverse());v=q.next();case 4:if(v.done){jb.jumpTo(3);break}w=v.value;return jb.yield(fetch(w+"/config.json").then(function(Eb){return Eb.json()}),
7);case 7:x=jb.yieldResult;B=Object.keys(x).filter(function(Eb){return f.includes(Eb)});E=$jscomp.makeIterator(B);for(J=E.next();!J.done;J=E.next())if(W=J.value,a.import.hasOwnProperty(W)||(a.import[W]=[]),R=x[W],Array.isArray(R)&&0<R.length){ea=[];X=$jscomp.makeIterator(R);for(oa=X.next();!oa.done;oa=X.next()){ja=oa.value;Ca=[];if("string"===typeof ja)Ca=[w+"/"+ja,-Infinity];else if(ja.hasOwnProperty("name")&&ja.hasOwnProperty("place")&&"string"===typeof ja.name&&"number"===typeof ja.place)Ca=[w+
"/"+ja.name,ja.place];else if(Array.isArray(ja)&&2===ja.length&&"string"===typeof ja[0]&&"number"===typeof ja[1])Ca=[w+"/"+ja[0],ja[1]];else continue;ea.push(Ca)}a.import[W]=ea.concat(a.import[W])}v=q.next();jb.jumpTo(4);break;case 3:Na=Object.keys(a.import).filter(function(Eb){return f.includes(Eb)}),ua=$jscomp.makeIterator(Na),J=ua.next();case 8:if(J.done){jb.jumpTo(2);break}Ha=J.value;Ua=a.import[Ha];if(!(Array.isArray(Ua)&&0<Ua.length)){jb.jumpTo(9);break}Ra="cs"+Ha;if(a[Ha+"script"])Ra=a[Ha+
"script"];else if(m)Ra=m.replace(/\*/,Ha);else return jb.return();Ja=[];for(Ka=0;Ka<Ua.length;Ka++){Xa=[];ab=Ua[Ka];if("string"===typeof ab)Xa=[ab,-Infinity];else if(ab.hasOwnProperty("name")&&ab.hasOwnProperty("place")&&"string"===typeof ab.name&&"number"===typeof ab.place)Xa=[ab.name,ab.place];else if(Array.isArray(ab)&&2===ab.length&&"string"===typeof ab[0]&&"number"===typeof ab[1])Xa=ab;else continue;Ja.push({index:Ka,value:Xa})}Ja.sort(function(Eb,Mb){return Math.sign(Eb.value[1])===Math.sign(Mb.value[1])?
0>Eb.value[1]?Eb.value[1]===Mb.value[1]?Mb.index-Eb.index:Mb.value[1]-Eb.value[1]:Eb.value[1]===Mb.value[1]?Eb.index-Mb.index:Eb.value[1]-Mb.value[1]:0>Eb.value[1]?-1:1});console.log("===== Importing CindyScript libraries to "+Ra+" =====");bb=za(Ra);ya=$jscomp.makeIterator(Ja);nb=ya.next();case 12:if(nb.done){jb.jumpTo(9);break}qb=nb.value;qb=qb.value;console.log("Loading "+qb[0]+" ...");Fb=-1==qb[0].search(/.+\.cjs$/)?qb[0]+".cjs":qb[0];jb.setCatchFinallyBlocks(15);return jb.yield(fetch(Fb),17);
case 17:Db=jb.yieldResult;if(200!==Db.status){console.log("CAUTION! Import of "+qb[0]+" failed.");jb.jumpTo(18);break}return jb.yield(Db.text(),19);case 19:ib=jb.yieldResult,ub=";"==ib[ib.length-1]?"":";",Xb=document.createTextNode(ib+ub+"\n"),0>qb[1]?cb(bb,Xb):0<qb[1]?bb.appendChild(Xb):console.log("CAUTION! Import of "+qb[0]+" failed.");case 18:jb.leaveTryBlock(13);break;case 15:if(Lb=jb.enterCatchBlock(),"Failed to fetch"===Lb.message)console.log("CAUTION! Import of "+qb[0]+" failed."),console.log("This website seems to not run on a web server. CindyJS will continue without importing CindyScript libraries.");
else throw Lb;case 13:nb=ya.next();jb.jumpTo(12);break;case 9:J=ua.next();jb.jumpTo(8);break;case 2:f.forEach(function(Eb){if(null!==k&&k[Eb])var Mb=k[Eb];else{Mb=Eb+"script";if(a[Mb])Mb=document.getElementById(a[Mb]);else if(m){if(Mb=document.getElementById(m.replace(/\*/,Eb)),!Mb)return}else return;Mb=Mb.text}Mb=Bc(Mb,!1);"error"===Mb.ctype?console.error("Error compiling "+Eb+" script: "+Mb.message):Ba[Eb]=Yc(Mb,Eb)});Pa(2,9,1888)&&!Ba.keydown&&(Ba.keydown=Ba.keytyped,Ba.keytyped=Ba.keytype,Ba.keytype=
void 0);cc(a.grid)&&0<a.grid&&($b=a.grid);a.snap&&(ad=!0);Number.isFinite(a.snapdistance)&&(pd=Math.max(a.snapdistance,0));G={};Oc=0;Jc={};a.geometry||(a.geometry=[]);rf(a.geometry);a.behavior||(a.behavior=[]);"function"===typeof md&&md(a.behavior);for(ac in a.images)fe=vb(a.images[ac],!1),fe!==A&&(Jc[ac]=fe);for(Hd in a.videos)ge=vb(a.videos[Hd],!0),ge!==A&&(Jc[Hd]=ge);Vb.canvas=b;if(a.oninit)a.oninit(Vb);Tb.instances.push(Vb);Z.use&&Z.use.forEach(function(Eb){z.use$1([p.wrap(Eb)],{})});rd.convexhull3d$1&&
kb("QuickHull3D","QuickHull3D.js");(rd.colorplot$1||rd.colorplot$2||rd.colorplot$3||rd.colorplot$4)&&kb("CindyGL","CindyGL.js");(rd.playtone$1||rd.playmelody$1)&&kb("midi","midi-plugin.js");U();jb.jumpToEnd()}})}function za(a){var b=document.getElementById(a);b||(b=document.createElement("script"),b.id=a,b.type="text/x-cindyscript",document.head.appendChild(b));return b}function cb(a,b){a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b)}function vb(a,b){if("string"===typeof a){if(b){var c=
document.createElement("video");c.preload="auto";c.loop=!0;c.setAttribute("playsinline","");enableInlineVideo(c)}else c=new Image;c.src=a}else c=a;if(!c.tagName)return console.error("Not a valid image element",c),A;var d={img:c,width:NaN,height:NaN,ready:!0,live:!1,generation:0,whenReady:db};a=c.tagName.toLowerCase();var f=[];if("img"===a)c.complete?(d.width=c.width,d.height=c.height):(d.ready=!1,c.addEventListener("load",function(){d.width=c.width;d.height=c.height;d.ready=!0;d.whenReady=db;f.forEach(db);
F()}),d.whenReady=f.push.bind(f));else if("video"===a)d.live=!0,c.readyState>=c.HAVE_METADATA?(d.width=c.videoWidth,d.height=c.videoHeight):(d.ready=!1,c.addEventListener("loadedmetadata",function(){d.width=c.videoWidth;d.height=c.videoHeight;d.ready=!0;d.whenReady=db;f.forEach(db);F()}),d.whenReady=f.push.bind(f));else if("canvas"===a)d.width=c.width,d.height=c.height;else return console.error("Not a valid image element",a,c),A;return{ctype:"image",value:d}}function t(a){function b(B,E){var J=document.createElement("button"),
W=document.createElement("img");J.appendChild(W);w.appendChild(J);Fd(W,B);J.addEventListener("click",E);qc[B]=function(R){R?J.classList.add("CindyJS-active"):J.classList.remove("CindyJS-active")}}function c(B){if(x){var E=q.getBoundingClientRect();Za(m*(B.clientX-E.left-q.clientLeft+.5)/E.width+f)}}var d=document.createElement("div");d.className="CindyJS-animcontrols";ob.parentNode.appendChild(d);var f=0,k=1,m=1;a.animation&&a.animation.speedRange&&cc(a.animation.speedRange[0])&&cc(a.animation.speedRange[1])&&
(f=a.animation.speedRange[0],k=a.animation.speedRange[1],m=k-f);var q=document.createElement("div");q.className="CindyJS-animspeed";d.appendChild(q);var v=document.createElement("div");q.appendChild(v);g(q,"pointerdown",function(B){x=!0;c(B)});g(q,"pointermove",c);g(ob.parentNode,"pointerup",function(B){x=!1},!0);var w=document.createElement("div");w.className="CindyJS-animbuttons";d.appendChild(w);b("play",Ia);b("pause",Ob);b("stop",Sb);qc.stop(!0);Zd=function(B){B=(B-f)/m;B=Math.max(0,Math.min(1,
B));B=.1*Math.round(1E3*B);v.style.width=B+"%"};var x=!1}function Za(a){gf=a;Zd&&Zd(a)}function db(a){return a()}function kb(a,b,c){var d=null;Z.plugins&&(d=Z.plugins[a]);d||(d=Tb._pluginRegistry[a]);d?z.use$1([p.wrap(a)],{}):(++He,Tb.autoLoadPlugin(a,b,function(){z.use$1([p.wrap(a)],{});U(c)}))}function U(a){0===--He&&(a?F():(L(Ba.init),(Z.animation||Z).autoplay&&Ia(),Vb.canvas&&l(Vb.canvas,Z)))}function Aa(){null!==qd&&(Nb.set(qd.state),Object.keys(qd.speeds).forEach(function(a){var b=G.csnames[a];
"undefined"!==typeof b.behavior&&(a=qd.speeds[a],b.behavior.vx=a[0],b.behavior.vy=a[1],b.behavior.vz=a[2],b.behavior.fx=0,b.behavior.fy=0,b.behavior.fz=0)}),bf())}function Ia(){if(!Hc){if(Rd){var a=Uc.backup;a.set(Nb);for(var b={},c=$jscomp.makeIterator(G.points),d=c.next();!d.done;d=c.next())d=d.value,"undefined"!==typeof d.behavior&&(b[d.name]=[d.behavior.vx,d.behavior.vy,d.behavior.vz]);qd={state:a,speeds:b};nd=0;Rd=!1;qc.stop(!1)}else qc.pause(!1);hf=Date.now();qc.play(!0);"function"===typeof md&&
Bf&&ld();Hc=!0;L(Ba.simulationstart);F()}}function Ob(){Hc&&(qc.play(!1),qc.pause(!0),Hc=!1)}function Sb(){Rd||(Hc?(L(Ba.simulationstop),Hc=!1,qc.play(!1)):qc.pause(!1),qc.stop(!0),Rd=!0,Aa())}function Kb(){if(!Gd){Gd=!0;for(var a=Tb.instances.length;0<a;)if(Tb.instances[--a]===Vb){Tb.instances.splice(a,1);break}for(a=Nc.length;0<a;)try{Nc[--a]()}catch(b){console.error(b)}}}function Pb(a){this.in=function(b,c){console.log(b);c?this.append(this.createTextNode("span","blue",b)):this.append(this.createTextNode("p",
"blue",b))};this.out=function(b,c){console.log(b);c?this.append(this.createTextNode("span","red",b)):this.append(this.createTextNode("p","red",b))};this.err=function(b,c){console.log(b);c?this.append(this.createTextNode("span","red",b)):this.append(this.createTextNode("p","red",b))};this.createTextNode=function(b,c,d){return"undefined"!==typeof document?(b=document.createElement(b),b.appendChild(document.createTextNode(d)),b.style.color=c,b):d+"\n"}}function Jb(){var a=this,b=document.createElement("div");
b.innerHTML='<div id="console" style="border-top: 1px solid #333333; bottom: 0px; position: absolute; width: 100%;"><div id="log" style="height: 150px; overflow-y: auto;"></div><input id="cmd" type="text" style="box-sizing: border-box; height: 30px; width: 100%;"></div>';document.body.appendChild(b);var c=document.getElementById("cmd");var d=document.getElementById("log");c.onkeydown=function(f){13===f.keyCode&&""!==c.value&&(a.in(c.value),f=z.parse$1([p.wrap(c.value)],[]),f=L(f),console.log(Ea(f)),
"undefined"!==f.ctype&&Qb.out(Ea(f)),c.value="",d.scrollTop=d.scrollHeight)};this.append=function(f){d.appendChild(f)};this.clear=function(){d.innerHTML=""}}function Gb(a){var b=a;"string"===typeof a&&(b=document.getElementById(a));this.append=function(c){b.appendChild(c)};this.clear=function(){b.innerHTML=""}}function ud(){this.append=function(a){};this.clear=function(){}}function e(a){for(var b=null,c=1E6,d,f=$jscomp.makeIterator(G.free),k=f.next();!k.done;k=f.next())if(k=k.value,!k.pinned&&!1!==
k.visible&&!0!==k.tmp){var m=P.drawingstate.matrix.sdet;if("P"===k.kind){var q=h.normalizeZ(k.homog);if(!h._helper.isAlmostReal(q))continue;var v=q.value[0].value.real-a.x;q=q.value[1].value.real-a.y;var w=Math.sqrt(v*v+q*q);if(k.narrow&&w>("number"===typeof k.narrow?k.narrow:20)/m)continue}else if("C"===k.kind){q=h.normalizeZ(G.csnames[k.args[0]].homog);v=k.radius;if(!h._helper.isAlmostReal(q)||!n._helper.isAlmostReal(v))continue;w=q.value[0].value.real;var x=q.value[1].value.real;q=a.x-w;var B=
a.y-x,E=Math.sqrt(q*q+B*B);if(0===E)continue;x+=B/E*v.value.real;v=w+q/E*v.value.real-a.x;q=x-a.y;w=Math.sqrt(v*v+q*q);w+=30/m;if(k.narrow&&w>(("number"===typeof k.narrow?k.narrow:20)+30)/m)continue}else if("L"===k.kind)v=k.homog,w=n,q=w.add(w.mult(v.value[0],w.conjugate(v.value[0])),w.mult(v.value[1],w.conjugate(v.value[1]))),q=h.scaldiv(w.sqrt(q),v),w=q.value[0].value.real*a.x+q.value[1].value.real*a.y+q.value[2].value.real,v=-q.value[0].value.real*w,q=-q.value[1].value.real*w,0>w&&(w=-w),w+=25/
m;else if("Text"===k.kind){if(!k.homog||k.dock||!k._bbox)continue;q=P.from(a.x,a.y,1);v=Math.max(0,q[0]-k._bbox.right,k._bbox.left-q[0]);q=Math.max(0,q[1]-k._bbox.bottom,k._bbox.top-q[1]);w=Math.sqrt(v*v+q*q);if(20<w)continue;w/=m;q=h.normalizeZ(k.homog);if(!h._helper.isAlmostReal(q))continue;v=q.value[0].value.real-a.x;q=q.value[1].value.real-a.y}else continue;w<c+.2/m&&(c=w,b=k,d={x:v,y:q})}return null===b?null:{mover:b,offset:d,prev:{x:a.x,y:a.y}}}function g(a,b,c,d){void 0===d&&(d=!1);Nc.push(function(){a.removeEventListener(b,
c,d)});a.addEventListener(b,c,d)}function l(a,b){function c(x,B){x=$jscomp.makeIterator(x.changedTouches);for(var E=x.next();!E.done;E=x.next()){var J=E.value;E=f(J.identifier);if(B||Tc[E]){var W=a.getBoundingClientRect();J=P.to(J.clientX-W.left-a.clientLeft+.5,J.clientY-W.top-a.clientTop+.5);Tc[E]=[J[0],J[1]]}}F()}function d(x){var B=a.getBoundingClientRect();x=P.to(x.clientX-B.left-a.clientLeft+.5,x.clientY-B.top-a.clientTop+.5);hb.prevx=hb.x;hb.prevy=hb.y;hb.x=x[0];hb.y=x[1];Cb[0]=hb.x;Cb[1]=hb.y;
F()}function f(x){if(Wb.hasOwnProperty(x))return Wb[x];var B=Object.values(Wb);B=B.sort(function(W,R){return W-R});var E=!1,J;for(J in B)!E&&B[J]>(J|0)+1&&(Wb[x]=(J|0)+1,E=!0);E||(Wb[x]=B.length+1);return Wb[x]}function k(x){var B=x.changedTouches;c(x,!1);for(var E=0;E<x.changedTouches.length;E++)rc=f(x.changedTouches[E].identifier),La(rc),delete Wb[x.changedTouches[E].identifier];E=!1;for(var J=0;J<B.length;J++)B[J].identifier===w&&(E=!0);E&&(w=-1,hb.down=!1,fd("mouseup"),L(Ba.mouseup),wb=void 0,
v||L(Ba.mouseclick),F(),x.preventDefault())}var m=null,q=null,v=!1;"undefined"!==typeof MutationObserver&&(m=MutationObserver);m||"undefined"===typeof WebKitMutationObserver||(m=WebKitMutationObserver);m?(m=new m(function(x){document.body.contains(a)||Kb()}),m.observe(document.documentElement,{childList:!0,subtree:!0}),Nc.push(function(){m.disconnect()})):(g(a,"DOMNodeRemovedFromDocument",Kb),g(a,"DOMNodeRemoved",Kb));if(!0===b.keylistener)g(document,"keydown",function(x){ka(x,Ba.keydown);return!1}),
g(document,"keyup",function(x){ka(x,Ba.keyup);return!1}),g(document,"keypress",function(x){ka(x,Ba.keytyped);return!1});else if(Ba.keydown||Ba.keyup||Ba.keytyped)a.setAttribute("tabindex","0"),g(a,"pointerdown",function(){a.focus()}),g(a,"keydown",function(x){9!==x.keyCode&&(ka(x,Ba.keydown),Ba.keytyped||x.preventDefault())}),g(a,"keyup",function(x){ka(x,Ba.keyup);x.preventDefault()}),g(a,"keypress",function(x){9!==x.keyCode&&(ka(x,Ba.keytyped),x.preventDefault())});g(a,"pointerdown",function(x){"touch"!=
x.pointerType&&(q=x,v=!1,hb.button=x.which,d(x),fd("mousedown"),pa(0),L(Ba.mousedown),hb.down=!0,x.preventDefault(),a.setPointerCapture(x.pointerId))});g(a,"pointerup",function(x){"touch"!=x.pointerType&&(hb.down=!1,fd("mouseup"),L(Ba.mouseup),La(0),wb=void 0,delete Tc[0],F(),x.preventDefault(),a.releasePointerCapture(x.pointerId))});g(a,"pointermove",function(x){"touch"!=x.pointerType&&(d(x),hb.down?(q&&(2<Math.abs(q.clientX-x.clientX)||2<Math.abs(q.clientY-x.clientY))&&(v=!0),L(Ba.mousedrag),rc=
0,L(Ba.multidrag),rc=0):L(Ba.mousemove),fd("mousemove"),x.preventDefault())});g(a,"click",function(x){d(x);v||L(Ba.mouseclick);x.preventDefault()});g(a,"dragenter",function(x){x.preventDefault()});g(a,"dragover",function(x){x.preventDefault()});g(a,"drop",function(x){function B(ua,Ha){function Ua(){Ja.readyState===XMLHttpRequest.DONE&&(200!==Ja.status?(console.error("GET request for "+ua+" failed: "+(Ja.responseText||"(no error message)")),R(Ha,A)):J(Ha,Ja.responseText))}var Ra=ua.replace(/[?#][^]*/,
"");Ra=Ra.replace(/[^]*\/([^\/])/,"$1");X[Ha]={type:"",name:Ra};var Ja=new XMLHttpRequest;Ja.onreadystatechange=function(){if(Ja.readyState===XMLHttpRequest.DONE)if(200!==Ja.status)console.error("HEAD request for "+ua+" failed: "+(Ja.responseText||"(no error message)")),R(Ha,A);else{var Ka=Ja.getResponseHeader("Content-Type");X[Ha].type=Ka;/^image\//.test(Ka)?W(Ha,ua):E(Ka)?(Ja=new XMLHttpRequest,Ja.onreadystatechange=Ua,Ja.open("GET",ua),Ja.send()):R(Ha,A)}};Ja.open("HEAD",ua);Ja.send()}function E(ua){ua=
ua.replace(/;[^]*/,"");return/^text\//.test(ua)?1:"application/json"===ua?2:0}function J(ua,Ha){switch(E(X[ua].type)){case 1:R(ua,p.string(Ha));break;case 2:try{var Ua=JSON.parse(Ha);var Ra=p.wrapJSON(Ua)}catch(Ja){console.error(Ja),Ra=A}R(ua,Ra);break;default:R(ua,A)}}function W(ua,Ha){var Ua=new Image,Ra=!1;Ua.onload=function(){Ra||(Ra=!0,R(ua,vb(Ua,!1)))};Ua.onerror=function(Ja){Ra||(Ra=!0,console.error(Ja),R(ua,A))};Ua.src=Ha}function R(ua,Ha,Ua){oa[ua]=h.turnIntoCSList([Ha,p.string(Ua||Ha.ctype),
p.string(X[ua].type),p.string(X[ua].name)]);0===--ja&&(Yd=h.turnIntoCSList(oa),Ge=Na,L(Ba.ondrop),Ge=Yd=A,F())}x.preventDefault();var ea=x.dataTransfer,X=ea.files,oa=Array(X.length),ja=X.length,Ca=x.currentTarget.getBoundingClientRect(),Na=h.realVector(P.to(x.clientX-Ca.left-a.clientLeft+.5,x.clientY-Ca.top-a.clientTop+.5));if(0<X.length)Array.prototype.forEach.call(X,function(ua,Ha){var Ua=new FileReader;E(ua.type)?(Ua.onload=function(){J(Ha,Ua.result)},Ua.readAsText(ua)):/^image\//.test(ua.type)?
(Ua.onload=function(){W(Ha,Ua.result)},Ua.readAsDataURL(ua)):(console.log("Unknown MIME type: "+ua.type),R(Ha,A))});else if(x=ea.getData("text/uri-list"))x=x.split("\n").filter(function(ua){return!/^\s*(#|$)/.test(ua)}),ja=x.length,oa=Array(ja),X=Array(ja),x.forEach(B)});var w=-1;g(a,"touchstart",function(x){c(x,!0);for(var B=0;B<x.changedTouches.length;B++)pa(f(x.changedTouches[B].identifier));-1===w&&(B=x.changedTouches,0!==B.length&&(w=B[0].identifier,d(x.targetTouches[0]),hb.down=!0,q=x.targetTouches[0],
v=!1,wb=e(hb),fd("mousedown"),L(Ba.mousedown),x.preventDefault()))},!1);g(a,"touchmove",function(x){c(x,!1);for(var B=0;B<x.changedTouches.length;B++)rc=f(x.changedTouches[B].identifier),L(Ba.multidrag),rc=0;B=x.changedTouches;for(var E=!1,J=0;J<B.length;J++)B[J].identifier===w&&(E=!0);E&&(d(x.targetTouches[0]),hb.down?(q&&(2<Math.abs(q.clientX-x.targetTouches[0].clientX)||2<Math.abs(q.clientY-x.targetTouches[0].clientY))&&(v=!0),rc=f(w),L(Ba.mousedrag)):L(Ba.mousemove),fd("mousemove"),x.preventDefault())},
!0);g(a,"touchend",k,!1);"undefined"!==typeof document&&document.body&&g(document.body,"touchcancel",k,!1);"undefined"!==typeof window&&g(window,"resize",function(){dc(function(){ha();F()})},!1);y(a.parentNode);F()}function r(a,b){var c=document.createElement("div");c.setAttribute("style",b);a.appendChild(c);return c}function y(a){function b(){d.scrollLeft=d.scrollTop=f.scrollLeft=f.scrollTop=1E5}function c(){if(k!==a.clientWidth||m!==a.clientHeight)k=a.clientWidth,m=a.clientHeight,q||(q=!0,dc(function(){q=
!1;ha();F()}));b()}if("undefined"!==typeof document){var d=r(a,"position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;");r(d,"position: absolute; transition: 0s; left: 0; top: 0; width: 100000px; height: 100000px");var f=r(a,"position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;");r(f,"position: absolute; transition: 0s; left: 0; top: 0; width: 200%; height: 200%");
b();var k=a.clientWidth,m=a.clientHeight,q=!1;d.addEventListener("scroll",c);f.addEventListener("scroll",c)}}function F(){de||(de=dc(K))}function K(){de=null;if(!Gd){if(Hc){var a=Date.now(),b=Math.min(50,a-hf)*gf*zf;nd=a;a=nd+b;Bf&&"undefined"!==typeof ec&&ec.tick(b);nd=a;Hc&&L(Ba.tick)}ca();Hc&&F()}}function ca(){P.reset();Q.save();Q.clearRect(0,0,pb,rb);var a=P.drawingstate.matrix,b,c;if(0!==$b){Q.beginPath();Q.strokeStyle="rgba(0,0,0,0.1)";Q.lineWidth=1;Q.lineCap="butt";var d=$b*a.a;for(b=Math.ceil(-a.tx/
d);(c=b*d+a.tx)<pb;){if(b||!Ed)Q.moveTo(c,0),Q.lineTo(c,rb);b++}for(b=Math.floor(a.ty/d);(c=b*d-a.ty)<rb;){if(b||!Ed)Q.moveTo(0,c),Q.lineTo(pb,c);b++}Q.stroke()}if(0!==Fe){Q.beginPath();Q.strokeStyle="rgba(0,0,0,0.1)";Q.lineWidth=1;Q.lineCap="butt";d=Fe*a.a;var f=Math.sqrt(3);var k=a.ty/f;var m=(rb+a.ty)/f;for(b=Math.ceil(-(a.tx+m)/d);(c=b*d+a.tx)+k<pb;)Q.moveTo(c+k,0),Q.lineTo(c+m,rb),b++;for(b=Math.ceil(-(a.tx-k)/d);(c=b*d+a.tx)-m<pb;)Q.moveTo(c-k,0),Q.lineTo(c-m,rb),b++;d*=.5*f;for(b=Math.floor(a.ty/
d);(c=b*d-a.ty)<rb;){if(b||!Ed)Q.moveTo(0,c),Q.lineTo(pb,c);b++}Q.stroke()}Ed&&(Q.beginPath(),Q.strokeStyle="rgba(0,0,0,0.2)",Q.lineWidth=3,Q.lineCap="butt",Q.lineJoin="miter",Q.miterLimit=10,Q.beginPath(),Q.moveTo(0,-a.ty),Q.lineTo(pb-6,-a.ty),Q.moveTo(pb-13,-5-a.ty),Q.lineTo(pb-3,-a.ty),Q.lineTo(pb-13,5-a.ty),Q.moveTo(a.tx,rb),Q.lineTo(a.tx,6),Q.moveTo(a.tx-5,13),Q.lineTo(a.tx,3),Q.lineTo(a.tx+5,13),Q.stroke());uf();P.greset();$e();for(a=0;a<G.polygons.length;a++)d=G.polygons[a],d.isshowing&&!1!==
d.visible&&(k={color:d.color,alpha:d.alpha,fillcolor:d.fillcolor,fillalpha:d.fillalpha,size:d.size,lineJoin:p.string("miter"),fillrule:p.string(d.fillrule)},M.drawpolygon([d.vertices],k,"D",!0));for(a=0;a<G.conics.length;a++)G.conics[a].isArc?(d=G.conics[a],d.isshowing&&!1!==d.visible&&(k={},k.color=d.color,k.alpha=d.alpha,k.size=d.size,M.drawarc(d,k,d.filled?"F":"D"))):(d=G.conics[a],d.isshowing&&!1!==d.visible&&(k={},k.color=d.color,k.alpha=d.alpha,k.size=d.size,M.drawconic(d.matrix,k)));for(a=
0;a<G.lines.length;a++)a:if(d=G.lines[a],d.isshowing&&!1!==d.visible&&h._helper.isAlmostReal(d.homog))if("S"===d.kind)k={overhang:d.overhang,dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha,arrow:d.arrow,arrowsize:d.arrowsize,arrowposition:d.arrowposition,arrowshape:d.arrowshape,arrowsides:d.arrowsides},0<=n.mult(d.startpos.value[2],n.conjugate(d.endpos.value[2])).value.real?(z.draw$2([d.startpos,d.endpos],k),d.labeled&&!d.tmp&&(k=d.printname||d.name||"S",m=h.scalmult(n.real(Math.sign(d.startpos.value[2].value.real)*
Math.sign(d.endpos.value[2].value.real)),h.cross(d.startpos,d.endpos)),m={x:m.value[0].value.real,y:m.value[1].value.real},b=Math.sqrt(m.x*m.x+m.y*m.y),m={x:8*m.x/b-3,y:8*m.y/b-3},m=d.labelpos||m,b=N.makeColor(zb.textColor),c=u._helper.midpoint(u._helper.midpoint(d.startpos,d.endpos),d.endpos),zd(d,k,c,m,b))):(N.handleModifs(k,N.lineModifs),N.drawRaySegment(d.startpos,d.endpos));else if("end"===d.clip.value&&"Join"===d.type)b=G.csnames[d.args[0]],k=G.csnames[d.args[1]],z.draw$2([b.homog,k.homog],
{overhang:d.overhang,dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha});else{if("inci"===d.clip.value){b=[1E6,0];k=[-1E6,0];c=[1E6,0];m=[-1E6,0];for(f=0;f<d.incidences.length;f++){var q=G.csnames[d.incidences[f]].homog,v=q.value[0],w=q.value[1],x=q.value[2];n._helper.isAlmostZero(x)||(v=n.div(v,x),w=n.div(w,x),n._helper.isAlmostReal(v)&&n._helper.isAlmostReal(w)&&(v.value.real<b[0]&&(b=[v.value.real,q]),v.value.real>k[0]&&(k=[v.value.real,q]),w.value.real<c[0]&&(c=[w.value.real,q]),w.value.real>
m[0]&&(m=[w.value.real,q])))}k[0]-b[0]>m[0]-c[0]?(b=b[1],k=k[1]):(b=c[1],k=m[1]);if(b!==k){z.draw$2([b,k],{dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha,overhang:d.overhang});break a}}z.draw$1([d.homog],{dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha})}for(a=0;a<G.points.length;a++)if(d=G.points[a],d.isshowing&&!1!==d.visible&&h._helper.isAlmostReal(d.homog)&&(k=d.color,d.behavior&&(k=d.color),z.draw$1([d.homog],{size:d.size,color:k,alpha:d.alpha,noborder:d.noborder,border:d.border}),
d.labeled&&!d.tmp)){m=d.printname||d.name||"P";b=d.labelpos||{x:3,y:3};c=N.makeColor(zb.textColor);if(!0===d.noborder.value||!1===d.border.value)c=k;zd(d,m,d.homog,b,c)}for(a=0;a<G.texts.length;a++)Ze(G.texts[a]);if(G.ifs.length){if(lb.dirty||!p.deeplyEqual(lb.mat,P.drawingstate.matrix))u.IFS.updateParameters(),lb.dirty=!1;lb.img&&Q.drawImage(lb.img,0,0,pb,rb)}Q.restore()}function ka(a,b){a=a||window.event;be=a.key||String.fromCharCode(a.keyCode||a.charCode||0);ce=a.keyCode||a.charCode||0;b&&L(b);
F()}function pa(a){rc=a;0===a&&(Tc[0]=Cb);L(Ba.multidown);rc=0}function La(a){rc=a;L(Ba.multiup);delete Tc[a];rc=0}function eb(a){var b=a.value;a=b[0].value;var c=b[1].value;b=b[2].value;return h.turnIntoCSList([a[0],n.add(a[1],c[0]),n.add(a[2],b[0]),c[1],n.add(c[2],b[1]),b[2]])}function Va(a){var b=!0;return function(c,d){b&&(console.error("Operator "+a+" is not supported yet."),b=!1);return A}}function Ea(a,b){if("undefined"===typeof a)return"_??_";if(null===a)return"_???_";if("undefined"===a.ctype)return"___";
if("number"===a.ctype)return n.niceprint(a);if("string"===a.ctype||"boolean"===a.ctype)return a.value;if("list"===a.ctype){b="[";for(var c=0;c<a.value.length;c++)b+=Ea(L(a.value[c])),c!==a.value.length-1&&(b+=", ");return b+"]"}if("JSON"===a.ctype)try{return $a.niceprint(a,b)}catch(d){return $a._helper.handlePrintException(d)}return"dict"===a.ctype?O.niceprint(a):"function"===a.ctype?"FUNCTION":"infix"===a.ctype?"INFIX":"modifier"===a.ctype?a.key+"->"+Ea(a.value):"shape"===a.ctype?a.type:"error"===
a.ctype?"Error: "+a.message:"variable"===a.ctype?Ea(V.getvar(a.name)):"geo"===a.ctype?a.value.name:"image"===a.ctype?"IMAGE":"_?_"}function Sa(a,b,c){a=D[a];if(void 0===a)return A;var d=[],f;for(f=0;f<a.arglist.length;f++)d[f]=L(b[f]);var k={};Object.entries(c).forEach(function(m){var q=$jscomp.makeIterator(m);m=q.next().value;q=q.next().value;k[m]=L(q)});for(f=0;f<a.arglist.length;f++)V.newvar(a.arglist[f].name),V.setvar(a.arglist[f].name,d[f]);Object.entries(k).forEach(function(m){var q=$jscomp.makeIterator(m);
m=q.next().value;q=q.next().value;V.newvar(m);V.setvar(m,q)});V.pushVstack("*");b=L(a.body);V.cleanVstack();Object.entries(c).forEach(function(m){m=$jscomp.makeIterator(m);var q=m.next().value;m.next();V.removevar(q)});for(f=0;f<a.arglist.length;f++)V.removevar(a.arglist[f].name);return b}function fc(a,b){b="undefined"===a[0].ctype;var c="undefined"===a[1].ctype,d=L(a[1]);if(b||c)return A;"variable"===a[0].ctype?("list"===d.ctype&&(d.internal_usage=void 0),V.setvar(a[0].name,d)):"infix"===a[0].ctype?
"_"===a[0].oper?M.assigntake(a[0],d):xb("Can't use infix expression as lvalue"):"field"===a[0].ctype?M.assigndot(a[0],d):"userdata"===a[0].ctype?M.assigncolon(a[0],d):"function"===a[0].ctype&&"genList"===a[0].oper?"list"===d.ctype?M.assignlist(a[0].args,d.value):xb("Expected list in rhs of assignment"):xb("Left hand side of assignment is not a recognized lvalue");return d}function Ab(a,b){b=L(a[0]);a=L(a[1]);if(b.ctype===a.ctype){if("number"===b.ctype)return p.bool(b.value.real===a.value.real&&b.value.imag===
a.value.imag);if("string"===b.ctype||"boolean"===b.ctype)return p.bool(b.value===a.value);if("list"===b.ctype)return h.equals(b,a);if("geo"===b.ctype||"JSON"===b.ctype)return p.bool(b.value===a.value)}return{ctype:"boolean",value:!1}}function gc(a,b){return p.not(Ab(a,b))}function hc(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===a.ctype?{ctype:"boolean",value:n._helper.isAlmostEqual(b,a)}:"string"===b.ctype&&"string"===a.ctype||"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",
value:b.value===a.value}:"list"===b.ctype&&"list"===a.ctype?h.almostequals(b,a):{ctype:"boolean",value:!1}}function Wc(a,b){b=Y(a[0]);a=Y(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value&&a.value}:A}function ke(a,b){b=Y(a[0]);a=Y(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value||a.value}:A}function Ne(a,b){b=a[0];"void"!==b.ctype&&(b=Y(b));a=Y(a[1]);var c=p.add(b,a);"Angle"===b.usage&&"Angle"===a.usage&&(c=p.withUsage(c,"Angle"));
return c}function Id(a,b){b=a[0];"void"!==b.ctype&&(b=Y(b));a=Y(a[1]);var c=p.sub(b,a);"Angle"===b.usage&&"Angle"===a.usage&&(c=p.withUsage(c,"Angle"));return c}function Hb(a,b){b=Y(a[0]);a=Y(a[1]);var c=p.mult(b,a);"Angle"!==b.usage||a.usage?"Angle"!==a.usage||b.usage||(c=p.withUsage(c,"Angle")):c=p.withUsage(c,"Angle");return c}function Ga(a,b){b=Y(a[0]);a=Y(a[1]);"number"===a.ctype&&n._helper.isZero(a)&&xb("WARNING: Division by zero!");var c=p.div(b,a);"Angle"!==b.usage||a.usage?"Angle"!==a.usage||
b.usage||(c=p.withUsage(c,"Angle")):c=p.withUsage(c,"Angle");return c}function Pc(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.pow(b,a):A}function vc(a,b){b=Fa(a[0]);a=Fa(a[1]);if(b!==A&&a!==A){var c=h.cross(b,a);"Point"===b.usage&&"Point"===a.usage&&(c=p.withUsage(c,"Line"));"Line"===b.usage&&"Line"===a.usage&&(c=p.withUsage(c,"Point"));return c}return A}function Lc(a){var b=a.length;if(0===b)return[];if(1===b)return[0];if(2===b)return a[0][0]+a[1][1]<=a[0][1]+a[1][0]?
[0,1]:[1,0];if(4<b)return le(a);var c=xa[b],d=Number.POSITIVE_INFINITY,f=c[0];c=$jscomp.makeIterator(c);for(var k=c.next();!k.done;k=c.next()){k=k.value;for(var m=0,q=0;q<b;++q)m+=a[q][k[q]];m<d&&(d=m,f=k)}return f}function le(a){function b(){return{matched:-1,prev:-1,start:-1,cost:0,used:!1,leaf:!1}}function c(W){for(var R=0;R<k;++R)0<x[W][R]||w[R].used||(w[R].used=!0,c(w[R].matched))}function d(W){for(var R=0;R<k;++R)0<x[R][W]||v[R].used||(v[R].used=!0,d(v[R].matched))}var f=Math.abs,k=a.length,
m,q,v=Array(k),w=Array(k),x=Array(k);for(m=0;m<k;++m)x[m]=Array(k);for(m=0;m<k;++m)for(v[m]=b(),w[m]=b(),v[m].cost=a[m][0],q=1;q<k;++q)v[m].cost>a[m][q]&&(v[m].cost=a[m][q]);for(;;){for(m=0;m<k;++m)for(q=0;q<k;++q)x[m][q]=a[m][q]-v[m].cost-w[q].cost,x[m][q]<1E-14*(f(a[m][q])+f(v[m].cost)+f(w[q].cost))&&(x[m][q]=0);for(m=0;m<k;++m)v[m].matched=w[m].matched=-1;for(var B=0;;){for(m=0;m<k;++m)v[m].used=v[m].leaf=w[m].used=w[m].leaf=!1,-1===v[m].matched&&(v[m].start=m,v[m].used=v[m].leaf=!0,v[m].prev=
-1);for(var E=!1,J=!1;!J;){for(m=0;m<k;++m)if(v[m].leaf)for(v[m].leaf=!1,q=0;q<k;++q)if(!(w[q].used||0<x[m][q])&&v[m].matched!==q&&(w[q].prev=m,w[q].start=v[m].start,w[q].used=w[q].leaf=!0,-1===w[q].matched)){v[w[q].start].prev=q;E=!0;break}if(E)break;J=!0;for(q=0;q<k;++q)w[q].leaf&&(w[q].leaf=!1,m=w[q].matched,v[m].used||(v[m].prev=q,v[m].start=w[q].start,v[m].used=v[m].leaf=!0,J=!1))}if(!E)break;for(E=0;E<k;++E)if(-1===v[E].matched&&-1!==v[E].prev){q=v[E].prev;do m=w[q].prev,w[q].matched=m,v[m].matched=
q,q=v[m].prev;while(m!==E);++B}}if(B===k)break;for(m=0;m<k;++m)v[m].used=v[m].leaf=w[m].used=w[m].leaf=!1;for(m=0;m<k;++m)-1===v[m].matched&&c(m);for(q=0;q<k;++q)-1===w[q].matched&&d(q);for(m=0;m<k;++m)-1===v[m].matched||v[m].used||w[v[m].matched].used||(v[m].used=!0);B=Number.POSITIVE_INFINITY;for(m=0;m<k;++m)if(!v[m].used)for(q=0;q<k;++q)w[q].used||B>x[m][q]&&(B=x[m][q]);for(m=0;m<k;++m)v[m].used||(v[m].cost+=B),w[m].used&&(w[m].cost-=B)}a=Array(k);for(m=0;m<k;++m)q=v[m].matched,a[m]=q;return a}
function vd(a,b){b=L(a[0]);a=Y(a[1]);"string"!==b.ctype&&"JSON"!==b.ctype&&(b=h.asList(b));if("JSON"!==b.ctype&&"number"===a.ctype){a=Math.floor(a.value.real);0>a&&(a=b.value.length+a+1);if(0<a&&a<b.value.length+1)return"list"===b.ctype?b.value[a-1]:{ctype:"string",value:b.value.charAt(a-1)};xb("WARNING: Index out of range!");return A}if("JSON"===b.ctype){a=Ea(a);if(Ea.errorTypes.includes(a))return A;b=b.value[a];return void 0!==b&&b.ctype?b:A}if("list"===a.ctype){for(var c=[],d=0;d<a.value.length;d++){var f=
Y(a.value[d]);c[d]=vd([b,f],[])}return h.turnIntoCSList(c)}return A}function wc(a,b){b=L(a[0]);a=L(a[1]);if("shape"===b.ctype&&"shape"===a.ctype)return M.shapeconcat(b,a);b=h.asList(b);a=h.asList(a);return"list"===b.ctype&&"list"===a.ctype?h.concat(b,a):A}function S(a,b){b=L(a[0]);a=L(a[1]);return"list"===b.ctype&&"list"===a.ctype?h.set(h.common(b,a)):"shape"===b.ctype&&"shape"===a.ctype?M.shapecommon(b,a):A}function wd(a,b){b=L(a[0]);a=L(a[1]);if("shape"===b.ctype&&"shape"===a.ctype)return M.shaperemove(b,
a);b=h.asList(b);a=h.asList(a);return"list"===b.ctype&&"list"===a.ctype?h.remove(b,a):A}function me(a,b){b=L(a[0]);a=L(a[1]);return"list"===b.ctype?h.append(b,a):A}function ne(a,b){b=L(a[0]);a=L(a[1]);return"list"===a.ctype?h.prepend(b,a):A}function xd(a,b){a|=0;b|=0;if(0===a&&0===b)return 0;for(;0!==b;){var c=a;a=b;b=c%b|0}return a}function Oe(a){return 1===a?0:1}function cd(a,b,c){var d=b*b-4*a*c;0<=d?(d=Math.sqrt(d),0<b&&(d=-d),a=[[d-b,2*a],[2*c,d-b]]):a=null;b=a;if(null===b)return null;a=b[0][0]/
b[0][1];b=b[1][0]/b[1][1];return b<a?[b,a]:[a,b]}function oe(a,b,c,d,f,k,m,q){q=void 0===q?0:q;if(b.includes("\n")){var v=Infinity,w=-Infinity,x=Infinity,B=-Infinity;b.split("\n").forEach(function(J){J=oe(a,J,c,d,f,k);v>J.left&&(v=J.left);w<J.right&&(w=J.right);x>J.top&&(x=J.top);B<J.bottom&&(B=J.bottom);d+=m});return{left:v,right:w,top:x,bottom:B}}var E=a.measureText(b);q?(a.save(),a.translate(c,d),a.rotate(-q),0<a.lineWidth&&a.strokeText(b,-E.width*f,0),a.fillText(b,-E.width*f,0),a.restore()):(0<
a.lineWidth&&a.strokeText(b,c-E.width*f,d),a.fillText(b,c-E.width*f,d));return{left:c-E.width*f,right:c+E.width*(1-f),top:d-.84*k,bottom:d+.36*k}}function bc(a){return"image"===a.ctype?a.value:"string"===a.ctype&&Jc.hasOwnProperty(a.value)?Jc[a.value].value:null}function Xc(a,b,c,d,f){var k=[];if(a.readPixels)k=a.readPixels(b,c,d,f);else{if(a.img.getContext){var m=a.img.getContext("2d");var q=m.getImageData(b,c,d,f).data}else try{Bd||(Bd=document.createElement("canvas")),Bd.width=d,Bd.height=f,m=
Bd.getContext("2d"),m.drawImage(a.img,b,c,d,f,0,0,d,f),q=m.getImageData(0,0,d,f).data}catch(w){console.log(w)}for(var v in q)k.push(q[v]/255)}return k}function pe(a){return a.replace(/[^A-Za-z0-9 \u0080-\uffff]/gi,"\\$&")}function Bb(a,b,c){var d=a;b&&(d=d+" at "+b.row+":"+b.col);c&&(d=d+": \u2018"+c+"\u2019");d=Error(d);d.name="CindyScriptParseError";d.description=a;d.location=b;d.text=c;return d}function Rc(a){this.input=a;this.re=new RegExp(kf,"g");for(var b=[],c=a.indexOf("\n")+1;c;)b.push(c),
c=a.indexOf("\n",c)+1;b.push(a.length);this.bols=b;this.bol=this.pos=0;this.line=1}function Jd(a){var b=a[a.length-2],c=a[a.length-3],d=a[a.length-1];if(c){if(c.isSuperscript&&b.precedence<=c.precedence)throw Bb("Operator not allowed after superscript",b.start,b.text);if(d){if(!b.op.infix)throw Bb("Operator may not be used infix",b.start,b.text);}else if(!b.op.postfix)throw Bb("Operator may not be used postfix",b.start,b.text);}else if(d){if(!b.op.prefix)throw Bb("Operator may not be used prefix",
b.start,b.text);}else if(!b.op.bare)throw Bb("Operator without operands",b.start,b.text);b.ctype="infix";b.oper=b.op.sym;b.args=[c,d];a.splice(a.length-3,3,b)}function dd(a,b,c,d){a.length&1||a.push(null);for(c=tb[c];3<=a.length&&a[a.length-2].precedence<=c.precedence;)Jd(a);a.push({op:c,precedence:c.precedence+(c.rassoc?1:0),start:b.start,end:b.end,text:b.text,rawtext:b.rawtext});c="";for(var f=b.text,k=0;k<f.length;++k)c+="0123456789+-".charAt(d.indexOf(f.charAt(k)));b.ctype="number";b.value={real:+c,
imag:0};a.push(b);Jd(a)}function oc(a,b){var c=[],d="}"===b;a:for(;;){var f=a.next();switch(f.toktype){case "OP":var k=tb[f.text];"_"!==k.sym||!c.length||c.length&1||"OP"!==c[c.length-1].toktype||":="!==c[c.length-1].op.sym||(c.pop(),k=tb[":=_"],f.text=k.sym);f.op=k;f.precedence=k.precedence;for(c.length&1||c.push(null);3<=c.length&&c[c.length-2].precedence<=f.precedence;)Jd(c);k.rassoc&&f.precedence++;d&&":"===k.sym&&(f.jsonatom=!0,f.precedence=tb[","].precedence,d=!1);"}"===b&&","===k.sym&&0<c.length&&
c[c.length-1].jsonatom&&(d=!0);c.push(f);break;case "ID":f.ctype="variable";f.name=f.text;if(c.length&1)throw Bb("Missing operator",f.start,f.text);c.push(f);break;case "NUM":f.ctype="number";f.value={real:+f.text,imag:0};if(c.length&1)throw Bb("Missing operator",f.start,f.text);c.push(f);break;case "STR":f.ctype="string";f.value=f.raw.substring(1,f.raw.length-1);if(c.length&1)throw Bb("Missing operator",f.start,f.text);c.push(f);break;case "SUB":dd(c,f,"_","\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089\u208a\u208b");
break;case "SUP":dd(c,f,"^","\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079\u207a\u207b");c[c.length-1].isSuperscript=!0;break;case "BRA":k="[](){}||".indexOf(f.text);if(f.text===b||k&1)break a;var m="[](){}||".charAt(k+1);k=oc(a,m);var q=k.closedBy;if(q.text!==m)throw Bb("Opening "+f.text+" at "+f.start.row+":"+f.start.col+" closed by "+(q.text||"EOF")+" at "+q.start.row+":"+q.start.col);q=f.text+q.text;m=[];if(k=k.expr){for(;k&&"infix"===k.ctype&&","===k.oper;)m.push(k.args[0]),k=
k.args[1];m.push(k)}if(c.length&1){if("{}"===q)throw Bb("{\u2026} not yet defined for operators.",f.start);k=c[c.length-1];if("variable"!==k.ctype)throw Bb("Function name must be an identifier",k.start);if(2<c.length&&c[c.length-2].precedence<Ic)throw Bb("Function call in indexing construct must be enclosed in parentheses",f.start);k.ctype="function";f=k.args=[];q=k.modifs={};m=$jscomp.makeIterator(m);for(var v=m.next();!v.done;v=m.next())if((v=v.value)&&"infix"===v.ctype&&"->"===v.oper){var w=v.args[0];
if("variable"!==w.ctype)throw Bb("Modifier name must be an identifier",v.start);q[w.name]=v.args[1]}else f.push(v);k.oper=k.name.toLowerCase()+"$"+k.args.length}else if("||"===q)if(1===m.length)c.push({ctype:"function",oper:"abs_infix",args:m,modifs:{}});else if(2===m.length)c.push({ctype:"function",oper:"dist_infix",args:m,modifs:{}});else throw Bb("Don't support |\u2026| with "+m.length+" arguments",f.start);else"{}"===q?c.push({ctype:"function",oper:"genJSON",args:m,modifs:{}}):"[]"!==q&&1===m.length?
c.push({ctype:"paren",args:m}):0===m.length?c.push({ctype:"list",value:[]}):c.push({ctype:"function",oper:"genList",args:m,modifs:{}});break;case "EOF":break a}}for(c.length&1||c.push(null);3<=c.length;)Jd(c);return{expr:c[0],closedBy:f}}function ed(a){this.usedFunctions={};this.usedVariables={}}function L(a){if(void 0===a)return A;if("infix"===a.ctype)return a.impl(a.args,{},a);if("variable"===a.ctype)return L(V.getvar(a.name));if("function"===a.ctype)return Ke.push(a),a=M.evaluate(a.oper,a.args,
a.modifs),Ke.pop(),a;if("void"===a.ctype)return A;if("field"===a.ctype){var b=L(a.obj);if("geo"===b.ctype){var c=$a._helper.self;$a._helper.self=b;a=L(la.getField(b.value,a.key));$a._helper.self=c;return a}return"list"===b.ctype?(c=$a._helper.self,$a._helper.self=b,a=h.getField(b,a.key),$a._helper.self=c,a):"JSON"===b.ctype?(c=$a._helper.self,$a._helper.self=b,a=L($a.getField(b,a.key)),$a._helper.self=c,a):A}return"userdata"===a.ctype?(b=L(a.obj),a=p.string(Ea(L(a.key))),"_?_"===a.value&&(a=A),"geo"===
b.ctype?(c=$a._helper.self,$a._helper.self=b,a=L(la.getuserData(b.value,a)),$a._helper.self=c,a):"list"===b.ctype||"string"===b.ctype?(c=$a._helper.self,$a._helper.self=b,a=L(la.getuserData(b,a)),$a._helper.self=c,a):"JSON"===b.ctype?(c=$a._helper.self,$a._helper.self=b,a=L($a.getField(b,a.value)),$a._helper.self=c,a):A):a}function Y(a){a=L(a);if("geo"===a.ctype){var b=a.value;if("P"===b.kind)return la.getField(b,"xy");if("V"===b.kind)return b.value}return a}function Fa(a){a=L(a);if("geo"===a.ctype){var b=
a.value;if("P"===b.kind||"L"===b.kind)return la.getField(b,"homog")}return h._helper.isNumberVecN(a,3)?a:h._helper.isNumberVecN(a,2)?(b=h.turnIntoCSList([a.value[0],a.value[1],n.real(1)]),a.usage&&(b=p.withUsage(b,a.usage)),b):A}function Bc(a){var b=new ed;b.usedFunctions=rd;b.infixmap=I;a=b.parse(a);for(var c in b.usedVariables)V.create(c);return a}function Yc(a,b){return{ctype:"infix",args:[],impl:function(){Ke=[{oper:b}];var c=L(a);Ke=[];return c}}}function xb(a){Qb.err(a+Ke.map(function(b){return"  at "+
b.oper}).join("\n"))}function Pe(){this._path=[];this._defs=["<defs>"];this._imgcache=[];this._body=[];this._saveStack=[""];this._clipIndex=0;this._stroke=this._fill="#000";this._strokeOpacity=this._fillOpacity=null;this.height=this.width=0;this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10;this.globalAlpha=1}function Qe(){this._body=[];this._yPos=this._xPos=NaN;this._extGState={Af255:"<< /ca 1 >>",As255:"<< /CA 1 >>"};this._objects=[["%PDF-1.4\n"]];this._offset=this._objects[0][0].length;
this._nextIndex=5;this._imgcache=[];this._xobjects={};this._pathUsed=-1;this._fillAlpha=this._strokeAlpha=this._globalAlpha=1;this.height=this.width=0;this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10}function qe(a,b){var c=a.width,d=a.height,f=document.createElement("canvas");f.setAttribute("width",c);f.setAttribute("height",d);f.setAttribute("style","display:none;");var k=Vb.canvas;k.parentNode.insertBefore(f,k.nextSibling);try{return f.getContext("2d").drawImage(a,0,
0,c,d),f.toDataURL(b||"image/png")}finally{f.parentNode.removeChild(f)}}function Re(a){a=a.replace(RegExp("[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/]+","g"),"");var b=new Uint8Array(3*a.length>>2),c,d;for(d=c=0;c+3<a.length;c+=4){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c));var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+1));var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+
2));var q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+3));b[d++]=f<<2|k>>4;b[d++]=k<<4|m>>2;b[d++]=m<<6|q}switch(a.length-c){case 0:break;case 2:f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c));k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+1));b[d++]=f<<2|k>>4;break;case 3:f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c));k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+
1));m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+2));b[d++]=f<<2|k>>4;b[d++]=k<<4|m>>2;break;default:throw Error("Malformed Base64 input: "+(a.length-c)+" chars left: "+a.substr(c));}if(d!==b.length)throw Error("Failed assertion: "+d+" should be "+b.length);return b}function Se(a){function b(q){return(a[q]<<24|a[q+1]<<16|a[q+2]<<8|a[q+3])>>>0}if(57>a.length)throw Error("Too short to be a PNG file");if(2303741511!==b(0)||218765834!==b(4))throw Error("PNG signature missing");
for(var c=[],d=8;d<a.length;){if(d+12>a.length)throw Error("Incomplete chunk at offset 0x"+d.toString(16));var f=b(d);if(2147483648<=f)throw Error("Chunk too long");var k=d+12+f;if(k>a.length)throw Error("Incomplete chunk at offset 0x"+d.toString(16));var m=a.subarray(d+4,d+8);m=String.fromCharCode.apply(String,m);c.push({len:f,type:m,data:a.subarray(d+8,d+8+f),crc:b(d+8+f)});d=k}return c}function Cc(a,b){var c;if(c=/^rgba\(([0-9.]+), *([0-9.]+), *([0-9.]+), *([0-9.]+)\)$/.exec(a))b(+c[1],+c[2],+c[3],
+c[4]);else if(c=/^rgb\(([0-9.]+), *([0-9.]+), *([0-9.]+)\)$/.exec(a))b(+c[1],+c[2],+c[3],1);else throw Error("Can't handle color style "+a);}function re(a){var b=1;Object.keys(Jc).forEach(function(c){var d=Jc[c].value.img;if(void 0===d.cachedDataURL&&d.src)if("data:"===d.src.substr(0,5))d.cachedDataURL=d.src;else{++b;d.cachedDataURL=null;var f=new XMLHttpRequest;f.responseType="blob";f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE)if(200===f.status){var k=new FileReader;k.onloadend=
function(){d.cachedDataURL=k.result;console.log("Cached data for image "+d.src);0===--b&&a()};k.readAsDataURL(f.response)}else console.error("Failed to load "+d.src+": "+f.statusText),0===--b&&a()};f.open("GET",d.src,!0);f.send()}});0===--b&&a()}function Dc(a,b,c){for(c||(c="0");a.length<b;)a=c+a;return a}function Qc(){null!==Le&&(window.URL.revokeObjectURL(Le),Le=null)}function Kd(a,b){re(function(){var c=Q;try{Q=new a;Q.width=pb;Q.height=rb;ca();var d=Q.toBlob();Le=window.URL.createObjectURL(d);
Hf(Le,b)}finally{Q=c}})}function yd(a){var b=null,c=1E6;console.log("getElementAtMouse");for(var d=$jscomp.makeIterator(G.gslp),f=d.next();!f.done;f=d.next())if(f=f.value,!f.pinned&&!1!==f.visible&&!0!==f.tmp){var k=void 0,m=void 0,q=void 0,v=P.drawingstate.matrix.sdet;if("P"===f.kind){q=h.normalizeZ(f.homog);if(!h._helper.isAlmostReal(q))continue;k=q.value[0].value.real-a.x;m=q.value[1].value.real-a.y;q=Math.sqrt(k*k+m*m);f.narrow&q>20/v&&(q=1E4)}else if("C"===f.kind)m=G.csnames[f.args[0]],q=0,"undefined"!==
typeof f.radius&&(q=f.radius.value.real),k=n.div(m.homog.value[0],m.homog.value[2]).value.real,m=n.div(m.homog.value[1],m.homog.value[2]).value.real,k-=a.x,m-=a.y,q=Math.sqrt(k*k+m*m)-q,m=k=0,0>q&&(q=-q),q+=30/v;else if("L"===f.kind||"S"===f.kind)k=f.homog,q=n,m=q.add(q.mult(k.value[0],q.conjugate(k.value[0])),q.mult(k.value[1],q.conjugate(k.value[1]))),m=h.scaldiv(q.sqrt(m),k),q=m.value[0].value.real*a.x+m.value[1].value.real*a.y+m.value[2].value.real,k=m.value[0].value.real*q,m=m.value[1].value.real*
q,0>q&&(q=-q),q+=1;if(q<c+.2/v){c=q;b=f;var w={x:k,y:m}}}return null===b?null:{mover:b,offset:w,prev:{x:a.x,y:a.y}}}function xc(){return"P"+Lf++}function fd(a){var b=ia[Cf].actions;b[he].event===a&&b[he].do()&&(F(),he===b.length-1?(lc=[],he=Vc=0):he++)}function Ld(a){return a&&.5>Math.abs(a.offset.x)&&.5>Math.abs(a.offset.y)&&!a.mover.tmp}function se(a){return Ld(a)&&("L"===a.mover.kind||"S"===a.mover.kind)}function te(a){wb={mover:a,offset:{x:0,y:0},prev:{x:hb.x,y:hb.y}}}function ic(){var a=yd(hb);
Ld(a)&&"P"===a.mover.kind?lc[Vc]=a.mover:(lc[Vc]={type:"Free",name:xc(),labeled:!0,pos:[Cb[0],Cb[1],1]},jc(lc[Vc]));Vc++}function Te(){var a=yd(hb);return se(a)?(lc[Vc]=a.mover,Vc++,!0):!1}function Ue(){var a=yd(hb);return se(a)||Ld(a)&&"C"===a.mover.kind?(lc[Vc]=a.mover,Vc++,!0):!1}function gd(){var a=yd(hb);if(Ld(a)&&"P"===a.mover.kind){Me.args[1]=a.mover.name;a=$jscomp.makeIterator(G.gslp);for(var b=a.next();!b.done;b=a.next())b=b.value,!0===b.tmp&&Nd(b.name)}else for(a=$jscomp.makeIterator(G.gslp),
b=a.next();!b.done;b=a.next())b=b.value,!0===b.tmp&&(b.tmp=!1)}function Md(a){var b={type:"Free",name:xc(),labeled:!0,pos:[Cb[0],Cb[1],1],tmp:!0};b=jc(b);Me=jc({type:a,name:xc(),labeled:!0,args:[lc[0].name,b.name]});te(b)}function qf(a){for(var b in a)null!==a[b]&&(zb[b]=a[b])}function rf(a){Object.keys(u).forEach(function(b){var c=u[b];yc(c.signature||"_helper"===b,b+" has no signature");void 0!==c.updatePosition&&void 0===c.stateSize&&(c.stateSize=0)});G.gslp=[];G.csnames={};G.points=[];G.lines=
[];G.conics=[];G.texts=[];G.free=[];G.polygons=[];G.ifs=[];G.sets={points:[],lines:[],conics:[]};a.forEach(function(b,c){ve(b);try{Gc(b)}catch(d){console.error(d)}});Be()}function Ve(a){"undefined"===typeof a.tracedim&&(a.tracedim=1);"undefined"===typeof a.tracelength&&(a.tracelength=100);"undefined"===typeof a.traceskip&&(a.traceskip=1);a._traces=Array(a.tracelength);a._traces_index=0;a._traces_tick=0}function We(a){void 0===a.size&&(a.size=zb.pointSize);a.size=n.real(a.size);!a.movable||a.pinned?
(a.color=h.realVector(a.color||zb.pointColor),a.color=h.scalmult(n.real(zb.dimDependent),a.color)):a.color=h.realVector(a.color||zb.pointColor);void 0===a.alpha&&(a.alpha=zb.alpha);a.alpha=n.real(a.alpha);"boolean"!==typeof a.noborder&&(a.noborder=zb.noborder);a.noborder=p.bool(a.noborder);"boolean"!==typeof a.border&&(a.border=!zb.noborder);a.border=p.bool(a.border);a.drawtrace&&Ve(a)}function hd(a){void 0===a.size&&(a.size=zb.lineSize);a.size=n.real(a.size);a.color=h.realVector(a.color||zb.lineColor);
void 0===a.alpha&&(a.alpha=zb.alpha);a.alpha=n.real(a.alpha);a.clip=p.string(a.clip||zb.clip);void 0===a.overhang&&(a.overhang=zb.overhangLine);a.overhang=n.real(a.overhang);a.dashtype&&(a.dashtype=p.wrap(a.dashtype))}function Xe(a){void 0===a.overhang&&(a.overhang=zb.overhangSeg);a.arrow&&(a.arrow=p.bool(a.arrow));a.arrowsize&&(a.arrowsize=n.real(a.arrowsize));a.arrowposition&&(a.arrowposition=n.real(a.arrowposition));a.arrowshape&&(a.arrowshape=p.string(a.arrowshape));a.arrowsides&&(a.arrowsides=
p.string(a.arrowsides));hd(a);a.clip=p.string("end")}function Ec(a){a.size=void 0!==a.textsize?a.textsize:zb.textsize;a.size=n.real(+a.size)}function ue(a){a.filled=void 0!==a.filled?p.bool(a.filled):p.bool(!0);a.fillcolor=void 0===a.fillcolor?A:h.realVector(a.fillcolor);void 0===a.fillalpha&&(a.fillalpha=0);a.fillalpha=n.real(a.fillalpha);hd(a)}function jc(a,b){a=ve(a);try{sb(a),Gc(a)}catch(c){console.error(c)}Be();return"boolean"===typeof b&&b&&a.Duplicate?(b=a.Duplicate,console.log("duplication detected: removing "+
a.name+" (type "+a.kind+") (duplicate of "+b.name+")."),Nd(a.name),b):a}function ve(a){if(void 0!==G.csnames[a.name]){console.log("Element name '"+a.name+"' already exists");var b=G.csnames[a.name];u[b.type].isMovable&&"P"===u[b.type].kind&&Zb(b,a.pos,"homog");return b}for(;ie.hasOwnProperty(a.type);)a.type=ie[a.type];if(b=Df[a.type]){var c=b(a),d=null;for(b=0;b<c.length;++b)d=jc(c[b]);return d}var f=u[a.type];c=!1;if(!f)return console.error(a),console.error("Operation "+a.type+" not implemented yet"),
null;if("**"!==f.signature)if(!Array.isArray(f.signature)&&"*"===f.signature.charAt(1))c=!0,a.args.forEach(function(k){if(G.csnames[k].kind!==f.signature.charAt(0))return console.error("Not all elements in set are of same type: "+a.name+" expects "+f.signature+" but "+k+" is of kind "+G.csnames[k].kind),"undefined"!==typeof window&&window.alert("Not all elements in set are of same type: "+a.name),null});else if(f.signature.length!==(a.args?a.args.length:0))return console.error("Wrong number of arguments for "+
a.name+" of type "+a.type),"undefined"!==typeof window&&window.alert("Wrong number of arguments for "+a.name),null;if(a.args)for(b=0;b<a.args.length;++b){if(!G.csnames.hasOwnProperty(a.args[b]))return console.log("Dropping "+a.name+" due to missing argument "+a.args[b]),null;if("**"!==f.signature&&!c&&(d=G.csnames[a.args[b]].kind,f.signature[b]!==d&&("S"!==d||"L"!==f.signature[b])))return window.alert("Wrong argument kind "+d+" as argument "+b+" to element "+a.name+" of type "+a.type),null}f.signatureConstraints&&
!f.signatureConstraints(a)&&window.alert("signature constraints violated for element "+a.name);G.gslp.push(a);G.csnames[a.name]=a;b=sc.length;a.kind=f.kind;a.stateIdx=b;b+=f.stateSize;a.incidences=[];a.isshowing=!0;a.movable=!1;f.isMovable&&(a.movable=!0,G.free.push(a));"P"===a.kind&&(G.points.push(a),We(a));"L"===a.kind&&(G.lines.push(a),hd(a));"C"===a.kind&&(G.conics.push(a),hd(a));"S"===a.kind&&(G.lines.push(a),Xe(a));"Text"===a.kind&&(G.texts.push(a),Ec(a));"Poly"===a.kind&&(G.polygons.push(a),
ue(a));"IFS"===a.kind&&G.ifs.push(a);/^[P|L|S|C]s$/.test(a.kind)&&G.sets[{P:"points",L:"lines",S:"lines",C:"conics"}[a.kind[0]]].push(a);tf(b);Nb=Kc=sc;sd=!0;f.initialize&&(mc=tc=a.stateIdx,a.param=f.initialize(a),yc(tc===a.stateIdx+f.stateSize,"State fully initialized"));mc=tc=a.stateIdx;f.updatePosition(a,!1);yc(mc===a.stateIdx+f.stateSize,"State fully consumed");yc(tc===a.stateIdx+f.stateSize,"State fully updated");sd=!1;Nb=Uc.in;Nb.set(sc);Kc=Uc.out;we(a,f);of={};return G.csnames[a.name]}function Nd(a){if(G.csnames.hasOwnProperty(a)){var b=
{};Object.keys(G.csnames).forEach(function(d){var f=G.csnames[d];f.hasOwnProperty("args")&&f.args.forEach(function(k){b.hasOwnProperty(k)||(b[k]={});b[k][d]=!0})});var c=function(d,f){f[d]=!0;if(!b.hasOwnProperty(d))return f;for(var k in b[d])f[k]||c(k,f);return f};a=c(a,{});sf(a)}else console.log("removeElement: name "+a+"does not exist.")}function sf(a){var b=Object.keys(a),c=function(k,m){return function(q){return k[q.name]?!1:!0}},d={};b.forEach(function(k){G.csnames[k].incidences.forEach(function(m){d[m]||
(G.csnames[m].incidences=G.csnames[m].incidences.filter(function(q){return!a[q]}),d[m]=!0)})});"conics free gslp ifs lines points polygons texts".split(" ").map(function(k){G[k]=G[k].filter(c(a,k))});for(var f in G.sets)G.sets[f]=G.sets[f].filter(c(a,"set of "+f));b.forEach(function(k){delete G.csnames[k]});of={}}function Ye(a,b){var c=G.csnames[b.args[0]].homog,d=G.csnames[b.args[1]].homog;b=a.homog;a=n.div(c.value[0],c.value[2]);c=n.div(c.value[1],c.value[2]);var f=n.div(d.value[0],d.value[2]);
d=n.div(d.value[1],d.value[2]);var k=n.div(b.value[0],b.value[2]);b=n.div(b.value[1],b.value[2]);return n._helper.isAlmostReal(a)&&n._helper.isAlmostReal(c)&&n._helper.isAlmostReal(f)&&n._helper.isAlmostReal(d)&&n._helper.isAlmostReal(k)&&n._helper.isAlmostReal(b)?(a=a.value.real,c=c.value.real,f=f.value.real,d=d.value.real,k=k.value.real,b=b.value.real,a=Math.sqrt((a-f)*(a-f)+(c-d)*(c-d))-Math.sqrt((a-k)*(a-k)+(c-b)*(c-b))-Math.sqrt((f-k)*(f-k)+(d-b)*(d-b)),1E-15>a*a):!1}function we(a,b){a.isshowing=
!0;if(a.args)for(var c=0;c<a.args.length;c++)if(!G.csnames[a.args[c]].isshowing){a.isshowing=!1;return}b.visiblecheck&&b.visiblecheck(a)}function zd(a,b,c,d,f){var k=a.textsize||zb.textsize,m=!0===a.textbold,q=!0===a.textitalics,v=a.text_fontfamily||zb.fontFamily,w=d.x*d.x+d.y*d.y,x=1;0<w&&(x=1+a.size.value.real/Math.sqrt(w));a=a.alpha||n.real(zb.alpha);M.drawtext([c,p.wrap(b)],{xoffset:p.wrap(x*d.x),yoffset:p.wrap(x*d.y),size:p.wrap(k),bold:p.wrap(m),italics:p.wrap(q),family:p.wrap(v),color:f,alpha:a})}
function Ze(a){a._bbox=null;if(a.isshowing&&!1!==a.visible){var b={size:a.size},c=a.homog,d=a.text,f=u[a.type].getText;d=f?f(a):d.replace(/@[$#]"([^"\\]|\\.)*"/g,function(w){try{var x=JSON.parse(w.substring(2));var B=G.csnames[x];if(!B)return"?"}catch(E){return"?"}switch(w.charAt(1)){case "$":return B.printname||x;case "#":return"P"===B.kind?Ea(la.getField(B,"xy")):"V"==B.kind?Ea(B.value):B.value}});f=null;if(a.html){var k=a._textCache||{text:!1},m=a.html,q=m.parentNode,v=q.parentNode;f=function(w,
x,B,E,J){x/=yb;B/=yb;J=N.bold+N.italics+Math.round(J/yb*10)/10+"px "+N.family;k.invisible&&v.style.removeProperty("display");if(w!==k.text||J!==k.font||x!==k.x||B!==k.y||E!==k.align){J!==k.font&&(m.style.font=J,m.style.lineHeight=zb.lineHeight);w!==k.text&&!1!==w&&!1===Sd(m,w,J)&&(w=!1);v.style.left=x+"px";v.style.top=B+"px";if(E||q.style.transform)q.style.transform="translateX("+-100*E+"%)";a._textCache={text:w,font:J,x:x,y:B,align:E}}}}d=p.string(d);a.dock&&(a.dock.to?c=G.csnames[a.dock.to].homog:
If.hasOwnProperty(a.dock.corner)&&(c=z.screenbounds$0([],{}),c=c.value[If[a.dock.corner]]),b.offset=a.dock.offset);a.align&&(b.align=p.string(a.align));c&&(a._bbox=M.drawtext([c,d],b,f))}else a.html&&(a.html.parentNode.parentNode.style.display="none",a._textCache={invisible:!0})}function $e(){function a(){var v=q++/c._traces.length,w=c._traces[m];w&&(v*=d*v*v,z.draw$1([w],{size:n.real(f),color:c.color,alpha:n.real(v)}));f*=k}for(var b=0;b<G.points.length;b++){var c=G.points[b];if(c.drawtrace){c._traces_tick===
c.traceskip?(c._traces[c._traces_index]=c.homog,c._traces_index=(c._traces_index+1)%c._traces.length,c._traces_tick=0):c._traces_tick++;var d=c.alpha.value.real,f=c.size.value.real,k=1;1!==c.tracedim&&(f*=c.tracedim,k=Math.pow(c.tracedim,-1/c._traces.length));var m,q=0;for(m=c._traces_index;m<c._traces.length;++m)a();for(m=0;m<c._traces_index;++m)a()}}}function yc(a,b){b="Assertion failed: "+b;if(!a)throw console.log(b),Kb(),"undefined"!==typeof alert&&alert(b),Error(b);}function tf(a){if(a!==sc.length){var b,
c=Ef.length;if(td.length<a*c){var d=2*a;td=new Float64Array(c*d)}else d=td.length/c|0;for(b=0;b<c;++b)Uc[Ef[b]]=td.subarray(b*d,b*d+a);a=sc;Nb=Uc.in;Kc=Uc.out;sc=Uc.good;sc.set(a)}}function Zc(){sc.set(Nb);zc=!1;ye(!1);for(var a=sc.length,b=Math.abs,c=0;c<a;c+=2)b(sc[c])>1E12*b(sc[c+1])&&(sc[c+1]=0)}function Od(){if(je)zc=!0;else throw Jf;}function xe(a,b,c,d,f){return p.add(d,p.mult(c,p.sub(f,d)))}function uf(){wa&&(wa.currentMouseAndScripts=[]);Ff=!0;if(wb){var a=wb.mover,b=h.realVector([hb.x+wb.offset.x,
hb.y+wb.offset.y,1]);af(a,b,"mouse");wb.prev.x=hb.x;wb.prev.y=hb.y}L(Ba.move);L(Ba.draw);zc||Zc();Ff=!1;wa&&(wa.fullLog.push(h.turnIntoCSList([h.turnIntoCSList(wa.currentMouseAndScripts)])),wa.length>wa.logLength&&wa.splice(0,wa.length-wa.logLength),wa.currentMouseAndScripts=null,wa.postMouseHooks.forEach(function(c){c()}))}function Zb(a,b,c){af(a,b,c);Ff||zc||Zc()}function af(a,b,c){wa&&wa.currentMouseAndScripts&&(wa.currentMover=[]);a===Kf?(Nb.set(sc),zc=!1):(Kf=a,Zc());Kc.set(Nb);var d=1E4;var f=
of[a.name];if(!f){var k={},m=0;f=[];k[a.name]=a;for(var q=$jscomp.makeIterator(G.gslp),v=q.next();!v.done;v=q.next()){v=v.value;var w=v.args;if(w){w=$jscomp.makeIterator(w);for(var x=w.next();!x.done;x=w.next())k.hasOwnProperty(x.value)&&(k[v.name]=v,f[m++]=v)}}of[a.name]=f}k=-1;m=.9;var B;q=u[a.type];v=q.parameterPath||xe;mc=a.stateIdx;w=q.getParamFromState(a);mc=tc=a.stateIdx;x=q.getParamForInput(a,b,c);for(var E=k+m;k!==E;){var J=E*E,W=.5/(1+J);W=n.complex(2*E*W+.5,(1-J)*W);je=k+.5*m<=k||0===d;
0===d&&console.log("tracing limit Reached");J=!1;wa&&wa.currentMouseAndScripts&&(wa.currentStep=[]);try{mc=tc=a.stateIdx;var R=v(a,E,W,w,x);wa&&(wa.currentParam=R);W=Kc;Kc=Nb;q.putParamToState(a,R);Kc=W;tc=a.stateIdx;wa&&(wa.currentElement=a);q.updatePosition(a,!0);yc(mc===a.stateIdx+q.stateSize,"State fully consumed");yc(tc===a.stateIdx+q.stateSize,"State fully updated");for(B=0;B<f.length;++B){var ea=f[B];var X=u[ea.type];mc=tc=ea.stateIdx;wa&&(wa.currentElement=ea);X.updatePosition(ea,!1);yc(mc===
ea.stateIdx+X.stateSize,"State fully consumed");yc(tc===ea.stateIdx+X.stateSize,"State fully updated")}wa&&(wa.currentElement=null);k=E;m*=1.25;E+=m;1<=E&&(E=1);Kc=Nb;Nb=W}catch(oa){if(oa!==Jf)throw oa;m*=.5;E=k+m;--d;J=!0}wa&&wa.currentMouseAndScripts&&(wa.currentMover.push(h.turnIntoCSList([h.turnIntoCSList(wa.currentStep),p.wrap(J),p.wrap(k),p.wrap(E),p.wrap(wa.currentParam)])),wa.currentStep=null,wa.currentParam=null)}ye(zc);for(B=0;B<f.length;++B)ea=f[B],X=u[ea.type],we(ea,X);wa&&wa.currentMouseAndScripts&&
(wa.currentMouseAndScripts.push(h.turnIntoCSList([h.turnIntoCSList(wa.currentMover),p.wrap(zc),p.wrap(a.name),b,p.wrap(c),w,x])),wa.currentMover=null)}function bf(){Zc();je=!0;for(var a=$jscomp.makeIterator(G.gslp),b=a.next();!b.done;b=a.next()){b=b.value;var c=u[b.type];mc=tc=b.stateIdx;c.updatePosition(b,!1);we(b,c)}a=Kc;Kc=Nb;Nb=a;Zc()}function ye(a){var b=Z.tracingStateReport;"string"===typeof b&&(document.getElementById(b).textContent=a?"BAD":"GOOD")}function vf(){return h.turnIntoCSList(wa.fullLog.slice())}
function wf(a){var b=JSON.stringify(wa.fullLog);a=new Blob([b],{type:a?"application/octet-stream":"application/json"});return window.URL.createObjectURL(a)}function id(){var a=mc;mc+=2;return n.complex(Nb[a],Nb[a+1])}function fb(a){for(var b=Array(a),c=0;c<a;++c)b[c]=id();return h.turnIntoCSList(b)}function Fc(a){Kc[tc]=a.value.real;Kc[tc+1]=a.value.imag;tc+=2}function Ta(a){for(var b=0,c=a.value.length;b<c;++b)Fc(a.value[b])}function pc(a,b){var c=fb(3),d=fb(3);a=ze(a,b,c,d);Ta(a[0]);Ta(a[1]);return h.turnIntoCSList(a)}
function ze(a,b,c,d){if(sd)return[a,b];var f=h.projectiveDistMinScal(c,a),k=h.projectiveDistMinScal(c,b),m=h.projectiveDistMinScal(d,a),q=h.projectiveDistMinScal(d,b),v=h.projectiveDistMinScal(c,d),w=h.projectiveDistMinScal(a,b),x=f+q,B=k+m;if(x>B){var E=[b,a];x=B}else E=[a,b];B=function(){};if(wa&&wa.currentStep){var J=[wa.labelTracing2,p.wrap(wa.currentElement.name),h.turnIntoCSList(E),h.turnIntoCSList([c,d]),h.realMatrix([[f,k],[m,q]]),p.wrap(x),p.wrap(v),p.wrap(w),A];wa.currentStep.push(h.turnIntoCSList(J));
B=function(W){wa.hasOwnProperty(W)||(wa[W]=p.wrap(W));J[J.length-1]=wa[W]}}h._helper.isNaN(a)||h._helper.isNaN(b)?(B("Tracing failed due to NaNs."),zc=!0):v>3*x&&w>3*x?B("Normal case, everything all right."):1E-5>w?1E-5>v?B("Staying inside singularity."):(B("Moved into singularity."),zc=!0):1E-5>v?B("Moved out of singularity."):(je?B("Reached refinement limit, giving up."):B("Need to refine."),Od());return E}function Ae(a,b,c,d){var f=fb(3),k=fb(3),m=fb(3),q=fb(3);a=xf(a,b,c,d,f,k,m,q);Ta(a[0]);Ta(a[1]);
Ta(a[2]);Ta(a[3]);return h.turnIntoCSList(a)}function xf(a,b,c,d,f,k,m,q){var v=function(){};f=[f,k,m,q];a=[a,b,c,d];if(sd)return a;k=0;d=Array(4);for(c=0;4>c;c++)for(d[c]=Array(4),q=0;4>q;q++)m=h.projectiveDistMinScal(f[c],a[q]),d[c][q]=m;m=Lc(d);b=Array(4);for(c=0;4>c;++c)b[c]=a[m[c]],k+=d[c][m[c]];var w=1*k,x=Infinity,B=Infinity;for(c=0;4>c;c++){if(h._helper.isNaN(a[c]))return v("Tracing failed due to NaNs."),zc=!0,b;for(q=c+1;4>q;q++)m=h.projectiveDistMinScal(f[c],f[q]),x>m&&(x=m),m=h.projectiveDistMinScal(b[c],
b[q]),B>m&&(B=m)}if(wa&&wa.currentStep){var E=[wa.labelTracing4,p.wrap(wa.currentElement.name),h.turnIntoCSList(b),h.turnIntoCSList(f),h.realMatrix(d),p.wrap(k),p.wrap(x),p.wrap(B),A];wa.currentStep.push(h.turnIntoCSList(E));v=function(J){wa.hasOwnProperty(J)||(wa[J]=p.wrap(J));E[E.length-1]=wa[J]}}x>w&&B>w||(1E-5>B?1E-5>x?v("Staying inside singularity."):(v("Moved into singularity."),zc=!0):1E-5>x?v("Moved out of singularity."):(je?v("Reached refinement limit, giving up."):v("Need to refine."),Od()));
return b}function cf(a){var b=a.length,c,d;if(sd){for(c=0;c<b;++c)mc+=2*a[c].value.length,Ta(a[c]);return a}var f=Array(b),k=Array(b),m=Array(b),q=99,v=99,w=Array(b);for(c=0;c<b;++c)f[c]=fb(a[c].value.length),k[c]=h.normSquared(f[c]).value.real,m[c]=h.normSquared(a[c]).value.real,w[c]=Array(b);for(c=0;c<b;++c){for(d=0;d<b;++d){var x=h.sesquilinearproduct(f[c],a[d]).value;x=(x.real*x.real+x.imag*x.imag)/(k[c]*m[d]);w[c][d]=1-x}for(d=c+1;d<b;++d)x=h.sesquilinearproduct(f[c],f[d]).value,x=(x.real*x.real+
x.imag*x.imag)/(k[c]*k[d]),q>1-x&&(q=1-x),x=h.sesquilinearproduct(a[c],a[d]).value,x=(x.real*x.real+x.imag*x.imag)/(m[c]*m[d]),v>1-x&&(v=1-x)}x=Lc(w);d=Array(b);k=0;m=!1;for(c=0;c<b;++c){k+=w[c][x[c]];var B=d[c]=a[x[c]];Ta(B);m|=h._helper.isNaN(B)}m|=isNaN(k);a=function(){};if(wa&&wa.currentStep){var E=[wa.labelTracingSesq,p.wrap(wa.currentElement.name),h.turnIntoCSList(d),h.turnIntoCSList(f),h.realMatrix(w),p.wrap(k),p.wrap(q),p.wrap(v),A];wa.currentStep.push(h.turnIntoCSList(E));a=function(J){wa.hasOwnProperty(J)||
(wa[J]=p.wrap(J));E[E.length-1]=wa[J]}}m?(a("Tracing failed due to NaNs."),zc=!0):q>3*k&&v>3*k?a("Normal case, everything all right."):1E-5>v?1E-5>q?a("Staying inside singularity."):(a("Moved into singularity."),zc=!0):1E-5>q?a("Moved out of singularity."):(je?a("Reached refinement limit, giving up."):a("Need to refine."),Od());return d}function jd(a,b){a=u._helper.flattenConicMatrix(a);b=u._helper.flattenConicMatrix(b);var c=fb(6),d=fb(6);b=ze(a,b,c,d);Ta(b[0]);Ta(b[1]);a=u._helper.buildConicMatrix(b[0].value);
b=u._helper.buildConicMatrix(b[1].value);return h.turnIntoCSList([a,b])}function sb(a){if(sb.hasOwnProperty(a.kind))sb[a.kind](a)}function Gc(a){Gc.hasOwnProperty(a.kind)&&(a.incidences=[],Gc[a.kind](a))}function df(a,b){return function(){a.incidences.push(b.name);b.incidences.push(a.name)}}function kd(a,b){return function(){a.Duplicate=b}}function ef(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"point "+a.name+" incident line "+b.name},apply:df(a,b),holds:function(){var c=
h.scaldiv(h.abs(a.homog),a.homog),d=h.scaldiv(h.abs(b.homog),b.homog);return n.abs(h.scalproduct(c,d)).value.real<n.epsbig}}}function ff(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"point "+a.name+" incident conic "+b.name},apply:df(a,b),holds:function(){var c=p.mult(b.matrix,a.homog);c=p.mult(a.homog,c);c=n.abs(c);return c.value.real<n.epsbig}}}function Be(){if(0!==Yb.length){Uc.prover.set(Nb);var a,b=function(){a={};Yb.forEach(function(v){var w;v.getInvolved().forEach(function(x){a[x.name]||
(a[x.name]=!0,w=c(x,{}),w.forEach(function(B){a[B]=!0}))})})},c=function(v,w){v.incidences.forEach(function(x){w[x]||(w[x]=!0,c(G.csnames[x],w))});return Object.keys(w)};b();var d=function(v){return v.holds()};Object.keys(a).forEach(function(v){v=G.csnames[v].args;"undefined"!==typeof v&&v.forEach(function(w){a[w]=!0})});for(var f,k=0;3>k;k++){for(var m in a){var q=G.csnames[m];!q.pinned&&u[q.type].isMovable&&(f=u[q.type].getRandomMove(q),Zb(q,f.value,f.type),Yb=Yb.filter(d))}b()}Nb.set(Uc.prover);
bf();for(b=0;b<Yb.length;++b)Yb[b].apply();Yb=[]}}function Ad(a,b,c){var d=document.createElement("div"),f=document.createElement("img");f.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAPoCAQAAAC1v1zVAAAAGklEQVR42u3BMQEAAADCoPVPbQ0PoAAAgHcDC7gAAVI8ZnwAAAAASUVORK5CYII=";d.className="CindyJS-baseline";d.appendChild(f);f=document.createElement("div");f.className="CindyJS-button";d.appendChild(f);for(var k=2;k<arguments.length;++k)f.appendChild(arguments[k]);ob.parentNode.appendChild(d);a.html=
arguments[arguments.length-1];cc(a.fillalpha)||(a.fillalpha=1);a.fillcolor&&(a.html.style.backgroundColor=N.makeColor(a.fillcolor,a.fillalpha));cc(a.alpha)||(a.alpha=1);a.color&&(a.html.style.color=N.makeColor(a.color,a.alpha));d=F;if(a.script){var m=Bc(a.script);d=function(){L(m);F()}}c.addEventListener(b,d);!Z.keylistener&&(Ba.keydown||Ba.keyup||Ba.keytyped)&&(c.addEventListener("keydown",function(q){9!==q.keyCode&&ka(q,Ba.keydown)}),c.addEventListener("keyup",function(q){ka(q,Ba.keyup)}),c.addEventListener("keypress",
function(q){9!==q.keyCode&&ka(q,Ba.keytyped)}));u.Text.initialize(a)}function kc(){}function Pd(a){if(!/^Select/.test(a.type)&&!u[a.type].isMovable)return null;var b=p.unwrap,c=n.add;switch(a.kind){case "P":case "L":case "Text":return b(a.homog);case "C":return a=a.matrix.value,{xx:b(a[0].value[0]),yy:b(a[1].value[1]),zz:b(a[2].value[2]),xy:b(c(a[0].value[1],a[1].value[0])),xz:b(c(a[0].value[2],a[2].value[0])),yz:b(c(a[1].value[2],a[2].value[1]))};default:return null}}function Qd(a){var b={};b.offset=
p.unwrap(a.offset);a.to&&(b.to=a.to);a.corner&&(b.corner=a.corner);return b}function yf(a){var b={},c={pinned:!1,movable:!0};"P"===a.kind&&We(c);"L"===a.kind&&hd(c);"C"===a.kind&&hd(c);"S"===a.kind&&Xe(c);"Text"===a.kind&&Ec(c);"Poly"===a.kind&&ue(c);Mf.forEach(function(f){if(a.hasOwnProperty(f)){var k=p.unwrap(a[f]),m=p.unwrap(c[f]);null!==k&&void 0!==k&&k!==m&&JSON.stringify(k)!==JSON.stringify(m)&&(b[f]=k)}});if("P"===a.kind&&(!a.movable||a.pinned)&&b.color){var d=n.real(1/zb.dimDependent);b.color=
p.unwrap(h.scalmult(d,a.color))}if(d=Pd(a))b.pos=d;a.dock&&(b.dock=Qd(a.dock));return b}function Ce(){var a=[];G.gslp.forEach(function(b){b.tmp||a.push(yf(b))});return a}function ld(){uc.forEach(function(a){var b=(a.geo||[]).map(function(c){return G.csnames[c]});Oa[a.type].reset(a,b[0],b)})}function md(a){Bf=0!==a.length;uc=[];Rb=[];Gf=[];Oa.Environment.init({});a.forEach(function(b){b.behavior?(b.name&&(b.behavior.geo=[b.name]),b=b.behavior,b.gravity&&(b.gravity=-b.gravity)):c=b.geo;var c=(b.geo||
[]).map(function(k){return G.csnames[k]}),d=c[0],f=Oa[b.type];f?(f.init&&f.init(b,d,c),d&&(d.behavior=b,"Mass"===b.type?Rb.push(d):"Spring"===b.type&&Gf.push(d)),uc.push(b)):(console.error(b),console.error("Behavior "+b.type+" not implemented yet"))})}var Tb=this,Qb,Ba={},Hc=!1,Rd=!0,nd=0,gf=.5,hf=0,$c=10,lf=5/360,zf=.32/lf/1E3*2,Ud=1,$b=0,Fe=0,ad=!1,pd=.2,Ed=!1,Vd=0,Wd=0,yb=1,ob,Xd,cc=Number.isFinite||function(a){return"number"===typeof a&&isFinite(a)},Cb,Q,pb,rb,G,Jc,Yd=A,Ge=A,qc={play:kc,pause:kc,
stop:kc},Zd=null,Fd=function(a,b){var c=[];Fd=function(k,m){c.push({img:k,id:m})};Fd(a,b);var d=Tb.getBaseDir()+"images/Icons.svg",f=new XMLHttpRequest;f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE)if(200!==f.status)console.error("Failed to load CindyJS Icons.svg from "+d+": "+f.statusText);else{var k=f.responseXML,m=k.documentElement,q={},v;for(v=m.firstChild;v;v=w){var w=v.nextSibling;v.nodeType===Node.ELEMENT_NODE&&"http://www.w3.org/2000/svg"===v.namespaceURI&&"g"===v.localName.toLowerCase()&&
(m.removeChild(v),v.setAttribute("style","display:inline"),q[v.getAttribute("id")]=v)}var x=new XMLSerializer;Fd=function(B,E){if(q.hasOwnProperty(E)){E=q[E];m.appendChild(E);try{var J=x.serializeToString(k)}finally{m.removeChild(E)}B.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(J)}};c.forEach(function(B){Fd(B.img,B.id)});c=null}};f.responseType="document";f.open("GET",d);f.send()},He=1,qd=null,Nc=[],Gd=!1,Vb={config:Z,startup:Ya,shutdown:Kb,evokeCS:function(a){a=Bc(a,!1);L(a);F()},
play:Ia,pause:Ob,stop:Sb,evalcs:function(a){return L(Bc(a,!1))},parse:function(a){return Bc(a)},niceprint:Ea,canvas:null},$d=!1,ae=0;Z.use&&Z.use.forEach(function(a){var b=null;Z.plugins&&(b=Z.plugins[a]);b||(b=Tb._pluginRegistry[a]);b||(++ae,console.log("Loading script for plugin "+a),Tb.loadScript(a+"-plugin",a+"-plugin.js",function(){console.log("Successfully loaded plugin "+a);0===--ae&&$d&&Ya()},function(){console.error("Failed to auto-load plugin "+a);0===--ae&&$d&&Ya()}))});Jb.prototype=new Pb;
Gb.prototype=new Pb;ud.prototype=new Pb;var hb={},wb,be="",ce=0,rc=0,Tc={},Wb={};var dc=Z.isNode?process.nextTick:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,0)};var de=null,mf=[0,8,43,6,"gc9c97dd"],Ie=Z.angleUnit||"\u00b0",ee=2*Math.PI,Je=1/ee,Af={rad:ee,"\u00b0":360,deg:360,degree:360,gra:400,grad:400,turn:1,cyc:1,rev:1,rot:1,"\u03c0":2,pi:2,quad:4},
nf=Ie.replace(/\s+/g,""),n={_helper:{roundingfactor:1E4,angleroundingfactor:10,niceround:function(a,b){return Math.round(a*b)/b},niceangle:function(a){var b=Af[nf];if(!b)return n.niceprint(Object.assign({},a,{usage:void 0}));a=n.niceprint(n.realmult(b*Je,a),200<b?n._helper.angleroundingfactor:void 0);return a.includes("i*")?"("+a+")"+Ie:a+Ie},input:function(a){return void 0!=a.r||void 0!=a.i?n.complex(+a.r,+a.i):n.real(+a)},isReal:function(a){return 0===a.value.imag},isZero:function(a){return 0===
a.value.real&&0===a.value.imag},isAlmostZero:function(a){var b=a.value.real;a=a.value.imag;return b<n.eps&&b>-n.eps&&a<n.eps&&a>-n.eps},isAlmostReal:function(a){a=a.value.imag;return a<n.epsbig&&a>-n.epsbig},isNaN:function(a){return isNaN(a.value.real)||isNaN(a.value.imag)},isFinite:function(a){return isFinite(a.value.real)&&isFinite(a.value.imag)},isAlmostImag:function(a){a=a.value.real;return a<n.epsbig&&a>-n.epsbig},seed:"NO",seedrandom:function(a){a-=Math.floor(a);n._helper.seed=.8*a+.1},rand:function(){if("NO"===
n._helper.seed)return Math.random();var a=n._helper.seed;a=1E3*Math.sin(1E3*a);a-=Math.floor(a);return n._helper.seed=a},randnormal:function(){var a=n._helper.rand(),b=n._helper.rand();return Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*b)},isEqual:function(a,b){return a.value.real===b.value.real&&a.value.imag===b.value.imag},isLessThan:function(a,b){return a.value.real<b.value.real||a.value.real===b.value.real&&a.value.imag<b.value.imag},compare:function(a,b){return n._helper.isLessThan(a,b)?-1:
n._helper.isEqual(a,b)?0:1},isAlmostEqual:function(a,b,c){var d=n.eps;"undefined"!==typeof c&&(d=c);c=a.value.real-b.value.real;a=a.value.imag-b.value.imag;return c<d&&c>-d&&a<d&&a>-d},get z3a(){return n.complex(-.5,.5*Math.sqrt(3))},get z3b(){return n.complex(-.5,-.5*Math.sqrt(3))},get cub1(){return{ctype:"list",value:[n.one,n.one,n.one]}},get cub2(){return{ctype:"list",value:[n._helper.z3a,n.one,n._helper.z3b]}},get cub3(){return{ctype:"list",value:[n._helper.z3b,n.one,n._helper.z3a]}},solveCubicHelper:function(a,
b,c,d){var f=a.value.real;a=a.value.imag;var k=b.value.real;b=b.value.imag;var m=c.value.real,q=c.value.imag,v=d.value.real,w=d.value.imag,x=f*m-a*q;c=f*q+a*m;d=4*x-(k*k-b*b);var B=4*c-2*k*b,E=f*k-a*b,J=f*b+a*k,W=d*m-B*q-18*(E*v-J*w);B=d*q+B*m-18*(E*w+J*v);d=27*(f*f-a*a);var R=54*a*f,ea=d*v-R*w,X=d*w+R*v,oa=k*k-b*b,ja=2*k*b,Ca=oa*k-ja*b,Na=oa*b+ja*k,ua=ea+4*Ca;R=X+4*Na;d=27*(W*m-B*q+ua*v-R*w);B=27*(W*q+B*m+ua*w+R*v);ua=Math.sqrt(Math.sqrt(d*d+B*B));R=Math.atan2(B,d);B=ua*Math.sin(R/2);d=ua*Math.cos(R/
2);Ca=-2*Ca+9*(E*m-J*q)-ea+(d*f-B*a);Na=-2*Na+9*(E*q+J*m)-X+(d*a+B*f);d=Math.exp(Math.log(Math.sqrt(Ca*Ca+Na*Na))/3);m=Math.atan2(Na,Ca);R=d*Math.sin(m/3);B=d*Math.cos(m/3);d*=d;m*=2;x=2*oa-6*x;c=2*ja-6*c;ja=-1.5874010519681994*(k*B-b*R);k=-1.5874010519681994*(k*R+b*B);b=1.2599210498948732*d*Math.cos(m/3);m=1.2599210498948732*d*Math.sin(m/3);d=4.762203155904598*(B*f-R*a);B=4.762203155904598*(B*a+R*f);f=d*d+B*B;R=(-x*B+c*d)/f;x=(x*d+c*B)/f;c=R;R=(-ja*B+k*d)/f;ja=(ja*d+k*B)/f;k=R;R=(-b*B+m*d)/f;b=(b*
d+m*B)/f;m=R;return{ctype:"list",value:[n.complex(x,c),n.complex(ja,k),n.complex(b,m)]}},getRangeRand:function(a,b){return Math.random()*(b-a)+a}},niceprint:function(a,b){b=void 0===b?n._helper.roundingfactor:b;if("Angle"===a.usage)return n._helper.niceangle(a);var c=n._helper.niceround(a.value.real,b);a=n._helper.niceround(a.value.imag,b);return 0===a?""+c:0<a?""+c+" + i*"+a:""+c+" - i*"+-a},complex:function(a,b){return{ctype:"number",value:{real:a,imag:b}}},real:function(a){return{ctype:"number",
value:{real:a,imag:0}}},get zero(){return n.real(0)},get one(){return n.real(1)},get infinity(){return n.complex(Infinity,Infinity)},get nan(){return n.complex(NaN,NaN)},argmax:function(a,b){return a.value.real*a.value.real+a.value.imag*a.value.imag<b.value.real*b.value.real+b.value.imag*b.value.imag?b:a},max:function(a,b){return{ctype:"number",value:{real:Math.max(a.value.real,b.value.real),imag:Math.max(a.value.imag,b.value.imag)}}},min:function(a,b){return{ctype:"number",value:{real:Math.min(a.value.real,
b.value.real),imag:Math.min(a.value.imag,b.value.imag)}}},add:function(a,b){return{ctype:"number",value:{real:a.value.real+b.value.real,imag:a.value.imag+b.value.imag}}},sub:function(a,b){return{ctype:"number",value:{real:a.value.real-b.value.real,imag:a.value.imag-b.value.imag}}},neg:function(a){return Object.assign({},a,{ctype:"number",value:{real:-a.value.real,imag:-a.value.imag}})},re:function(a){return{ctype:"number",value:{real:a.value.real,imag:0}}},im:function(a){return{ctype:"number",value:{real:a.value.imag,
imag:0}}},conjugate:function(a){return{ctype:"number",value:{real:a.value.real,imag:-a.value.imag}}},round:function(a){return{ctype:"number",value:{real:Math.round(a.value.real),imag:Math.round(a.value.imag)}}},ceil:function(a){return{ctype:"number",value:{real:Math.ceil(a.value.real),imag:Math.ceil(a.value.imag)}}},floor:function(a){return{ctype:"number",value:{real:Math.floor(a.value.real),imag:Math.floor(a.value.imag)}}},mult:function(a,b){return{ctype:"number",value:{real:a.value.real*b.value.real-
a.value.imag*b.value.imag,imag:a.value.real*b.value.imag+a.value.imag*b.value.real}}},realmult:function(a,b){return{ctype:"number",value:{real:a*b.value.real,imag:a*b.value.imag}}},multiMult:function(a){var b=a[0];if("number"!==b.ctype)return A;for(var c=1;c<a.length;c++){if("number"!==a[c].ctype)return A;b=n.mult(b,a[c])}return b},abs2:function(a){return{ctype:"number",value:{real:a.value.real*a.value.real+a.value.imag*a.value.imag,imag:0}}},abs:function(a){return n.sqrt(n.abs2(a))},inv:function(a){var b=
a.value.real*a.value.real+a.value.imag*a.value.imag;return{ctype:"number",value:{real:a.value.real/b,imag:-a.value.imag/b}}},div:function(a,b){var c=a.value.real;a=a.value.imag;var d=b.value.real;b=b.value.imag;var f=d*d+b*b;return{ctype:"number",value:{real:(c*d+a*b)/f,imag:(a*d-c*b)/f}}},eps:1E-10,epsbig:1E-6,snap:function(a){var b=a.value.real,c=a.value.imag;Math.floor(b+n.eps)!==Math.floor(b-n.eps)&&(b=Math.round(b));Math.floor(c+n.eps)!==Math.floor(c-n.eps)&&(c=Math.round(c));return Object.assign({},
a,{ctype:"number",value:{real:b,imag:c}})},exp:function(a){var b=Math.exp(a.value.real);return{ctype:"number",value:{real:b*Math.cos(a.value.imag),imag:b*Math.sin(a.value.imag)}}},cos:function(a){var b=a.value.real;a=a.value.imag;var c=Math.exp(a),d=c*Math.sin(-b),f=c*Math.cos(-b);c=Math.exp(-a);return{ctype:"number",value:{real:(f+c*Math.cos(b))/2,imag:(d+c*Math.sin(b))/2}}},sin:function(a){var b=a.value.real;a=a.value.imag;var c=Math.exp(a),d=c*Math.sin(-b),f=c*Math.cos(-b);c=Math.exp(-a);return{ctype:"number",
value:{real:-(d-c*Math.sin(b))/2,imag:(f-c*Math.cos(b))/2}}},tan:function(a){var b=n.sin(a);a=n.cos(a);return n.div(b,a)},arccos:function(a){var b=n.mult(a,n.neg(a));b=n.sqrt(n.add(n.real(1),b));a=n.add(n.mult(a,n.complex(0,1)),b);a=n.add(n.mult(n.log(a),n.complex(0,1)),n.real(.5*Math.PI));return Object.assign({},a,{usage:"Angle"})},arcsin:function(a){var b=n.mult(a,n.neg(a));b=n.sqrt(n.add(n.real(1),b));a=n.add(n.mult(a,n.complex(0,1)),b);a=n.mult(n.log(a),n.complex(0,-1));return Object.assign({},
a,{usage:"Angle"})},arctan:function(a){var b=n.log(n.add(n.mult(a,n.complex(0,-1)),n.real(1)));a=n.log(n.add(n.mult(a,n.complex(0,1)),n.real(1)));b=n.mult(n.sub(b,a),n.complex(0,.5));return Object.assign({},b,{usage:"Angle"})},arctan2:function(a,b){if(void 0===b)var c=n.real(Math.atan2(a.value.imag,a.value.real));else n._helper.isReal(a)&&n._helper.isReal(b)?c=n.real(Math.atan2(b.value.real,a.value.real)):(c=n.add(a,n.mult(n.complex(0,1),b)),a=n.sqrt(n.add(n.mult(a,a),n.mult(b,b))),c=n.mult(n.complex(0,
-1),n.log(n.div(c,a))));return Object.assign({},c,{usage:"Angle"})},sqrt:function(a){var b=a.value.real,c=a.value.imag;a=Math.sqrt(Math.sqrt(b*b+c*c));b=Math.atan2(c,b);return{ctype:"number",value:{real:a*Math.cos(b/2),imag:a*Math.sin(b/2)}}},powRealExponent:function(a,b){var c=a.value.real,d=a.value.imag;a=Math.pow(Math.sqrt(c*c+d*d),b);c=Math.atan2(d,c);return{ctype:"number",value:{real:a*Math.cos(c*b),imag:a*Math.sin(c*b)}}},powIntegerExponent:function(a,b){b=Math.round(b);return 0>b?n.powIntegerExponent(n.inv(a),
-b):0===b?n.one:0===b%2?n.powIntegerExponent(n.mult(a,a),b/2):n.mult(a,n.powIntegerExponent(n.mult(a,a),(b-1)/2))},log:function(a){var b=a.value.real;a=a.value.imag;var c=Math.sqrt(b*b+a*a),d=Math.atan2(a,b);0>a&&(d+=2*Math.PI);0===a&&0>b&&(d=Math.PI);d>Math.PI&&(d-=2*Math.PI);return n.snap({ctype:"number",value:{real:Math.log(c),imag:d}})},pow:function(a,b){return n._helper.isZero(b)?n.one:n._helper.isZero(a)?n.zero:[a,b].every(n._helper.isReal)?n.real(Math.pow(a.value.real,b.value.real)):n._helper.isReal(b)?
(b=b.value.real,Number.isInteger(b)?n.powIntegerExponent(a,b):n.powRealExponent(a,b)):n.exp(n.mult(n.log(a),b))},mod:function(a,b){var c=a.value.real,d=b.value.real,f=a.value.imag,k=b.value.imag;c-=Math.floor(c/d)*d;f-=Math.floor(f/k)*k;0===d&&(c=0);0===k&&(f=0);return n.snap(Object.assign({},[a,b].every(function(m){return"Angle"===m.usage})&&{usage:"Angle"},{ctype:"number",value:{real:c,imag:f}}))},solveCubic:function(a,b,c,d){a=n._helper.solveCubicHelper(a,b,c,d);return[h.scalproduct(n._helper.cub1,
a),h.scalproduct(n._helper.cub2,a),h.scalproduct(n._helper.cub3,a)]},getRandReal:function(a,b){a=n._helper.getRangeRand(a,b);return n.real(a)},getRandComplex:function(a,b){var c=n._helper.getRangeRand(a,b);a=n._helper.getRangeRand(a,b);return n.complex(c,a)}},h={_helper:{},turnIntoCSList:function(a){return{ctype:"list",value:a}}};h.EMPTY=h.turnIntoCSList([]);h.asList=function(a){return"list"===a.ctype?a:"number"===a.ctype||"boolean"===a.ctype||"geo"===a.ctype?h.turnIntoCSList([a]):h.EMPTY};h.realVector=
function(a){for(var b=[],c=0;c<a.length;c++)b[c]={ctype:"number",value:{real:a[c],imag:0}};return{ctype:"list",value:b}};h._helper.unitvector=function(a,b){a=h.zerovector(a);a.value[Math.floor(b.value.real-1)]=n.real(1);return a};h.idMatrix=function(a){for(var b=h.zeromatrix(a,a),c=n.real(1),d=0;d<a.value.real;d++)b.value[d].value[d]=c;return b};h._helper.flippedidMatrix=function(a){for(var b=h.zeromatrix(a,a),c=n.real(1),d=0;d<a.value.real;d++)b.value[d].value[a.value.real-d-1]=c;return b};h.println=
function(a){for(var b=[],c=0;c<a.value.length;c++)if("number"===a.value[c].ctype)b[c]=n.niceprint(a.value[c]);else if("list"===a.value[c].ctype)h.println(a.value[c]);else return A;"number"===a.value[0].ctype&&console.log(b)};h.matrix=function(a){return h.turnIntoCSList(a.map(h.turnIntoCSList))};h.realMatrix=function(a){for(var b=a.length,c=Array(b),d=0;d<b;d++)c[d]=h.realVector(a[d]);return h.turnIntoCSList(c)};h.ex=h.realVector([1,0,0]);h.ey=h.realVector([0,1,0]);h.ez=h.realVector([0,0,1]);h.linfty=
h.realVector([0,0,1]);h.ii=h.turnIntoCSList([n.complex(1,0),n.complex(0,1),n.complex(0,0)]);h.jj=h.turnIntoCSList([n.complex(1,0),n.complex(0,-1),n.complex(0,0)]);h.fundDual=h.realMatrix([[1,0,0],[0,1,0],[0,0,0]]);h.fund=h.realMatrix([[0,0,0],[0,0,0],[0,0,1]]);h.sequence=function(a,b){b=Math.floor(b.value.real)+1;var c=[];a=Math.ceil(a.value.real);for(var d=0;a<b;a++,d++)c[d]=n.real(a);return h.turnIntoCSList(c)};h.pairs=function(a){for(var b=[],c=0;c<a.value.length-1;c++)for(var d=c+1;d<a.value.length;d++)b.push({ctype:"list",
value:[a.value[c],a.value[d]]});return{ctype:"list",value:b}};h.triples=function(a){for(var b=[],c=0;c<a.value.length-2;c++)for(var d=c+1;d<a.value.length-1;d++)for(var f=d+1;f<a.value.length;f++)b.push({ctype:"list",value:[a.value[c],a.value[d],a.value[f]]});return{ctype:"list",value:b}};h.cycle=function(a){for(var b=[],c=0;c<a.value.length-1;c++)b[c]={ctype:"list",value:[a.value[c],a.value[c+1]]};b.push({ctype:"list",value:[a.value[a.value.length-1],a.value[0]]});return{ctype:"list",value:b}};h.consecutive=
function(a){for(var b=[],c=0;c<a.value.length-1;c++)b[c]={ctype:"list",value:[a.value[c],a.value[c+1]]};return{ctype:"list",value:b}};h.reverse=function(a){for(var b=Array(a.value.length),c=a.value.length-1,d=0;0<=c;c--,d++)b[d]=a.value[c];return{ctype:"list",value:b}};h.directproduct=function(a,b){for(var c=[],d=0;d<a.value.length;d++)for(var f=0;f<b.value.length;f++)c.push({ctype:"list",value:[a.value[d],b.value[f]]});return{ctype:"list",value:c}};h.concat=function(a,b){for(var c=[],d=0;d<a.value.length;d++)c.push(a.value[d]);
for(a=0;a<b.value.length;a++)c.push(b.value[a]);return{ctype:"list",value:c}};h.prepend=function(a,b){var c=[];c[0]=a;for(a=0;a<b.value.length;a++)c[a+1]=b.value[a];return{ctype:"list",value:c}};h.append=function(a,b){for(var c=[],d=0;d<a.value.length;d++)c[d]=a.value[d];c.push(b);return{ctype:"list",value:c}};h.contains=function(a,b){a=$jscomp.makeIterator(a.value);for(var c=a.next();!c.done;c=a.next())if(M.equals(c.value,b).value)return{ctype:"boolean",value:!0};return{ctype:"boolean",value:!1}};
h.common=function(a,b){for(var c=[],d=0,f=0;f<a.value.length;f++){for(var k=!1,m=a.value[f],q=0;q<b.value.length;q++)k=k||M.equals(m,b.value[q]).value;k&&(c[d]=a.value[f],d++)}return{ctype:"list",value:c}};h.remove=function(a,b){for(var c=[],d=0,f=0;f<a.value.length;f++){for(var k=!1,m=a.value[f],q=0;q<b.value.length;q++)k=k||M.equals(m,b.value[q]).value;k||(c[d]=a.value[f],d++)}return{ctype:"list",value:c}};h.sort1=function(a){a=a.value.slice();a.sort(p.compare);return h.turnIntoCSList(a)};h._helper.isEqual=
function(a,b){return h.equals(a,b).value};h._helper.isLessThan=function(a,b){for(var c=a.value.length,d=b.value.length,f=0;!(f>=c||f>=d)&&p.isEqual(a.value[f],b.value[f]);)f++;return f===c&&f<d?!0:f===d&&f<c||f===c&&f===d?!1:p.isLessThan(a.value[f],b.value[f])};h._helper.compare=function(a,b){return h._helper.isLessThan(a,b)?-1:h._helper.isEqual(a,b)?0:1};h.equals=function(a,b){if(a.value.length!==b.value.length)return{ctype:"boolean",value:!1};for(var c=!0,d=0;d<a.value.length;d++){var f=a.value[d],
k=b.value[d];c="list"===f.ctype&&"list"===k.ctype?c&&h.equals(f,k).value:c&&Ab([f,k],[]).value}return{ctype:"boolean",value:c}};h.almostequals=function(a,b){if(a.value.length!==b.value.length)return{ctype:"boolean",value:!1};for(var c=!0,d=0;d<a.value.length;d++){var f=a.value[d],k=b.value[d];c="list"===f.ctype&&"list"===k.ctype?c&&h.almostequals(f,k).value:c&&hc([f,k],[]).value}return{ctype:"boolean",value:c}};h._helper.isAlmostReal=function(a){var b=!0;a=$jscomp.makeIterator(a.value);for(var c=
a.next();!c.done;c=a.next())c=c.value,b="list"===c.ctype?b&&h._helper.isAlmostReal(c):b&&n._helper.isAlmostReal(c);return b};h._helper.isAlmostZero=function(a){a=$jscomp.makeIterator(a.value);for(var b=a.next();!b.done;b=a.next())if(b=b.value,"list"===b.ctype){if(!h._helper.isAlmostZero(b))return!1}else if(!n._helper.isAlmostZero(b))return!1;return!0};h._helper.isNaN=function(a){var b=!1;a=$jscomp.makeIterator(a.value);for(var c=a.next();!c.done;c=a.next())c=c.value,b="list"===c.ctype?b||h._helper.isNaN(c):
b||n._helper.isNaN(c);return b};h.set=function(a){var b=[],c=0;a=a.value.slice();a.sort(p.compare);for(var d=0;d<a.length;d++)0!==d&&Ab([b[b.length-1],a[d]],[]).value||(b[c]=a[d],c++);return{ctype:"list",value:b}};h.maxval=function(a){var b=n.zero;a=$jscomp.makeIterator(a.value);for(var c=a.next();!c.done;c=a.next())c=c.value,"number"===c.ctype&&(b=n.argmax(b,c)),"list"===c.ctype&&(b=n.argmax(b,h.maxval(c)));return b};h.maxIndex=function(a,b,c){var d=0;void 0!==c&&(d=c);c=d;for(var f=b(a.value[d]).value.real;d<
a.value.length;++d){var k=b(a.value[d]).value.real;k>f&&(c=d,f=k)}return c};h.normalizeMax=function(a){var b=n.inv(h.maxval(a));return n._helper.isFinite(b)?h.scalmult(b,a):a};h.normalizeZ=function(a){var b=n.inv(a.value[2]);return h.scalmult(b,a)};h.dehom=function(a){a=a.value.slice();var b=a.length-1,c=n.inv(a[b]);a.length=b;for(var d=0;d<b;++d)a[d]=n.mult(c,a[d]);return h.turnIntoCSList(a)};h.normalizeAbs=function(a){var b=n.inv(h.abs(a));return h.scalmult(b,a)};h.max=function(a,b){if(a.value.length!==
b.value.length)return A;for(var c=[],d=0;d<a.value.length;d++)c[d]=p.max(a.value[d],b.value[d]);return{ctype:"list",value:c}};h.min=function(a,b){if(a.value.length!==b.value.length)return A;for(var c=[],d=0;d<a.value.length;d++)c[d]=p.min(a.value[d],b.value[d]);return{ctype:"list",value:c}};h.scaldiv=function(a,b){if("number"!==a.ctype)return A;for(var c=[],d=0;d<b.value.length;d++){var f=b.value[d];c[d]="number"===f.ctype?p.div(f,a):"list"===f.ctype?h.scaldiv(a,f):A}return{ctype:"list",value:c}};
h.scalmult=function(a,b){if("number"!==a.ctype)return A;for(var c=[],d=0;d<b.value.length;d++){var f=b.value[d];c[d]="number"===f.ctype?p.mult(f,a):"list"===f.ctype?h.scalmult(a,f):A}return{ctype:"list",value:c}};h.add=function(a,b){if(a.value.length!==b.value.length)return A;for(var c=[],d=0;d<a.value.length;d++){var f=a.value[d],k=b.value[d];c[d]="number"===f.ctype&&"number"===k.ctype?p.add(f,k):"list"===f.ctype&&"list"===k.ctype?h.add(f,k):A}return{ctype:"list",value:c}};h.sub=function(a,b){if(a.value.length!==
b.value.length)return A;for(var c=[],d=0;d<a.value.length;d++){var f=a.value[d],k=b.value[d];c[d]="number"===f.ctype&&"number"===k.ctype?n.sub(f,k):"list"===f.ctype&&"list"===k.ctype?h.sub(f,k):A}return{ctype:"list",value:c}};h.abs2=function(a){var b=0;a=$jscomp.makeIterator(a.value);for(var c=a.next();!c.done;c=a.next())if(c=c.value,"number"===c.ctype)b+=n.abs2(c).value.real;else if("list"===c.ctype)b+=h.abs2(c).value.real;else return A;return{ctype:"number",value:{real:b,imag:0}}};h.abs=function(a){return n.sqrt(h.abs2(a))};
h.normalizeMaxXX=function(a){for(var b=-1E4,c=n.real(1),d=0;d<a.value.length;d++){var f=n.abs(a.value[d]);f.value.real>b&&(c=a.value[d],b=f.value.real)}return h.scaldiv(c,a)};h.recursive=function(a,b){for(var c=[],d=0;d<a.value.length;d++){var f=Y(a.value[d]);c[d]="number"===f.ctype?n[b](f):"list"===f.ctype?h[b](f):A}return{ctype:"list",value:c}};h.re=function(a){return h.recursive(a,"re")};h.neg=function(a){return h.recursive(a,"neg")};h.im=function(a){return h.recursive(a,"im")};h.conjugate=function(a){return h.recursive(a,
"conjugate")};h.transjugate=function(a){return h.transpose(h.conjugate(a))};h.round=function(a){return h.recursive(a,"round")};h.ceil=function(a){return h.recursive(a,"ceil")};h.floor=function(a){return h.recursive(a,"floor")};h._helper.colNumb=function(a){if("list"!==a.ctype)return-1;for(var b=-1,c=0;c<a.value.length;c++){if("list"!==a.value[c].ctype)return-1;if(0===c)b=a.value[c].value.length;else if(b!==a.value[c].value.length)return-1}return b};h._helper.isNumberVecN=function(a,b){if("list"!==
a.ctype||a.value.length!==b)return!1;for(b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return!1;return!0};h.isNumberVector=function(a){if("list"!==a.ctype)return{ctype:"boolean",value:!1};for(var b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};h.isNumberVectorN=function(a,b){if("list"!==a.ctype)return{ctype:"boolean",value:!1};if(a.value)for(b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return{ctype:"boolean",
value:!1};return{ctype:"boolean",value:!0}};h.isNumberMatrix=function(a){if(-1===h._helper.colNumb(a))return{ctype:"boolean",value:!1};for(var b=0;b<a.value.length;b++)if(!h.isNumberVector(a.value[b]).value)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};h._helper.isNumberMatrixMN=function(a,b,c){return h.isNumberMatrix(a).value&&a.value.length===b&&a.value[0].value.length===c};h.scalproduct=function(a,b){if(a.value.length!==b.value.length)return A;for(var c={ctype:"number",value:{real:0,
imag:0}},d=0;d<b.value.length;d++){var f=a.value[d],k=b.value[d];if("number"===f.ctype&&"number"===k.ctype)c=n.add(n.mult(f,k),c);else return A}return c};h.sesquilinearproduct=function(a,b){if(a.value.length!==b.value.length)return A;for(var c=0,d=0,f=0;f<b.value.length;f++){var k=a.value[f].value,m=b.value[f].value;c+=k.real*m.real+k.imag*m.imag;d+=k.real*m.imag-k.imag*m.real}return n.complex(c,d)};h.normSquared=function(a){for(var b=0,c=0;c<a.value.length;c++){var d=a.value[c].value;b+=d.real*d.real+
d.imag*d.imag}return n.real(b)};h.productMV=function(a,b){if(a.value[0].value.length!==b.value.length)return A;for(var c=[],d=0;d<a.value.length;d++){for(var f={ctype:"number",value:{real:0,imag:0}},k=a.value[d],m=0;m<b.value.length;m++){var q=k.value[m],v=b.value[m];if("number"===q.ctype&&"number"===v.ctype)f=n.add(n.mult(q,v),f);else return A}c[d]=f}return h.turnIntoCSList(c)};h.productVM=function(a,b){if(a.value.length!==b.value.length)return A;for(var c=[],d=0;d<b.value[0].value.length;d++){for(var f=
{ctype:"number",value:{real:0,imag:0}},k=0;k<a.value.length;k++){var m=a.value[k],q=b.value[k].value[d];if("number"===m.ctype&&"number"===q.ctype)f=n.add(n.mult(m,q),f);else return A}c[d]=f}return h.turnIntoCSList(c)};h.productMM=function(a,b){if(a.value[0].value.length!==b.value.length)return A;for(var c=[],d=0;d<a.value.length;d++){var f=h.productVM(a.value[d],b);c[d]=f}return h.turnIntoCSList(c)};h.mult=function(a,b){return a.value.length===b.value.length&&h.isNumberVector(a).value&&h.isNumberVector(b).value?
h.scalproduct(a,b):h.isNumberMatrix(a).value&&b.value.length===a.value[0].value.length&&h.isNumberVector(b).value?h.productMV(a,b):h.isNumberMatrix(b).value&&a.value.length===b.value.length&&h.isNumberVector(a).value?h.productVM(a,b):h.isNumberMatrix(a).value&&h.isNumberMatrix(b).value&&b.value.length===a.value[0].value.length?h.productMM(a,b):A};h.projectiveDistMinScal=function(a,b){var c=h.abs(a),d=h.abs(b);if(0===c.value.real||0===d.value.real)return 0;var f=h.conjugate(b);f=h.scalproduct(a,f);
f=n._helper.isAlmostZero(f)?n.real(1):n.div(f,n.abs(f));a=h.scaldiv(c,a);b=h.scaldiv(d,b);b=h.scalmult(f,b);d=h.abs(h.add(a,b));b=h.abs(h.sub(a,b));return Math.min(d.value.real,b.value.real)};h.conicDist=function(a,b){a=eb(a);b=eb(b);return h.projectiveDistMinScal(a,b)};h.crossOperator=function(a){var b=a.value[0],c=a.value[1];a=a.value[2];return h.turnIntoCSList([h.turnIntoCSList([n.zero,n.neg(a),c]),h.turnIntoCSList([a,n.zero,n.neg(b)]),h.turnIntoCSList([n.neg(c),b,n.zero])])};h.cross=function(a,
b){var c=n.sub(n.mult(a.value[1],b.value[2]),n.mult(a.value[2],b.value[1])),d=n.sub(n.mult(a.value[2],b.value[0]),n.mult(a.value[0],b.value[2]));a=n.sub(n.mult(a.value[0],b.value[1]),n.mult(a.value[1],b.value[0]));return h.turnIntoCSList([c,d,a])};h.crossratio3harm=function(a,b,c,d,f){var k=h.det3(a,c,f),m=h.det3(b,d,f);a=h.det3(a,d,f);b=h.det3(b,c,f);k=n.mult(k,m);m=n.mult(a,b);return h.turnIntoCSList([k,m])};h.crossratio3=function(a,b,c,d,f){a=h.crossratio3harm(a,b,c,d,f);return n.div(a.value[0],
a.value[1])};h.veronese=function(a){var b=n.mult(a.value[0],a.value[0]),c=n.mult(a.value[1],a.value[1]),d=n.mult(a.value[2],a.value[2]),f=n.mult(a.value[0],a.value[1]),k=n.mult(a.value[0],a.value[2]);a=n.mult(a.value[1],a.value[2]);return h.turnIntoSCList([b,c,d,f,k,a])};h.matrixFromVeronese=function(a){var b=a.value[0],c=a.value[1],d=a.value[2],f=n.realmult(.5,a.value[3]),k=n.realmult(.5,a.value[4]);a=n.realmult(.5,a.value[5]);return h.turnIntoCSList([h.turnIntoCSList([b,f,k]),h.turnIntoCSList([f,
c,a]),h.turnIntoCSList([k,a,d])])};h.det2=function(a,b){var c=n.mult(a.value[0],b.value[1]);return c=n.sub(c,n.mult(a.value[1],b.value[0]))};h.det3=function(a,b,c){return n.complex(a.value[0].value.real*b.value[1].value.real*c.value[2].value.real-a.value[0].value.imag*b.value[1].value.imag*c.value[2].value.real-a.value[0].value.imag*b.value[1].value.real*c.value[2].value.imag-a.value[0].value.real*b.value[1].value.imag*c.value[2].value.imag+a.value[2].value.real*b.value[0].value.real*c.value[1].value.real-
a.value[2].value.imag*b.value[0].value.imag*c.value[1].value.real-a.value[2].value.imag*b.value[0].value.real*c.value[1].value.imag-a.value[2].value.real*b.value[0].value.imag*c.value[1].value.imag+a.value[1].value.real*b.value[2].value.real*c.value[0].value.real-a.value[1].value.imag*b.value[2].value.imag*c.value[0].value.real-a.value[1].value.imag*b.value[2].value.real*c.value[0].value.imag-a.value[1].value.real*b.value[2].value.imag*c.value[0].value.imag-a.value[0].value.real*b.value[2].value.real*
c.value[1].value.real+a.value[0].value.imag*b.value[2].value.imag*c.value[1].value.real+a.value[0].value.imag*b.value[2].value.real*c.value[1].value.imag+a.value[0].value.real*b.value[2].value.imag*c.value[1].value.imag-a.value[2].value.real*b.value[1].value.real*c.value[0].value.real+a.value[2].value.imag*b.value[1].value.imag*c.value[0].value.real+a.value[2].value.imag*b.value[1].value.real*c.value[0].value.imag+a.value[2].value.real*b.value[1].value.imag*c.value[0].value.imag-a.value[1].value.real*
b.value[0].value.real*c.value[2].value.real+a.value[1].value.imag*b.value[0].value.imag*c.value[2].value.real+a.value[1].value.imag*b.value[0].value.real*c.value[2].value.imag+a.value[1].value.real*b.value[0].value.imag*c.value[2].value.imag,-a.value[0].value.imag*b.value[1].value.imag*c.value[2].value.imag+a.value[0].value.imag*b.value[1].value.real*c.value[2].value.real+a.value[0].value.real*b.value[1].value.real*c.value[2].value.imag+a.value[0].value.real*b.value[1].value.imag*c.value[2].value.real-
a.value[2].value.imag*b.value[0].value.imag*c.value[1].value.imag+a.value[2].value.imag*b.value[0].value.real*c.value[1].value.real+a.value[2].value.real*b.value[0].value.real*c.value[1].value.imag+a.value[2].value.real*b.value[0].value.imag*c.value[1].value.real-a.value[1].value.imag*b.value[2].value.imag*c.value[0].value.imag+a.value[1].value.imag*b.value[2].value.real*c.value[0].value.real+a.value[1].value.real*b.value[2].value.real*c.value[0].value.imag+a.value[1].value.real*b.value[2].value.imag*
c.value[0].value.real+a.value[0].value.imag*b.value[2].value.imag*c.value[1].value.imag-a.value[0].value.imag*b.value[2].value.real*c.value[1].value.real-a.value[0].value.real*b.value[2].value.real*c.value[1].value.imag-a.value[0].value.real*b.value[2].value.imag*c.value[1].value.real+a.value[2].value.imag*b.value[1].value.imag*c.value[0].value.imag-a.value[2].value.imag*b.value[1].value.real*c.value[0].value.real-a.value[2].value.real*b.value[1].value.real*c.value[0].value.imag-a.value[2].value.real*
b.value[1].value.imag*c.value[0].value.real+a.value[1].value.imag*b.value[0].value.imag*c.value[2].value.imag-a.value[1].value.imag*b.value[0].value.real*c.value[2].value.real-a.value[1].value.real*b.value[0].value.real*c.value[2].value.imag-a.value[1].value.real*b.value[0].value.imag*c.value[2].value.real)};h.det4m=function(a){var b=a.value,c=b[0].value,d=c[0].value,f=+d.real,k=+d.imag;d=c[1].value;var m=+d.real,q=+d.imag;d=c[2].value;var v=+d.real,w=+d.imag;d=c[3].value;var x=+d.real,B=+d.imag;
c=b[1].value;d=c[0].value;var E=+d.real,J=+d.imag;d=c[1].value;var W=+d.real,R=+d.imag;d=c[2].value;var ea=+d.real,X=+d.imag;d=c[3].value;c=+d.real;d=+d.imag;a=f*W-k*R-m*E+q*J;var oa=f*R+k*W-m*J-q*E,ja=f*ea-k*X-v*E+w*J,Ca=f*X+k*ea-v*J-w*E,Na=f*c-k*d-x*E+B*J,ua=f*d+k*c-x*J-B*E,Ha=m*ea-q*X-v*W+w*R,Ua=m*X+q*ea-v*R-w*W,Ra=m*c-q*d-x*W+B*R,Ja=m*d+q*c-x*R-B*W,Ka=v*c-w*d-x*ea+B*X,Xa=v*d+w*c-x*X-B*ea;c=b[2].value;d=c[0].value;f=+d.real;k=+d.imag;d=c[1].value;m=+d.real;q=+d.imag;d=c[2].value;v=+d.real;w=+d.imag;
d=c[3].value;x=+d.real;B=+d.imag;c=b[3].value;d=c[0].value;E=+d.real;J=+d.imag;d=c[1].value;W=+d.real;R=+d.imag;d=c[2].value;ea=+d.real;X=+d.imag;d=c[3].value;c=+d.real;d=+d.imag;b=f*W-k*R-m*E+q*J;var ab=f*R+k*W-m*J-q*E,bb=f*ea-k*X-v*E+w*J,ya=f*X+k*ea-v*J-w*E,nb=f*c-k*d-x*E+B*J;f=f*d+k*c-x*J-B*E;k=m*ea-q*X-v*W+w*R;E=m*X+q*ea-v*R-w*W;J=m*c-q*d-x*W+B*R;m=m*d+q*c-x*R-B*W;q=v*c-w*d-x*ea+B*X;v=v*d+w*c-x*X-B*ea;return n.complex(a*q-oa*v-ja*J+Ca*m+Na*k-ua*E+Ha*nb-Ua*f-Ra*bb+Ja*ya+Ka*b-Xa*ab,a*v+oa*q-ja*
m-Ca*J+Na*E+ua*k+Ha*f+Ua*nb-Ra*ya-Ja*bb+Ka*ab+Xa*b)};h.eucangle=function(a,b){var c=h.cross(a,h.linfty);a=h.cross(b,h.linfty);b=h.det3(h.ez,c,h.ii);c=h.det3(h.ez,c,h.jj);var d=h.det3(h.ez,a,h.ii);a=h.det3(h.ez,a,h.jj);b=n.div(n.mult(b,a),n.mult(d,c));b=n.log(b);return b=n.mult(b,n.complex(0,.5))};h.zerovector=function(a){a=Math.floor(a.value.real);for(var b=Array(a),c=0;c<a;c++)b[c]=0;return h.realVector(b)};h.zeromatrix=function(a,b){a=Math.floor(a.value.real);for(var c=Array(a),d=0;d<a;d++)c[d]=
h.zerovector(b);return h.turnIntoCSList(c)};h.vandermonde=function(a){for(var b=a.value.length,c=[],d=0;d<b;d++){for(var f=[],k=0;k<b;k++)f.push(n.pow(a.value[d],n.real(k)));c.push(h.turnIntoCSList(f))}return h.turnIntoCSList(c)};h.transpose=function(a){for(var b=[],c=a.value[0].value.length,d=a.value.length,f=0;f<c;f++){for(var k=[],m=0;m<d;m++)k[m]=a.value[m].value[f];b[f]=h.turnIntoCSList(k)}return h.turnIntoCSList(b)};h.column=function(a,b){var c=[],d=a.value.length;b=Math.floor(b.value.real-
1);for(var f=0;f<d;f++)c[f]=a.value[f].value[b];return h.turnIntoCSList(c)};h.row=function(a,b){var c=[],d=a.value[0].value.length;b=Math.floor(b.value.real-1);for(var f=0;f<d;f++)c[f]=a.value[b].value[f];return h.turnIntoCSList(c)};h.adjoint2=function(a){var b=a.value[0].value[0],c=a.value[1].value[0],d=Array(2);d[0]=h.turnIntoCSList([a.value[1].value[1],n.neg(a.value[0].value[1])]);d[1]=h.turnIntoCSList([n.neg(c),b]);return d=h.turnIntoCSList(d)};h.adjoint3=function(a){var b=a.value[0].value;var c=
b[0].value;var d=c.real;var f=c.imag;c=b[1].value;var k=c.real;var m=c.imag;c=b[2].value;var q=c.real;var v=c.imag;b=a.value[1].value;c=b[0].value;var w=c.real;var x=c.imag;c=b[1].value;var B=c.real;var E=c.imag;c=b[2].value;var J=c.real;var W=c.imag;b=a.value[2].value;c=b[0].value;a=c.real;var R=c.imag;c=b[1].value;var ea=c.real;var X=c.imag;c=b[2].value;b=c.real;c=c.imag;return{ctype:"list",value:[{ctype:"list",value:[{ctype:"number",value:{real:B*b-J*ea-E*c+W*X,imag:B*c-J*X-ea*W+b*E}},{ctype:"number",
value:{real:-k*b+q*ea+m*c-v*X,imag:-k*c+q*X+ea*v-b*m}},{ctype:"number",value:{real:k*J-q*B-m*W+v*E,imag:k*W-q*E-B*v+J*m}}]},{ctype:"list",value:[{ctype:"number",value:{real:-w*b+J*a+x*c-W*R,imag:-w*c+J*R+a*W-b*x}},{ctype:"number",value:{real:d*b-q*a-f*c+v*R,imag:d*c-q*R-a*v+b*f}},{ctype:"number",value:{real:-d*J+q*w+f*W-v*x,imag:-d*W+q*x+w*v-J*f}}]},{ctype:"list",value:[{ctype:"number",value:{real:w*ea-B*a-x*X+E*R,imag:w*X-B*R-a*E+ea*x}},{ctype:"number",value:{real:-d*ea+k*a+f*X-m*R,imag:-d*X+k*R+
a*m-ea*f}},{ctype:"number",value:{real:d*B-k*w-f*E+m*x,imag:d*E-k*x-w*m+B*f}}]}]}};h.inverse=function(a){var b=a.value.length;if(b!==a.value[0].value.length)return console.log("Inverse works only for square matrices"),A;if(2===b)return h.scaldiv(h.det(a),h.adjoint2(a));if(3===b)return h.scaldiv(h.det(a),h.adjoint3(a));b=h.LUdecomp(a);a=a.value.length;var c=n.real(0),d=n.real(1),f=h.zerovector(n.real(a));f.value[0]=d;for(var k=Array(a),m=0;m<a;m++)k[m]=h._helper.LUsolve(b,f),f.value[m]=c,f.value[m+
1]=d;k=h.turnIntoCSList(k);return k=h.transpose(k)};h.linearsolve=function(a,b){return 2===a.value.length?h.linearsolveCramer2(a,b):3===a.value.length?h.linearsolveCramer3(a,b):h.LUsolve(a,b)};h.getDiag=function(a){if(a.value.length!==a.value[0].value.length)return A;for(var b=Array(a.value.length),c=0;c<a.value.length;c++)b[c]=a.value[c].value[c];return h.turnIntoCSList(b)};h.getSubDiag=function(a){if(a.value.length!==a.value[0].value.length)return A;for(var b=Array(a.value.length-1),c=0;c<a.value.length-
1;c++)b[c]=a.value[c+1].value[c];return h.turnIntoCSList(b)};h.eig2=function(a){var b=n.add(a.value[0].value[0],a.value[1].value[1]);a=h.det2(a.value[0],a.value[1]);var c=n.mult(b,b),d=b=n.mult(b,n.real(.5));a=n.sqrt(n.sub(n.div(c,n.real(4)),a));b=n.add(b,a);d=n.sub(d,a);return h.turnIntoCSList([b,d])};h.eig=function(a,b){var c=b||!0,d=a,f=n.real(d.value.length);b=f.value.real;n.real(0);d=h._helper.QRIteration(d)[0];d=h.getDiag(d);d=h.sort1(d);f=h.idMatrix(f,f);var k=Array(b);k=h.turnIntoCSList(k);
if(c){var m,q=0,v=!1;for(c=0;c<b;c++){if(v)var w=x.value[q];else{var x=d.value[c];x=h.sub(a,h.scalmult(x,f));x=h.nullSpace(x);w=x.value[0];void 0!==w&&(m=w)}void 0===w&&(w=m);1E-8>h.abs(w).value.real&&0===q&&(w=h._helper.inverseIteration(a,d.value[c]));k.value[c]=h._helper.isAlmostZeroVec(w)?w:h.scaldiv(h.abs(w),w);c<b-1&&((v=1E-6>n.abs(n.sub(d.value[c],d.value[c+1])).value.real)?q++:q=0)}k=h.transpose(k)}return h.turnIntoCSList([d,k])};h._helper.isNormalMatrix=function(a){return 1E-10>h.abs(h.sub(a,
h.transjugate(a))).value.real};h._helper.QRIteration=function(a,b){var c=n.real(a.value.length),d=c.value.real,f=c.value.real;n.real(0);h.idMatrix(c,c);var k=h.zeromatrix(c,c);c=h.idMatrix(c,c);var m=b?b:2500,q=0,v=Array(f);for(b=0;b<m;b++){var w=h._helper.getBlock(a,[f-2,f-1],[f-2,f-1]);var x=h.eig2(w);w=x.value[0];x=x.value[1];var B=a.value[f-1].value[f-1];var E=n.abs(n.sub(B,w)).value.real;B=n.abs(n.sub(B,x)).value.real;x=E<B?w:x;w=h.idMatrix(n.real(f),n.real(f));x=h.scalmult(x,w);w=h.QRdecomp(h.sub(a,
x));a=p.mult(w.R,w.Q);a=h.add(a,x);w.Q=h._helper.buildBlockMatrix(w.Q,h.idMatrix(n.real(q),n.real(q)));c=p.mult(c,w.Q);if(1E-48>n.abs2(a.value[a.value.length-1].value[a.value[0].value.length-2]).value.real&&1<f){v[d-q-1]=a.value[f-1].value[f-1];for(b=0;b<f;b++)k.value[f-1].value[b]=a.value[f-1].value[b],k.value[b].value[f-1]=a.value[b].value[f-1];a=h._helper.getBlock(a,[0,f-2],[0,f-2]);q++;f--}if(1===f){k.value[0].value[0]=a.value[0].value[0];break}if(h._helper.isUpperTriangular(a)){for(b=0;b<f;b++)k.value[b].value[b]=
a.value[b].value[b];break}}return[k,c]};h.rank=function(a,b){return h.RRQRdecomp(a,b).rank};h._helper.isAlmostZeroVec=function(a){for(var b=a.value.length,c=0;c<b;c++)if(!n._helper.isAlmostZero(a.value[c]))return!1;return!0};h._helper.isLowerTriangular=function(a){for(var b=a.value.length,c=a.value[0].value.length,d=0;d<b;d++)for(var f=d+1;f<c;f++)if(!n._helper.isAlmostZero(a.value[d].value[f]))return!1;return!0};h._helper.isUpperTriangular=function(a){return h._helper.isLowerTriangular(h.transpose(a))};
h.nullSpace=function(a,b){var c=a.value.length;b=h.RRQRdecomp(h.transjugate(a),b);a=h.transpose(b.Q);b=c-b.rank.value.real;var d=Array(b);a.value.reverse();for(var f,k=0;k<b;k++)f=a.value[k],d[k]=h.scaldiv(h.abs(f),f);d=h.turnIntoCSList(d);return 0<d.value.length?d:h.turnIntoCSList([h.zerovector(n.real(c))])};h._helper.isAlmostDiagonal=function(a){var b=a.value.length;n.real(b);n.real(0);if(b!==a.value[0].value.length)return!1;for(var c=0;c<b;c++)for(var d=0;d<b;d++)if(c!==d&&1E-16<n.abs(a.value[c].value[d]).value.real)return!1;
return!0};h._helper.inverseIteration=function(a,b){console.log("warning: code untested");for(var c=a.value.length,d=Array(c),f=0;f<c;f++)d[f]=2*Math.random()-.5;d=h.realVector(d);c=h.idMatrix(n.real(c),n.real(c));b=n.add(b,n.real(.1*Math.random()-.5));for(f=0;100>f;f++)d=h.scaldiv(h.abs(d),d),d=h.LUsolve(h.sub(a,h.scalmult(b,c)),JSON.parse(JSON.stringify(d)));return h.scaldiv(h.abs(d),d)};h._helper.swapEl=function(a,b,c){if("[object Array]"===Object.prototype.toString.call(a)){var d=a[b];a[b]=a[c];
a[c]=d}else"list"===a.ctype&&(d=a.value[b],a.value[b]=a.value[c],a.value[c]=d)};h.RRQRdecomp=function(a,b){var c=Math.sqrt(n.eps);void 0!==b&&(c=.1*b.value.real);b=c*c;var d;c=a.value.length;var f=n.real(c),k=n.real(1),m=h._helper.unitvector(n.real(a.value.length),k),q=h.idMatrix(f,f),v=JSON.parse(JSON.stringify(a)),w=h.transpose(a);a=Array(c);for(d=0;d<c;d++)a[d]=h.abs2(w.value[d]);a=h.turnIntoCSList(a);w=Array(c);for(d=0;d<c;d++)w[d]=d;d=h.maxIndex(a,n.abs);for(var x=a.value[d],B=0,E=0;1E-16<n.abs2(x).value.real;E++){B++;
h._helper.swapColumn(v,E,d);h._helper.swapEl(a,E,d);h._helper.swapEl(w,E,d);d=h._helper.getBlock(v,[E],[E]);d=h.column(d,k);x=h.abs2(d).value.real;1E-8<x&&(d=h._helper.getHouseHolder(d),d=h._helper.buildBlockMatrix(h.idMatrix(n.real(E),n.real(E)),d),q=p.mult(q,h.transjugate(d)),v=p.mult(d,v));for(d=E+1;d<c;d++)a.value[d]=n.sub(a.value[d],n.mult(v.value[E].value[d],n.conjugate(v.value[E].value[d])));d=h.maxIndex(a,n.abs2,E+1);x=a.value[d];if(E+2===c){n.abs(x).value.real>b&&B++;break}f=n.sub(f,k);m.value=
m.value.splice(0,m.value.length-1)}return{Q:q,R:v,P:h.turnIntoCSList(w),rank:n.real(B)}};h._helper.getHouseHolder=function(a){var b=n.real(a.value.length);if(1E-16>h.abs2(a))return h.idMatrix(b,b);var c=n.real(1),d=h._helper.unitvector(n.real(a.value.length),c);var f=h._helper.QRgetAlpha(a,0);f=h.sub(a,h.scalmult(f,d));f=h.scaldiv(h.abs(f),f);a=n.div(h.sesquilinearproduct(a,f),h.sesquilinearproduct(f,a));b=h.idMatrix(b,b);return b=h.sub(b,h.scalmult(n.add(c,a),h._helper.transposeMult(f,h.conjugate(f))))};
h._helper.reOrderbyPivots=function(a,b){var c=a.value.length.length;a=h.transpose(a);c=Array(c);for(var d=0;d<b.length;d++)c[b[d]]=a.value[d];c=h.turnIntoCSList(c);return h.transpose(c)};h.QRdecomp=function(a){var b=a.value.length,c=n.real(b);if(h._helper.isUpperTriangular(a))return{Q:h.idMatrix(c,c),R:a};var d=n.real(1),f=h._helper.unitvector(n.real(a.value.length),d),k=h.idMatrix(c,c);a=JSON.parse(JSON.stringify(a));for(var m=0;;m++){var q=h._helper.getBlock(a,[m],[m]);q=h.column(q,d);var v=h.abs2(q).value.real;
1E-8<v&&(q=h._helper.getHouseHolder(q),q=h._helper.buildBlockMatrix(h.idMatrix(n.real(m),n.real(m)),q),k=p.mult(k,h.transjugate(q)),a=p.mult(q,a));if(m+2===b)break;c=n.sub(c,d);f.value=f.value.splice(0,f.value.length-1)}return{Q:k,R:a}};h._helper.swapColumn=function(a,b,c){for(var d,f=0;f<a.value.length;f++)d=a.value[f].value[b],a.value[f].value[b]=a.value[f].value[c],a.value[f].value[c]=d};h._helper.buildBlockMatrix=function(a,b){if(0===a.value.length)return b;if(0===b.value.length)return a;var c=
a.value.length,d=a.value[0].value.length,f=d+b.value[0].value.length;f=h.zeromatrix(n.real(c+b.value.length),n.real(f));for(var k=0;k<a.value.length;k++)for(var m=0;m<a.value[0].value.length;m++)f.value[k].value[m]=a.value[k].value[m];for(a=0;a<b.value.length;a++)for(k=0;k<b.value[0].value.length;k++)f.value[c+a].value[d+k]=b.value[a].value[k];return f};h._helper.getBlock=function(a,b,c){a=JSON.parse(JSON.stringify(a));var d=b[0],f=c[0];b=void 0===b[1]?a.value.length:b[1];c=void 0===c[1]?a.value[0].value.length:
c[1];b++;c++;a.value=a.value.slice(d,b);for(d=0;d<a.value.length;d++)a.value[d].value=a.value[d].value.slice(f,c);return a};h._helper.setBlock=function(a,b,c){a=JSON.parse(JSON.stringify(a));var d=c[0];c=c[1];for(var f=b.value.length,k=b.value[0].value.length,m=0;m<f;m++)for(var q=0;q<k;q++)a.value[d+m].value[c+q]=b.value[m].value[q];return a};h._helper.transposeMult=function(a,b){if(a.value.length!==b.value.length)return A;for(var c=a.value.length,d=Array(c),f=0;f<c;f++)d[f]=h.scalmult(a.value[f],
b);return h.turnIntoCSList(d)};h._helper.QRgetAlpha=function(a,b){return 0>a.value[b].value.real?h.abs(a):n.neg(h.abs(a))};h.LUdecomp=function(a){a=JSON.parse(JSON.stringify(a));var b,c,d=0,f=a.value.length,k=f-1,m=Array(f);for(c=0;c<f;++c){var q=c;var v=a.value[c];var w=n.abs(v.value[c]).value.real;for(b=c+1;b<f;++b){var x=n.abs(a.value[b].value[c]);w<x.value.real&&(w=x.value.real,q=b)}w<n.eps&&console.log("Warning: singular matrix!");m[c]=q;q!==c&&(a.value[c]=a.value[q],a.value[q]=v,v=a.value[c],
d++);b=v.value[c];for(x=c+1;x<f;++x)a.value[x].value[c]=n.div(a.value[x].value[c],b);for(x=c+1;x<f;++x){q=a.value[x];for(b=c+1;b<k;++b)q.value[b]=n.sub(q.value[b],n.mult(q.value[c],v.value[b])),++b,q.value[b]=n.sub(q.value[b],n.mult(q.value[c],v.value[b]));b===k&&(q.value[b]=n.sub(q.value[b],n.mult(q.value[c],v.value[b])))}}return{LU:a,P:m,TransPos:d}};h.LUsolve=function(a,b){a=h.LUdecomp(a);return h._helper.LUsolve(a,b)};h._helper.LUsolve=function(a,b){var c=JSON.parse(JSON.stringify(b));b=a.LU;
var d=b.value.length,f=JSON.parse(JSON.stringify(c)),k=a.P;for(a=d-1;-1!==a;--a)f.value[a]=c.value[a];for(a=0;a<d;++a){c=k[a];if(k[a]!==a){var m=f.value[a];f.value[a]=f.value[c];f.value[c]=m}m=b.value[a];for(c=0;c<a;++c)f.value[a]=n.sub(f.value[a],n.mult(f.value[c],m.value[c]))}for(a=d-1;0<=a;--a){m=b.value[a];for(c=a+1;c<d;++c)f.value[a]=n.sub(f.value[a],n.mult(f.value[c],m.value[c]));f.value[a]=n.div(f.value[a],m.value[a])}return f};h.linearsolveCramer2=function(a,b){var c=h.column(a,n.real(1)),
d=h.column(a,n.real(2));a=h.det2(c,d);n._helper.isZero(a)&&console.log("A is not regular!");d=h.det2(b,d);d=n.div(d,a);b=h.det2(c,b);b=n.div(b,a);return h.turnIntoCSList([d,b])};h.linearsolveCramer3=function(a,b){var c=h.column(a,n.real(1)),d=h.column(a,n.real(2)),f=h.column(a,n.real(3));a=h.det3(c,d,f);n._helper.isZero(a)&&console.log("A is not regular!");var k=h.det3(b,d,f);f=h.det3(c,b,f);b=h.det3(c,d,b);b=h.turnIntoCSList([k,f,b]);return b=h.scaldiv(a,b)};h.linearsolveCGNR=function(a,b){var c=
h.transpose(a);a=p.mult(c,a);b=p.mult(c,b);return h.linearsolveCG(a,b)};h.linearsolveCG=function(a,b){var c;var d=b;var f=b=h.sub(b,p.mult(a,b));for(var k=Math.ceil(1.2*a.value.length),m=0;m<k;){m++;var q=p.mult(a,f);var v=c=h.scalproduct(b,b);c=n.div(c,h.scalproduct(f,q));d=h.add(d,p.mult(c,f));b=h.sub(b,p.mult(c,q));if(h.abs(b).value.real<n.eps)break;c=h.scalproduct(b,b);c=n.div(c,v);f=h.add(b,p.mult(c,f))}m>=k&&console.log("CG did not converge");return d};h.det=function(a){if(1===a.value.length)return a.value[0].value[0];
if(2===a.value.length)return h.det2(a.value[0],a.value[1]);if(3===a.value.length)return h.det3(a.value[0],a.value[1],a.value[2]);if(4===a.value.length)return h.det4m(a);var b=a.value.length,c=n.real(1),d,f=JSON.parse(JSON.stringify(a));for(a=0;a<b-1;a++){var k=a;for(d=a+1;d<b;d++)n.abs(f.value[d].value[a]).value.real>n.abs(f.value[k].value[a]).value.real&&(k=d);k!==a&&(d=f.value[k],f.value[k]=f.value[a],f.value[a]=d,c=n.neg(c));var m=f.value[a];for(d=a+1;d<b;d++){var q=f.value[d];var v=n.div(q.value[a],
m.value[a]);for(k=a+1;k<b-1;k+=2){var w=k+1;q.value[k]=n.sub(q.value[k],n.mult(m.value[k],v));q.value[w]=n.sub(q.value[w],n.mult(m.value[w],v))}k!==b&&(q.value[k]=n.sub(q.value[k],n.mult(m.value[k],v)))}if(n._helper.isZero(m.value[a]))return n.real(0);c=n.mult(c,m.value[a])}return n.mult(c,f.value[a].value[a])};h.LUdet=function(a){a=h.LUdecomp(a);for(var b=a.LU,c=b.value.length,d=b.value[0].value[0],f=1;f<c;f++)d=n.mult(d,b.value[f].value[f]);1===a.TransPos%2&&(d=n.neg(d));return d};h.getField=function(a,
b){if("homog"===b){if(h._helper.isNumberVecN(a,3))return a;if(h._helper.isNumberVecN(a,2))return h.turnIntoCSList([a.value[0],a.value[1],n.real(1)])}if("xy"===b){if(h._helper.isNumberVecN(a,2))return a;if(h._helper.isNumberVecN(a,3))return h.turnIntoCSList([n.div(a.value[0],a.value[2]),n.div(a.value[1],a.value[2])])}if("x"===b&&h.isNumberVector(a)){var c=a.value.length;if(0<c&&3!==c)return a.value[0];if(3===c)return"Point"===a.usage?n.div(a.value[0],a.value[2]):a.value[0]}if("y"===b&&h.isNumberVector(a)){c=
a.value.length;if(1<c&&3!==c)return a.value[1];if(3===c)return"Point"===a.usage?n.div(a.value[1],a.value[2]):a.value[1]}return"z"===b&&h.isNumberVector(a)&&(c=a.value.length,2<c)?a.value[2]:A};h.nil=h.turnIntoCSList([]);h.ofGeos=function(a){return h.turnIntoCSList(a.map(function(b){return{ctype:"geo",value:b}}))};h._helper.isAlmostFarpoint=function(a){a=h.normalizeMax(a).value[2];return n.abs(a).value.real<n.eps};h.getRandRealVec3=function(a,b){var c=n.getRandReal;return h.turnIntoCSList([c(a,b),
c(a,b),c(a,b)])};h.getRandComplexVec3=function(a,b){var c=n.getRandComplex;return h.turnIntoCSList([c(a,b),c(a,b),c(a,b)])};var $a={_helper:{GenJSONAtom:function(a,b){return{ctype:"JSON",value:{key:p.string(a),value:b}}},forall:function(a,b,c,d){d=void 0===d?{}:d;var f;d=(null===(f=d.iterator)||void 0===f?void 0:f.value)||"value";var k;for(k in a){"key"===d?V.setvar(b,p.string(k)):"pair"===d?V.setvar(b,this.GenJSONAtom(k,a[k])):V.setvar(b,a[k]);var m=L(c)}return m},niceprint:function(a,b,c){return"JSON"===
a.ctype?$a.niceprint(a,b,c):Ea(a)},handlePrintException:function(a){a instanceof RangeError?console.log("Warning: Dictionary string could not be generated! Probably large cyclic Dictionary!"):a instanceof SyntaxError?console.log("Warning: Dictionary string could not be parsed!"):console.log("Warning: Dictionary printing failed!")}},turnIntoCSJson:function(a){return{ctype:"JSON",value:a}},getField:function(a,b){var c;return(null===(c=a.value)||void 0===c?void 0:c[b])||A},setField:function(a,b,c){"undefined"===
c.ctype&&a[b]?delete a[b]:a[b]=c},GenFromUserDataEl:function(a){var b=a.key;a=a.value;return"string"!==(null===b||void 0===b?void 0:b.ctype)?(console.log("Error: JSON keys have to be strings."),A):void 0==a?(console.log("Warning: JSON object not defined."),{key:b.value,val:A}):{key:b.value,val:L(a)}},niceprint:function(a,b,c){var d=c||{printedWarning:!1,visitedMap:{tracker:new WeakMap,level:0,maxLevel:1E3,maxElVisit:5E3,newLevel:!1,printedWarning:!1}};if(null===b||void 0===b?0:b.maxDepth)c=L(b.maxDepth),
"number"===c.ctype&&(d.visitedMap.maxLevel=c.value.real);var f=d.visitedMap;f.newLevel=!0;f.level+=1;return"{"+Object.keys(a.value).sort().map(function(k){var m=a.value[k];if(f.tracker.has(m)){if(f[m]>f.maxElVisit||f.level>f.maxLevel)return d&&!d.printedWarning&&(console.log("Warning: We visited a key-value pair very often or encountered a very deeply nested dictionary. Dictionary is probably cyclic. Output will be probably incomplete."),d.printedWarning=!0),k+":...";f.newLevel&&(f.tracker.set(m,
f.tracker.get(m)+1),f.newLevel=!1)}else f.tracker.set(m,1);return k+":"+$a._helper.niceprint(m,b,d)}).join(", ")+"}"}},O={key:function(a){if("string"===a.ctype)return"s"+a.value.length+":"+a.value+";";if("number"===a.ctype)return"n"+a.value.real+","+a.value.imag+";";if("list"===a.ctype)return"l"+a.value.length+":"+a.value.map(O.key).join(",")+";";if("boolean"===a.ctype)return"b"+a.value+";";if("dict"===a.ctype)return a=Object.keys(a.value).sort(),"d"+a.length+":"+a.join(",")+";";"undefined"!==a.ctype&&
Qb.err("Bad dictionary key: "+Ea(a));return"undef"},create:function(){return{ctype:"dict",value:{}}},clone:function(a){var b=O.create(),c;for(c in a.value)a.value.hasOwnProperty(c)&&(b.value[c]=a.value[c]);return b},put:function(a,b,c){a.value[O.key(b)]={key:b,value:c}},get:function(a,b,c){return(a=a.value[O.key(b)])?a.value:c},niceprint:function(a){return"{"+Object.keys(a.value).sort().map(function(b){b=a.value[b];return Ea(b.key)+":"+Ea(b.value)}).join(", ")+"}"}},p={_helper:{},order:{undefined:0,
boolean:1,number:2,term:3,atomic:4,variable:5,geo:6,string:7,list:8},string:function(a){return{ctype:"string",value:a}},bool:function(a){return{ctype:"boolean",value:a}},not:function(a){return p.bool(!a.value)},isLessThan:function(a,b){return-1===p.compare(a,b)},isEqual:function(a,b){return 0===p.compare(a,b)},compareResults:function(a,b){return p.compare(a.result,b.result)},compare:function(a,b){if(a.ctype!==b.ctype)return p.order[a.ctype]-p.order[b.ctype];if("number"===a.ctype)return n._helper.compare(a,
b);if("list"===a.ctype)return h._helper.compare(a,b);if("geo"===a.ctype)return a.value.name===b.value.name?0:a.value.name<b.value.name?-1:1;if("string"===a.ctype)return a.value===b.value?0:a.value<b.value?-1:1;if("boolean"===a.ctype)return a.value===b.value?0:!1===a.value?-1:1},add:function(a,b){return"void"===a.ctype&&"number"===b.ctype||"void"===a.ctype&&"list"===b.ctype?b:"number"===a.ctype&&"number"===b.ctype?n.add(a,b):"string"===a.ctype||"string"===b.ctype?{ctype:"string",value:Ea(a)+Ea(b)}:
"list"===a.ctype&&"list"===b.ctype?h.add(a,b):A},sub:function(a,b){return"void"===a.ctype&&"number"===b.ctype?n.neg(b):"void"===a.ctype&&"list"===b.ctype?h.neg(b):"number"===a.ctype&&"number"===b.ctype?n.sub(a,b):"list"===a.ctype&&"list"===b.ctype?h.sub(a,b):A},mult:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.mult(a,b):"number"===a.ctype&&"list"===b.ctype?h.scalmult(a,b):"list"===a.ctype&&"number"===b.ctype?h.scalmult(b,a):"list"===a.ctype&&"list"===b.ctype?h.mult(a,b):A},div:function(a,
b){return"number"===a.ctype&&"number"===b.ctype?n.div(a,b):"list"===a.ctype&&"number"===b.ctype?h.scaldiv(b,a):A},max:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.max(a,b):"list"===a.ctype&&"list"===b.ctype?h.max(a,b):A},min:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.min(a,b):"list"===a.ctype&&"list"===b.ctype?h.min(a,b):A},wrap:function(a){if("number"===typeof a)return n.real(a);if("object"===typeof a&&void 0!==a.length){for(var b=[],c=0;c<a.length;c++)b[c]=p.wrap(a[c]);
return h.turnIntoCSList(b)}return"string"===typeof a?{ctype:"string",value:a}:"boolean"===typeof a?{ctype:"boolean",value:a}:A},unwrap:function(a){if("object"!==typeof a||null===a)return a;if(Array.isArray(a))return a.map(p.unwrap);switch(a.ctype){case "string":case "boolean":return a.value;case "number":return 0===a.value.imag?a.value.real:{r:a.value.real,i:a.value.imag};case "list":return a.value.map(p.unwrap);default:return null}},withUsage:function(a,b){return{ctype:a.ctype,value:a.value,usage:b}},
wrapJSON:function(a){switch(typeof a){case "number":return n.real(a);case "string":return p.string(a);case "boolean":return p.bool(a);case "object":if(null===a)return A;if(Array.isArray(a))return h.turnIntoCSList(a.map(p.wrapJSON));var b=O.create(),c;for(c in a)O.put(b,p.string(c),p.wrapJSON(a[c]));return b;default:return console.log("Failed to convert "+typeof a+" to CindyJS data type"),A}},identity:function(a){return a},deeplyEqual:function(a,b){if("object"!==typeof a||"object"!==typeof b||null===
a||null===b)return a===b;var c=0,d;for(d in a)if(++c,!(d in b&&p.deeplyEqual(a[d],b[d])))return!1;for(d in b)--c;return 0===c}},D={},I={};I[":"]=Va(":");I["\u00b0"]=function(a,b){b=Y(a[0]);return"number"===b.ctype&&"void"===a[1].ctype?p.withUsage(n.realmult(Math.PI/180,b),"Angle"):A};I._=vd;I["^"]=Pc;I["\u221a"]=function(a,b){return"void"===a[0].ctype?z.sqrt$1([a[1]],b):A};I["*"]=Hb;I["\u00d7"]=vc;I["/"]=Ga;I["+"]=Ne;I["-"]=Id;I["!"]=function(a,b){b=Y(a[1]);return"void"===a[0].ctype&&"boolean"===
b.ctype?{ctype:"boolean",value:!b.value}:A};I["=="]=Ab;I["~="]=hc;I["~<"]=function(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real<=-n.eps}:A};I["~>"]=function(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real>=n.eps}:A};I["=:="]=Va("=:=");I[">="]=function(a,
b){b=Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real>=a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value>=a.value}:A};I["<="]=function(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real<=a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",
value:b.value<=a.value}:A};I["~>="]=function(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real>-n.eps}:A};I["~<="]=function(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real<n.eps}:A};I[">"]=function(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===
a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real>a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value>a.value}:A};I["<"]=function(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real<a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value<a.value}:A};I["<>"]=gc;I["\u2208"]=function(a,b){b=
L(a[0]);a=L(a[1]);return"list"===a.ctype?h.contains(a,b):A};I["\u2209"]=function(a,b){b=L(a[0]);a=L(a[1]);return"list"===a.ctype?p.not(h.contains(a,b)):A};I["&"]=Wc;I["%"]=ke;I["!="]=gc;I["~!="]=function(a,b){return p.not(hc(a,b))};I[".."]=function(a,b){b=L(a[0]);a=L(a[1]);return"number"===b.ctype&&"number"===a.ctype?h.sequence(b,a):A};I["++"]=wc;I["--"]=wd;I["~~"]=S;I[":>"]=me;I["<:"]=ne;I["="]=fc;I[":="]=function(a,b,c){b="undefined"===a[1].ctype;if("undefined"===a[0].ctype||b)return A;if("function"===
a[0].ctype){b=a[0].oper;var d=a[0].args;a=a[1];var f=1;if(D.hasOwnProperty(b)){f=D[b];if(f.definer===c)return A;f=f.generation+1}D[b]={oper:b,body:a,arglist:d,definer:c,generation:f}}else"variable"===a[0].ctype?V.setvar(a[0].name,a[1]):"field"===a[0].ctype?M.assigndotNoVal(a[0],a[1]):"userdata"===a[0].ctype&&M.assigncolonNoVal(a[0],a[1]);return A};I[":=_"]=function(a,b){if("void"!==a[1].ctype)return A;"function"===a[0].ctype&&delete D[a[0].oper];return A};I["::="]=Va("::=");I[";"]=function(a,b){b=
"void"===a[0].ctype;var c="void"===a[1].ctype;if(b&&c)return A;if(!b&&c)return L(a[0]);b||c||L(a[0]);return c?A:L(a[1])};Ea.errorTypes=["_?_","_??_","_???_","___"];var z={},M={evaluate:function(a,b,c){if(D.hasOwnProperty(a))return Sa(a,b,c);var d=z[a];if(d)return d(b,c);var f=a.lastIndexOf("$");if(-1!==f&&(f=a.substr(0,f),d=z[f]))return d(b,c);Qb.err("Called undefined function "+f+" (as "+a+")");return A},equals:function(a,b){return"number"===a.ctype&&"number"===b.ctype?{ctype:"boolean",value:a.value.real===
b.value.real&&a.value.imag===b.value.imag}:"string"===a.ctype&&"string"===b.ctype||"boolean"===a.ctype&&"boolean"===b.ctype?{ctype:"boolean",value:a.value===b.value}:"list"===a.ctype&&"list"===b.ctype?h.equals(a,b):"geo"===a.ctype&&"geo"===b.ctype||"JSON"===a.ctype&&"JSON"===b.ctype?{ctype:"boolean",value:a.value===b.value}:{ctype:"boolean",value:!1}}},V={};V.vars=function(){var a={pi:n.real(Math.PI),"\u03c0":n.real(Math.PI),i:n.complex(0,1),true:p.bool(!0),false:p.bool(!1),"#":A,nil:h.turnIntoCSList([]),
newline:p.string("\n"),tab:p.string("\t")},b=[],c;for(c in a)b[c]=[a[c]];return b}();V.isVariable=function(a){return this.vars.hasOwnProperty(a)};V.create=function(a){if(this.vars.hasOwnProperty(a))return this.vars[a];var b=[null];return this.vars[a]=b};V.newvar=function(a){a=this.create(a);a.push(A);return a};V.removevar=function(a){var b=this.vars[a];0===b.length&&console.error("Removing non-existing "+a);b.pop();0===b.length&&console.warn("Removing last "+a)};V.setvar=function(a,b){var c=this.vars[a];
0===c.length&&console.error("Setting non-existing variable "+a);void 0===b&&(console.error("Setting variable "+a+" to undefined value"),b=A);"undefined"===b.ctype?c[c.length-1]=b:(a=b,null===a&&(a=A),c[c.length-1]=a)};V.undefinedWarning={};V.getvar=function(a){var b=this.vars[a]||[];0===b.length&&console.error("Getting non-existing variable "+a);b=b[b.length-1];if(null===b){if(G.csnames.hasOwnProperty(a))return{ctype:"geo",value:G.csnames[a]};console&&console.log&&void 0===this.undefinedWarning[a]&&
(this.undefinedWarning[a]=!0,console.log("Warning: Accessing undefined variable: "+a));return A}return b};V.dump=function(a){var b=this.vars[a];console.log("*** Dump "+a);for(a=0;a<b.length;a++)console.log(a+":> "+Ea(b[a]))};V.vstack=[];V.pushVstack=function(a){this.vstack.push(a)};V.popVstack=function(){this.vstack.pop()};V.cleanVstack=function(){for(var a=this.vstack;0<a.length&&"*"!==a[a.length-1];)this.removevar(a[a.length-1]),a.pop();0<a.length&&a.pop()};var la={generalFields:{color:"color",
colorhsb:"",size:"size",alpha:"alpha",fillcolor:"fillcolor",fillalpha:"fillalpha",isshowing:"isshowing",visible:"visible",name:"name",caption:"caption",trace:"",tracelength:"",selected:"",labeled:"labeled",labelled:"labeled"},getGeoField:function(a,b){return"undefined"!==typeof G.csnames[a]?la.getField(G.csnames[a],b):A},setGeoField:function(a,b,c){return"undefined"!==typeof G.csnames[a]?la.setField(G.csnames[a],b,c):A},getField:function(a,b){if("P"===a.kind){if("xy"===b||"coord"===b)return a=h.dehom(a.homog),
p.withUsage(a,"Point");if("homog"===b)return p.withUsage(a.homog,"Point");if("x"===b)return n.div(a.homog.value[0],a.homog.value[2]);if("y"===b)return n.div(a.homog.value[1],a.homog.value[2]);if("narrow"===b)return p.wrap(a.narrow)}if("L"===a.kind||"S"===a.kind){if("homog"===b)return p.withUsage(a.homog,"Line");if("angle"===b)return a=h.eucangle(h.ey,a.homog),p.withUsage(a,"Angle");if("slope"===b)return n.neg(n.div(a.homog.value[0],a.homog.value[1]))}if("Tr"===a.kind&&"matrix"===b)return a.matrix;
if("C"===a.kind){if("radius"===b){var c=a.matrix;a=c.value[0].value[0];var d=c.value[0].value[2];b=c.value[1].value[2];c=c.value[2].value[2];n.mult(a,a);d=n.div(d,a);b=n.div(b,a);a=n.div(c,a);return a=n.sqrt(n.sub(n.add(n.mult(d,d),n.mult(b,b)),a))}if("size"===b)return a.size;if("matrix"===b)return a.matrix;if("center"===b)return a=u._helper.CenterOfConic(a.matrix),a=h.dehom(a),p.withUsage(a,"Point");if("dualMatrix"===b)return h.normalizeMax(h.adjoint3(a.matrix));if("narrow"===b)return p.wrap(a.narrow)}if("Text"===
a.kind){if("pressed"===b)return a.checkbox?p.bool(a.checkbox.checked):p.bool(!1);if("xy"===b)return a=h.dehom(a.homog),p.withUsage(a,"Point");if("homog"===b)return p.withUsage(a.homog,"Point");if("x"===b)return n.div(a.homog.value[0],a.homog.value[2]);if("y"===b)return n.div(a.homog.value[1],a.homog.value[2])}if("trace"===b)return p.bool(!!a.drawtrace);if("pinned"===b)return p.bool(!!a.pinned);if(la.generalFields[b])return(a=a[la.generalFields[b]])&&a.ctype?a:"object"!==typeof a?p.wrap(a):A;if(a.behavior){if("mass"===
b&&"Mass"===a.behavior.type)return n.real(a.behavior.mass);if("radius"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.radius);if("charge"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.charge);if("friction"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.friction);if("vx"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.vx);if("vy"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.vy);if("v"===b&&"Mass"===a.behavior.type)return h.realVector([a.behavior.vx,a.behavior.vy]);
if("fx"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.fx);if("fy"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.fy);if("f"===b&&"Mass"===a.behavior.type)return h.realVector([a.behavior.fx,a.behavior.fy]);if("ldiff"===b&&"Spring"===a.behavior.type)return n.real(a.behavior.ldiff)}b=u[a.type]["get_"+b];return"function"===typeof b?b(a):A},setField:function(a,b,c){"color"===b&&h._helper.isNumberVecN(c,3)&&(a.color=c);"size"===b&&"number"===c.ctype&&(a.size=c);"alpha"===b&&"number"===
c.ctype&&(a.alpha=c);"fillcolor"===b&&h._helper.isNumberVecN(c,3)&&(a.fillcolor=c);"fillalpha"===b&&"number"===c.ctype&&(a.fillalpha=c);"visible"===b&&"boolean"===c.ctype&&(a.visible=c.value);"pinned"===b&&"boolean"===c.ctype&&(a.pinned=c.value);"labeled"!==b&&"labelled"!==b||"boolean"!==c.ctype||(a.labeled=c.value);"printlabel"===b&&(a.printname=Ea(c));"trace"===b&&"boolean"===c.ctype&&(c.value&&!a.drawtrace?(a.drawtrace=!0,Ve(a)):a.drawtrace=c.value);"P"===a.kind&&a.movable&&("xy"===b&&h._helper.isNumberVecN(c,
2)&&Zb(a,h.turnIntoCSList([c.value[0],c.value[1],n.real(1)]),"homog"),"xy"===b&&h._helper.isNumberVecN(c,3)&&Zb(a,c,"homog"),"x"===b&&"number"===c.ctype&&Zb(a,h.turnIntoCSList([n.mult(c,a.homog.value[2]),a.homog.value[1],a.homog.value[2]]),"homog"),"y"===b&&"number"===c.ctype&&Zb(a,h.turnIntoCSList([a.homog.value[0],n.mult(c,a.homog.value[2]),a.homog.value[2]]),"homog"),"homog"===b&&h._helper.isNumberVecN(c,3)&&Zb(a,c,"homog"));"homog"===b&&"L"===a.kind&&a.movable&&h._helper.isNumberVecN(c,3)&&Zb(a,
c,"homog");"Text"===a.kind&&("pressed"===b&&"boolean"===c.ctype&&a.checkbox&&(a.checkbox.checked=c.value),a.movable&&("xy"===b?h._helper.isNumberVecN(c,2)?a.homog=h.turnIntoCSList([c.value[0],c.value[1],n.real(1)]):h._helper.isNumberVecN(c,3)&&(a.homog=c):"homog"===b&&h._helper.isNumberVecN(c,3)?a.homog=c:"x"===b&&"number"===c.ctype?a.homog=h.turnIntoCSList([n.mult(c,a.homog.value[2]),a.homog.value[1],a.homog.value[2]]):"y"===b&&"number"===c.ctype&&(a.homog=h.turnIntoCSList([a.homog.value[0],n.mult(c,
a.homog.value[2]),a.homog.value[2]]))));a.behavior&&("mass"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.mass=c.value.real),"mass"===b&&"Sun"===a.behavior.type&&"number"===c.ctype&&(a.behavior.mass=c.value.real),"friction"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.friction=c.value.real),"charge"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.charge=c.value.real),"radius"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.radius=c.value.real),
"vx"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.vx=c.value.real),"vy"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.vy=c.value.real),"v"===b&&"Mass"===a.behavior.type&&h._helper.isNumberVecN(c,2)&&(a.behavior.vx=c.value[0].value.real,a.behavior.vy=c.value[1].value.real));"narrow"===b&&["P","C"].includes(a.kind)&&("boolean"===c.ctype&&(a.narrow=c.value),"number"===c.ctype&&n._helper.isAlmostReal(c)&&(a.narrow=c.value.real));b=u[a.type]["set_"+b];if("function"===
typeof b)return b(a,c)},getuserData:function(a,b){var c;"string"===b.ctype&&a.userData&&a.userData[b.value]&&(c=a.userData[b.value]);return c&&c.ctype?c:"object"!==typeof c?p.wrap(c):A},setuserData:function(a,b,c){b&&"string"===b.ctype&&a&&c&&(a.userData||(a.userData={}),a.userData[b.value]=c)}};z.version$0=function(a,b){a=["CindyJS"].concat(mf);return h.turnIntoCSList(a.map(p.wrap))};z.clearconsole$0=function(a,b){Qb.clear()};z.err$1=function(a,b){b="";"variable"===a[0].ctype?(b=a[0].name,a=V.getvar(a[0].name)):
a=a[0];a=b+" ===> "+Ea(L(a));Qb.err(a);return A};z.errc$1=function(a,b){"variable"===a[0].ctype?(b=L(V.getvar(a[0].name)),console.log(a[0].name+" ===> "+Ea(b))):(b=L(a[0]),console.log(" ===> "+Ea(b)));return A};z.print$1=function(a,b){Qb.out(Ea(L(a[0]),b),!0);return A};z.println$1=function(a,b){Qb.out(Ea(L(a[0],b)));return A};z.assert$2=function(a,b){var c=L(a[0]);if("boolean"===c.ctype){if(!1===c.value)return z.println$1([a[1]],b)}else xb("Condition for assert is not boolean");return A};z.dump$1=
function(a,b){console.log(JSON.stringify(a[0]));return A};z.repeat$2=function(a,b){return z.repeat$3([a[0],null,a[1]],b)};z.repeat$3=function(a,b){var c=Y(a[0]),d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);if("number"!==c.ctype)return A;c=Math.round(c.value.real);var f=1,k=1,m=c+1,q=!1,v=!1,w=!1;if(void 0!==b.start){var x=L(b.start);"number"===x.ctype&&(q=!0,k=x.value.real)}void 0!==b.step&&(x=L(b.step),"number"===x.ctype&&(w=!0,f=x.value.real));void 0!==b.stop&&(x=L(b.stop),"number"===
x.ctype&&(v=!0,m=x.value.real));!q||v||w||(m=f*c+k);q||!v||w||(k=-f*(c-1)+m,m+=f);q||v||!w||(m=f*c+k);q&&v&&!w&&(f=(m-k)/(c-1),m+=f);q&&!v&&w&&(m=f*c+k);!q&&v&&w&&(k=-f*(c-1)+m,m+=f);q&&v&&w&&(m+=f);(k<=m&&0<f||k>=m&&0>f)&&q&&v&&w&&(c=Math.floor((m-k)/f));V.newvar(d);b=A;for(m=0;m<c;m++)V.setvar(d,{ctype:"number",value:{real:m*f+k,imag:0}}),b=L(a[2]);V.removevar(d);return b};z.while$2=function(a,b){b=a[1];a=a[0];for(var c=L(a),d=A;"list"!==c.ctype&&c.value;)d=L(b),c=L(a);return d};z.apply$2=function(a,
b){return z.apply$3([a[0],null,a[1]],b)};z.apply$3=function(a,b){return z.apply$4([a[0],a[1],null,a[2]],b)};z.apply$4=function(a,b){b=Y(a[0]);if("list"!==b.ctype&&"JSON"!==b.ctype)return A;var c="#";null!==a[1]&&"variable"===a[1].ctype&&(c=a[1].name);if(null!==a[2]&&"variable"===a[2].ctype){var d=a[2].name;V.newvar(d)}var f=b.value,k="list"===b.ctype?[]:{};V.newvar(c);if(void 0!==d){if("list"===b.ctype)for(var m=0;m<f.length;m++)V.setvar(d,n.real(m+1)),V.setvar(c,f[m]),k[m]=L(a[3]);else for(m in f)V.setvar(d,
p.string(m)),V.setvar(c,f[m]),k[m]=L(a[3]);V.removevar(d)}else if("list"===b.ctype)for(k=[],d=0;d<f.length;d++)V.setvar(c,f[d]),k[d]=L(a[3]);else for(var q in f)V.setvar(c,f[q]),k[q]=L(a[3]);V.removevar(c);return"list"===b.ctype?h.turnIntoCSList(k):$a.turnIntoCSJson(k)};z.forall$2=function(a,b){return z.forall$3([a[0],null,a[1]],b)};z.forall$3=function(a,b){return z.forall$4([a[0],a[1],null,a[2]],b)};z.forall$4=function(a,b){var c=Y(a[0]);if("list"!==c.ctype&&"JSON"!==c.ctype)return A;var d="#";null!==
a[1]&&"variable"===a[1].ctype&&(d=a[1].name);if(null!==a[2]&&"variable"===a[2].ctype){var f=a[2].name;V.newvar(f)}var k=c.value;V.newvar(d);if(void 0!==f){if("list"===c.ctype)for(b=0;b<k.length;b++){V.setvar(f,n.real(b+1));V.setvar(d,k[b]);var m=L(a[3])}else for(var q in k)V.setvar(f,p.string(q)),V.setvar(d,k[q]),m=L(a[3]);V.removevar(f)}else if("list"===c.ctype)for(f=0;f<k.length;f++)V.setvar(d,k[f]),m=L(a[3]);else m=$a._helper.forall(k,d,a[3],b);V.removevar(d);return m};z.select$2=function(a,b){return z.select$3([a[0],
null,a[1]],b)};z.select$3=function(a,b){return z.select$4([a[0],a[1],null,a[2]],b)};z.select$4=function(a,b){var c=Y(a[0]);if("list"!==c.ctype&&"JSON"!==c.ctype)return A;b="#";null!==a[1]&&"variable"===a[1].ctype&&(b=a[1].name);if(null!==a[2]&&"variable"===a[2].ctype){var d=a[2].name;V.newvar(d)}var f=c.value;V.newvar(b);if(void 0!==d){if("list"===c.ctype){c=[];for(var k=0,m=0;m<f.length;m++){V.setvar(d,n.real(m+1));V.setvar(b,f[m]);var q=L(a[3]);"boolean"===q.ctype&&!0===q.value&&(c[k]=f[m],k++)}a=
{ctype:"list",value:c}}else{c={};for(k in f)V.setvar(d,p.string(k)),V.setvar(b,f[k]),q=L(a[3]),"boolean"===q.ctype&&!0===q.value&&(c[k]=f[k]);a={ctype:"JSON",value:c}}V.removevar(d)}else if("list"===c.ctype){c=[];for(k=d=0;k<f.length;k++)V.setvar(b,f[k]),q=L(a[3]),"boolean"===q.ctype&&!0===q.value&&(c[d]=f[k],d++);a={ctype:"list",value:c}}else{c={};for(m in f)V.setvar(b,f[m]),q=L(a[3]),"boolean"===q.ctype&&!0===q.value&&(c[m]=f[m]);a={ctype:"JSON",value:c}}V.removevar(b);return a};z.flatten$1=function(a,
b){function c(d,f){return-1===f||"list"!==d.ctype?d:[].concat.apply([],d.value.map(function(k){return c(k,f-1)}))}a=Y(a[0]);if("list"!==a.ctype)return a;b=b.levels;void 0===b?b=1:(b=L(b),b="number"===b.ctype?b.value.real:"string"===b.ctype&&"all"===b.value?-2:1);return{ctype:"list",value:c(a,b)}};z.createvar$1=function(a,b){"variable"===a[0].ctype&&V.newvar(a[0].name);return A};z.local=function(a,b){for(b=0;b<a.length;b++)"variable"===a[b].ctype&&V.newvar(a[b].name);return A};z.removevar$1=function(a,
b){b=L(a[0]);"variable"===a[0].ctype&&V.removevar(a[0].name);return b};z.release=function(a,b){if(0===a.length)return A;b=L(a[a.length-1]);for(var c=0;c<a.length;c++)"variable"===a[c].ctype&&V.removevar(a[c].name);return b};z.regional=function(a,b){for(b=0;b<a.length;b++)if("variable"===a[b].ctype){var c=a[b].name;V.newvar(c);V.pushVstack(c)}return A};z.genList=function(a,b){return h.turnIntoCSList(a.map(L))};z.genJSON=function(a,b){b={};for(var c=0;c<a.length;c++){var d=$a.GenFromUserDataEl(a[c]);
d.key&&(b[d.key]=d.val)}return{ctype:"JSON",value:b}};M.assigntake=function(a,b){var c=a.args[0],d=L(c);a=Y(a.args[1]);var f=A;if("list"===d.ctype||"string"===d.ctype){var k=Math.floor(a.value.real);0>k&&(k=d.value.length+k+1);0<k&&k<=d.value.length&&("list"===d.ctype?(f="userData"===d.internal_usage?d.value:d.value.slice(),f[k-1]=L(b),f=h.turnIntoCSList(f),d.userData&&(f.userData=d.userData)):(f=d.value,f=f.substring(0,k-1)+Ea(L(b))+f.substring(k,f.length),f=p.string(f)))}"JSON"===d.ctype&&(a=Ea(a),
Ea.errorTypes.includes(a)||(f=Object.assign({},d),f.value[a]=L(b)));fc([c,f])};M.assigndot=function(a,b){var c=L(a.obj);a=a.key;"geo"===c.ctype&&"string"===typeof a&&la.setField(c.value,a,Y(b));"JSON"===c.ctype&&"string"===typeof a&&$a.setField(c.value,a,Y(b));return A};M.assigndotNoVal=function(a,b){var c=L(a.obj);a=a.key;"geo"===c.ctype&&"string"===typeof a&&la.setField(c.value,a,b);"JSON"===c.ctype&&"string"===typeof a&&$a.setField(c.value,a,b);return A};M.assigncolon=function(a,b){var c=a.obj,
d=L(c);a=p.string(Ea(L(a.key)));"_?_"===a.value&&(a=A);if("geo"===d.ctype&&a)la.setuserData(d.value,a,Y(b));else if("JSON"===d.ctype&&a)$a.setField(d.value,a.value,Y(b));else if("list"===d.ctype||"string"===d.ctype&&a){var f=Object.assign({},d);f.userData||(f.userData={});"userData"!==d.internal_usage&&(f.userData=Object.assign({},f.userData));b=Y(b);"list"===b.ctype&&(b.internal_usage="userData");f.userData[a.value]=b;fc([c,f])}else a&&"string"===a.ctype?console.log("User data "+a.value+" can only be assigned to geo objects and lists, not to "+
d.ctype):console.log("Key is undefined");return A};M.assigncolonNoVal=function(a,b){var c=a.obj,d=L(c);a=p.string(Ea(L(a.key)));"_?_"===a.value&&(a=A);if("geo"===d.ctype&&a)la.setuserData(d.value,a,L(b));else if("JSON"===d.ctype&&a)$a.setField(d.value,a.value,b);else if("list"===d.ctype||"string"===d.ctype&&a){var f={},k;for(k in d)f[k]=d[k];if(f.userData){d={};for(var m in f.userData)d[m]=f.userData[m];f.userData=d}else f.userData={};f.userData[a.value]=b;fc([c,f])}else a&&"string"===a.ctype?console.log("User data "+
a.value+" can only be assigned to geo objects and lists, not to "+d.ctype):console.log("Key is undefined");return A};z.keys$1=function(a,b){b=L(a[0]);var c=b.ctype;return"geo"===c||"list"===c||"JSON"===c?(a=[],(b="geo"===c?b.value.userData:"list"===c?b.userData:b.value)&&(a=Object.keys(b).map(p.string).sort()),h.turnIntoCSList(a)):A};z.values$1=function(a,b){a=L(a[0]);b=a.ctype;if("list"===b)return a;if("geo"===b||"JSON"===b){var c=[],d;(d="geo"===b?a.value.userData:a.value)&&(c=Object.keys(d).sort().map(function(f){return d[f]}));
return h.turnIntoCSList(c)}return A};M.assignlist=function(a,b){var c=a.length,d=b.length;d<c&&(c=d);for(d=0;d<c;d++)fc([a[d],b[d]],[])};z.if$2=function(a,b){return z.if$3(a,b)};z.if$3=function(a,b){b=Y(a[0]);if("boolean"===b.ctype){if(!0===b.value)return L(a[1]);if(3===a.length)return L(a[2])}else"undefined"!==b.ctype&&xb("Condition for if is not boolean");return A};z.and$2=Wc;z.or$2=ke;z.xor$2=function(a,b){b=Y(a[0]);a=Y(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value!==
a.value}:A};z.not$1=function(a,b){a=Y(a[0]);return"boolean"===a.ctype?{ctype:"boolean",value:!a.value}:A};M.genericListMathGen=function(a,b,c){z[a+"$1"]=function(f,k){f=L(f[0]);if("list"!==f.ctype)return A;f=f.value;if(0===f.length)return c;k=f[0];for(var m=1;m<f.length;m++)k=b(k,f[m]);return k};var d=a+"$3";z[a+"$2"]=function(f,k){return z[d]([f[0],null,f[1]])};z[d]=function(f,k){k=Y(f[0]);if("list"!==k.ctype)return A;k=k.value;if(0===k.length)return c;var m="#";null!==f[1]&&"variable"===f[1].ctype&&
(m=f[1].name);V.newvar(m);V.setvar(m,k[0]);for(var q=L(f[2]),v=1;v<k.length;v++){V.setvar(m,k[v]);var w=L(f[2]);q=b(q,w)}V.removevar(m);return q}};M.genericListMathGen("product",p.mult,n.real(1));M.genericListMathGen("sum",p.add,n.real(0));z.max$1=function(a,b){a=L(a[0]);if("list"!==a.ctype)return A;a=a.value;if(0===a.length)return A;b=a[0];for(var c=1;c<a.length;c++)b=0<p.compare(b,a[c])?b:a[c];return b};z.max$2=function(a,b){var c=Y(a[0]);if("list"===c.ctype)return z.max$3([c,null,a[1]],b);a=Y(a[1]);
return z.max$1([h.turnIntoCSList([c,a])])};z.max$3=function(a,b){return z.max$4([a[0],a[1],null,a[2]],b)};z.max$4=function(a,b){var c=Y(a[0]);if("list"!==c.ctype)return A;c=c.value;if(0===c.length)return A;var d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);if(null!==a[2]&&"variable"===a[2].ctype){var f=a[2].name;V.newvar(f)}V.newvar(d);V.setvar(d,c[0]);var k=!1;void 0!==b.element&&(k=L(b.element),k="boolean"===k.ctype?k.value:!1);if(void 0!==f){V.setvar(f,n.real(1));b={element:c[0],value:L(a[3])};
for(var m=1;m<c.length;m++){V.setvar(f,n.real(m+1));V.setvar(d,c[m]);var q=L(a[3]);b=0<p.compare(b.value,q)?b:{element:c[m],value:q}}V.removevar(f)}else for(b={element:c[0],value:L(a[3])},f=1;f<c.length;f++)V.setvar(d,c[f]),m=L(a[3]),b=0<p.compare(b.value,m)?b:{element:c[f],value:m};V.removevar(d);return k?b.element:b.value};z.min$1=function(a,b){a=L(a[0]);if("list"!==a.ctype)return A;a=a.value;if(0===a.length)return A;b=a[0];for(var c=1;c<a.length;c++)b=0>p.compare(b,a[c])?b:a[c];return b};z.min$2=
function(a,b){var c=Y(a[0]);if("list"===c.ctype)return z.min$3([c,null,a[1]],b);a=Y(a[1]);return z.min$1([h.turnIntoCSList([c,a])])};z.min$3=function(a,b){return z.min$4([a[0],a[1],null,a[2]],b)};z.min$4=function(a,b){var c=Y(a[0]);if("list"!==c.ctype)return A;c=c.value;if(0===c.length)return A;var d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);if(null!==a[2]&&"variable"===a[2].ctype){var f=a[2].name;V.newvar(f)}V.newvar(d);V.setvar(d,c[0]);var k=!1;void 0!==b.element&&(k=L(b.element),
k="boolean"===k.ctype?k.value:!1);if(void 0!==f){V.setvar(f,n.real(1));b={element:c[0],value:L(a[3])};for(var m=1;m<c.length;m++){V.setvar(f,n.real(m+1));V.setvar(d,c[m]);var q=L(a[3]);b=0>p.compare(b.value,q)?b:{element:c[m],value:q}}V.removevar(f)}else for(b={element:c[0],value:L(a[3])},f=1;f<c.length;f++)V.setvar(d,c[f]),m=L(a[3]),b=0>p.compare(b.value,m)?b:{element:c[f],value:m};V.removevar(d);return k?b.element:b.value};z.add$2=Ne;z.sub$2=Id;z.mult$2=Hb;z.div$2=Ga;z.mod$2=function(a,b){b=Y(a[0]);
a=Y(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.mod(b,a):A};z.d$2=function(a,b){b=b.eps;void 0===b?b=n.real(1E-4):(b=L(b),"number"!==b.ctype&&(b=n.real(1E-4)));var c=a[0],d=Y(a[1]);V.newvar("#");V.setvar("#",n.add(d,b));a=L(c);V.setvar("#",n.sub(d,b));c=L(c);V.removevar("#");return n.div(n.sub(a,c),n.mult(b,n.real(2)))};z.tangent$2=function(a,b){b=b.eps;void 0===b?b=n.real(1E-4):(b=L(b),"number"!==b.ctype&&(b=n.real(1E-4)));var c=a[0],d=Y(a[1]);V.newvar("#");V.setvar("#",n.add(d,b));a=h.turnIntoCSList([n.add(d,
b),L(c),n.one]);V.setvar("#",n.sub(d,b));b=h.turnIntoCSList([n.sub(d,b),L(c),n.one]);V.removevar("#");return a!==A&&a!==A?(b=h.cross(a,b),b=p.withUsage(b,"Line")):A};z.pow$2=Pc;z.exp$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?n.exp(a):A};z.sin$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?n.sin(a):A};z.sqrt$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?n.sqrt(a):A};M.laguerre=function(a,b,c){if("list"!==a.ctype)return A;var d=a.value.length-1,f;for(f=0;f<=d;f++)if("number"!==a.value[f].ctype)return A;
if("number"!==b.ctype)return A;for(var k=[1,.3141,.5926,.5358,.9793,.2385,.6264,.3383,.2795,.0288],m,q,v,w=1;w<=c;w++){q=v=n.zero;m=a.value[d];for(f=d-1;0<=f;f--)v=n.add(q,n.mult(v,b)),q=n.add(m,n.mult(q,b)),m=n.add(a.value[f],n.mult(m,b));if(n._helper.isLessThan(n.abs(m),n.real(1E-14)))break;f=n.div(q,m);q=n.mult(f,f);m=n.sub(q,n.div(n.mult(n.real(2),v),m));v=n.sqrt(n.mult(n.real(d-1),n.sub(n.mult(n.real(d),m),q)));m=n.add(f,v);f=n.sub(f,v);n._helper.isLessThan(n.abs(m),n.abs(f))&&(m=f);f=n._helper.isLessThan(n.real(1E-14),
n.abs(m))?n.div(n.real(d),m):n.mult(n.add(n.abs(b),n.one),n.complex(Math.cos(w),Math.sin(w)));if(n._helper.isLessThan(n.abs(f),n.real(1E-14)))break;0===w%20&&w<c-19&&(f=n.mult(f,n.real(k[Math.floor(w/20)])));b=n.sub(b,f)}return b};M.quadratic_roots=function(a){if("list"!==a.ctype)return A;var b=a.value[2],c=a.value[1];a=a.value[0];if(n._helper.isZero(a))return[n.zero,n.neg(n.div(c,b))];var d=n.sqrt(n.sub(n.mult(c,c),n.mult(n.real(4),n.mult(b,a))));0<=n.re(c)&&(d=n.neg(d));return[n.div(n.sub(d,c),
n.mult(n.real(2),b)),n.div(n.mult(n.real(2),a),n.sub(d,c))]};M.roots=function(a){var b=[],c=a,d=a.value.length-1;if(0>=d)return h.turnIntoCSList([]);if(n._helper.isZero(a.value[d]))return b=M.roots(h.turnIntoCSList(a.value.slice(0,d))),h.append(b,n.infinity);if(1===d)b[0]=n.neg(n.div(a.value[0],a.value[1]));else if(2===d)b=M.quadratic_roots(a);else{for(var f=0;f<d-2;f++){b[f]=M.laguerre(a,n.zero,200);b[f]=M.laguerre(c,b[f],1);var k=[];k[d-f]=a.value[d-f];for(var m=d-f;0<m;m--)k[m-1]=n.add(a.value[m-
1],n.mult(k[m],b[f]));k.shift();a=h.turnIntoCSList(k)}a=M.quadratic_roots(a);b[d-2]=a[0];b[d-1]=a[1]}return h.turnIntoCSList(b)};z.roots$1=function(a,b){a=Y(a[0]);if("list"===a.ctype){for(b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return A;a=M.roots(a);return h.sort1(a)}return A};z.autodiff$3=function(a,b){b="x";if("function"===a[0].ctype){var c=D[a[0].oper].body;b=a[0].args[0].name}else if("function"===typeof a[0].impl)c=a[0];else return xb("could not parse function"),A;var d=Y(a[1]);
a=Y(a[2]);if(1>a.value.real)return xb("grade cant be < 1"),A;a=n.add(a,n.real(1));return Qa.autodiff(c,b,d,a)};z.cos$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?n.cos(a):A};z.tan$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?n.tan(a):A};z.arccos$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?n.arccos(a):A};z.arcsin$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?n.arcsin(a):A};z.arctan$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?n.arctan(a):A};z.arctan2$2=function(a,b){b=
Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.arctan2(b,a):A};z.arctan2$1=function(a,b){a=Y(a[0]);if("list"===a.ctype&&2===a.value.length){if(a=a.value,"number"===a[0].ctype&&"number"===a[1].ctype)return z.arctan2$2(a,b)}else if("number"===a.ctype)return n.arctan2(a);return A};z.log$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?n.log(a):A};M.recursiveGen=function(a){var b=n[a],c=h[a];z[a+"$1"]=function(d,f){d=Y(d[0]);return"number"===d.ctype?b(d):"list"===d.ctype?c(d):A}};
M.recursiveGen("im");M.recursiveGen("re");M.recursiveGen("conjugate");M.recursiveGen("round");M.recursiveGen("ceil");M.recursiveGen("floor");M.recursiveGen("abs");z.abs_infix=z.abs$1;z.random$0=function(a,b){return n.real(n._helper.rand())};z.random$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?n.complex(a.value.real*n._helper.rand(),a.value.imag*n._helper.rand()):A};z.seedrandom$1=function(a,b){a=Y(a[0]);"number"===a.ctype&&n._helper.seedrandom(a.value.real);return A};z.randomnormal$0=function(a,
b){return n.real(n._helper.randnormal())};z.randominteger$1=function(a,b){b=Y(a[0]);return"number"===b.ctype?(a=b.value.real|0,b=b.value.imag|0,a=a*n._helper.rand()|0,b=b*n._helper.rand()|0,n.complex(a,b)):A};z.randomint$1=z.randominteger$1;z.randombool$0=function(a,b){return.5<n._helper.rand()?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isreal$1=function(a,b){a=L(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isinteger$1=
function(a,b){a=L(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&a.value.real===Math.floor(a.value.real)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.iseven$1=function(a,b){a=L(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&a.value.real/2===Math.floor(a.value.real/2)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isodd$1=function(a,b){a=L(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&(a.value.real-1)/2===Math.floor((a.value.real-1)/2)?{ctype:"boolean",
value:!0}:{ctype:"boolean",value:!1}};z.iscomplex$1=function(a,b){return"number"===L(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isstring$1=function(a,b){return"string"===L(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.islist$1=function(a,b){return"list"===L(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.ismatrix$1=function(a,b){a=L(a[0]);return-1!==h._helper.colNumb(a)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.iscircle$1=
function(a,b){a=L(a[0]);return"geo"===a.ctype&&"C"===a.value.kind&&"Circle"===a.value.matrix.usage?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isconic$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&"C"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isline$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&"L"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.ispoint$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&"P"===a.value.kind?{ctype:"boolean",
value:!0}:{ctype:"boolean",value:!1}};z.isgeometric$1=function(a,b){return"geo"===L(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isnumbermatrix$1=function(a,b){a=L(a[0]);return h.isNumberMatrix(a)};z.isnumbervector$1=function(a,b){a=L(a[0]);return h.isNumberVector(a)};z.issun$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Sun"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.ismass$1=function(a,b){a=L(a[0]);return"geo"===
a.ctype&&void 0!==a.value.behavior&&"Mass"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isspring$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Spring"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isbouncer$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Bouncer"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isundefined$1=function(a,
b){return"undefined"===L(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};var ma={ArcBy3:"Arc",CenterOfConic:"Center",ConicBy1p4l:"Conic1P4L",ConicBy4p1l:"Conic4P1L",ConicBy5lines:"Conic5L",ConicBy2Foci1P:"ConicFoci",ConicFromPrincipalDirections:"ConicPrincipleDirs",Free:"FreePoint",PolarOfLine:"PolarLine",PolarOfPoint:"PolarPoint",PointOnSegment:"PointOnLine",Button:"Text",ToggleButton:"Text",TrReflectionL:"TrReflection",TrReflectionP:"TrReflection",TrReflectionC:"TrReflection",
TrTranslation:"TrProjection",TrSimilarity:"TrProjection",TrAffine:"TrProjection",TransformP:"Transform",TransformL:"Transform",TransformSegment:"Transform",TransformS:"Transform",TransformPolygon:"Transform",TransformArc:"Transform",TransformConic:"Transform",TransformC:"Transform",TrMoebiusP:"Transform",TrMoebiusL:"Transform",TrMoebiusSegment:"Transform",TrMoebiusS:"Transform",TrMoebiusPolygon:"Transform",TrMoebiusArc:"Transform",TrMoebiusCircle:"Transform",TrMoebiusC:"Transform",TrInverseMoebius:"TrInverse",
Perp:"Orthogonal",Para:"Parallel",AngleBisector:"AngularBisector",IntersectLC:"IntersectionConicLine",IntersectCirCir:"IntersectionCircleCircle",OtherPointOnCircle:"PointOnCircle"};z.algorithm$1=function(a,b){a=L(a[0]);if("geo"===a.ctype){a=a.value;var c=a.type;b=Y(b.compatibility);"string"===b.ctype&&/^cinderella$/i.test(b.value)&&(/^Select/.test(c)&&(a=G.csnames[a.args[0]],c=a.type),ma.hasOwnProperty(c)?c=ma[c]:"CircleMr"===c&&(c=a.pinned?"CircleByFixedRadius":"CircleByRadius"));return p.string(c)}return A};
z.inputs$1=function(a,b){a=L(a[0]);if("geo"===a.ctype){a=a.value;b=a.type;var c=[];a.args&&(c=a.args.map(function(d){return{ctype:"geo",value:G.csnames[d]}}));if(/^Select/.test(b)||u[b].isMovable)switch(a.kind){case "P":case "L":c.push(a.homog);break;case "C":c.push(a.matrix)}return h.turnIntoCSList(c)}return A};z.moveto$2=function(a,b){b=L(a[0]);a=Y(a[1]);"geo"===b.ctype&&(b=b.value,h._helper.isNumberVecN(a,2)?la.setField(b,"xy",a):h._helper.isNumberVecN(a,3)&&la.setField(b,"homog",a));return A};
z.continuefromhere$0=function(a,b){Zc();return A};z.matrixrowcolumn$1=function(a,b){a=L(a[0]);return-1!==h._helper.colNumb(a)?h.realVector([a.value.length,a.value[0].value.length]):A};z.rowmatrix$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.turnIntoCSList([a]):A};z.columnmatrix$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.turnIntoCSList(a.value.map(function(c){return h.turnIntoCSList([c])})):A};z.submatrix$3=function(a,b){b=L(a[0]);var c=L(a[1]);a=L(a[2]);if("list"===b.ctype&&"number"===
c.ctype&&"number"===a.ctype){var d=Math.round(c.value.real);a=Math.round(a.value.real);b=b.value.slice();0<a&&a<=b.length&&b.splice(a-1,1);var f=!0;b=b.map(function(k){if("list"!==k.ctype)f=!1;else return k=k.value.slice(),0<d&&d<=k.length&&k.splice(d-1,1),h.turnIntoCSList(k)});return f?h.turnIntoCSList(b):A}return A};z.complex$1=function(a,b){var c=Y(a[0]);if("list"===c.ctype&&h.isNumberVector(c)){if(2===c.value.length)return a=c.value[0],b=c.value[1],n.complex(a.value.real-b.value.imag,b.value.real+
a.value.imag);if(3===c.value.length)return a=c.value[0],b=c.value[1],c=c.value[2],a=n.div(a,c),b=n.div(b,c),n.complex(a.value.real-b.value.imag,b.value.real+a.value.imag)}return A};z.gauss$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?h.realVector([a.value.real,a.value.imag]):A};z.cross$2=vc;z.crossratio$4=function(a,b){b=L(a[0]);var c=L(a[1]),d=L(a[2]);a=L(a[3]);var f=Fa(b),k=Fa(c),m=Fa(d),q=Fa(a);return f!==A&&k!==A&&m!==A&&q!==A?h.crossratio3(f,k,m,q,h.ii):"number"===b.ctype&&"number"===c.ctype&&
"number"===d.ctype&&"number"===a.ctype?n.div(n.mult(n.sub(b,d),n.sub(c,a)),n.mult(n.sub(b,a),n.sub(c,d))):A};z.para$2=function(a,b){b=Y(a[0]);var c=Y(a[1]);a=Fa(b);var d=Fa(c);if(b!==A&&c!==A){c=c.usage;var f=a,k=d;if("Line"===b.usage||"Point"===c)f=d,k=a;b=h.cross(h.cross(h.linfty,k),f);return p.withUsage(b,"Line")}return A};z.perp$2=function(a,b){b=Y(a[0]);var c=Y(a[1]);a=Fa(b);var d=Fa(c);if(b!==A&&c!==A){var f=c.usage||d.usage;c=a;var k=d;if("Line"===(b.usage||a.usage)||"Point"===f)c=d,k=a;b=
h.turnIntoCSList([k.value[0],k.value[1],n.zero]);b=h.cross(b,c);return p.withUsage(b,"Line")}return A};z.perp$1=function(a,b){a=Y(a[0]);return h._helper.isNumberVecN(a,2)?h.turnIntoCSList([n.neg(a.value[1]),a.value[0]]):A};z.parallel$2=z.para$2;z.perpendicular$2=z.perp$2;z.perpendicular$1=z.perp$1;z.meet$2=function(a,b){b=Fa(a[0]);a=Fa(a[1]);return b!==A&&a!==A?(a=h.cross(b,a),p.withUsage(a,"Point")):A};z.join$2=function(a,b){b=Fa(a[0]);a=Fa(a[1]);return b!==A&&a!==A?(a=h.cross(b,a),p.withUsage(a,
"Line")):A};z.dist$2=function(a,b){b=Y(a[0]);a=Y(a[1]);a=Id([b,a],[]);return z.abs$1([a],[])};z.dist_infix=z.dist$2;z.point$1=function(a,b){a=L(a[0]);return h._helper.isNumberVecN(a,3)||h._helper.isNumberVecN(a,2)?p.withUsage(a,"Point"):a};z.line$1=function(a,b){a=L(a[0]);return h._helper.isNumberVecN(a,3)?p.withUsage(a,"Line"):a};z.det$3=function(a,b){b=Fa(a[0]);var c=Fa(a[1]);a=Fa(a[2]);if(b!==A&&c!==A&&a!==A)return h.det3(b,c,a)};z.det$1=function(a,b){a=Y(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),
-1!==b&&b===a.value.length)?h.det(a):A};z.eig$1=function(a,b){a=Y(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a):A};z.eigenvalues$1=function(a,b){a=Y(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a,!1).value[0]:A};z.rank$1=function(a,b){a=Y(a[0]);if("list"===a.ctype){var c=h._helper.colNumb(a);if(-1!==c&&c===a.value.length)return h.rank(a,b.precision)}return A};z.kernel$1=function(a,b){a=Y(a[0]);if("list"===a.ctype){var c=
h._helper.colNumb(a);if(-1!==c&&c===a.value.length)return b=h.nullSpace(a,b.precision),h.transpose(b)}return A};z.eigenvectors$1=function(a,b){a=Y(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a).value[1]:A};z.area$3=function(a,b){b=Fa(a[0]);var c=Fa(a[1]);a=Fa(a[2]);if(b!==A&&c!==A&&a!==A){var d=b.value[2],f=c.value[2],k=a.value[2];if(!n._helper.isAlmostZero(d)&&!n._helper.isAlmostZero(f)&&!n._helper.isAlmostZero(k))return b=h.scaldiv(d,b),c=h.scaldiv(f,
c),a=h.scaldiv(k,a),b=h.det3(b,c,a),n.realmult(.5,b)}return A};z.inverse$1=function(a,b){a=Y(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.inverse(a):A};z.linearsolve$2=function(a,b){b=Y(a[0]);a=Y(a[1]);if("list"===b.ctype){var c=h._helper.colNumb(b);if(-1!==c&&c===b.value.length&&h._helper.isNumberVecN(a,c))return h.linearsolve(b,a)}return A};var xa=[[[]],[[0]],[[0,1],[1,0]],[[0,1,2],[0,2,1],[1,0,2],[1,2,0],[2,0,1],[2,1,0]],[[0,1,2,3],[0,1,3,2],[0,2,1,3],[0,
2,3,1],[0,3,1,2],[0,3,2,1],[1,0,2,3],[1,0,3,2],[1,2,0,3],[1,2,3,0],[1,3,0,2],[1,3,2,0],[2,0,1,3],[2,0,3,1],[2,1,0,3],[2,1,3,0],[2,3,0,1],[2,3,1,0],[3,0,1,2],[3,0,2,1],[3,1,0,2],[3,1,2,0],[3,2,0,1],[3,2,1,0]]];z.mincostmatching$1=function(a,b){var c=L(a[0]);if(h.isNumberMatrix(c).value){a=c.value.length;b=h._helper.colNumb(c);var d=a<b?b:a,f,k,m=Array(d);for(f=0;f<d;++f)for(m[f]=Array(d),k=0;k<d;++k)m[f][k]=f<a&&k<b?c.value[f].value[k].value.real:0;c=Lc(m);d=Array(a);for(f=0;f<a;++f)k=c[f],d[f]=k<
b?n.real(k+1):n.real(0);return h.turnIntoCSList(d)}return A};z.take$2=vd;z.length$1=function(a,b){a=L(a[0]);return"list"===a.ctype||"string"===a.ctype?n.real(a.value.length):n.real(h.asList(a).value.length)};z.pairs$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.pairs(a):A};z.triples$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.triples(a):A};z.cycle$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.cycle(a):A};z.consecutive$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.consecutive(a):
A};z.reverse$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.reverse(a):"string"===a.ctype?(a=Array.from(a.value).reverse().join(""),p.string(a)):A};z.directproduct$2=function(a,b){b=L(a[0]);a=L(a[1]);return"list"===b.ctype&&"list"===a.ctype?h.directproduct(b,a):A};z.concat$2=wc;z.common$2=S;z.remove$2=wd;z.append$2=me;z.prepend$2=ne;z.contains$2=function(a,b){b=L(a[0]);a=L(a[1]);return"list"===b.ctype?h.contains(b,a):A};z.sort$2=function(a,b){return z.sort$3([a[0],null,a[1]],b)};z.sort$3=function(a,
b){return z.sort$4([a[0],a[1],null,a[2]],b)};z.sort$4=function(a,b){b=Y(a[0]);if("list"!==b.ctype)return A;var c="#";null!==a[1]&&"variable"===a[1].ctype&&(c=a[1].name);if(null!==a[2]&&"variable"===a[2].ctype){var d=a[2].name;V.newvar(d)}b=b.value;var f=[];V.newvar(c);if(void 0!==d){for(var k=0;k<b.length;k++)V.setvar(d,n.real(k+1)),V.setvar(c,b[k]),f[k]={val:b[k],result:L(a[3])};V.removevar(d)}else for(d=0;d<b.length;d++)V.setvar(c,b[d]),f[d]={val:b[d],result:L(a[3])};V.removevar(c);f.sort(p.compareResults);
a=[];for(c=0;c<b.length;c++)a[c]=f[c].val;return{ctype:"list",value:a}};z.sort$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.sort1(a):A};z.set$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.set(a):A};z.combinations$2=function(a,b){function c(E,J){E===f?x.push(h.turnIntoCSList(B.slice())):J<k&&(B[E]=d.value[J],c(E+1,J+1),c(E,J+1))}var d=L(a[0]);a=L(a[1]);if("number"===a.ctype){var f=a.value.real|0;if("number"===d.ctype){var k=d.value.real|0;k-f<f&&(f=k-f);if(0>f)return n.real(0);if(0===f)return n.real(1);
if(1===f)return d;for(var m=b=a=1;m<=f;++m){var q=k-f+m|0,v=m|0,w=xd(q,v)|0;q=q/w|0;v=v/w|0;w=xd(a,v)|0;a=a/w|0;v=v/w|0;w=xd(q,b)|0;q=q/w|0;b=b/w|0;a=a*q|0;b=b*v|0}return n.real(a/b)}if("list"===d.ctype){k=d.value.length;if(0>f||f>k)return h.turnIntoCSList([]);if(0===f)return h.turnIntoCSList([h.turnIntoCSList([])]);if(f===k)return h.turnIntoCSList([d]);var x=[];var B=Array(f);c(0,0);return h.turnIntoCSList(x)}}return A};z.zeromatrix$2=function(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===b.ctype&&"number"===
a.ctype?h.zeromatrix(b,a):A};z.zerovector$1=function(a,b){a=Y(a[0]);return"number"===a.ctype?h.zerovector(a):A};z.transpose$1=function(a,b){a=Y(a[0]);return"list"===a.ctype&&-1!==h._helper.colNumb(a)?h.transpose(a):A};z.row$2=function(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===a.ctype&&"list"===b.ctype&&-1!==h._helper.colNumb(b)?h.row(b,a):A};z.column$2=function(a,b){b=Y(a[0]);a=Y(a[1]);return"number"===a.ctype&&"list"===b.ctype&&-1!==h._helper.colNumb(b)?h.column(b,a):A};z.dict$0=function(a,b){a=
O.create();for(var c in b)b.hasOwnProperty(c)&&O.put(a,p.string(c),L(b[c]));return a};z.put$3=function(a,b){b=L(a[0]);var c=L(a[1]);a=L(a[2]);return"dict"===b.ctype?(b=O.clone(b),O.put(b,c,a),b):A};z.get$2=function(a,b){b=L(a[0]);a=L(a[1]);return"dict"===b.ctype?O.get(b,a,A):A};z.red$1=function(a,b){a=L(a[0]);return"number"===a.ctype?h.realVector([Math.min(1,Math.max(0,a.value.real)),0,0]):A};z.green$1=function(a,b){a=L(a[0]);return"number"===a.ctype?h.realVector([0,Math.min(1,Math.max(0,a.value.real)),
0]):A};z.blue$1=function(a,b){a=L(a[0]);return"number"===a.ctype?h.realVector([0,0,Math.min(1,Math.max(0,a.value.real))]):A};z.gray$1=function(a,b){a=L(a[0]);return"number"===a.ctype?(a=Math.min(1,Math.max(0,a.value.real)),h.realVector([a,a,a])):A};z.grey$1=z.gray$1;M.HSVtoRGB=function(a,b,c){a&&void 0===b&&void 0===c&&(b=a.s,c=a.v,a=a.h);var d=Math.floor(6*a);var f=6*a-d;a=c*(1-b);var k=c*(1-f*b);b=c*(1-(1-f)*b);switch(d%6){case 0:var m=c;var q=b;var v=a;break;case 1:m=k;q=c;v=a;break;case 2:m=a;
q=c;v=b;break;case 3:m=a;q=k;v=c;break;case 4:m=b;q=a;v=c;break;case 5:m=c,q=a,v=k}return h.realVector([m,q,v])};z.hue$1=function(a,b){a=L(a[0]);return"number"===a.ctype?(a=a.value.real,a-=Math.floor(a),M.HSVtoRGB(a,1,1)):A};M.shapeconvert=function(a){if("circle"===a.type){var b=a.value.value[0];b=p.div(b,b.value[2]);var c=b.value[0].value.real,d=b.value[1].value.real;a=a.value.value[1].value.real;var f=Array(125);var k=2*Math.PI/125;for(b=0;125>b;b++)f[b]={X:c+Math.cos(b*k)*a,Y:d+Math.sin(b*k)*a};
return[f]}if("polygon"===a.type){c=[];for(b=0;b<a.value.length;b++){d=a.value[b];f=[];for(k=0;k<d.length;k++)f[k]={X:d[k].X,Y:d[k].Y};c[b]=f}return c}};M.shapeop=function(a,b,c){a=M.shapeconvert(a);var d=M.shapeconvert(b);ClipperLib.JS.ScaleUpPaths(a,1E3);ClipperLib.JS.ScaleUpPaths(d,1E3);b=new ClipperLib.Clipper;b.AddPaths(a,ClipperLib.PolyType.ptSubject,!0);b.AddPaths(d,ClipperLib.PolyType.ptClip,!0);d=a=ClipperLib.PolyFillType.pftNonZero;var f=new ClipperLib.Paths;b.Execute(c,f,a,d);ClipperLib.JS.ScaleDownPaths(f,
1E3);return{ctype:"shape",type:"polygon",value:f}};M.shapecommon=function(a,b){return M.shapeop(a,b,ClipperLib.ClipType.ctIntersection)};M.shaperemove=function(a,b){return M.shapeop(a,b,ClipperLib.ClipType.ctDifference)};M.shapeconcat=function(a,b){return M.shapeop(a,b,ClipperLib.ClipType.ctUnion)};z.key$0=function(a,b){return{ctype:"string",value:be}};z.keycode$0=function(a,b){return n.real(ce)};z.mouse$0=function(a,b){return b.id?(a=L(b.id),"number"===a.ctype&&(a=a.value.real,Tc[a])?h.realVector(Tc[a]):
A):h.realVector(Cb)};z.mover$0=function(a,b){return wb&&wb.mover?{ctype:"geo",value:wb.mover}:A};z.multiid$0=function(a,b){return n.real(rc)};z.multiidlist$0=function(a,b){a=[];for(var c in Tc)a.push(c);return h.realVector(a)};z.translate$1=function(a,b){a=Y(a[0]);"list"===a.ctype&&h.isNumberVector(a)&&2===a.value.length&&P.translate(a.value[0].value.real,a.value[1].value.real);return A};z.rotate$1=function(a,b){a=Y(a[0]);"number"===a.ctype&&P.rotate(a.value.real);return A};z.scale$1=function(a,b){a=
Y(a[0]);"number"===a.ctype&&P.scale(a.value.real);return A};z.greset$0=function(a,b){a=bd.stack.length;P.greset();for(b=0;b<a;b++)Q.restore();return A};z.gsave$0=function(a,b){P.gsave();Q.save();return A};z.grestore$0=function(a,b){P.grestore();Q.restore();return A};z.color$1=function(a,b){a=Y(a[0]);"list"===a.ctype&&h.isNumberVector(a).value&&P.setcolor(a);return A};z.linecolor$1=function(a,b){a=Y(a[0]);"list"===a.ctype&&h.isNumberVector(a).value&&P.setlinecolor(a);return A};z.pointcolor$1=function(a,
b){a=Y(a[0]);"list"===a.ctype&&h.isNumberVector(a).value&&P.setpointcolor(a);return A};z.alpha$1=function(a,b){a=Y(a[0]);"number"===a.ctype&&P.setalpha(a);return A};z.pointsize$1=function(a,b){a=Y(a[0]);"number"===a.ctype&&P.setpointsize(a);return A};z.linesize$1=function(a,b){a=Y(a[0]);"number"===a.ctype&&P.setlinesize(a);return A};z.textsize$1=function(a,b){a=Y(a[0]);"number"===a.ctype&&P.settextsize(a);return A};z.playanimation$0=function(a,b){Ia();return A};z.pauseanimation$0=function(a,b){Ob();
return A};z.stopanimation$0=function(a,b){Sb();return A};z.text$1=function(a,b){a=Y(a[0]);return p.string(Ea(a))};z.replace$3=function(a,b){var c=L(a[0]);b=L(a[1]);a=L(a[2]);if("string"===c.ctype&&"string"===b.ctype&&"string"===a.ctype)return c=c.value,b=b.value.replace(/[^A-Za-z0-9]/g,"\\$&"),a=a.value.replace(/\$/g,"$$$$"),c=c.replace(new RegExp(b,"g"),a),{ctype:"string",value:c}};z.replace$2=function(a,b){function c(q,v,w){var x="";d=m=-1;for(var B=0;B<v.length;B++){var E=v[B][0],J=q.indexOf(E,
w);-1!==J&&(-1===m?(x=E,m=J,d=B):J<m&&(x=E,m=J,d=B))}return x}var d;b=L(a[0]);var f=L(a[1]);if("string"===b.ctype&&"list"===f.ctype){a=b.value;b=[];f=$jscomp.makeIterator(f.value);for(var k=f.next();!k.done;k=f.next())k=k.value,"list"===k.ctype&&2===k.value.length&&"string"===k.value[0].ctype&&"string"===k.value[1].ctype&&(b[b.length]=[k.value[0].value,k.value[1].value]);var m=-1;for(f=c(a,b,0);-1!==m;)a=a.substring(0,m)+b[d][1]+a.substring(m+f.length,a.length),f=m+b[d][1].length,f=c(a,b,f);return{ctype:"string",
value:a}}return A};z.substring$3=function(a,b){b=L(a[0]);var c=Y(a[1]);a=Y(a[2]);return"string"===b.ctype&&"number"===c.ctype&&"number"===a.ctype?{ctype:"string",value:b.value.substring(Math.floor(c.value.real),Math.floor(a.value.real))}:A};z.tokenize$2=function(a,b){var c=L(a[0]);a=L(a[1]);if("string"===c.ctype&&"string"===a.ctype)return z.tokenize$2([c,h.turnIntoCSList([a])],b);if("string"===c.ctype&&"list"===a.ctype){c=c.value;if(0===a.value.length){a=!0;if(void 0!==b.autoconvert){var d=L(b.autoconvert);
"boolean"===d.ctype&&(a=d.value)}return a&&""!==c&&(a=Number(c),!isNaN(a))?n.real(a):p.string(c)}d=a.value[0];var f=h.turnIntoCSList(a.value.slice(1));c=c.split(d.value);return h.turnIntoCSList(c.map(function(k){return z.tokenize$2([p.string(k),f],b)}))}return A};z.indexof$2=function(a,b){b=L(a[0]);a=L(a[1]);return"string"===b.ctype&&"string"===a.ctype?(a=b.value.indexOf(a.value),n.real(a+1)):A};z.indexof$3=function(a,b){b=L(a[0]);var c=L(a[1]);a=L(a[2]);return"string"===b.ctype&&"string"===c.ctype&&
"number"===a.ctype?(a=b.value.indexOf(c.value,Math.round(a.value.real)-1),n.real(a+1)):A};z.parse$1=function(a,b){a=L(a[0]);return"string"===a.ctype?(a=Bc(a.value),L(a)):A};z.import$1=function(a,b){var c,d,f,k,m,q,v;return $jscomp.asyncExecutePromiseGeneratorProgram(function(w){switch(w.nextAddress){case 1:c="";d=L(a[0]);if("string"!==d.ctype)return w.return(A);d=d.value;console.log("Loading "+d+" ...");f=-1==d.search(/.+\.cjs$/)?d+".cjs":d;w.setCatchFinallyBlocks(2);return w.yield(fetch(f),4);case 4:k=
w.yieldResult;if(200!==k.status){console.log("CAUTION! Import of "+d+" failed.");w.jumpTo(5);break}return w.yield(k.text(),6);case 6:return m=w.yieldResult,q=";"==m[m.length-1]?"":";",c=m+q,console.log(d+" loaded!"),w.return(z.parse$1([{ctype:"string",value:c}],{}));case 5:w.leaveTryBlock(3);break;case 2:if(v=w.enterCatchBlock(),"Failed to fetch"===v.message)console.log("CAUTION! Import of "+d+" failed."),console.log("This website seems to not run on a web server. CindyJS will continue without importing "+
d+".");else throw v;case 3:return w.return(A)}})};z.unicode$1=function(a,b){a=L(a[0]);var c=16;b.base&&(b=L(b.base),"number"===b.ctype&&(c=b.value.real));if("string"===a.ctype)b=parseInt(a.value,c);else if("number"===a.ctype)b=a.value.real;else return A;"undefined"!==typeof String.fromCodePoint?b=String.fromCodePoint(b):65535>=b?b=String.fromCharCode(b):(b-=65536,b=String.fromCharCode((b>>10)+55296,(b&1023)+56320));return p.string(b)};z.international$1=function(a,b){return z.international$2([a[0],
null],b)};z.international$2=function(a,b){b=L(a[0]);if("string"!==b.ctype)return A;var c=(Z.translations||{})[Z.language||"en"]||{};if(!c.hasOwnProperty(b.value))return b;var d=c[b.value];if("string"===typeof d)return p.string(d);if(null===a[1])return b;a=L(a[1]);a="number"===a.ctype?a.value.real:0;a=(c._pluralFormFunction||Oe)(a);return a<d.length?p.string(d[a]):b};z.currentlanguage$0=function(a,b){return p.string(Z.language||"en")};M.basismap=function(a,b,c,d){var f=h.turnIntoCSList([a,b,c]);f=
h.adjoint3(h.transpose(f));d=p.mult(f,d);f=h.turnIntoCSList([p.mult(d.value[0],a),p.mult(d.value[1],b),p.mult(d.value[2],c)]);return h.transpose(f)};z.map$8=function(a,b){b=Fa(a[0]);var c=Fa(a[1]),d=Fa(a[2]),f=Fa(a[3]),k=Fa(a[4]),m=Fa(a[5]),q=Fa(a[6]);a=Fa(a[7]);return k!==A&&m!==A&&q!==A&&a!==A&&b!==A&&c!==A&&d!==A&&f!==A?(a=M.basismap(k,m,q,a),b=M.basismap(b,c,d,f),b=p.mult(a,h.adjoint3(b)),h.normalizeMax(b)):A};z.map$6=function(a,b){b=Fa(a[0]);var c=Fa(a[1]),d=Fa(a[2]),f=h.realVector([0,0,1]),
k=h.cross,m=k(k(d,k(f,k(b,c))),k(c,k(f,k(b,d)))),q=Fa(a[3]),v=Fa(a[4]);a=Fa(a[5]);f=k(k(a,k(f,k(q,v))),k(v,k(f,k(q,a))));return q!==A&&v!==A&&a!==A&&f!==A&&b!==A&&c!==A&&d!==A&&m!==A?(q=M.basismap(q,v,a,f),b=M.basismap(b,c,d,m),b=p.mult(q,h.adjoint3(b)),h.normalizeMax(b)):A};z.map$4=function(a,b){b=h.ii;var c=h.jj,d=Fa(a[0]),f=Fa(a[1]),k=Fa(a[2]);a=Fa(a[3]);return k!==A&&a!==A&&d!==A&&f!==A?(a=M.basismap(k,a,b,c),b=M.basismap(d,f,b,c),b=p.mult(a,h.adjoint3(b)),h.normalizeMax(b)):A};z.map$2=function(a,
b){b=h.ii;var c=h.jj,d=Fa(a[0]),f=p.add(h.realVector([1,0,0]),d);a=Fa(a[1]);var k=p.add(h.realVector([1,0,0]),a);return a!==A&&k!==A&&d!==A&&f!==A?(a=M.basismap(a,k,b,c),b=M.basismap(d,f,b,c),b=p.mult(a,h.adjoint3(b)),h.normalizeMax(b)):A};z.pointreflect$1=function(a,b){b=h.ii;var c=h.jj;a=Fa(a[0]);var d=p.add(h.realVector([1,0,0]),a),f=p.add(h.realVector([-1,0,0]),a);return f!==A&&a!==A&&d!==A?(f=M.basismap(a,f,b,c),b=M.basismap(a,d,b,c),b=p.mult(f,h.adjoint3(b)),h.normalizeMax(b)):A};z.linereflect$1=
function(a,b){b=h.ii;var c=h.jj;a=Fa(a[0]);var d=h.realVector([Math.random(),Math.random(),Math.random()]),f=h.realVector([Math.random(),Math.random(),Math.random()]);d=h.cross(d,a);f=h.cross(f,a);return a!==A&&d!==A?(a=M.basismap(d,f,b,c),b=M.basismap(d,f,c,b),b=p.mult(a,h.adjoint3(b)),h.normalizeMax(b)):A};M.extractPointVec=function(a){var b={ok:!1};if("geo"===a.ctype){var c=a.value;if("P"===c.kind)return b.x=la.getField(c,"x"),b.y=la.getField(c,"y"),b.z=n.real(1),b.ok=!0,b}if("list"!==a.ctype)return b;
var d=a.value;if(2===d.length&&(a=d[0],c=d[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a,b.y=c,b.z=n.real(1),b.ok=!0,b;3===d.length&&(a=d[0],c=d[1],d=d[2],"number"===a.ctype&&"number"===c.ctype&&"number"===d.ctype&&(b.x=n.div(a,d),b.y=n.div(c,d),b.z=n.real(1),b.ok=!0));return b};z.polygon$1=function(a,b){a=L(a[0]);if("list"===a.ctype){b=[];for(var c=0;c<a.value.length;c++){var d=M.extractPoint(a.value[c]);if(!d.ok)return A;b[c]={X:d.x,Y:d.y}}return{ctype:"shape",type:"polygon",value:[b]}}return A};
z.circle$2=function(a,b){b=Y(a[0]);a=Y(a[1]);b=M.extractPointVec(b);if(!b.ok||"number"!==a.ctype)return A;b=h.turnIntoCSList([b.x,b.y,b.z]);return{ctype:"shape",type:"circle",value:h.turnIntoCSList([b,a])}};z.screen$0=function(a,b){var c=P.drawingstate.initialmatrix;a=function(d,f){d-=c.tx;f+=c.ty;return{X:(d*c.d-f*c.b)/c.det,Y:-(-d*c.c+f*c.a)/c.det}};return{ctype:"shape",type:"polygon",value:[[a(0,0),a(pb,0),a(pb,rb),a(0,rb)]]}};z.halfplane$2=function(a,b){b=Y(a[0]);a=Y(a[1]);var c=Fa(b),d=Fa(a);
if(b!==A&&a!==A){var f=a.usage;a=c;var k=d;if("Line"===b.usage||"Point"===f)a=d,k=c;b=h.turnIntoCSList([k.value[0],k.value[1],n.zero]);b=h.cross(b,a);k=h.cross(k,b);k=p.div(k,k.value[2]);a=p.div(a,a.value[2]);a=h.sub(a,k);b=h.abs(a);a=p.div(a,b);b=k.value[0].value.real;k=k.value[1].value.real;c=1E3*a.value[0].value.real;a=1E3*a.value[1].value.real;return{ctype:"shape",type:"polygon",value:[[{X:b+a/2,Y:k-c/2},{X:b+a/2+c,Y:k-c/2+a},{X:b-a/2+c,Y:k+c/2+a},{X:b-a/2,Y:k+c/2}]]}}return A};z.element$1=function(a,
b){a=L(a[0]);return"string"===a.ctype&&G.csnames.hasOwnProperty(a.value)?{ctype:"geo",value:G.csnames[a.value]}:A};M.all$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&a.value.incidences?h.ofGeos(a.value.incidences.map(function(c){return G.csnames[c]}).filter(b)):h.nil};z.allpoints$0=function(a,b){return h.ofGeos(G.points)};z.allpoints$1=function(a,b){return M.all$1(a,function(c){return"P"===c.kind})};z.allmasses$0=function(a,b){return h.ofGeos(Rb)};z.allmasses$1=function(a,b){return M.all$1(a,
function(c){return"P"===c.kind&&c.behavior&&"Mass"===c.behavior.type})};z.allsprings$0=function(a,b){return h.ofGeos(Gf)};z.allsprings$1=function(a,b){return M.all$1(a,function(c){return"S"===c.kind&&c.behavior&&"Spring"===c.behavior.type})};z.alllines$0=function(a,b){return h.ofGeos(G.lines)};z.alllines$1=function(a,b){return M.all$1(a,function(c){return"L"===c.kind||"S"===c.kind})};z.allsegments$0=function(a,b){return h.ofGeos(G.lines.filter(function(c){return"S"===c.kind}))};z.allsegments$1=function(a,
b){return M.all$1(a,function(c){return"S"===c.kind})};z.allconics$0=function(a,b){return h.ofGeos(G.conics)};z.allconics$1=function(a,b){return M.all$1(a,function(c){return"C"===c.kind})};z.allcircles$0=function(a,b){return h.ofGeos(G.conics.filter(function(c){return"Circle"===c.matrix.usage}))};z.allcircles$1=function(a,b){return M.all$1(a,function(c){return"C"===c.kind&&"Circle"===c.matrix.usage})};z.allelements$0=function(a,b){return h.ofGeos(G.gslp)};z.allelements$1=function(a,b){return M.all$1(a,
function(c){return!0})};z.elementsatmouse$0=function(a,b){var c=h.realVector([Cb[0],Cb[1],1]),d=function(q){if(n._helper.isAlmostZero(q.value[2]))return Infinity;q=h.normalizeZ(q);return h.abs(h.sub(q,c)).value.real},f=function(q){q=h.turnIntoCSList([q.value[0],q.value[1],n.zero]);return h.normalizeMax(h.cross(c,q))},k=function(q){var v=p.mult(q.matrix,c);v=f(v);q=u._helper.IntersectLC(v,q.matrix).map(function(w){return d(w)});return.5>Math.min(q[0],q[1])};a=G.points.filter(function(q){return.5>d(q.homog)});
b=G.lines.filter(function(q){var v=f(q.homog);v=h.normalizeMax(h.cross(q.homog,v));if((v=.5>d(v))&&"S"===q.kind){var w=q.homog;w=h.turnIntoCSList([w.value[0],w.value[1],n.zero]);q=h.crossratio3(q.farpoint,q.startpos,q.endpos,c,w).value.real;if(0>q||1<q)v=!1}return v});var m=G.conics.filter(function(q){var v=k(q);if(v&&q.isArc){var w=h.crossratio3harm(q.startPoint,q.endPoint,q.viaPoint,c,h.ii);q=w.value[0];w=w.value[1];n._helper.isAlmostZero(q)?(q=n.div(q,w),w=n.real(1)):(w=n.div(w,q),q=n.real(1));
var x=h.abs(h.turnIntoCSList([w,q]));q=n.div(q,x);w=n.div(w,x);w=n.mult(w,q);0>q.value.real&&(w=n.neg(w));0>w.value.real&&(v=!1)}return v});a=a.concat(b,m);return h.ofGeos(a)};z.incidences$1=z.allelements$1;z.createpoint$2=function(a,b){b=L(a[0]);a=Fa(a[1]);return"string"!==b.ctype?(xb("Name must be a string"),A):"list"!==a.ctype&&h.isNumberVector(a)?(xb("Position must be a number vector"),A):{ctype:"geo",value:ve({name:b.value,type:"Free",labeled:!0,pos:a})}};z.create$3=function(a,b){var c=L(a[0]),
d=L(a[1]),f=L(a[2]);a={};for(var k in b)a[k]=Y(b[k]);if("string"===c.ctype)k=c.value;else{if("list"!==c.ctype)return xb("Names must be a string or a list of strings"),A;if(1!==c.value.length){k=p.string(c.value.map(function(w){return w.value}).join("__"));f=z.create$3([k,d,f],a);var m=[];if(f!==A)for(d=p.string(f.value.kind.replace(/^(.*)s$/,"Select$1")),f=h.turnIntoCSList([p.string(f.value.name)]),b=0;b<c.value.length;++b)a.index=n.real(b+1),m.push(z.create$3([c.value[b],d,f],a));return h.turnIntoCSList(m)}if("string"!==
c.value[0].ctype)return xb("Element of names list must be a string"),A;k=c.value[0].value}if("string"!==d.ctype)return xb("Type must be a string"),A;if("list"!==f.ctype)return xb("Arguments must be a list"),A;if(!u.hasOwnProperty(d.value)&&!ie.hasOwnProperty(d.value)&&!Df.hasOwnProperty(d.value))return xb("Invalid geometric operation: '"+d.value+"'"),A;c=[];var q=null;for(b=0;b<f.value.length;b++){var v=f.value[b];if("string"===v.ctype)c.push(v.value);else if("geo"===v.ctype)c.push(v.value.name);
else if(q=Fa(v),q===A)return xb("Unknown argument type"),A}f={name:k,type:d.value,labeled:!0};q&&(f.pos=q);0<c.length&&(f.args=c);for(m in a)f[m]=p.unwrap(a[m]);return{ctype:"geo",value:jc(f,!0)}};z.create$2=function(a,b){function c(v){function w(E){G.csnames[E]||(x=E)}var x=!1,B;if("P"===v)for(B=0;26>B&!x;B++)8!==B&&9!==B&&w(String.fromCharCode(65+B));else if("L"===v||"S"===v)for(B=0;26>B&!x;B++)8!==B&&9!==B&&w(String.fromCharCode(97+B));for(B=0;!x;B++)w(v+B);return x}var d=L(a[0]);a=L(a[1]);var f=
{};for(k in b)f[k]=Y(b[k]);if(!u.hasOwnProperty(d.value)&&!ie.hasOwnProperty(d.value)&&!Df.hasOwnProperty(d.value))return xb("Invalid geometric operation: '"+d.value+"'"),A;for(;ie.hasOwnProperty(d.value);)d.value=ie[d.value];var k=u[d.value];b=p.string(c(k.kind));if(a.value.length>k.signature.length){var m="Operation "+d.value+" requieres only "+k.signature.length+" argument"+(1===k.signature.length?"":"s")+" ("+a.value.length+" argument"+(1===a.value.length?"":"s")+" given) to create "+b.value+
". Ignoring the last arguments.";if(!f.pos){var q=Fa(a.value[a.value.length-1]);q!==A&&(m+=" Use the last argument as modifier `pos`.",f.pos=q)}xb(m);a=h.turnIntoCSList(a.value.slice(0,k.signature.length))}k=z.create$3([b,d,a],f);if(k!==A&&"s"===k.value.kind[1]&&k.value.results){d=p.string("Select"+k.value.kind[0]);a=h.turnIntoCSList([p.string(k.value.name)]);if(f.pos)return b=p.string(c(k.value.kind[0])),z.create$3([b,d,a],f);m=[];for(q=0;q<k.value.results.value.length;q++)f.index=n.real(q+1),b=
p.string(c(k.value.kind[0])),m.push(z.create$3([b,d,a],f));return h.turnIntoCSList(m)}k.isDuplicate&&delete k.isDuplicate;return k};$a._helper.self=A;z.self$0=function(a,b){return $a._helper.self};z.eval$1=function(a,b){Object.entries(b).forEach(function(c){var d=$jscomp.makeIterator(c);c=d.next().value;d=d.next().value;d=L(d);V.newvar(c);V.setvar(c,d)});V.pushVstack("*");a=L(a[0]);V.cleanVstack();Object.entries(b).forEach(function(c){c=$jscomp.makeIterator(c);var d=c.next().value;c.next();V.removevar(d)});
return a};z.javascript$1=function(a,b){a=L(a[0]);"string"===a.ctype&&(new Function(a.value)).call(Vb);return A};z.use$1=function(a,b){function c(f,k,m){z[f.toLowerCase()+"$"+k]=m}a=L(a[0]);if("string"===a.ctype){a=a.value;var d;Z.plugins&&(d=Z.plugins[a]);d||(d=Tb._pluginRegistry[a]);if(d)return d({instance:Vb,config:Z,nada:A,evaluate:L,cscompiled:Ba,extractPoint:M.extractPoint,evaluateAndVal:Y,defineFunction:c,addShutdownHook:Nc.push.bind(Nc),addAutoCleaningEventListener:g,getVariable:V.getvar.bind(V),
getInitialMatrix:function(){return P.drawingstate.initialmatrix},setTextRenderer:function(f,k){Sc=f;k&&(Sd=k)},setMeasure:function(f){Ub=f},getImage:function(f,k){"string"===typeof f&&(f=p.string(f));f=bc(f);if(!f)return null;!k&&f.cdyUpdate&&f.cdyUpdate();return f},getMyfunction:function(f){return D.hasOwnProperty(f)?D[f]:null},scheduleUpdate:F}),{ctype:"boolean",value:!0};xb("Plugin "+a+" not found");return{ctype:"boolean",value:!1}}return A};z.format$2=function(a,b){function c(v,w){v=v.toFixed(q);
do{var x=v;v=v.substring(0,v.length-1)}while(w&&""!==v&&"-"!==v&&+v===+x);w=""+x;b.delimiter&&"string"===b.delimiter.ctype&&(w=w.replace(".",b.delimiter.value));return w}function d(v,w){if("number"===v.ctype){var x=c(v.value.real,k);var B=c(v.value.imag,k);v=Math.abs(v.value.imag)<Math.pow(10,-w)?x:"-"===B.substring(0,1)?x+" - i*"+B.substring(1):x+" + i*"+B;return{ctype:"string",value:v}}return"list"===v.ctype?{ctype:"list",value:v.value.map(d)}:{ctype:"string",value:Ea(v).toString()}}var f=Y(a[0]);
a=Y(a[1]);var k=!0;if(b.truncate){var m=L(b.truncate);"boolean"===m.ctype&&(k=m.value)}if(("number"===f.ctype||"list"===f.ctype)&&"number"===a.ctype){var q=Math.max(0,Math.min(20,Math.round(a.value.real)));return d(f,q)}return A};Date.now||(Date.now=function(){return(new Date).getTime()});var Ma=0;z.timestamp$0=function(a,b){return n.real(Date.now())};z.seconds$0=function(a,b){return n.real((Date.now()-Ma)/1E3)};z.resetclock$0=function(a,b){Ma=Date.now();return A};z.time$0=function(a,b){a=new Date;
return h.realVector([a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()])};z.date$0=function(a,b){a=new Date;return h.realVector([a.getFullYear(),a.getMonth()+1,a.getDate()])};z.simulationtime$0=function(a,b){return n.real(nd*lf)};z.settimeout$2=function(a,b){function c(){L(d);F()}b=L(a[0]);var d=a[1];"number"===b.ctype&&"undefined"!==typeof window&&window.setTimeout(c,1E3*b.value.real);return A};M.formatForWebGL=function(a){return a.toFixed(10)};z.generateWebGL$2=function(a,b){var c=
M.formatForWebGL;b=a[0];a=L(a[1]);console.log(a);if("list"!==a.ctype)return A;for(var d=[],f=0;f<a.value.length;f++)"string"===a.value[f].ctype&&d.push(a.value[f].value);console.log("***********");console.log(d);a=M.plotvars(b);console.log(a);a.includes("a")||a.includes("b")||a.includes("c")||a.includes("d")||a.includes("e")||a.includes("f")||(b=Y(b));if("number"===b.ctype)return{ctype:"string",value:"vec2("+c(b.value.real)+","+c(b.value.imag)+")"};if("variable"===b.ctype)return{ctype:"string",value:b.name};
if("string"===b.ctype||"void"===b.ctype)return b;if(2===b.args.length&&("infix"===b.ctype||"function"===b.ctype)){c=z.compileToWebGL$1([b.args[0]],{});a=z.compileToWebGL$1([b.args[1]],{});if("+"===b.oper||"add"===b.oper)return void 0===c.value||"void"===c.ctype?{ctype:"string",value:a.value}:{ctype:"string",value:"addc("+c.value+","+a.value+")"};if("*"===b.oper||"mult"===b.oper)return{ctype:"string",value:"multc("+c.value+","+a.value+")"};if("/"===b.oper||"div"===b.oper)return{ctype:"string",value:"divc("+
c.value+","+a.value+")"};if("-"===b.oper||"sub"===b.oper)return void 0===c.value||"void"===c.ctype?{ctype:"string",value:"negc("+a.value+")"}:{ctype:"string",value:"subc("+c.value+","+a.value+")"};if("^"===b.oper||"pow"===b.oper)return{ctype:"string",value:"powc("+c.value+","+a.value+")"}}if("function"===b.ctype&&1===b.args.length){c=z.compileToWebGL$1([b.args[0]],{});if("sin$1"===b.oper)return{ctype:"string",value:"sinc("+c.value+")"};if("cos$1"===b.oper)return{ctype:"string",value:"cosc("+c.value+
")"};if("tan$1"===b.oper)return{ctype:"string",value:"tanc("+c.value+")"};if("exp$1"===b.oper)return{ctype:"string",value:"expc("+c.value+")"};if("log$1"===b.oper)return{ctype:"string",value:"logc("+c.value+")"};if("arctan$1"===b.oper)return{ctype:"string",value:"arctanc("+c.value+")"};if("arcsin$1"===b.oper)return{ctype:"string",value:"arcsinc("+c.value+")"};if("arccos$1"===b.oper)return{ctype:"string",value:"arccosc("+c.value+")"};if("sqrt$1"===b.oper)return{ctype:"string",value:"sqrtc("+c.value+
")"}}return A};z.compileToWebGL$1=function(a,b){b=M.formatForWebGL;a=a[0];var c=M.plotvars(a);c.includes("a")||c.includes("b")||c.includes("c")||c.includes("d")||c.includes("e")||c.includes("f")||(a=Y(a));if("number"===a.ctype)return{ctype:"string",value:"vec2("+b(a.value.real)+","+b(a.value.imag)+")"};if("variable"===a.ctype)return{ctype:"string",value:a.name};if("string"===a.ctype||"void"===a.ctype)return a;if(2===a.args.length&&("infix"===a.ctype||"function"===a.ctype)){b=z.compileToWebGL$1([a.args[0]],
{});c=z.compileToWebGL$1([a.args[1]],{});if("+"===a.oper||"add"===a.oper)return void 0===b.value||"void"===b.ctype?{ctype:"string",value:c.value}:{ctype:"string",value:"addc("+b.value+","+c.value+")"};if("*"===a.oper||"mult"===a.oper)return{ctype:"string",value:"multc("+b.value+","+c.value+")"};if("/"===a.oper||"div"===a.oper)return{ctype:"string",value:"divc("+b.value+","+c.value+")"};if("-"===a.oper||"sub"===a.oper)return void 0===b.value||"void"===b.ctype?{ctype:"string",value:"negc("+c.value+
")"}:{ctype:"string",value:"subc("+b.value+","+c.value+")"};if("^"===a.oper||"pow"===a.oper)return{ctype:"string",value:"powc("+b.value+","+c.value+")"}}if("function"===a.ctype&&1===a.args.length){b=z.compileToWebGL$1([a.args[0]],{});if("sin$1"===a.oper)return{ctype:"string",value:"sinc("+b.value+")"};if("cos$1"===a.oper)return{ctype:"string",value:"cosc("+b.value+")"};if("tan$1"===a.oper)return{ctype:"string",value:"tanc("+b.value+")"};if("exp$1"===a.oper)return{ctype:"string",value:"expc("+b.value+
")"};if("log$1"===a.oper)return{ctype:"string",value:"logc("+b.value+")"};if("arctan$1"===a.oper)return{ctype:"string",value:"arctanc("+b.value+")"};if("arcsin$1"===a.oper)return{ctype:"string",value:"arcsinc("+b.value+")"};if("arccos$1"===a.oper)return{ctype:"string$1",value:"arccosc("+b.value+")"};if("sqrt$1"===a.oper)return{ctype:"string",value:"sqrtc("+b.value+")"}}return A};z.setsimulationspeed$1=function(a,b){a=Y(a[0]);"number"===a.ctype&&Za(a.value.real);return A};z.setsimulationaccuracy$1=
function(a,b){a=Y(a[0]);"number"===a.ctype&&"undefined"!==typeof Oa&&"undefined"!==typeof Oa.env&&(Oa.env.accuracy=Math.max(1,a.value.real|0));return A};z.setsimulationquality$1=function(a,b){a=Y(a[0]);"number"===a.ctype&&"undefined"!==typeof Oa&&"undefined"!==typeof Oa.env&&(a=a.value.real,0===a&&(Oa.env.errorbound=.01,Oa.env.lowestdeltat=1E-5,Oa.env.slowdownfactor=2),1===a&&(Oa.env.errorbound=.001,Oa.env.lowestdeltat=1E-7,Oa.env.slowdownfactor=2),2===a&&(Oa.env.errorbound=1E-5,Oa.env.lowestdeltat=
1E-10,Oa.env.slowdownfactor=4),3===a&&(Oa.env.errorbound=1E-6,Oa.env.lowestdeltat=1E-12,Oa.env.slowdownfactor=4));return A};var mb=null,Mc=null;z.createtool$3=function(a,b){var c="left",d="top",f=null;if(b.space){var k=L(b.space);"number"===k.ctype&&(f=k.value.real/2)}var m=null;b.toolbar&&(k=L(b.toolbar),"string"===k.ctype&&((m=document.getElementById(k.value))||console.warn("Element #"+k.value+" not found")));if(!m){if(b.reference&&(k=L(b.reference),"string"===k.ctype))switch(k.value){case "UR":c=
"right";break;case "LL":d="bottom";break;case "LR":c="right",d="bottom"}m=document.createElement("div");m.className="CindyJS-toolbar";ob.parentNode.appendChild(m);k=L(a[1]);var q=L(a[2]);"number"===k.ctype&&(m.style[c]=k.value.real+"px");"number"===q.ctype&&(m.style[d]=q.value.real+"px");null!==f&&(m.style.margin=-f+"px")}a=L(a[0]);if("string"===a.ctype)a=[[a.value]];else if("list"===a.ctype)a=a.value.map(function(x){return"string"===x.ctype?[x.value]:"list"===x.ctype?x.value.map(function(B){return"string"===
B.ctype?B.value:null}):[null]});else return xb("Name must be a string or a list of strings"),A;if(b.flipped&&(k=L(b.flipped),"boolean"===k.ctype&&k.value)){xb("Flipping");var v=0;b=a.length;a.forEach(function(x){x.length>v&&(v=x.length)});k=[];for(q=0;q<v;++q){k[q]=[];for(var w=0;w<b;++w)k[q][w]=a[w][q]||null}a=k}"bottom"===d&&a.reverse();a.forEach(function(x){"right"===c&&x.reverse();var B=document.createElement("div");m.appendChild(B);x.forEach(function(E){function J(){mb&&mb.classList.remove("CindyJS-active");
mb=R;R.classList.add("CindyJS-active");Cf=E;var ea=ia[Cf].actions;Mc&&(Mc.textContent=ea[0].tooltip||"");lc=[];he=Vc=0}ia.hasOwnProperty(E)||(xb("Tool '"+E+"' not implemented yet."),E=null);if(null===E){var W=document.createElement("span");W.className="CindyJS-spacer";B.appendChild(W)}else{var R=document.createElement("button");W=document.createElement("img");W.src=Tb.getBaseDir()+"images/"+E+".png";R.appendChild(W);R.addEventListener("click",J);mb||J();null!==f&&(R.style.margin=f+"px");B.appendChild(R)}})});
return A};z.dropped$0=function(){return Yd};z.droppoint$0=function(){return Ge};z.parsecsv$1=function(a,b){var c=!0,d=Y(b.autoconvert);"boolean"===d.ctype&&(c=d.value);d=null;b=Y(b.delimiter);"string"===b.ctype&&/^[^"\r\n]$/.test(b.value)&&(d=b.value);a=Y(a[0]);if("string"!==a.ctype)return xb("CSV data is not a string"),A;a=a.value;b='(?:"((?:[^"]+|"")*)"|([^]*?))(\r\n|(,)|[\r\n]|$)';d&&(d=d.replace(/[^A-Za-z0-9]/g,"\\$&").replace(/\$/g,"$$$$"),b=b.replace(/,/g,d));b=new RegExp(b,"g");d=[];for(var f=
[],k=null;b.lastIndex<a.length;){var m=b.exec(a),q=m[2];"string"===typeof m[1]&&(q=m[1].replace(/""/g,'"'));q=c?/^[Tt]rue$/.test(q)?p.bool(!0):/^[Ff]alse$/.test(q)?p.bool(!1):/^[\-+]?([0-9]+(\.[0-9]*)?|\.[0-9]+|Infinity)$/.test(q)?n.real(Number(q)):p.string(q):p.string(q);d.push(q);m[4]&&b.lastIndex===a.length&&(d.push(p.string("")),m={});if(!m[4]){null===k&&(k=d.length);if(k<d.length)for(k=d.length,m=0;m<f.length;++m)for(q=f[m].length;q<k;++q)f[m][q]=A;else if(k>d.length)for(m=d.length;m<k;++m)d[m]=
A;f.push(d);d=[]}}return h.turnIntoCSList(f.map(h.turnIntoCSList))};z.load$2=function(a,b){return z.load$3([a[0],null,a[1]],b)};z.load$3=function(a,b){function c(){if(k.readyState===XMLHttpRequest.DONE){if(200===k.status)var m=p.string(String(k.responseText));else xb("Failed to load "+f+": "+k.statusText),m=A;V.newvar(d);V.setvar(d,m);L(a[2]);V.removevar(d);F()}}var d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);b=Y(a[0]);var f=null,k=null;"string"===b.ctype&&/^https?:\/\//.test(b.value)&&
(f=b.value);return null!==f?(k=new XMLHttpRequest,k.onreadystatechange=c,k.open("GET",f),k.send(),p.bool(!0)):A};z.removeelement$1=function(a,b){a=L(a[0]);"geo"===a.ctype?Nd(a.value.name):console.log("argument of removeelement is undefined or not of type <geo>")};z.guess$1=function(a,b){function c(v){if((v=nc.doPSLQ([v,1,Math.PI*Math.E],15))&&0===v[2])return[Math.round(v[0]),Math.round(v[1])]}function d(v){if(n._helper.isAlmostZero(v))return"0";if(!n._helper.isAlmostReal(v)){var w=v.value.real,x=
v.value.imag,B=c(w),E=c(w*w+x*x);if(B&&E){w=-B[0]*E[0];var J=-B[1]*E[0]*2,W=B[0]*E[1];B=k(-J,2*w);E=J*J-4*W*w;v=m(E);E/=v*v;E=v===2*w?"+i*sqrt("+-E+")":v===-2*w?"+i*sqrt("+-E+")":"+i*"+k(v,2*w).substring(1)+"*sqrt("+-E+")";v="-"+E.substring(1);J=Math.abs((J*J-4*W*w)/(4*w*w));w=Math.sqrt(J);J=-Math.sqrt(J);if("+0"===B||"-0"===B)B="";x=Math.abs(x-w)<Math.abs(x-J)?B+E:B+v;x.startsWith("+")&&(x=x.substring(1))}else x=Ea(v);return x}var R=nc.doPSLQ([Math.PI,v.value.real,1],15);x=""+v.value.real;W=w="";
var ea=J=1E4;B=1E5;if(R&&3E3>(B=f(R))){w=v.value.real;J=R[0];E=-R[1];R=R[2];var X="";if(0!==J){var oa=Math.round(J);var ja=Math.round(E);X=k(oa,ja)+"*pi"}oa="";0!==R&&(oa=Math.round(R),ja=Math.round(E),oa=k(oa,ja));q=Math.abs(w-(R/E+Math.PI*J/E));w=oa+X;""===w?w="0":w.startsWith("+")&&(w=w.substring(1));J=q}X=nc.doPSLQ([v.value.real*v.value.real,v.value.real,1],15);E=1E5;if(X&&9E3>(E=10+f(X))){v=v.value.real;ea=X[0];R=X[1];X=X[2];oa=Math.round(ea);ja=Math.round(R);var Ca=Math.round(X);W=k(-ja,2*oa);
ja=ja*ja-4*Ca*oa;Ca=m(ja);ja/=Ca*Ca;oa=Ca===2*oa?"+sqrt("+ja+")":Ca===-2*oa?"-sqrt("+ja+")":k(Ca,2*oa)+"*sqrt("+ja+")";ja=-R/(2*ea);X=Math.abs((R*R-4*X*ea)/(4*ea*ea));oa="+"+oa.substring(1);ea="-"+oa.substring(1);R=ja+Math.sqrt(X);X=ja-Math.sqrt(X);if("+0"===W||"-0"===W)W="";Math.abs(v-R)<Math.abs(v-X)?(q=Math.abs(v-R),v=W+oa):(q=Math.abs(v-X),v=W+ea);v.startsWith("+")&&(v=v.substring(1));W=v;ea=q}B<E&&1E-12>J&&(x=w);E<B&&1E-12>ea&&(x=W);return x}function f(v){var w=Math.abs(v[0]);Math.abs(v[1])>
w&&(w=Math.abs(v[1]));Math.abs(v[2])>w&&(w=Math.abs(v[2]));return w}function k(v,w){var x="+";0>v*w&&(v=Math.abs(v),w=Math.abs(w),x="-");var B=xd(v,w);v/=B;w/=B;0>v&&0>w&&(v=-v,w=-w);return 1===w?x+v:x+v+"/"+w}function m(v){for(var w=3E3;0<w;w--)if(0===v%(w*w))return w;return 1}var q=0;a=Y(a[0]);return"number"===a.ctype&&n._helper.isFinite(a)?(a=void 0===d(a)?"no guess":d(a),p.string(a)):A};M.extractPoint=function(a){var b={ok:!1};if("geo"===a.ctype){var c=a.value;if("P"===c.kind)return b.x=la.getField(c,
"x").value.real,b.y=la.getField(c,"y").value.real,b.ok=!0,b}if("list"!==a.ctype)return b;var d=a.value;if(2===d.length&&(a=d[0],c=d[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a.value.real,b.y=c.value.real,b.ok=!0,b;3===d.length&&(a=d[0],c=d[1],d=d[2],"number"===a.ctype&&"number"===c.ctype&&"number"===d.ctype&&(a=n.div(a,d),c=n.div(c,d),b.x=a.value.real,b.y=c.value.real,b.ok=!0));return b};z.draw$1=function(a,b){a=Y(a[0]);if("shape"===a.ctype)M.drawshape(a,b);else if("Line"===a.usage)N.handleModifs(b,
N.lineModifs),N.drawline(a);else{var c=M.extractPoint(a);if(!c.ok){if("undefined"!==typeof a.value&&2===a.value.length)return z.draw$2(a.value,b);return}null!==b&&N.handleModifs(b,N.pointModifs);N.drawpoint(c)}return A};z.draw$2=function(a,b){var c=Y(a[0]);a=Y(a[1]);c=M.extractPoint(c);a=M.extractPoint(a);if(!c.ok||!a.ok)return A;null!==b&&N.handleModifs(b,N.lineModifs);N.drawsegcore(c,a);return A};z.drawcircle$2=function(a,b){return M.drawcircle(a,b,"D")};M.arcHelper=function(a){var b={};b.startPoint=
Fa(a[0]);b.viaPoint=Fa(a[1]);b.endPoint=Fa(a[2]);return b};z.fillcircle$2=function(a,b){return M.drawcircle(a,b,"F")};z.drawarc$3=function(a,b){a=M.arcHelper(a);return M.drawarc(a,b,"D")};z.fillarc$3=function(a,b){a=M.arcHelper(a);return M.drawarc(a,b,"F")};M.drawarc=function(a,b,c){var d=a.startPoint,f=a.viaPoint;a=a.endPoint;if(!h._helper.isAlmostReal(h.turnIntoCSList([d,f,a])))return A;N.handleModifs(b,N.conicModifs);N.preDrawCurve();b=h.det3(d,f,a);if(1E-12<Math.abs(b.value.real)){b=u._helper.ConicBy5(null,
d,f,a,h.ii,h.jj);var k=u._helper.CenterOfConic(b);k=h.normalizeMax(k);b=n.real(0);var m=h.turnIntoCSList([h.turnIntoCSList([k.value[2],b,n.neg(k.value[0])]),h.turnIntoCSList([b,k.value[2],n.neg(k.value[1])]),h.turnIntoCSList([b,b,k.value[2]])]);b=h.normalizeZ(p.mult(m,d));h.normalizeZ(p.mult(m,f));m=h.normalizeZ(p.mult(m,a));b=-Math.atan2(b.value[1].value.real,b.value[0].value.real);m=-Math.atan2(m.value[1].value.real,m.value[0].value.real);k=h.normalizeZ(k);d=h.normalizeZ(d);f=h.normalizeZ(f);a=
h.normalizeZ(a);var q=h.abs(h.sub(d,k)),v=[k.value[0].value.real,k.value[1].value.real];k=P.drawingstate.matrix;var w=v[0]*k.a-v[1]*k.b+k.tx;v=v[0]*k.c-v[1]*k.d-k.ty;d=0<h.det3(d,f,a).value.real;Q.save();Q.beginPath();Q.translate(w,v);Q.arc(0,0,q.value.real*k.sdet,b,m,d);"F"===c&&(Q.fillStyle=N.lineColor,Q.closePath(),Q.fill());"D"===c&&Q.stroke();Q.restore()}else{if("D"!==c)return A;c=M.extractPoint(d);b=M.extractPoint(f);m=M.extractPoint(a);if(!c.ok||!b.ok||!m.ok)return A;q=(c.x-m.x)*(c.x-m.x)+
(c.y-m.y)*(c.y-m.y);k=(m.x-b.x)*(m.x-b.x)+(m.y-b.y)*(m.y-b.y);if(1E-12>(c.x-b.x)*(c.x-b.x)+(c.y-b.y)*(c.y-b.y)||1E-12>q||1E-12>k)return A;0>h.crossratio3(d,a,f,h.cross(h.cross(d,f),h.linfty),h.ii).value.real?N.drawsegcore(c,m):N.drawRaySegment(d,a)}return A};M.drawcircle=function(a,b,c){var d=Y(a[0]);a=Y(a[1]);var f=M.extractPoint(d);if(!f.ok||"number"!==a.ctype||!n._helper.isAlmostReal(a))return A;d=P.drawingstate.matrix;var k=f.x*d.a-f.y*d.b+d.tx;f=f.x*d.c-f.y*d.d-d.ty;N.handleModifs(b,N.conicModifs);
N.preDrawCurve();Q.lineJoin="miter";Q.beginPath();Q.arc(k,f,Math.abs(a.value.real)*d.sdet,0,2*Math.PI);Q.closePath();"D"===c&&Q.stroke();"F"===c&&(Q.fillStyle=N.lineColor,Q.fill());"C"===c&&Q.clip();return A};z.drawconic$1=function(a,b){a=Y(a[0]);if("list"!==a.ctype||3!==a.value.length&&6!==a.value.length)return console.error("could not parse conic"),A;if(6===a.value.length){for(var c=0;6>c;c++)if("number"!==a.value[c].ctype)return console.error("could not parse conic"),A;var d=n.real(.5);c=a.value[0];
var f=a.value[2];f=n.mult(f,d);var k=a.value[1],m=a.value[3];m=n.mult(m,d);var q=a.value[4];q=n.mult(q,d);a=a.value[5];a=h.turnIntoCSList([h.turnIntoCSList([c,f,m]),h.turnIntoCSList([f,k,q]),h.turnIntoCSList([m,q,a])])}else{if(!h.isNumberMatrix(a).value||3!==a.value.length||3!==a.value[0].value.length)return A;c=h.transpose(a);h.equals(a,c).value||(a=h.add(c,a))}return M.drawconic(a,b)};M.drawconic=function(a,b){function c(ya,nb){ya=(v*ya+w*nb+x)*ya+(B*nb+E)*nb+J;return 0<=ya?1:0>ya?-1:NaN}function d(ya){Ja.next=
ya;ya.prev=Ja;return Ja=ya}function f(ya,nb,qb,Fb){return{a:ya,b1:nb,b2:qb,vertical:!0,index:Fb,sign:function(Db){return c(ya,Db)},mkp:function(Db){return{x:ya,y:Db}},sol:cd(B,w*ya+E,(v*ya+x)*ya+J),discr:function(){return cd(ja,-2*ea,W)},tpt:function(Db){return{x:Db,y:-.5*(w*Db+E)/B}}}}function k(ya,nb,qb,Fb){return{a:ya,b1:nb,b2:qb,vertical:!1,index:Fb,sign:function(Db){return c(Db,ya)},mkp:function(Db){return{x:Db,y:ya}},sol:cd(v,w*ya+x,(B*ya+E)*ya+J),discr:function(){return cd(ja,-2*oa,X)},tpt:function(Db){return{x:-.5*
(w*Db+x)/v,y:Db}}}}function m(ya){var nb=Math.min(ya.b1,ya.b2),qb=Math.max(ya.b1,ya.b2),Fb=ya.sign(nb),Db=ya.sign(qb);if(!isFinite(Fb*Db))return!1;var ib=ya.sol;if(Fb!==Db){if(null===ib)return!1;var ub=.5*(ib[0]+ib[1]);ub>nb&&ub<qb?(nb=ya.sign(ub),ub=ib[nb===Db?0:1]):(Fb=.5*(nb+qb),ub=ib[Math.abs(Fb-ib[0])<Math.abs(Fb-ib[1])?0:1]);Ra.push(d(ya.mkp(ub)))}else{if(null===ib){if(0>=Ca)return!0;ib=ya.discr();if(null===ib)return!0;ya=ya.tpt(ib[ya.index]);ya.x>=Na&&ya.x<=Ha&&ya.y>=ua&&ya.y<=Ua&&d(ya);return!0}ub=
.5*(ib[0]+ib[1]);if(!(ub>nb&&ub<qb))return!0;nb=ya.sign(ub);if(nb===Fb||isNaN(nb))return!0;ya.b1>ya.b2&&(ib=[ib[1],ib[0]]);Ra.push(d(ya.mkp(ib[0])));Ra.push(d(ya.mkp(ib[1])))}return!0}function q(ya,nb,qb,Fb,Db){var ib=nb-Fb,ub=qb-ya,Xb=ya*Fb-nb*qb,Lb=ea*ib+oa*ub+ja*Xb;if(1E-14>Math.abs(Lb))return Q.lineTo(qb,Fb);var Oc=(W*ib+R*ub+ea*Xb)/Lb;ib=(R*ib+X*ub+oa*Xb)/Lb;if(!isFinite(Oc)||!isFinite(ib)||.04>Math.abs(ya*ib+Oc*Fb+qb*nb-qb*ib-Oc*nb-ya*Fb))return Q.lineTo(qb,Fb);do if(!(10<Db)){Xb=.5*(ya+qb);
ub=.5*(nb+Fb);var ac=Oc-Xb;Lb=ib-ub;if(!(.04>ac*ac+Lb*Lb)){var fe=v*ac*ac+w*ac*Lb+B*Lb*Lb,Hd=2*v*ac*Xb+w*(ac*ub+Lb*Xb)+2*B*Lb*ub+x*ac+E*Lb,ge=(v*Xb+w*ub+x)*Xb+(B*ub+E)*ub+J,jb=cd(fe,Hd,ge);jb||(jb=[-.5*Hd/fe,-2*ge/Hd]);if(0<jb[0])jb=jb[0];else if(0<=jb[1])jb=jb[1];else break;ac=Xb+jb*ac;Lb=ub+jb*Lb;Xb=ac-.5*(Oc+Xb);ub=Lb-.5*(ib+ub);if(!(.04>Xb*Xb+ub*ub)){q(ya,nb,ac,Lb,Db+1);q(ac,Lb,qb,Fb,Db+1);return}}}while(0);Q.quadraticCurveTo(Oc,ib,qb,Fb)}N.handleModifs(b,N.conicModifs);if(0!==N.lsize&&(N.preDrawCurve(),
a=h.normalizeMax(a),h._helper.isAlmostReal(a))){b=P.toMat();a=h.mult(h.transpose(b),a);a=h.mult(a,b);a=h.normalizeMax(a);var v=a.value[0].value[0].value.real,w=2*a.value[0].value[1].value.real,x=2*a.value[0].value[2].value.real,B=a.value[1].value[1].value.real,E=2*a.value[1].value[2].value.real,J=a.value[2].value[2].value.real,W=4*J*B-E*E,R=E*x-2*J*w,ea=E*w-2*B*x,X=4*J*v-x*x,oa=x*w-2*E*v,ja=4*B*v-w*w,Ca=ja;a=B*X+w*R+v*W-J*ja;0>a&&(v=-v,w=-w,x=-x,B=-B,E=-E,J=-J,a=-a);a=N.lsize;var Na=-a,ua=-a,Ha=pb+
a,Ua=rb+a,Ra=[],Ja=a={};if(m(f(Na,ua,Ua,0))&&m(k(Ua,Na,Ha,1))&&m(f(Ha,Ua,ua,1))&&m(k(ua,Ha,Na,0))&&Ja!==a){Ja.next=a.next;a.next.prev=Ja;Q.beginPath();if(0===Ra.length){var Ka=Ja;Q.moveTo(Ka.x,Ka.y);do{var Xa=Ka.next;q(Ka.x,Ka.y,Xa.x,Xa.y,0);Ka=Xa}while(Ka!==Ja);Q.closePath()}b=1===c(Na,ua)?0:1;if(4===Ra.length){var ab=0;for(a=0;2>a;++a){Ka=Ra[a];Xa=Ra[a+2];var bb=Xa.x-Ka.x;Ka=Xa.y-Ka.y;Ka=(v*bb+w*Ka)*bb+B*Ka*Ka;Math.abs(Ka)>Math.abs(ab)&&(ab=Ka)}if(isNaN(ab))return;0<=ab&&(b=1-b)}for(a=b;a<Ra.length;a+=
2)for(Ka=Ra[a],b=Ra[(a+1)%Ra.length],Q.moveTo(Ka.x,Ka.y),Xa=Ka.next;Ka!==b;Xa=(Ka=Xa).next)q(Ka.x,Ka.y,Xa.x,Xa.y,0);Q.stroke()}}};z.drawall$1=function(a,b){a=L(a[0]);if("list"===a.ctype)for(N.handleModifs(b,N.pointAndLineModifs),b=0;b<a.value.length;b++)z.draw$1([a.value[b]],null);return A};z.connect$1=function(a,b){return M.drawpolygon(a,b,"D",!1)};z.drawpoly$1=function(a,b){return M.drawpolygon(a,b,"D",!0)};z.fillpoly$1=function(a,b){return M.drawpolygon(a,b,"F",!0)};z.drawpolygon$1=function(a,
b){return M.drawpolygon(a,b,"D",!0)};z.fillpolygon$1=function(a,b){return M.drawpolygon(a,b,"F",!0)};M.drawpolygon=function(a,b,c,d){function f(){for(var v=$jscomp.makeIterator(q.value),w=v.next();!w.done;w=v.next()){w=w.value;var x;for(x=0;x<w.length;x++){var B=w[x],E=B.X*m.a-B.Y*m.b+m.tx;B=B.X*m.c-B.Y*m.d-m.ty;0===x?Q.moveTo(E,B):Q.lineTo(E,B)}Q.closePath()}}function k(){var v;for(v=0;v<q.value.length;v++){var w=M.extractPoint(q.value[v]);if(!w.ok)return;var x=w.x*m.a-w.y*m.b+m.tx;w=w.x*m.c-w.y*
m.d-m.ty;0===v?Q.moveTo(x,w):Q.lineTo(x,w)}d&&Q.closePath()}N.handleModifs(b,d?N.conicModifs:N.lineModifs);N.preDrawCurve();var m=P.drawingstate.matrix,q=L(a[0]);Q.beginPath();"list"===q.ctype&&k();"shape"===q.ctype&&f();"D"===c&&(N.fillColor&&(Q.fillStyle=N.fillColor,Q.fill(N.fillrule)),Q.stroke());"F"===c&&(Q.fillStyle=N.lineColor,Q.fill(N.fillrule));"C"===c&&Q.clip();return A};var Ub=function(a,b,c,d,f,k,m,q){if(b.includes("\n")){var v=Infinity,w=-Infinity,x=Infinity,B=-Infinity;b.split("\n").forEach(function(E){E=
Ub(a,E,c,d,f,k);v>E.left&&(v=E.left);w<E.right&&(w=E.right);x>E.top&&(x=E.top);B<E.bottom&&(B=E.bottom);d+=m});return{left:v,right:w,top:x,bottom:B}}b=a.measureText(b);return{left:c-b.width*f,right:c+b.width*(1-f),top:d-.84*k,bottom:d+.36*k}},Sc=oe,Sd=function(a,b,c){if(b.includes("\n"))for(b=b.split("\n"),a.textContent=b[0],c=1;c<b.length;++c)a.appendChild(document.createElement("br")),a.appendChild(document.createTextNode(b[c]));else a.textContent=b};M.drawtext=function(a,b,c){var d=Y(a[0]);a=L(a[1]);
var f=M.extractPoint(d);if(!f.ok)return null;N.handleModifs(b,N.textModifs);b=P.drawingstate.textsize;null===b&&(b=zb.textsize);null!==N.size&&(b=N.size);Q.fillStyle=N.textColor;Q.lineWidth=N.outlinewidth;Q.lineJoin=N.linejoin;Q.strokeStyle=N.outlinecolor;var k=P.drawingstate.matrix;d=f.x*k.a-f.y*k.b+k.tx+N.xOffset;f=f.x*k.c-f.y*k.d-k.ty-N.yOffset;a=Ea(a);Tb._pluginRegistry.katex||"string"!==typeof a||3<=a.split("$").length&&kb("katex","katex-plugin.js",!0);Q.font=N.bold+N.italics+Math.round(10*b)/
10+"px "+N.family;return c?c(a,d,f,N.align,b):Sc(Q,a,d,f,N.align,b,b*zb.lineHeight,N.angle)};z.drawtext$2=function(a,b){var c=M.drawtext(a,b,null);if(!c)return A;a=p.withUsage(h.realVector(P.to(c.left,c.bottom)),"Point");b=p.withUsage(h.realVector(P.to(c.right,c.bottom)),"Point");var d=p.withUsage(h.realVector(P.to(c.right,c.top)),"Point");c=p.withUsage(h.realVector(P.to(c.left,c.top)),"Point");return h.turnIntoCSList([a,b,d,c])};M.pixelsize=function(a,b){a=L(a[0]);N.handleModifs(b,N.textModifs);
b=P.drawingstate.textsize;null===b&&(b=zb.textsize);null!==N.size&&(b=N.size);Q.fillStyle=N.textColor;a=Ea(a);Tb._pluginRegistry.katex||"string"!==typeof a||3<=a.split("$").length&&kb("katex","katex-plugin.js",!0);Q.font=N.bold+N.italics+Math.round(10*b)/10+"px "+N.family;b=Ub(Q,a,0,0,N.align,b,b*zb.lineHeight,N.angle);return void 0===b?A:b};z.pixelsize$1=function(a,b){a=M.pixelsize(a,b);return h.realVector([a.right-a.left,-a.top,a.bottom])};z.drawtable$2=function(a,b){var c=Y(a[0]);a=Y(a[1]);var d=
M.extractPoint(c);if(!d.ok||"list"!==a.ctype)return A;c=a.value;a=c.length;var f=-1,k;for(k=0;k<a;++k)"list"===c[k].ctype&&c[k].value.length>f&&(f=c[k].value.length);-1===f?(c=c.map(function(J){return[J]}),f=1):c=c.map(function(J){return h.asList(J).value});var m=100,q=null,v=!0,w=P.drawingstate.textcolor;N.handleModifs(b,{size:!0,color:function(J){h._helper.isNumberVecN(J,3)&&(w=N.makeColor([J.value[0].value.real,J.value[1].value.real,J.value[2].value.real]))},alpha:!0,bold:!0,italics:!0,family:!0,
align:!0,xoffset:!0,yoffset:!0,offset:!0,width:function(J){"number"===J.ctype&&(m=J.value.real)},height:function(J){"number"===J.ctype&&(q=J.value.real)},border:function(J){"boolean"===J.ctype&&(v=J.value)}});k=P.drawingstate.textsize;null===k&&(k=zb.textsize);null!==N.size&&(k=N.size);null===q&&(q=1.6*k);Q.font=N.bold+N.italics+Math.round(10*k)/10+"px "+N.family;k=P.drawingstate.matrix;var x=f*m,B=a*q;b=d.x*k.a-d.y*k.b+k.tx+N.xOffset;var E=d.x*k.c-d.y*k.d-k.ty-N.yOffset-B;if(v){N.preDrawCurve();
Q.strokeStyle=N.lineColor;Q.beginPath();for(k=1;k<a;++k)Q.moveTo(b,E+k*q),Q.lineTo(b+x,E+k*q);for(d=1;d<f;++d)Q.moveTo(b+d*m,E),Q.lineTo(b+d*m,E+B);Q.stroke();Q.lineWidth=N.lsize+1;Q.beginPath();Q.rect(b,E,x,B);Q.stroke()}b+=N.align*m+(1-2*N.align)*q*.3;E+=.7*q;Q.fillStyle=w;for(k=0;k<a;++k)for(d=0;d<f;++d)x=Ea(c[k][d]),Sc(Q,x,b+d*m,E+k*q,N.align);return A};M.drawshape=function(a,b){return"polygon"===a.type?M.drawpolygon([a],b,"D",1):"circle"===a.type?M.drawcircle([a.value.value[0],a.value.value[1]],
b,"D"):A};M.fillshape=function(a,b){return"polygon"===a.type?M.drawpolygon([a],b,"F",1):"circle"===a.type?M.drawcircle([a.value.value[0],a.value.value[1]],b,"F"):A};M.clipshape=function(a,b){return"polygon"===a.type?M.drawpolygon([a],b,"C",1):"circle"===a.type?M.drawcircle([a.value.value[0],a.value.value[1]],b,"C"):A};z.fill$1=function(a,b){a=L(a[0]);return"shape"===a.ctype?M.fillshape(a,b):A};z.clip$1=function(a,b){var c=L(a[0]);return"shape"===c.ctype?M.clipshape(c,b):"list"===c.ctype?(a=z.polygon$1(a,
[]),z.clip$1([a],[])):A};z.plot$1=function(a,b){return z.plot$2([a[0],null],b)};z.plot$2=function(a,b){function c(ja){return"number"===ja.ctype&&n._helper.isAlmostReal(ja)}function d(ja,Ca,Na,ua,Ha){q++;Ca=+Ca.value.real;Ha=+ua.value.real;ua=Ca*R.a-Ha*R.b+R.tx;Ca=Ca*R.c-Ha*R.d-R.ty;ja=+ja.value.real;Ha=+Na.value.real;Na=ja*R.a-Ha*R.b+R.tx;ja=ja*R.c-Ha*R.d-R.ty;v?(Q.lineTo(Na,ja),Q.lineTo(ua,Ca)):(Q.beginPath(),Q.moveTo(Na,ja),Q.lineTo(ua,Ca),v=!0)}function f(ja,Ca,Na,ua,Ha){var Ua=c(Na),Ra=c(ua);
if(.001>Ha)!k&&v&&(Q.stroke(),v=!1);else if(Ua||Ra){var Ja=n.real((ja.value.real+Ca.value.real)/2);V.setvar(W,Ja);var Ka=L(J),Xa=c(Ka);if(Ua&&Ra&&Xa){var ab=Na.value.real;Ra=Ka.value.real;Xa=ua.value.real;if(Ua=1>Math.abs(ab+Xa-2*Ra)/m){var bb=n.real((ja.value.real+Ja.value.real)/2);V.setvar(W,bb);bb=L(J);var ya=n.real((Ja.value.real+Ca.value.real)/2);V.setvar(W,ya);ya=L(J);ab=Math.abs(ab+Ra-2*bb.value.real)/m;Ra=Math.abs(Ra+Xa-2*ya.value.real)/m;Ua=Ua&&1>ab&&1>Ra}Ua?(d(ja,Ja,Na,Ka,Ha/2),d(Ja,Ca,
Ka,ua,Ha/2)):(f(ja,Ja,Na,Ka,Ha/2),f(Ja,Ca,Ka,ua,Ha/2))}else f(ja,Ja,Na,Ka,Ha/2),f(Ja,Ca,Ka,ua,Ha/2)}}var k=!1,m=.2/Ud,q=0,v=!1,w=-10,x=10,B=.1,E=1E3,J=a[0];if(null!==a[1]&&"variable"===a[1].ctype)var W=a[1].name;else a=M.plotvars(J),W="#",a.includes("t")&&(W="t"),a.includes("z")&&(W="z"),a.includes("y")&&(W="y"),a.includes("x")&&(W="x");V.newvar(W);var R=P.drawingstate.matrix;N.handleModifs(b,{color:!0,alpha:!0,size:!0,dashpattern:!0,dashtype:!0,dashing:!0,lineCap:!0,lineJoin:!0,miterLimit:!0,connect:function(ja){"boolean"===
ja.ctype&&(k=ja.value)},start:function(ja){"number"===ja.ctype&&(w=ja.value.real)},stop:function(ja){"number"===ja.ctype&&(x=ja.value.real)},steps:function(ja){"number"===ja.ctype&&(E=ja.value.real)}});Q.strokeStyle=N.lineColor;Q.lineWidth=N.lsize;v=!1;b=n.real(14.32);V.setvar(W,b);var ea=L(J);if("number"!==ea.ctype){if(h.isNumberVector(ea).value&&2===ea.value.length){v=!1;B=(x-w)/E;for(b=w;b<x;b+=B){V.setvar(W,n.real(b));var X=L(J);if(h.isNumberVector(X).value&&2===X.value.length){var oa=+X.value[0].value.real;
X=+X.value[1].value.real;a=oa*R.a-X*R.b+R.tx;oa=oa*R.c-X*R.d-R.ty;v?Q.lineTo(a,oa):(Q.beginPath(),Q.moveTo(a,oa),v=!0)}}v&&Q.stroke();V.removevar(W)}return A}for(a=w;a<x+B;a+=B)b=n.real(a),V.setvar(W,b),ea=L(J),b.value.real>w&&f(oa,b,X,ea,B),oa=b,X=ea;v&&Q.stroke();V.removevar(W);return A};z.plotX$1=function(a,b){a=a[0];var c=M.plotvars(a);b="#";c.includes("t")&&(b="t");c.includes("z")&&(b="z");c.includes("y")&&(b="y");c.includes("x")&&(b="x");V.newvar(b);c=P.drawingstate.matrix;Q.fillStyle=P.drawingstate.linecolor;
Q.lineWidth=1;Q.lineCap=N.lineCap;Q.lineJoin=N.lineJoin;Q.miterLimit=N.miterLimit;for(var d=!1,f=-10;10>f;f+=.01){V.setvar(b,n.real(f));var k=L(a);if("number"===k.ctype){var m=+k.value.real;k=f*c.a-m*c.b+c.tx;m=f*c.c-m*c.d-c.ty;d?Q.lineTo(k,m):(Q.beginPath(),Q.moveTo(k,m),d=!0)}}Q.stroke();V.removevar(b);return A};M.plotvars=function(a){function b(q,v){var w={},x;for(x=q.length-1;0<=x;--x)w[q[x]]=q[x];for(x=v.length-1;0<=x;--x)w[v[x]]=v[x];q=[];for(var B in w)w.hasOwnProperty(B)&&q.push(w[B]);return q}
function c(q,v){for(var w=0;w<q.length;w++)q[w]===v&&(q.splice(w,1),w--);return q}var d;if("variable"===a.ctype)return[a.name];if("infix"===a.ctype){var f=M.plotvars(a.args[0]);a=M.plotvars(a.args[1]);return b(f,a)}if("list"===a.ctype){var k=a.value;var m=[];for(d=0;d<k.length;d++)f=M.plotvars(k[d]),m=b(m,f);return m}if("function"===a.ctype){k=a.args;m=[];for(d=0;d<k.length;d++)f=M.plotvars(k[d]),m=b(m,f);"apply"!==a.oper&&"select"!==a.oper&&"forall"!==a.oper&&"sum"!==a.oper&&"product"!==a.oper&&
"repeat"!==a.oper&&"min"!==a.oper&&"max"!==a.oper&&"sort"!==a.oper||"variable"!==a.args[1].ctype||(m=c(m,a.args[1].name));return m}return[]};z.clrscr$0=function(a,b){"undefined"!==typeof pb&&"undefined"!==typeof rb&&Q.clearRect(0,0,pb,rb);return A};z.repaint$0=function(a,b){F();return A};z.screenbounds$0=function(a,b){a=p.withUsage(h.realVector(P.to(0,0)),"Point");b=p.withUsage(h.realVector(P.to(ob.clientWidth,0)),"Point");var c=p.withUsage(h.realVector(P.to(ob.clientWidth,ob.clientHeight)),"Point"),
d=p.withUsage(h.realVector(P.to(0,ob.clientHeight)),"Point");return h.turnIntoCSList([a,b,c,d])};z.createimage$3=function(a,b){b=L(a[0]);var c=Y(a[1]);a=Y(a[2]);if("number"!==c.ctype||"number"!==a.ctype||"string"!==b.ctype)return A;var d=document.createElement("canvas");d.id=b.value;d.width=c.value.real;d.height=a.value.real;d.style.display="none";document.body.appendChild(d);Jc[b.value]=vb(d,!1);return A};z.clearimage$1=function(a,b){a=L(a[0]);if("string"!==a.ctype&&"image"!==a.ctype)return A;a=
bc(a);if(!a)return A;b=a.img;if("undefined"===typeof b||null===b)return A;var c=a.width,d=a.height;b.getContext("2d").clearRect(0,0,c,d);a.generation++;return A};z.canvas$4=function(a,b){var c=Y(a[0]),d=Y(a[1]);b=L(a[2]);a=a[3];var f=M.extractPoint(c),k=M.extractPoint(d);if(!f.ok||!k.ok||"string"!==b.ctype&&"image"!==b.ctype)return A;b=bc(b);if(!b||!b.img.getContext)return A;d=b.img;var m=b.width;c=b.height;var q=k.x-f.x,v=k.y-f.y,w=f.x-v*c/m,x=f.y+q*c/m;v=k.x-v*c/m;q=k.y+q*c/m;k=P.from(f.x,f.y,1);
w=P.from(w,x,1);v=P.from(v,q,1);f=k[0]*yb;x=k[1]*yb;q=w[0]*yb;var B=w[1]*yb,E=v[0]*yb,J=v[1]*yb;w=m*(x-B)/((f-q)*(x-J)-(f-E)*(x-B));m=m*(f-q)/((x-B)*(f-E)-(x-J)*(f-q));v=-w*f-m*x;k=(c*(x-J)-c*(x-B))/((f-q)*(x-J)-(f-E)*(x-B));q=(c*(f-E)-c*(f-q))/((x-B)*(f-E)-(x-J)*(f-q));c=c-k*f-q*x;d=d.getContext("2d");f=Q;Q=d;Q.save();Q.transform(w,k,m,q,v,c);b.generation++;L(a);Q.restore();Q=f};z.canvas$5=function(a,b){var c=Y(a[0]),d=Y(a[1]),f=Y(a[2]);b=L(a[3]);a=a[4];c=M.extractPoint(c);var k=M.extractPoint(d),
m=M.extractPoint(f);if(!c.ok||!k.ok||!m.ok||"string"!==b.ctype&&"image"!==b.ctype)return A;b=bc(b);if(!b||!b.img.getContext)return A;f=b.img;var q=b.width;d=b.height;var v=P.from(c.x,c.y,1),w=P.from(k.x,k.y,1);k=P.from(m.x,m.y,1);c=v[0]*yb;m=v[1]*yb;var x=w[0]*yb,B=w[1]*yb,E=k[0]*yb,J=k[1]*yb;k=((0-q)*(m-J)-0*(m-B))/((c-x)*(m-J)-(c-E)*(m-B));q=((0-q)*(c-E)-0*(c-x))/((m-B)*(c-E)-(m-J)*(c-x));w=-(k*c)-q*m;v=((d-d)*(m-J)-(d-0)*(m-B))/((c-x)*(m-J)-(c-E)*(m-B));x=((d-d)*(c-E)-(d-0)*(c-x))/((m-B)*(c-E)-
(m-J)*(c-x));d=d-v*c-x*m;f=f.getContext("2d");c=Q;Q=f;Q.save();Q.transform(k,v,q,x,w,d);b.generation++;L(a);Q.restore();Q=c};z.screenresolution$0=function(a,b){return n.real(P.drawingstate.matrix.a)};z.layer$1=function(a,b){};z.imagesize$1=function(a,b){a=bc(Y(a[0]));b=function(c){return"number"===typeof c&&Number.isFinite(c)};return void 0!=a&&b(a.width)&&b(a.height)?h.realVector([+a.width,+a.height]):A};z.imageready$1=function(a,b){a=bc(Y(a[0]));return p.bool(!(!a||!a.ready))};z.drawimage$2=function(a,
b){function c(){var v=1,w=1,x=1,B=1,E=0,J=1,W=M.extractPoint(f);if(!W.ok)return A;k=bc(k);if(!k)return A;Q.save();if(void 0!==b.angle){var R=L(b.angle);"number"===R.ctype&&(E=R.value.real)}void 0!==b.rotation&&(R=L(b.rotation),"number"===R.ctype&&(E=R.value.real));void 0!==b.scale&&(R=Y(b.scale),"number"===R.ctype&&(w=v=R.value.real),h.isNumberVector(R).value&&2===R.value.length&&(v=R.value[0].value.real,w=R.value[1].value.real));void 0!==b.scalex&&(R=L(b.scalex),"number"===R.ctype&&(v=R.value.real));
void 0!==b.scaley&&(R=L(b.scaley),"number"===R.ctype&&(w=R.value.real));void 0!==b.flipx&&(R=L(b.flipx),"boolean"===R.ctype&&R.value&&(x=-1));void 0!==b.flipy&&(R=L(b.flipy),"boolean"===R.ctype&&R.value&&(B=-1));void 0!==b.alpha&&(R=L(b.alpha),"number"===R.ctype&&(J=R.value.real));Q.imageSmoothingEnabled=!0;void 0!==b.interpolate&&(R=L(b.interpolate),"boolean"===R.ctype&&(Q.imageSmoothingEnabled=R.value));var ea=P.drawingstate.matrix,X=P.drawingstate.initialmatrix,oa=k.width,ja=k.height;R=W.x*ea.a-
W.y*ea.b+ea.tx;var Ca=W.x*ea.c-W.y*ea.d-ea.ty,Na=(W.x+1)*ea.a-W.y*ea.b+ea.tx-R;ea=(W.x+1)*ea.c-W.y*ea.d-ea.ty-Ca;var ua=(W.x+1)*X.a-W.y*X.b+X.tx-(W.x*X.a-W.y*X.b+X.tx);X=(W.x+1)*X.c-W.y*X.d-X.ty-(W.x*X.c-W.y*X.d-X.ty);W=Math.sqrt(Na*Na+ea*ea)/Math.sqrt(ua*ua+X*X);Na=-Math.atan2(Na,ea)+Math.atan2(ua,X);ea=P.drawingstate.matrix.sdet/72;v*=ea;w*=ea;1!==J&&(Q.globalAlpha=J);Q.translate(R,Ca);Q.scale(v*x*W,w*B*W);Q.rotate(E+Na);Q.translate(-R,-Ca);Q.translate(-oa/2,-ja/2);v=k;v.drawTo?v.drawTo(Q,R,Ca):
Q.drawImage(v.img,R,Ca);Q.globalAlpha=1;Q.restore()}function d(){var v=1,w=1,x=1,B=1,E=M.extractPoint(f),J=M.extractPoint(m);if(!E.ok||!J.ok)return A;k=bc(k);if(!k)return A;var W=k.width,R=k.height;if(0===q){var ea={};ea.x=E.x-(J.y-E.y);ea.y=E.y+(J.x-E.x);B=R/W}else if(ea=M.extractPoint(q),!E.ok)return A;Q.save();if(void 0!==b.alpha){var X=L(b.alpha);"number"===X.ctype&&(v=X.value.real)}void 0!==b.aspect&&(X=L(b.aspect),"number"===X.ctype&&(B=X.value.real));void 0!==b.flipx&&(X=L(b.flipx),"boolean"===
X.ctype&&X.value&&(w=-1));void 0!==b.flipy&&(X=L(b.flipy),"boolean"===X.ctype&&X.value&&(x=-1));Q.imageSmoothingEnabled=!0;void 0!==b.interpolate&&(X=L(b.interpolate),"boolean"===X.ctype&&(Q.imageSmoothingEnabled=X.value));X=P.drawingstate.matrix;1!==v&&(Q.globalAlpha=v);v=E.x*X.a-E.y*X.b+X.tx;E=E.x*X.c-E.y*X.d-X.ty;Q.transform(J.x*X.a-J.y*X.b+X.tx-v,J.x*X.c-J.y*X.d-X.ty-E,ea.x*X.a-ea.y*X.b+X.tx-v,ea.x*X.c-ea.y*X.d-X.ty-E,v,E);Q.scale(1/W,-1/R*B);Q.translate(W/2,-R/2);Q.scale(w,x);Q.translate(-W/
2,R/2);Q.translate(0,-R);w=k;w.drawTo?w.drawTo(Q,0,0):Q.drawImage(w.img,0,0);Q.globalAlpha=1;Q.restore()}if(2===a.length){var f=Y(a[0]);var k=Y(a[1]);return c()}if(3===a.length){f=Y(a[0]);var m=Y(a[1]);var q=0;k=Y(a[2]);return d()}return 4===a.length?(f=Y(a[0]),m=Y(a[1]),q=Y(a[2]),k=Y(a[3]),d()):A};z.drawimage$3=z.drawimage$2;z.drawimage$4=z.drawimage$2;z.allimages$0=function(){var a=[];Object.keys(Jc).forEach(function(b){a.push({ctype:"string",value:b})});return h.turnIntoCSList(a)};var Cd={};z.cameravideo$0=
function(a,b){function c(m){return{video:{width:m,advanced:[{width:{max:m,min:m}},{width:{ideal:m}}]},audio:!1}}a=!0;var d={};void 0!==b.resolution&&(b=L(b.resolution),"string"===b.ctype&&"maximal"===b.value?a=!0:"number"===b.ctype?(a=!1,d=c(b.value.real)):h._helper.isNumberVecN(b,2)&&(a=!1,d=c(b.value[0].value.real),b=b.value[1].value.real,10>b||!Number.isInteger(b)?(d.video.aspectRatio=b,d.video.advanced[0].aspectRatio={min:b,max:b},d.video.advanced[1].aspectRatio={ideal:b}):(d.video.height=b,d.video.advanced[0].height=
{min:b,max:b},d.video.advanced[1].height={ideal:b})));a&&(d=[320,640,1024,1280,1920,2560],d=d.map(function(m){return{width:{min:m}}}),d={video:{width:16E3,height:9E3,advanced:d},audio:!1});a=JSON.stringify(d);if(Cd[a])return Cd[a];b=null;var f=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia;f?b=function(m,q){navigator.mediaDevices.getUserMedia(d).then(m,q)}:(f=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)&&(b=function(m,q){f.call(navigator,
d,m,q)});if(!b)return console.warn("getUserMedia call not supported"),Cd[a]=A;var k=document.createElement("video");k.autoplay=!0;Cd[a]=vb(k,!0);console.log("Opening stream.");b(function(m){k.srcObject=m;k.setAttribute("autoplay","");k.setAttribute("muted","");k.setAttribute("playsinline","");k.play();k.addEventListener("loadeddata",Ia)},function(m){console.error("Could not get user video:",String(m),m)});return Cd[a]};z.playvideo$1=function(a,b){a=bc(Y(a[0]));a.live&&a.img.play&&a.img.play();return A};
z.pausevideo$1=function(a,b){a=bc(Y(a[0]));a.live&&a.img.pause&&a.img.pause();return A};var Bd;z.imagergba$3=function(a,b){b=bc(Y(a[0]));var c=Y(a[1]);a=Y(a[2]);if(!b||"number"!==c.ctype||"number"!==a.ctype||!b.ready)return A;c=Math.round(c.value.real);a=Math.round(a.value.real);if(!cc(c)||!cc(a))return A;a=Xc(b,c,a,1,1);return h.realVector([255*a[0],255*a[1],255*a[2],a[3]])};z.imagergb$3=z.imagergba$3;z.imagergba$4=function(a,b){var c=bc(Y(a[2]));if(!c||!c.ready)return A;var d=c.width,f=c.height,
k=Fa(a[0]),m=Fa(a[1]),q=Fa(h.realVector([0,f,1]));d=Fa(h.realVector([d,f,1]));if(k===A||m===A||v===A)return A;v=h.ii;f=h.jj;q=M.basismap(q,d,v,f);k=M.basismap(k,m,f,v);var v=Fa(a[3]);f=M.extractPoint(p.mult(q,p.mult(h.adjoint3(k),v)));if(f.ok)if(a=c.width,k=c.height,m=!0,q=!1,void 0!==b.interpolate&&(v=L(b.interpolate),"boolean"===v.ctype&&(m=v.value)),void 0!==b.repeat&&(v=L(b.repeat),"boolean"===v.ctype&&(q=v.value)),m&&(f.x-=.5,f.y-=.5),q&&(f.x=(f.x%a+a)%a,f.y=(f.y%k+k)%k),v=Math.floor(f.x),d=
Math.floor(f.y),cc(v)&&cc(d)){b=[0,0,0,0];if(m){m=f.x-v;f=f.y-d;var w=Xc(c,v,d,2,2);if(q){if(v===a-1||d===k-1){q=Xc(c,(v+1)%a,d,1,1);var x=Xc(c,v,(d+1)%k,1,1);c=Xc(c,(v+1)%a,(d+1)%k,1,1);w=w.slice(0,4).concat(q,x,c)}}else{if(-1===v||v===a-1)m=Math.round(m);if(-1===d||d===k-1)f=Math.round(f)}for(c=0;4>c;c++)b[c]=(1-f)*((1-m)*w[c]+m*w[c+4])+f*((1-m)*w[c+8]+m*w[c+12])}else b=Xc(c,v,d,1,1);c=h.realVector(b)}else c=A;else c=A;return c};z.imagergb$4=function(a,b){a=z.imagergba$4(a,b);return a===A?A:h.turnIntoCSList(a.value.slice(0,
3))};z.readpixels$1=function(a,b){a=bc(Y(a[0]));a=Xc(a,0,0,a.width,a.height);b=[];for(var c=0;c+3<a.length;c+=4)b.push(h.turnIntoCSList([n.real(a[c+0]),n.real(a[c+1]),n.real(a[c+2]),n.real(a[c+3])]));return h.turnIntoCSList(b)};"use strict";var qa=[{key:[":"],field:["."],deg:["\u00b0"],take:["_"]},{functionCall:!0},{rassoc:!0,pow:["^"],sqrt:["\u221a"]},{mul:["*","\u2062","\u22c5","\u00b7"],cross:["\u00d7"],div:["/","\u00f7","\u2215","\u2236"]},{add:["+"],sub:["-","\u2212"],neg:["!","\u00ac"]},{seq:[".."]},
{eq:["==","\u225f"],ne:["!=","<>","\u2260"],lt:["<"],gt:[">"],le:["<=","\u2264","\u2266"],ge:[">=","\u2265","\u2267"],aeq:["~=","\u2248"],ane:["~!=","\u2249"],alt:["~<","\u2a89"],agt:["~>","\u2a8a"],ale:["~<=","\u2a85"],age:["~>=","\u2a86"],in:["\u2208"],nin:["\u2209"]},{and:["&","\u2227"],or:["%","\u2228"]},{rassoc:!0,prepend:["<:"]},{concat:["++","\u222a"],remove:["--","\u2216"],common:["~~","\u2229"],append:[":>"]},{rassoc:!0,assign:["="],define:[":="],undefine:[":=_"],bdefine:["::="]},{seq:[";"]},
{modif:["->","\u2192"]},{rassoc:!0,list:[","]}],va=["+","-"],ta=["!","\u221a"],Wa=["\u00b0",":=_"],gb=[";",","],Da=[],tb={},Ic;(function(){var a=0;qa.forEach(function(b){a+=2;var c=!!b.rassoc;b.functionCall&&(Ic=a);for(var d in b){var f=b[d];if("boolean"!==typeof f){var k={name:d,sym:f[0],symbols:f,rassoc:c,precedence:a,prefix:!1,postfix:!1,infix:!0,bare:!1};f=$jscomp.makeIterator(f);for(var m=f.next();!m.done;m=f.next()){m=m.value;if(tb.hasOwnProperty(m))throw Error("Duplicate operator: "+m);tb[m]=
k;Da.push(m)}}}});va.forEach(function(b){tb[b].prefix=!0});ta.forEach(function(b){tb[b].prefix=!0;tb[b].infix=!1});Wa.forEach(function(b){tb[b].postfix=!0;tb[b].infix=!1});gb.forEach(function(b){tb[b].prefix=!0;tb[b].postfix=!0;tb[b].infix=!0;tb[b].bare=!0})})();Da.sort(function(a,b){return b.length-a.length});var od="(?:[\u207a\u207b] )?[\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079](?: [\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079])*".replace(/ /g,"[ \t]*"),Dd="(?:[\u208a\u208b] )?[\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089](?: [\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089])*".replace(/ /g,
"[ \t]*"),Td=function(a,b,c){var d,f=0,k="(?:[",m=b.length;for(d=0;d<m;++d){var q=b.charCodeAt(d);55296<=q?(k+="]|"+b.charAt(d)+"[",f=56320):(k+=String.fromCharCode(q=f=a[q-32]+f),f+=a[b.charCodeAt(++d)-32],f!==q&&(f!==q+1&&(k+="-"),k+=String.fromCharCode(f)))}return k+"]|["+c+"][\udc00-\udfff])"}([2,0,106,3,4,1,6,5,7,11,17,8,12,21,9,22,30,10,15,24,25,16,13,42,46,14,18,19,29,37,27,28,35,26,32,36,40,43,47,53,20,48,50,56,33,34,39,51,52,55,63,64,65,68,85,23,31,38,45,49,105,59,66,69,72,88,102,114,117,
128,157,191,41,44,54,60,67,70,71,73,74,75,76,80,81,82,83,84,86,87,89,93,94,98,99,107,108,116,122,130,132,134,138,160,165,185,195,196,255,268,277,310,332,339,362,365,390,449,457,470,512,513,541,568,582,619,673,726,768,820,921,991,1164,2684,6581,8453,11171,20949],"T4(4I!)!'!&/ 0 \u0096')2$+! !\u0083$ %## !(!   ! ; u \u0086.\u0088 =#!+YoA& 87C% } !5%+%) #!*! <0a,!4B1%'!&-'!1!$!33`HsG$!;!+.52'(#%#- & !$#$!*!9%  2%H''%#- & % % %B# !H *+   - & % $$!;!5%3!,(#%#- & % $$!X%  5!:! '$  #$% ! %$%$ $)W!G(   / 2$!> &%C(   / . $$!L! %5%;(   D#!*!* 4'&*$W + !#&]F %6&]% !#% !#!(# &   ! !#% # %1!#$ !/#L!S( @?$\u00817-!*''#$!$%+ ',6!:= !&!#7 \u0090 ##& ! ##D ##B ##& ! ##9 K ##^Y2*V#'$\u009d#5 4&p((+, #2*2*2,  5OC!'!Uy.D !&_)0J<#$,E'4Q/1Pv!|8:&K<9%)E>@7 )@\u0080# #$%1gT\u008e#'#=#'#( ! ! ! 0#P & !$  &$##'',&  &d!9!*,b!'!#. !$$(! ! ! # 1##&$'!G%\u00a58 8 \u0084(#$%6= !&!#Q+!*/1& & & & & & & &t!\u0097%E$&%'V(  z #&D${:Aj2\u0099\u00a6q\u00a9E\u00a4UZ#\u008d$2)%-8*0#_J+#b#M#(S1   # /0O2[R'$! !6>)/A?+8<!*$ .)$ D3  (-/$!$[ !$%#$#! !4 #1+ 6'#'#'1& & 7 .)c0\u00a86/'I\u00a7\u0093#\\N&6$&! . , $ ! % % \u007fM\u0092;R#Gh)d$ \u0085=4(4,a$'#'#'# \ud800!) 4 : % 9#6@\u0082\u0094?$IIX*5 ((=)<#@'(\ud801!f~N.Of\u008f1-)(\ud802!'#! E %$!#/)/10^: %)-)4nQ(%T!5#   AZ?$?C( >?G)-):9*\ud803!`KJ9J\ud804#PriL3>@7M$!6F2#/! !C* 3V& ! # 9 .+8N(#%#- & % $$!;!6$\ud805eF-% !\u008987#=F-!k7x4\ud806\u0087RB!\u0095K\ud808!\u00a2\ud809e\u008a\ud80d!8\ud811!\u009c\ud81a!\u009b+0c<;F*#BH&:\ud81b\u00a0U,!l,\ud82c!%\ud82f!\"&,$++.\ud835!w m %#!#%## ) ! & S ##( & > # $ !$& \u0091#3 3 0 3 0 3 0 3 0 3 (\ud83a!\u008b\ud83b\u0098# A % !#! . # ! !(!'! ! !   % !#! ! ! ! ! % !## & # # ! . 5&  $ 5\ud869!\u009f7\u008c\ud86d!\u00a1,g\ud86e!<#\u00a3\ud873!\u009e\ud87e!\u009a",
"\ud80c\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872"),jf=("#(?: [1-9])?|(?:'|"+Td+")(?: (?:[0-9']|"+Td+"))*").replace(/ /g,"[ \t]*"),kf=["([ \t\n\r]+)|(//.*)|(/\\*)","("+("(?:[0-9](?: [0-9])*(?: \\.(?! \\.)(?:(?! "+jf+")|(?= (?: [Ee](?: [+-])?(?: [0-9])+)))(?: [0-9])*)?|\\.(?: [0-9])+)(?: [Ee](?: [+-])?(?: [0-9])+)?").replace(/ /g,"[ \t]*")+")","("+Da.map(pe).join("|")+")","("+"[](){}||".split("").map(pe).join("|")+")","("+Dd+")","("+od+")","("+jf+")",'("[^"]*")|($)'].join("|"),De=new RegExp("[ \t]*".replace(/\*$/,
"+"),"g"),Ee="ANY WS COMMENT START_COMMENT NUM OP BRA SUB SUP ID STR EOF".split(" ");(function(){var a=(new RegExp(kf,"g")).exec("");if(a.hasOwnProperty(Ee.length))throw Error("RE has more groups than expected");if(!a.hasOwnProperty(Ee.length-1))throw Error("RE has fewer groups than expected");})();Rc.prototype.advanceBy=function(a){this.advanceTo(this.pos+a)};Rc.prototype.advanceTo=function(a){for(this.pos=a;this.bols[0]<=a;)this.bol=this.bols.shift(),this.line++};Rc.prototype.curPos=function(){return{row:this.line,
col:this.pos-this.bol,pos:this.pos}};Rc.prototype.nextInternal=function(){var a=this.re.exec(this.input);if(a.index!==this.pos)throw Bb("Invalid token",this.curPos(),this.input.substring(this.pos,a.index));var b=this.curPos();this.advanceBy(a[0].length);var c=this.curPos(),d;for(d=1;null==a[d];++d);return{start:b,end:c,raw:a[0],text:a[0].replace(De,""),toktype:Ee[d]}};Rc.prototype.next=function(){do{var a=this.nextInternal();if("START_COMMENT"===a.toktype){var b=/\*\/|\/\*/g;b.lastIndex=a.start.pos+
2;for(var c=1,d;0<c;)if(d=b.exec(this.input))"/*"===d[0]?++c:--c;else throw Bb("Unterminated comment",a.start,a.text);this.re.lastIndex=b.lastIndex;this.advanceTo(b.lastIndex);a.end=this.curPos();a.raw=this.input.substring(a.start.pos,a.end.pos);a.text=a.raw;a.toktype="COMMENT"}}while("WS"===a.toktype||"COMMENT"===a.toktype);return a};var Nf={ctype:"void"};ed.prototype.postprocess=function(a){if(null===a)return Nf;if(a){if("infix"===a.ctype)if(":="===a.oper){var b=a.args[0];"function"===b.ctype&&
b.args.forEach(function(d){if(null===d||"variable"!==d.ctype)throw Bb("Function argument must be an identifier",d.start||a.start);})}else if(","===a.oper)throw Bb("comma may only be used to delimit list elements",a.start);a.args&&(a.args=a.args.map(this.postprocess,this));if(a.modifs)for(var c in a.modifs)a.modifs[c]=this.postprocess(a.modifs[c]);if("paren"===a.ctype)return a.args[0];if("infix"===a.ctype){if("."===a.oper){if(!a.args[1]||"variable"!==a.args[1].ctype)throw Bb("Field name must be identifier",
a.start,a.text);a.ctype="field";a.obj=a.args[0];a.key=a.args[1].name;delete a.args}if(":"===a.oper){if(a.jsonatom){if(!a.args[1])throw Bb("JSON: Value undefined",a.start,a.text);a.ctype="jsonatom";a.key=a.args[0];a.value=a.args[1];delete a.jsonatom}else{if(!a.args[1])throw Bb("UserData: Key undefined",a.start,a.text);a.ctype="userdata";a.obj=a.args[0];a.key=a.args[1]}delete a.args}this.infixmap&&(a.impl=this.infixmap[a.oper])}else"variable"===a.ctype?this.usedVariables[a.name]=!0:"function"===a.ctype&&
(this.usedFunctions[a.oper]=!0)}if("infix"===a.ctype)return{ctype:"infix",oper:String(a.oper),args:[a.args[0],a.args[1]],impl:a.impl};if("variable"===a.ctype)return{ctype:"variable",name:String(a.name)};if("number"===a.ctype)return{ctype:"number",value:{real:+a.value.real,imag:+a.value.imag}};if("string"===a.ctype)return{ctype:"string",value:String(a.value)};if("list"===a.ctype)return{ctype:"list",value:a.value};if("function"===a.ctype)return{ctype:"function",oper:String(a.oper),args:a.args,modifs:a.modifs};
if("field"===a.ctype)return{ctype:"field",obj:a.obj,key:String(a.key)};if("userdata"===a.ctype)return{ctype:"userdata",obj:a.obj,key:a.key};if("jsonatom"===a.ctype)return{ctype:"jsonatom",key:a.key,value:a.value};throw Error("Unsupported AST node of type "+a.ctype);};ed.prototype.parse=function(a){try{var b=oc(new Rc(a));if("EOF"!==b.closedBy.toktype)throw Bb("Closing bracket never opened.",b.closedBy.start,b.closedBy.text);return this.postprocess(b.expr)}catch(c){return c.ctype="error",c}};"undefined"!==
typeof process&&"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"===typeof window&&(module.exports.Parser=ed,module.exports.Tokenizer=Rc,module.exports.unicodeLetters=Td,module.exports.parse=function(a){return(new ed).parse(a)});var rd={},Ke=[],sa={lines:{},audioCtx:null,getAudioContext:function(){if(this.audioCtx)return this.audioCtx;window.AudioContext||window.webkitAudioContext?this.audioCtx=new (window.AudioContext||window.webkitAudioContext):console.warn("Web Audio API not supported in this browser");
return this.audioCtx},handleModif:function(a,b,c){if(void 0!==a){if(a=L(a),a.ctype===b){if("number"===a.ctype)return a.value.real;if("list"===a.ctype){b=a.value;a=[];for(c=0;c<b.length;c++)a[c]=b[c].value.real;return a}return a.value}}else return c},handleLineModif:function(a,b){return void 0!==a?(a=L(a),Ea(a)):b},getBufferNode:function(a,b){var c=this.getAudioContext();if(b*c.sampleRate>a.length){for(var d=[],f=0,k=0;f<c.sampleRate*b;f++,k++)k>a.length&&(k=0),d[f]=a[k];a=d}b=new Float32Array(a);
a=c.createBuffer(1,b.length,c.sampleRate);a.copyToChannel(b,0);c=c.createBufferSource();c.buffer=a;return c},createMonoOscillator:function(a,b){var c=this.getAudioContext().createOscillator();if(0!==b){var d=new Float32Array(2),f=new Float32Array(2);d[1]=Math.sin(b);f[1]=Math.cos(b);b=this.getAudioContext().createPeriodicWave(d,f,{disableNormalization:!0});c.setPeriodicWave(b)}else c.type="sine";c.mono=!0;c.frequency.setValueAtTime(a,this.audioCtx.currentTime);return c},createWaveOscillator:function(a,
b,c){for(var d=this.getAudioContext().createOscillator(),f=new Float32Array(b.length+1),k=new Float32Array(b.length+1),m=0;m<b.length;m++)k[m+1]=b[m]*Math.cos(c[m]),f[m+1]=b[m]*Math.sin(c[m]);b=this.getAudioContext().createPeriodicWave(f,k,{disableNormalization:!0});d.setPeriodicWave(b);d.frequency.setValueAtTime(a,this.audioCtx.currentTime);return d},cleanup:function(){for(var a in this.lines)if("sin"===this.lines[a].lineType)if(this.lines[a].oscNodes.every(function(c){return!c.oscNode.isplaying}))delete this.lines[a];
else for(var b=0;b<this.lines[a].oscNodes.length;b++)this.lines[a].oscNodes[b]&&!this.lines[a].oscNodes[b].oscNode.isplaying&&delete this.lines[a].oscNodes[b]},registerInput:function(a){a.cnt?a.cnt++:a.cnt=1},deregisterInput:function(a){a.cnt&&a.cnt--},hasRegisteredInput:function(a){return a.cnt&&0!==a.cnt},playOscillator:function(a,b,c,d,f,k){var m=this.getAudioContext(),q=m.createGain();q.gain.setValueAtTime(0,m.currentTime);a.connect(q);q.connect(b);sa.registerInput(b);a.start(0);a.isplaying=!0;
a.onended=function(){this.isplaying=!1;q.disconnect();sa.deregisterInput(b);sa.hasRegisteredInput(b)||(b.disconnect(),b.panNode&&b.panNode.disconnect());sa.cleanup()};q.gain.linearRampToValueAtTime(c,m.currentTime+d);0<=f&&(q.gain.setValueAtTime(c,m.currentTime+d+f),q.gain.linearRampToValueAtTime(0,m.currentTime+d+f+k),this.triggerStop(a,f+d+k));return{oscNode:a,gainNode:q}},softStop:function(a,b){var c=this.getAudioContext();a.gainNode.gain.cancelScheduledValues(c.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,
c.currentTime);a.gainNode.gain.linearRampToValueAtTime(0,c.currentTime+b);this.triggerStop(a.oscNode,b)},extendDuration:function(a,b,c){var d=this.getAudioContext();a.gainNode.gain.cancelScheduledValues(d.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,d.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,d.currentTime+b);a.gainNode.gain.linearRampToValueAtTime(0,d.currentTime+b+c);this.triggerStop(a.oscNode,b+c)},triggerStop:function(a,b){a.timeoutId&&clearTimeout(a.timeoutId);
a.timeoutId=setTimeout(function(){a.stop(0)},1E3*b+10)}},Ac=function(a){this.audioCtx=a;this.lineType="sin";this.oscNodes=[]};Ac.prototype.handleModif=function(a,b,c,d){if("phaseshift"===b)d=this.handlePhaseshiftModif(a.phaseshift,this.harmonics.length);else if(void 0!==a[b]&&(a=L(a[b]),a.ctype===c))if("number"===a.ctype)d=a.value.real;else if("list"===a.ctype){c=a.value;a=[];for(d=0;d<c.length;d++)a[d]=c[d].value.real;d=a}else d=a.value;return this[b]=d};Ac.prototype.handlePhaseshiftModif=function(a,
b){this.phaseshift=Array(b).fill(0);if(void 0!==a)if(a=L(a),"list"===a.ctype)for(b=a.value,a=0;a<b.length;a++)this.phaseshift[a]=b[a].value.real;else if("number"===a.ctype)for(var c=0;c<b;c++)this.phaseshift[c]=(c+1)*a.value.real;return this.phaseshift};Ac.prototype.cleanparameters=function(a){this.partials.length<this.harmonics.length&&(this.partials=Array(this.harmonics.length).fill(1),a.partials&&console.warn("Ignore partials because the given length does not match with the length of harmonics"));
this.phaseshift.length<this.harmonics.length&&(this.phaseshift=Array(this.harmonics.length).fill(0),a.phaseshift&&console.warn("Ignore phaseshift because the given length does not match with the length of harmonics"));this.precompute&=this.partials.every(function(b){return 1E-8>Math.abs(b-1)});0<this.damp&&(this.duration=Math.min(this.duration,6/this.damp))};Ac.prototype.panit=function(){0===this.pan||this.masterGain.panNode||(this.masterGain.disconnect(this.audioCtx.destination),this.masterGain.panNode=
this.audioCtx.createStereoPanner(),this.masterGain.connect(this.masterGain.panNode),this.masterGain.panNode.connect(this.audioCtx.destination));this.masterGain.panNode&&this.masterGain.panNode.pan.setValueAtTime(this.pan,this.audioCtx.currentTime)};Ac.prototype.dampit=function(){this.masterGain.gain.cancelScheduledValues(this.audioCtx.currentTime);this.masterGain.gain.setValueAtTime(this.masterGain.gain.value,this.audioCtx.currentTime);0<this.damp?this.masterGain.gain.setTargetAtTime(0,this.audioCtx.currentTime+
this.attack,1/this.damp):0>this.damp&&this.masterGain.gain.setTargetAtTime(1,this.audioCtx.currentTime+this.attack,-this.damp)};Ac.prototype.startOscillators=function(){if(this.precompute)this.oscNodes[0]=sa.playOscillator(sa.createWaveOscillator(this.freq,this.harmonics,this.phaseshift),this.masterGain,1,this.attack,this.duration,this.release);else for(var a=0;a<this.harmonics.length;a++)this.oscNodes[a]=sa.playOscillator(sa.createMonoOscillator(this.partials[a]*(a+1)*this.freq,this.phaseshift[a]),
this.masterGain,this.harmonics[a],this.attack,this.duration,this.release)};Ac.prototype.stopOscillators=function(){for(var a in this.oscNodes)sa.softStop(this.oscNodes[a],this.release),delete this.oscNodes[a]};Ac.prototype.stop=function(){this.stopOscillators()};Ac.prototype.updateFrequencyAndGain=function(){if(this.precompute)this.harmonicsdidnotchange()&&this.oscNodes[0]&&this.oscNodes[0].oscNode.isplaying&&!this.oscNodes[0].oscNode.mono?(this.oscNodes[0].oscNode.frequency.setValueAtTime(this.freq,
this.audioCtx.currentTime),sa.extendDuration(this.oscNodes[0],this.duration,this.release)):(this.stopOscillators(),this.startOscillators());else{for(var a=0;a<this.harmonics.length;a++)0<this.harmonics[a]&&(this.oscNodes[a]&&this.oscNodes[a].oscNode.isplaying&&this.oscNodes[a].oscNode.mono?(this.oscNodes[a].oscNode.frequency.setValueAtTime(this.partials[a]*(a+1)*this.freq,this.audioCtx.currentTime),this.oscNodes[a].gainNode.gain.setValueAtTime(this.harmonics[a],this.audioCtx.currentTime),sa.extendDuration(this.oscNodes[a],
this.duration,this.release)):(this.oscNodes[a]&&this.oscNodes[a].oscNode.isplaying&&!this.oscNodes[a].oscNode.mono&&sa.softStop(this.oscNodes[a],this.release),this.oscNodes[a]=sa.playOscillator(sa.createMonoOscillator(this.partials[a]*(a+1)*this.freq,this.phaseshift[a]),this.masterGain,this.harmonics[a],this.attack,this.duration,this.release)));for(var b in this.oscNodes)this.harmonics[b]||(sa.softStop(this.oscNodes[b],this.release),delete this.oscNodes[b])}};Ac.prototype.generateNewMasterGain=function(a){this.masterGain=
this.audioCtx.createGain();this.masterGain.connect(this.audioCtx.destination);this.masterGain.gain.setValueAtTime(a,this.audioCtx.currentTime)};Ac.prototype.harmonicsdidnotchange=function(){if(this.lastharmonics){var a=1&this.lastharmonics.length===this.harmonics.length;for(var b in this.harmonics)a&&(a&=this.harmonics[b]===this.lastharmonics[b])}else a=!1;return a};Ac.prototype.evokeplaysin=function(a,b,c){this.cleanparameters(c);if(0===this.duration)return this.stop(),A;a||b&&0!==this.damp?(b&&
!a&&this.stopOscillators(),this.generateNewMasterGain(this.amp),this.startOscillators()):(this.masterGain||this.generateNewMasterGain(this.amp),this.updateFrequencyAndGain());this.panit();this.dampit();this.lastharmonics=this.harmonics};z.stopsound$0=function(){if(sa.audioCtx){for(var a in sa.lines)sa.lines[a].stop(),delete sa.lines[a];sa.audioCtx.close();sa.audioCtx=null}};z.playsin$1=function(a,b){var c=sa.getAudioContext(),d=sa.handleLineModif(b.line,"0"),f=!1;sa.lines[d]&&"sin"===sa.lines[d].lineType||
(sa.lines[d]&&sa.lines[d].stop(),sa.lines[d]=new Ac(c),f=!0);c=sa.lines[d];c.freq=L(a[0]).value.real;c.handleModif(b,"amp","number",.5);c.handleModif(b,"damp","number",0);c.handleModif(b,"duration","number",sa.handleModif(b.stop,"number",1));c.handleModif(b,"harmonics","list",[1]);c.handleModif(b,"partials","list",[1]);c.handleModif(b,"attack","number",.01);c.handleModif(b,"release","number",.01);c.handleModif(b,"pan","number",0);c.handleModif(b,"precompute","boolean",!1);c.handleModif(b,"phaseshift",
"phaseshift",Array(c.harmonics.length).fill(0));a=sa.handleModif(b.restart,"boolean",!0);c.evokeplaysin(f,a,b);return A};z.playsin$0=function(a,b){if(void 0!==b.line&&(a=sa.handleLineModif(b.line,"0"),a=sa.lines[a])){a.handleModif(b,"freq","number",a.freq);a.handleModif(b,"amp","number",a.amp);a.handleModif(b,"damp","number",a.damp);a.handleModif(b,"duration","number",sa.handleModif(b.stop,"number",a.duration));a.handleModif(b,"harmonics","list",a.harmonics);a.handleModif(b,"partials","list",a.partials);
a.handleModif(b,"attack","number",a.attack);a.handleModif(b,"release","number",a.release);a.handleModif(b,"pan","number",a.pan);a.handleModif(b,"precompute","boolean",a.precompute);a.handleModif(b,"phaseshift","phaseshift",a.phaseshift);var c=sa.handleModif(b.restart,"boolean",!1);a.evokeplaysin(!1,c,b)}return A};z.playfunction$1=function(a,b){var c=sa.getAudioContext(),d=a[0];a=function(R){var ea=[];for(ea.push(R);0!==ea.length;){R=ea.pop();if("variable"===R.ctype&&L(R)===A&&["x","y","t"].includes(R.name))return R.name;
if(R.args)for(var X in R.args)ea.push(R.args[X])}return A}(d);a!==A&&V.newvar(a);var f=sa.handleLineModif(b.line,"0"),k=sa.handleModif(b.start,"number",0),m=sa.handleModif(b.amp,"number",.5),q=sa.handleModif(b.damp,"number",0);sa.handleModif(b.stop,"number",1);var v=sa.handleModif(b.duration,"number",1),w=sa.handleModif(b.attack,"number",.01),x=sa.handleModif(b.release,"number",.01),B=sa.handleModif(b.export,"boolean",!1),E=sa.handleModif(b.silent,"boolean",!1);b=[];for(var J=0;J<c.sampleRate*v;J++){a!==
A&&V.setvar(a,n.real(J/c.sampleRate));var W=L(d);b[J]=W.value.real*m*Math.exp(-q*J/c.sampleRate)}E||(sa.lines[f]&&"function"===sa.lines[f].lineType?(d=sa.lines[f],d.masterGain.gain.linearRampToValueAtTime(0,c.currentTime+x),d.bufferNode.stop(c.currentTime+x),d.bufferNode=sa.getBufferNode(b,v),d.bufferNode.connect(d.masterGain),d.bufferNode.start(k+x),d.masterGain.gain.linearRampToValueAtTime(m,c.currentTime+x+w)):(sa.lines[f]&&sa.lines[f].stop(),sa.lines[f]={lineType:"function",bufferNode:sa.getBufferNode(b,
v),masterGain:c.createGain(),stop:function(){this.bufferNode.stop()}},v=sa.lines[f],v.masterGain.gain.setValueAtTime(0,c.currentTime),v.masterGain.connect(c.destination),v.bufferNode.connect(v.masterGain),v.bufferNode.start(k),v.masterGain.gain.linearRampToValueAtTime(m,c.currentTime+w)));a!==A&&V.removevar(a);return B?b:A};z.playwave$1=function(a,b){var c=sa.getAudioContext(),d=L(a[0]),f=sa.handleLineModif(b.line,"0");a=sa.handleModif(b.amp,"number",.5);sa.handleModif(b.damp,"number",0);var k=sa.handleModif(b.duration,
"number",1),m=sa.handleModif(b.attack,"number",.01),q=sa.handleModif(b.release,"number",.01);b=sa.handleModif(b.start,"number",0);if("list"!==d.ctype)return A;sa.lines[f]&&"wave"===sa.lines[f].lineType?(f=sa.lines[f],f.masterGain.gain.linearRampToValueAtTime(0,c.currentTime+q),f.bufferNode.stop(c.currentTime+q),f.bufferNode=sa.getBufferNode(p.unwrap(d),k),f.bufferNode.connect(f.masterGain),f.bufferNode.start(b+q),f.masterGain.gain.linearRampToValueAtTime(a,c.currentTime+q+m)):(sa.lines[f]&&sa.lines[f].stop(),
sa.lines[f]={lineType:"wave",bufferNode:sa.getBufferNode(p.unwrap(d),k),masterGain:c.createGain(),stop:function(){this.bufferNode.stop()}},d=sa.lines[f],d.masterGain.gain.setValueAtTime(0,c.currentTime),d.masterGain.connect(c.destination),d.bufferNode.connect(d.masterGain),d.bufferNode.start(0),d.masterGain.gain.linearRampToValueAtTime(a,c.currentTime+m));return A};var Qa={printArr:function(a){for(var b=a.value.length,c=[],d=[],f=!1,k=0;k<b;k++)c[k]=a.value[k].value.real,d[k]=a.value[k].value.imag,
0!==d[k]&&(f=!0);console.log(c);f&&console.log(d)},zero:function(a){for(var b=[],c=n.real(0),d=0;d<a.value.real;d++)b[d]=c;return h.turnIntoCSList(b)},number:function(a,b){b=Qa.zero(b);b.value[0]=a;return b},variable:function(a,b){b=Qa.zero(b);b.value[0]=a;b.value[1]=n.real(1);return b},add:function(a,b){return h.add(a,b)},sub:function(a,b){return h.sub(a,b)},mult:function(a,b){if(a.value.length!==b.value.length)return console.error("dims don't fit return nada"),A;for(var c=a.value.length,d=Qa.zero(n.real(c)),
f=n.real(0),k=0;k<c;k++){for(var m=0;m<=k;m++)f=n.add(f,n.mult(a.value[m],b.value[k-m]));d.value[k]=f;f=n.real(0)}return d},pow:function(a,b){if(0>b.value.real||b.value.real!==Math.floor(b.value.real))return Qa.root(a,b);for(var c=a,d=1;d<b.value.real;d++)c=Qa.mult(c,a);return c},root:function(a,b){var c=n.real(0),d=n.real(1),f=n.add(d,b),k=a.value.length,m=Qa.zero(n.real(k));m.value[0]=n.pow(a.value[0],b);var q=c;for(b=1;b<k;b++){var v=n.real(b);for(var w=1;w<=b;w++){var x=n.mult(f,n.real(w));x=
n.div(x,v);x=n.sub(x,d);x=n.mult(x,a.value[w]);x=n.mult(x,m.value[b-w]);q=n.add(q,x)}q=n.div(q,a.value[0]);m.value[b]=q;q=c}return m},findFirstNoneZero:function(a,b,c){for(var d=Infinity,f=Infinity,k=c;k<a.value.length;k++)if(1E-12<n.abs2(a.value[k]).value.real){d=k;break}for(a=c;a<b.value.length;a++)if(1E-12<n.abs2(b.value[a]).value.real){f=a;break}return[d,f]},div:function(a,b){if(a.value.length!==b.value.length)return console.log("dims don't fit - return nada"),A;for(var c=a.value.length,d=n.real(0),
f=Qa.zero(n.real(c)),k=d,m,q=0;q<c;q++){m=Qa.findFirstNoneZero(a,b,q);q<m[0]&&m[0]===m[1]&&Infinity!==m[0]&&(a.value.splice(q,m[0]),b.value.splice(q,m[0]),f.value.splice(q,m[0]),c-=m[0]);m=a.value[q];for(var v=0;v<q;v++)k=n.add(k,n.mult(f.value[v],b.value[q-v]));m=n.sub(m,k);m=n.div(m,b.value[0]);f.value[q]=m;k=d}return f},exp:function(a){var b=n.real(0),c=a.value.length,d=Qa.zero(n.real(c)),f=b;d.value[0]=n.exp(a.value[0]);for(var k=1;k<c;k++){for(var m=1;m<=k;m++){var q=n.mult(n.real(m),a.value[m]);
q=n.mult(q,d.value[k-m]);f=n.add(f,q)}d.value[k]=n.div(f,n.real(k));f=b}return d},log:function(a){var b=n.real(0),c=a.value.length,d=Qa.zero(n.real(c));d.value[0]=n.log(a.value[0]);for(var f=b,k,m,q=1;q<c;q++){k=a.value[q];for(var v=1;v<q;v++)m=n.mult(n.real(v),d.value[v]),m=n.mult(m,a.value[q-v]),f=n.add(f,m);f=n.div(f,n.real(q));k=n.sub(k,f);k=n.div(k,a.value[0]);d.value[q]=k;f=b}return d},sincos:function(a){var b=n.real(0),c=a.value.length,d=Qa.zero(n.real(c)),f=Qa.zero(n.real(c));d.value[0]=n.sin(a.value[0]);
f.value[0]=n.cos(a.value[0]);for(var k=b,m=b,q,v,w,x=1;x<c;x++){w=n.real(x);for(var B=1;B<=x;B++)v=n.mult(n.real(B),a.value[B]),q=n.mult(v,f.value[x-B]),v=n.mult(v,d.value[x-B]),m=n.add(m,q),k=n.add(k,v);m=n.div(m,w);k=n.div(k,n.neg(w));d.value[x]=m;f.value[x]=k;k=m=b}Qa.sinsave=d;Qa.cossave=f;return[d,f]},sin:function(a){return Qa.sincos(a)[0]},cos:function(a){return Qa.sincos(a)[1]},faculty:function(a){var b=[];b[0]=n.real(1);for(var c=1,d=1;d<=a.value.real;d++)c*=d,b[d]=n.real(c);return b=h.turnIntoCSList(b)},
diff:function(a,b,c,d){if("variable"===a.ctype)var f=a.name!==b?Qa.number(L(a),d):Qa.variable(c,d);else if("number"===a.ctype)f=Qa.number(a,d);else{if("infix"===a.ctype){if("*"===a.oper)return Qa.mult(Qa.diff(a.args[0],b,c,d),Qa.diff(a.args[1],b,c,d));if("^"===a.oper)return Qa.pow(Qa.diff(a.args[0],b,c,d),Qa.diff(a.args[1],b,c,d).value[0]);if("/"===a.oper)return Qa.div(Qa.diff(a.args[0],b,c,d),Qa.diff(a.args[1],b,c,d));if("+"===a.oper)return Qa.add(Qa.diff(a.args[0],b,c,d),Qa.diff(a.args[1],b,c,d));
if("-"===a.oper)return Qa.sub(Qa.diff(a.args[0],b,c,d),Qa.diff(a.args[1],b,c,d));console.log("infix not found",a.oper);return A}if("function"===a.ctype){if("exp$1"===a.oper)return Qa.exp(Qa.diff(a.args[0],b,c,d));if("log$1"===a.oper)return Qa.log(Qa.diff(a.args[0],b,c,d));if("sin$1"===a.oper)return Qa.sin(Qa.diff(a.args[0],b,c,d));if("cos$1"===a.oper)return Qa.cos(Qa.diff(a.args[0],b,c,d))}else return console.log("ctype not found",a.ctype),A}return f},adevaluate:function(a,b,c,d){a=Qa.diff(a,b,c,
d);d=Qa.faculty(d);for(b=2;b<a.value.length;b++)a.value[b]=n.mult(a.value[b],d.value[b]);return a},autodiff:function(a,b,c,d){for(var f=[],k=c.value.length,m,q=0;q<k;q++)m=Qa.adevaluate(a,b,c.value[q],d),f[q]=m;return f=h.turnIntoCSList(f)}},N={handleModifs:function(a,b){N.dashing&&N.unSetDash();N.colorraw=null;N.fillcolorraw=null;N.fillrule="nonzero";N.size=null;0>=N.psize&&(N.psize=0);0>=N.lsize&&(N.lsize=0);N.overhang=1;N.dashing=!1;N.isArrow=!1;N.arrowSides="==>";N.arrowposition=1;N.headlen=10;
N.arrowShape=N.arrowShapes.line;N.alpha=P.drawingstate.alpha;N.fillalpha=0;N.bold="";N.italics="";N.family="sans-serif";N.align=0;N.angle=0;N.xOffset=0;N.yOffset=0;N.lineCap="round";N.lineJoin="round";N.miterLimit=10;N.noborder=!1;N.outlinewidth=0;N.outlinecolorraw=null;var c,d;for(c in a){var f=a[c];f&&((d=b[c])?(!0===d&&(d=N.modifHandlers[c]),d(L(f))):console.log("Modifier not supported: "+c))}null!==N.size?N.psize=N.lsize=N.size:(N.psize=P.drawingstate.pointsize,N.lsize=P.drawingstate.linesize);
N.dashing&&N.dashing(N.lsize);null!==N.colorraw?N.pointColor=N.lineColor=N.textColor=N.makeColor(N.colorraw):1===N.alpha?(N.pointColor=P.drawingstate.pointcolor,N.lineColor=P.drawingstate.linecolor,N.textColor=P.drawingstate.textcolor):(N.pointColor=N.makeColor(P.drawingstate.pointcolorraw),N.lineColor=N.makeColor(P.drawingstate.linecolorraw),N.textColor=N.makeColor(P.drawingstate.textcolorraw));N.black=1===N.alpha?"rgb(0,0,0)":"rgba(0,0,0,"+N.alpha+")";N.fillColor=N.fillcolorraw&&0<N.fillalpha?N.makeColor(N.fillcolorraw,
N.fillalpha):null;N.outlinecolor=N.outlinecolorraw&&0<N.outlinewidth?N.makeColor(N.outlinecolorraw,N.alpha):"rgb(0,0,0,0)"},modifHandlers:{size:function(a){"number"===a.ctype&&(N.size=a.value.real,0>N.size&&(N.size=0),1E3<N.size&&(N.size=1E3))},outlinewidth:function(a){"number"===a.ctype&&(N.outlinewidth=a.value.real,0>N.outlinewidth&&(N.outlinewidth=0),1E3<N.outlinewidth&&(N.outlinewidth=1E3))},color:function(a){h.isNumberVector(a).value&&3===a.value.length&&(N.colorraw=[a.value[0].value.real,a.value[1].value.real,
a.value[2].value.real])},outlinecolor:function(a){h.isNumberVector(a).value&&3===a.value.length&&(N.outlinecolorraw=[a.value[0].value.real,a.value[1].value.real,a.value[2].value.real])},fillcolor:function(a){h.isNumberVector(a).value&&3===a.value.length&&(N.fillcolorraw=[a.value[0].value.real,a.value[1].value.real,a.value[2].value.real])},alpha:function(a){"number"===a.ctype&&(N.alpha=a.value.real)},fillalpha:function(a){"number"===a.ctype&&(N.fillalpha=a.value.real)},dashpattern:function(a){if("list"===
a.ctype){for(var b=[],c=0,d=0;c<a.value.length;c++)"number"===a.value[c].ctype&&(b[d++]=a.value[c].value.real);N.dashing=N.setDash.bind(null,b)}},dashtype:function(a){if("number"===a.ctype)a=Math.floor(a.value.real);else if("string"===a.ctype)a=a.value;else return;if(a=N.dashTypes[a])N.dashing=N.setDash.bind(null,a)},dashing:function(a){"number"===a.ctype&&(a=Math.floor(a.value.real),N.dashing=N.setDash.bind(null,[2*a,a]))},overhang:function(a){"number"===a.ctype&&(N.overhang=N.overhang*a.value.real+
(1-N.overhang)*(1-a.value.real))},arrow:function(a){"boolean"===a.ctype?N.isArrow=a.value:console.error("arrow needs to be of type boolean")},arrowshape:function(a){"string"!==a.ctype?console.error("arrowshape needs to be of type string"):N.arrowShapes.hasOwnProperty(a.value)?(N.arrowShape=N.arrowShapes[a.value],N.isArrow=!0,N.arrowShape.deprecated&&(console.log("arrowshape "+a.value+" is deprecated, use "+N.arrowShape.deprecated+" instead."),N.arrowShape.deprecated=null)):(a=Object.keys(N.arrowShapes),
a.sort(),a=a.join(", "),console.error("arrowshape needs to be one of "+a))},arrowsides:function(a){"string"!==a.ctype?console.error("arrowsides is not of type string"):"==>"!==a.value&&"<==>"!==a.value&&"<=="!==a.value?console.error("arrowsides is unknows"):(N.arrowSides=a.value,N.isArrow=!0)},arrowposition:function(a){"number"!==a.ctype?console.error("arrowposition is not of type number"):0>a.value.real?console.error("arrowposition has to be positive"):1<a.value.real?N.overhang=N.overhang*a.value.real+
(1-N.overhang)*(1-a.value.real):(N.arrowposition=a.value.real,N.isArrow=!0)},arrowsize:function(a){"number"!==a.ctype?console.error("arrowsize is not of type number"):0>a.value.real?console.error("arrowsize has to be positive"):N.headlen*=a.value.real},bold:function(a){"boolean"===a.ctype&&a.value&&(N.bold="bold ")},italics:function(a){"boolean"===a.ctype&&a.value&&(N.italics="italic ")},family:function(a){"string"===a.ctype&&(N.family=a.value)},align:function(a){"string"===a.ctype&&(a=a.value,"left"===
a&&(N.align=0),"right"===a&&(N.align=1),"mid"===a||"center"===a)&&(N.align=.5)},angle:function(a){"number"===a.ctype&&(N.angle=a.value.real)},xoffset:function(a){"number"===a.ctype&&(N.xOffset=a.value.real)},yoffset:function(a){"number"===a.ctype&&(N.yOffset=a.value.real)},offset:function(a){"list"===a.ctype&&2===a.value.length&&"number"===a.value[0].ctype&&"number"===a.value[1].ctype&&(N.xOffset=a.value[0].value.real,N.yOffset=a.value[1].value.real)},lineCap:function(a){"string"!==a.ctype||"round"!==
a.value&&"square"!==a.value&&"butt"!==a.value||(N.lineCap=a.value)},lineJoin:function(a){"string"!==a.ctype||"round"!==a.value&&"bevel"!==a.value&&"miter"!==a.value||(N.lineJoin=a.value)},fillrule:function(a){"string"!==a.ctype||"nonzero"!==a.value&&"evenodd"!==a.value||(N.fillrule=a.value)},miterLimit:function(a){"number"===a.ctype&&0<a.value.real&&(N.miterLimit=Math.round(a.value.real))},noborder:function(a){"boolean"===a.ctype?N.noborder=a.value:console.error("noborder needs to be of type boolean")},
border:function(a){"boolean"===a.ctype?N.noborder=!a.value:console.error("border needs to be of type boolean")}},lineModifs:{size:!0,color:!0,alpha:!0,dashpattern:!0,dashtype:!0,dashing:!0,overhang:!0,arrow:!0,arrowshape:!0,arrowsides:!0,arrowposition:!0,arrowsize:!0,lineCap:!0,lineJoin:!0,miterLimit:!0},pointModifs:{size:!0,color:!0,alpha:!0,noborder:!0,border:!0}};N.pointAndLineModifs=Object.assign({},N.lineModifs,N.pointModifs);N.conicModifs={size:!0,color:!0,alpha:!0,dashing:!0,dashpattern:!0,
dashtype:!0,fillcolor:!0,fillrule:!0,fillalpha:!0,lineCap:!0,lineJoin:!0,miterLimit:!0};N.textModifs={size:!0,color:!0,alpha:!0,bold:!0,italics:!0,family:!0,align:!0,angle:!0,xoffset:!0,yoffset:!0,offset:!0,outlinecolor:!0,outlinewidth:!0};N.makeColor=function(a,b){void 0===b&&(b=N.alpha);return"rgba("+Math.floor(255*a[0])+","+Math.floor(255*a[1])+","+Math.floor(255*a[2])+","+b+")"};N.preDrawCurve=function(){Q.lineWidth=N.lsize;Q.lineCap=N.lineCap;Q.lineJoin=N.lineJoin;Q.mozFillRule=N.fillrule;Q.fillrule=
N.fillrule;Q.miterLimit=N.miterLimit;Q.strokeStyle=N.lineColor};N.arrowShapes={default:{close:!1,fill:!1,ratio:1,deprecated:"line"},line:{close:!1,fill:!1,ratio:1},empty:{close:!0,fill:!1,ratio:1},hollow:{close:!0,fill:!1,ratio:1,deprecated:"empty"},full:{close:!0,fill:!0,ratio:1},jet:{close:!0,fill:!0,ratio:1.5},delta:{close:!0,fill:!0,ratio:1.5,deprecated:"jet"}};N.clipSegment=function(a,b){var c=b.x-a.x,d=b.y-a.y,f=N.clipLineCore(-d,c,a.x*b.y-b.x*a.y);if(2!==f.length)return[];var k=f[0];f=f[1];
var m=1/(c*c+d*d),q=((k.x-a.x)*c+(k.y-a.y)*d)*m;c=((f.x-a.x)*c+(f.y-a.y)*d)*m;0>q&&(k=a);1<q&&(k=b);0>c&&(f=a);1<c&&(f=b);return k===f?[]:[k,f]};N.drawsegcore=function(a,b){function c(E,J,W,R){var ea=E-R*x+.5*B,X=J-R*B-.5*x,oa=E-R*x-.5*B;R=J-R*B+.5*x;Q.beginPath();N.arrowShape.fill&&(Q.lineWidth=N.lsize/2);Q.moveTo(ea,X);Q.lineTo(E,J);Q.lineTo(oa,R);N.arrowShape.close&&(Q.fillStyle=N.lineColor,Q.lineTo(E-W*x,J-W*B),Q.closePath(),N.arrowShape.fill&&Q.fill());Q.stroke()}var d=P.drawingstate.matrix,
f=a.x*d.a-a.y*d.b+d.tx,k=a.x*d.c-a.y*d.d-d.ty,m=b.x*d.a-b.y*d.b+d.tx,q=b.x*d.c-b.y*d.d-d.ty,v=N.overhang,w=1-v;b=v*f+w*m;d=v*k+w*q;a=v*m+w*f;v=v*q+w*k;if(0>b||b>pb||0>d||d>rb||0>a||a>pb||0>v||v>rb){v=N.clipSegment({x:b,y:d},{x:a,y:v});if(2!==v.length||.01>N.lsize)return;b=v[0].x;d=v[0].y;a=v[1].x;v=v[1].y}N.preDrawCurve();if(!N.isArrow||f===k&&m===q).01>N.lsize||(Q.beginPath(),Q.moveTo(b,d),Q.lineTo(a,v),Q.stroke());else{f=m-f;k=q-k;m=N.headlen/Math.sqrt(f*f+k*k);var x=f*m,B=k*m;q=N.arrowposition;
w=1-q;f=q*b+w*a;k=q*d+w*v;m=q*a+w*b;q=q*v+w*d;w=N.arrowSides;Q.beginPath();N.arrowShape.close?("<==>"===w||"<=="===w?(1>N.arrowposition&&(Q.moveTo(b,d),Q.lineTo(f,k)),Q.moveTo(f+x,k+B)):Q.moveTo(b,d),"==>"===w||"<==>"===w?(Q.lineTo(m-x,q-B),1>N.arrowposition&&(Q.moveTo(m,q),Q.lineTo(a,v))):Q.lineTo(a,v)):(Q.moveTo(b,d),Q.lineTo(a,v));Q.stroke();"==>"!==w&&"<==>"!==w||c(m,q,1,N.arrowShape.ratio);"<=="!==w&&"<==>"!==w||c(f,k,-1,-N.arrowShape.ratio)}};N.drawpoint=function(a){var b=P.drawingstate.matrix,
c=a.x*b.a-a.y*b.b+b.tx;a=a.x*b.c-a.y*b.d-b.ty;Q.lineWidth=.3*N.psize;Q.beginPath();Q.arc(c,a,N.psize,0,2*Math.PI);Q.fillStyle=N.pointColor;Q.fill();N.noborder||(Q.beginPath(),Q.arc(c,a,1.15*N.psize,0,2*Math.PI),Q.fillStyle=N.black,Q.strokeStyle=N.black,Q.stroke())};N.clipLineCore=function(a,b,c){var d=Math.SQRT1_2*N.lsize,f=0-d,k=pb+d,m=0-d;d=rb+d;var q=0>f*a+m*b+c,v=0>k*a+m*b+c,w=0>f*a+d*b+c,x=0>k*a+d*b+c,B=[];q!==v&&B.push({x:(-c-b*m)/a,y:m});v!==x&&B.push({x:k,y:(-c-a*k)/b});w!==x&&B.push({x:(-c-
b*d)/a,y:d});q!==w&&B.push({x:f,y:(-c-a*f)/b});return B};N.clipLine=function(a){a=h.normalizeMax(h.productVM(a,P.toMat()));return N.clipLineCore(a.value[0].value.real,a.value[1].value.real,a.value[2].value.real)};N.drawline=function(a){h._helper.isAlmostReal(a)&&(a=N.clipLine(a),2===a.length&&.01<=N.lsize&&(N.preDrawCurve(),Q.beginPath(),Q.moveTo(a[0].x,a[0].y),Q.lineTo(a[1].x,a[1].y),Q.stroke()))};N.drawRaySegment=function(a,b){a=M.extractPoint(a);b=M.extractPoint(b);if(a.ok&&b.ok){var c=a.x-b.x,
d=a.y-b.y,f=25E3/P.drawingstate.matrix.sdet/Math.sqrt(c*c+d*d);c*=f;d*=f;N.drawsegcore(a,{x:a.x+c,y:a.y+d});N.drawsegcore(b,{x:b.x-c,y:b.y-d})}};N.dashTypes={solid:[],dashed:[10,10],tightdash:[10,4],dotted:[1,3],dashdot:[10,5,1,5],"dashvalue.solid":[],"dashvalue.dashed":[10,10],"dashvalue.tightdash":[10,4],"dashvalue.dotted":[1,3],"dashvalue.dashdot":[10,5,1,5],0:[],1:[10,10],2:[10,4],3:[1,3],4:[10,5,1,5]};N.setDash=function(a,b){b=Math.sqrt(b);a=a.slice();for(var c=0;c<a.length;c++)a[c]*=b;Q.webkitLineDash=
a;Q.setLineDash(a);Q.mozDash=a};N.unSetDash=function(){Q.webkitLineDash=[];Q.setLineDash([]);Q.mozDash=[]};Pe.prototype={set fillStyle(a){var b=this;Cc(a,function(c,d,f,k){b._fill="#"+Dc(c.toString(16),2)+Dc(d.toString(16),2)+Dc(f.toString(16),2);b._fillOpacity=255===k?null:k})},set strokeStyle(a){var b=this;Cc(a,function(c,d,f,k){b._stroke="#"+Dc(c.toString(16),2)+Dc(d.toString(16),2)+Dc(f.toString(16),2);b._strokeOpacity=255===k?null:k})},clearRect:function(){},beginPath:function(){this._path=[]},
_pathcmd:function(){this._path.push.apply(this._path,arguments)},closePath:function(){this._pathcmd("Z")},moveTo:function(a,b){this._pathcmd("M",a,b)},lineTo:function(a,b){this._pathcmd("L",a,b)},bezierCurveTo:function(a,b,c,d,f,k){this._pathcmd("C",a,b,c,d,f,k)},quadraticCurveTo:function(a,b,c,d){this._pathcmd("Q",a,b,c,d)},arc:function(a,b,c,d,f,k){var m=c*Math.cos(d)+a,q=c*Math.sin(d)+b,v=c*Math.cos(f)+a,w=c*Math.sin(f)+b;f=k?d-f:f-d;f>=2*Math.PI?this._pathcmd(this._path.length?"L":"M",m,q,"A",
c,c,0,0,k?1:0,a-c*Math.cos(d),b-c*Math.sin(d),"A",c,c,0,0,k?1:0,m,q):this._pathcmd(this._path.length?"L":"M",m,q,"A",c,c,0,f>Math.PI?1:0,k?1:0,v,w)},rect:function(a,b,c,d){this._pathcmd("M",a,b,"h",c,"v",d,"h",-c,"z")},_cmd:function(a){1!==this.globalAlpha?(this._body.push('<g opacity="'+this.globalAlpha+'">'),this._body.push(a),this._body.push("</g>")):this._body.push(a)},_attrs:function(a){var b="",c;for(c in a)null!==a[c]&&(b+=" "+c+'="'+a[c]+'"');return b},fill:function(){this._cmd("<path"+this._attrs({d:this._path.join(" "),
fill:this._fill,"fill-opacity":this._fillOpacity})+"/>")},stroke:function(){this._cmd("<path"+this._attrs({d:this._path.join(" "),stroke:this._stroke,"stroke-opacity":this._strokeOpacity,"stroke-width":this.lineWidth,"stroke-linecap":this.lineCap,"stroke-linejoin":this.lineJoin,"stroke-miterlimit":"miter"===this.lineJoin?this.miterLimit:null})+"/>")},clip:function(){++this._clipIndex;this._body.push('<clipPath id="clip'+this._clipIndex+'"><path d="'+this._path.join(" ")+'"/></clipPath>','<g clip-path="url(#clip'+
this._clipIndex+')">');this._saveStack[this._saveStack.length-1]+="</g>"},save:function(){this._saveStack.push("")},restore:function(){this._body.push(this._saveStack.pop());0===this._saveStack.length&&this._saveStack.push("")},_transform:function(a){this._body.push('<g transform="'+a+'">');this._saveStack[this._saveStack.length-1]+="</g>"},translate:function(a,b){this._transform("translate("+a+" "+b+")")},rotate:function(a){this._transform("rotate("+Math.PI/180*a+")")},scale:function(a,b){this._transform("scale("+
a+" "+b+")")},transform:function(a,b,c,d,f,k){this._transform("matrix("+[a,b,c,d,f,k].join(" ")+")")},drawImage:function(a,b,c){if(3!==arguments.length)throw Error("SvgWriterContext only supports 3-argument version of drawImage");var d=this._imgcache.indexOf(a);if(-1===d){d=this._imgcache.length;var f=a.cachedDataURL?a.cachedDataURL:qe(a);this._defs.push('<image id="img'+d+'" x="0" y="0" width="'+a.width+'" height="'+a.height+'" xlink:href="'+f+'"/>');this._imgcache.push(a)}this._cmd('<use x="'+b+
'" y="'+c+'" xlink:href="#img'+d+'"/>')},toBlob:function(){for(;1<this._saveStack.length||""!==this._saveStack[0];)this.restore();var a='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+this.width+'px" height="'+this.height+'px">\n'+this._defs.join("\n")+'\n</defs>\n<g stroke="none" fill="none">\n'+this._body.join("\n")+"\n</g>\n</svg>\n";return new Blob([a],{type:"image/svg+xml"})}};Qe.prototype=
{_cmd:function(){this._body.push(Array.prototype.join.call(arguments," "))},_setAlpha:function(a,b,c){var d=Math.round(255*a*this._globalAlpha);b+=d;this._extGState[b]="<< /"+c+" "+d/255+" >>";this._cmd("/"+b,"gs");return a},set globalAlpha(a){this._globalAlpha=a;this._setAlpha(this._strokeAlpha,"As","CA");this._setAlpha(this._fillAlpha,"Af","ca")},set fillStyle(a){var b=this;Cc(a,function(c,d,f,k){b._cmd(c/255,d/255,f/255,"rg");b._setAlpha(b._fillAlpha=k,"Af","ca")})},set strokeStyle(a){var b=this;
Cc(a,function(c,d,f,k){b._cmd(c/255,d/255,f/255,"RG");b._setAlpha(b._strokeAlpha=k,"As","CA")})},set lineWidth(a){this._cmd(a,"w")},set lineCap(a){this._cmd({butt:0,round:1,square:2}[a],"J")},set lineJoin(a){this._cmd({miter:0,round:1,bevel:2}[a],"j")},set miterLimit(a){this._cmd(a,"M")},clearRect:function(){},beginPath:function(){this._pathUsed=!1},closePath:function(){this._cmd("h")},moveTo:function(a,b){this._cmd(this._xPos=a,this._yPos=-b,"m")},lineTo:function(a,b){this._cmd(this._xPos=a,this._yPos=
-b,"l")},bezierCurveTo:function(a,b,c,d,f,k){this._cmd(a,-b,c,-d,this._xPos=f,this._yPos=-k,"c")},quadraticCurveTo:function(a,b,c,d){this.bezierCurveTo((2*a+this._xPos)/3,(2*b-this._yPos)/3,(c+2*a)/3,(d+2*b)/3,c,d)},_kappa:.5522847498307935,arc:function(a,b,c,d,f,k){if(0===d&&f===2*Math.PI)d=this._kappa*c,this.moveTo(a+c,b),this.bezierCurveTo(a+c,b+d,a+d,b+c,a,b+c),this.bezierCurveTo(a-d,b+c,a-c,b+d,a-c,b),this.bezierCurveTo(a-c,b-d,a-d,b-c,a,b-c),this.bezierCurveTo(a+d,b-c,a+c,b-d,a+c,b);else throw Error("PdfWriterContext.arc only supports full circles");
},rect:function(a,b,c,d){this._cmd(a,-b,c,-d,"re")},_usePath:function(a){if(this._pathUsed){var b=this._body[this._pathUsed],c={"S + f":"B","f + S":"B","W n + S":"W S","W n + f":"W f","S + W n":"W S","f + W n":"W f","B + W n":"W B","W S + f":"W B","W f + S":"W B"}[b+" + "+a];if(!c)throw Error("Don't know how to combine '"+b+"' and '"+a+"'");this._body.splice(this._pathUsed,1);a=c}this._pathUsed=this._body.length;this._cmd(a)},fill:function(){this._usePath("f")},stroke:function(){this._usePath("S")},
clip:function(){this._usePath("W n")},save:function(){this._cmd("q")},restore:function(){this._cmd("Q")},translate:function(a,b){this.transform(1,0,0,1,a,b)},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);this.transform(b,a,-a,b,0,0)},scale:function(a,b){this.transform(a,0,0,b,0,0)},transform:function(a,b,c,d,f,k){this._cmd(a,-b,-c,d,f,-k,"cm")},_png:function(a){if("data:image/png;base64,"!==a.substr(0,22))return{error:"Not a base64-encoded PNG file"};a=Re(a.substr(22));var b=Se(a);console.log("PNG chunks:",
b.map(function(oa){return oa.type}));if("IHDR"!==b[0].type)throw Error("Image does not start with an IHDR");var c=b[0].data;a=(c[0]<<24|c[1]<<16|c[2]<<8|c[3])>>>0;var d=(c[4]<<24|c[5]<<16|c[6]<<8|c[7])>>>0,f=c[8],k=c[9],m=0===(k&2),q=0!==(k&4),v=c[10],w=c[11];c=c[12];if(0!==v)throw Error("Unsupported PNG compression method: "+v);if(0!==w)throw Error("Unsupported PNG filter method: "+w);if(0!==c)return{error:"Interlaced image not supported"};if(0!==(k&1))return{error:"Indexed PNG image not supported"};
w=null;k=m?1:3;v=b.filter(function(oa){return"IDAT"===oa.type}).map(function(oa){return oa.data});if(q){q=window.pako;w=new q.Inflate;for(b=0;b<v.length;++b)w.push(v[b],b+1===v.length);if(w.err)throw Error(w.err);w=w.result;c=f>>>3;if(w.length!==d*(a*(k+1)*c+1))throw Error("Data length mismatch");var x=k*c;v=new Uint8Array(d*(a*x+1));for(var B=new Uint8Array(d*(a*c+1)),E=0,J=0,W=0,R=0;R<d;++R){v[J++]=B[W++]=w[E++];for(var ea=0;ea<a;++ea){for(b=0;b<x;++b)v[J++]=w[E++];for(b=0;b<c;++b)B[W++]=w[E++]}}if(E!==
w.length||J!==v.length||W!==B.length)throw Error("Seems we garbled our index computation somehow");B=q.deflate(B);w=this._strm({Type:"/XObject",Subtype:"/Image",Width:a,Height:d,ColorSpace:"/DeviceGray",BitsPerComponent:f,Filter:"/FlateDecode",DecodeParms:this._dict({Predictor:15,Colors:1,BitsPerComponent:f,Columns:a})},B).ref;v=[q.deflate(v)]}var X=0;v.forEach(function(oa){X+=oa.length});return this._obj([this._dict({Type:"/XObject",Subtype:"/Image",Name:"/img"+this._imgcache.length,Width:a,Height:d,
ColorSpace:m?"/DeviceGray":"/DeviceRGB",SMask:w,BitsPerComponent:f,Length:X,Filter:"/FlateDecode",DecodeParms:this._dict({Predictor:15,Colors:k,BitsPerComponent:f,Columns:a})}),"\nstream\n"].concat(v,["\nendstream"]))},drawImage:function(a,b,c){if(3!==arguments.length)throw Error("PdfWriterContext only supports 3-argument version of drawImage");var d=this._imgcache.indexOf(a);if(-1===d){d=this._imgcache.length;this._imgcache.push(a);var f=this._png(a.cachedDataURL||"");f.hasOwnProperty("error")&&
(f=this._png(qe(a)));if(f.hasOwnProperty("error"))throw Error(f.error);this._xobjects["img"+d]=f.ref}this._cmd("q");this._setAlpha(1,"Af","ca");this._cmd(a.width,0,0,a.height,b,-c-a.height,"cm");this._cmd("/img"+d,"Do");this._cmd("Q")},_dict:function(a){var b="<<",c;for(c in a)b+=" /"+c+" "+a[c];return b+" >>"},_obj:function(a,b){b||(b=this._nextIndex++);Array.isArray(a)||(a=[this._dict(a)]);a.index=b;a.ref=b+" 0 R";a.offset=this._offset;var c=0;a.unshift(b+" 0 obj\n");a.push("\nendobj\n");for(b=
0;b<a.length;++b)c+=a[b].length;this._offset+=c;this._objects.push(a);return a},_strm:function(a,b,c){a.Length=b.length;return this._obj([this._dict(a),"\nstream\n",b,"\nendstream"],c)},toBlob:function(){var a="["+[0,-this.height,this.width,0].join(" ")+"]";this._obj({Type:"/Catalog",Pages:"2 0 R"},1);this._obj({Type:"/Pages",Kids:"[3 0 R]",Count:1},2);this._obj({Type:"/Page",Parent:"2 0 R",MediaBox:a,Contents:"4 0 R",Resources:this._dict({ProcSet:"[/PDF /Text /ImageB /ImageC /ImageI]",XObject:this._dict(this._xobjects),
ExtGState:this._dict(this._extGState)})},3);var b=this._body.join("\n"),c=new Uint8Array(b.length);for(a=0;a<b.length;++a)c[a]=b.charCodeAt(a)&255;b=window.pako.deflate(c);this._strm({Filter:"/FlateDecode"},b,4);b=this._objects;var d=[];for(a=1;a<b.length;++a)d[b[a].index]=b[a];c="xref\n0 "+d.length+"\n";for(a=0;a<d.length;++a)c=d[a]?c+(Dc(String(d[a].offset),10)+" 00000 n \n"):c+"0000000000 65535 f \n";a="trailer\n"+this._dict({Size:d.length,Root:"1 0 R"})+"\nstartxref\n"+this._offset+"\n%%EOF\n";
b=Array.prototype.concat.apply([],b);b.push(c,a);return new Blob(b,{type:"application/pdf"})}};var Le=null;Nc.push(Qc);Vb.exportSVG=function(a){Kd(Pe,void 0===a?"CindyJSExport":a)};Vb.exportPDF=function(a){a=void 0===a?"CindyJSExport":a;Tb.loadScript("pako","pako.min.js",function(){Kd(Qe,a)})};Vb.exportPNG=function(a){a=void 0===a?"CindyJSExport":a;Hf(Q.canvas.toDataURL(),a)};var Hf=function(a,b){var c=document.createElement("a");document.body.appendChild(c);c.style="display: none";c.href=a;c.download=
b;c.click();setTimeout(function(){document.body.removeChild(c);Qc()},100)},Cf="Move",Me,lc=[],Vc=0,Lf=0,he=0,ia={Delete:{}};ia.Delete.actions=[];ia.Delete.actions[0]={};ia.Delete.actions[0].event="mousedown";ia.Delete.actions[0].tooltip="...";ia.Delete.actions[0].do=function(){wb=yd(hb);null!==wb&&Nd(wb.mover.name);return!0};ia.Move={};ia.Move.actions=[];ia.Move.actions[0]={};ia.Move.actions[0].event="mousedown";ia.Move.actions[0].tooltip="Move free elements by dragging the mouse";ia.Move.actions[0].do=
function(){wb=e(hb);return!0};ia.Point={};ia.Point.actions=[];ia.Point.actions[0]={};ia.Point.actions[0].event="mousedown";ia.Point.actions[0].tooltip="Add a single point with the mouse";ia.Point.actions[0].do=function(){jc({type:"Free",name:xc(),labeled:!0,pos:[Cb[0],Cb[1],1]});return!0};ia.Mid={};ia.Mid.actions=[];ia.Mid.actions[0]={};ia.Mid.actions[0].event="mousedown";ia.Mid.actions[0].tooltip="Construct two points and their midpoint by dragging";ia.Mid.actions[0].do=function(){ic();return!0};
ia.Mid.actions[1]={};ia.Mid.actions[1].event="mousemove";ia.Mid.actions[1].do=function(){Md("Mid");return!0};ia.Mid.actions[2]={};ia.Mid.actions[2].event="mouseup";ia.Mid.actions[2].do=function(){gd();return!0};ia.Circle={};ia.Circle.actions=[];ia.Circle.actions[0]={};ia.Circle.actions[0].event="mousedown";ia.Circle.actions[0].tooltip="Construct two points and a circle by dragging the mouse";ia.Circle.actions[0].do=function(){ic();return!0};ia.Circle.actions[1]={};ia.Circle.actions[1].event="mousemove";
ia.Circle.actions[1].do=function(){Md("CircleMP");return!0};ia.Circle.actions[2]={};ia.Circle.actions[2].event="mouseup";ia.Circle.actions[2].do=function(){gd();return!0};ia.Compass={};ia.Compass.actions=[];ia.Compass.actions[0]={};ia.Compass.actions[0].event="mousedown";ia.Compass.actions[0].tooltip="...";ia.Compass.actions[0].do=function(){ic();return!0};ia.Compass.actions[1]={};ia.Compass.actions[1].event="mousedown";ia.Compass.actions[1].tooltip="...";ia.Compass.actions[1].do=function(){ic();
return!0};ia.Compass.actions[2]={};ia.Compass.actions[2].event="mousedown";ia.Compass.actions[2].tooltip="...";ia.Compass.actions[2].do=function(){ic();jc({type:"Compass",name:xc(),labeled:!0,args:[lc[0].name,lc[1].name,lc[2].name]});return!0};ia.Line={};ia.Line.actions=[];ia.Line.actions[0]={};ia.Line.actions[0].event="mousedown";ia.Line.actions[0].tooltip="Construct two points and their connecting line by dragging the mouse";ia.Line.actions[0].do=function(){ic();return!0};ia.Line.actions[1]={};
ia.Line.actions[1].event="mousemove";ia.Line.actions[1].do=function(){Md("Join");return!0};ia.Line.actions[2]={};ia.Line.actions[2].event="mouseup";ia.Line.actions[2].do=function(){gd();return!0};ia.Segment={};ia.Segment.actions=[];ia.Segment.actions[0]={};ia.Segment.actions[0].event="mousedown";ia.Segment.actions[0].tooltip="Draw a segment by dragging the mouse";ia.Segment.actions[0].do=function(){ic();return!0};ia.Segment.actions[1]={};ia.Segment.actions[1].event="mousemove";ia.Segment.actions[1].do=
function(){Md("Segment");return!0};ia.Segment.actions[2]={};ia.Segment.actions[2].event="mouseup";ia.Segment.actions[2].do=function(){gd();return!0};ia.Parallel={};ia.Parallel.actions=[];ia.Parallel.actions[0]={};ia.Parallel.actions[0].event="mousedown";ia.Parallel.actions[0].tooltip="Construct a parallel line by dragging a line";ia.Parallel.actions[0].do=function(){return Te()};ia.Parallel.actions[1]={};ia.Parallel.actions[1].event="mousemove";ia.Parallel.actions[1].do=function(){var a={type:"Free",
name:xc(),labeled:!0,pos:[Cb[0],Cb[1],1],tmp:!0};a=jc(a);Me=jc({type:"Para",name:xc(),labeled:!0,args:[lc[0].name,a.name]});te(a);return!0};ia.Parallel.actions[2]={};ia.Parallel.actions[2].event="mouseup";ia.Parallel.actions[2].do=function(){gd();return!0};ia.Orthogonal={};ia.Orthogonal.actions=[];ia.Orthogonal.actions[0]={};ia.Orthogonal.actions[0].event="mousedown";ia.Orthogonal.actions[0].tooltip="Construct a orthogonal line by dragging a line";ia.Orthogonal.actions[0].do=function(){if(Te()){var a=
{type:"Free",name:xc(),labeled:!0,pos:[Cb[0],Cb[1],1],tmp:!0};a=jc(a);Me=jc({type:"Perp",name:xc(),labeled:!0,args:[lc[0].name,a.name]});te(a);return!0}return!1};ia.Orthogonal.actions[1]={};ia.Orthogonal.actions[1].event="mouseup";ia.Orthogonal.actions[1].do=function(){gd();return!0};ia.Intersection={};ia.Intersection.actions=[];ia.Intersection.actions[0]={};ia.Intersection.actions[0].event="mousedown";ia.Intersection.actions[0].tooltip="Select two elements to define their intersection";ia.Intersection.actions[0].do=
function(){return Ue()};ia.Intersection.actions[1]={};ia.Intersection.actions[1].event="mousedown";ia.Intersection.actions[1].do=function(){return Ue()?(Me=jc({type:"Meet",name:xc(),labeled:!0,args:[lc[0].name,lc[1].name]}),!0):!1};var Ib=function(a){a?(this._e=[],this._e[0]=a[0][0],this._e[1]=a[1][0],this._e[2]=a[2][0],this._e[3]=a[0][1],this._e[4]=a[1][1],this._e[5]=a[2][1],this._e[6]=a[0][2],this._e[7]=a[1][2],this._e[8]=a[2][2]):this._e=[1,0,0,0,1,0,0,0,1]};Ib.prototype.clone=function(){var a=
[].concat($jscomp.arrayFromIterable(this._e)),b=new Ib;b.set(a);return b};Ib.prototype.get=function(a){return this._e[a]};Ib.prototype.getRow=function(a){var b=this._e;return[b[a],b[3+a],b[6+a]]};Ib.prototype.set=function(a,b){1===arguments.length&&(this._e=a);2===arguments.length&&(this._e[a]=b)};Ib.prototype.exchange=function(a,b){var c=$jscomp.makeIterator([this._e[b],this._e[a]]);this._e[a]=c.next().value;this._e[b]=c.next().value};Ib.prototype.inverse=function(){var a=this._e,b=-a[2]*a[4]*a[6]+
a[1]*a[5]*a[6]+a[2]*a[3]*a[7]-a[0]*a[5]*a[7]-a[1]*a[3]*a[8]+a[0]*a[4]*a[8];a=[-a[4]*a[7]+a[4]*a[8],a[5]*a[6]-a[3]*a[8],-a[4]*a[6]+a[3]*a[7],a[2]*a[7]-a[1]*a[8],-a[2]*a[6]+a[0]*a[8],a[1]*a[6]-a[0]*a[7],-a[2]*a[4]+a[1]*a[5],a[2]*a[3]-a[0]*a[5],-a[1]*a[3]+a[0]*a[4]];1E-10>Math.abs(b)&&console.log("PSLQ: inverting singular matrix!");this._e=a.map(function(c){return c/b});return this};Ib.prototype.swRow=function(a,b){for(var c=0;9>c;)this.exchange(c+a,c+b),c+=3};Ib.prototype.swCol=function(a,b){for(var c=
0;3>c;++c)this.exchange(3*a+c,3*b+c)};Ib.mult=function(a,b,c){a=[a.get(0)*b.get(0)+a.get(3)*b.get(1)+a.get(6)*b.get(2),a.get(1)*b.get(0)+a.get(4)*b.get(1)+a.get(7)*b.get(2),a.get(2)*b.get(0)+a.get(5)*b.get(1)+a.get(8)*b.get(2),a.get(0)*b.get(3)+a.get(3)*b.get(4)+a.get(6)*b.get(5),a.get(1)*b.get(3)+a.get(4)*b.get(4)+a.get(7)*b.get(5),a.get(2)*b.get(3)+a.get(5)*b.get(4)+a.get(8)*b.get(5),a.get(0)*b.get(6)+a.get(3)*b.get(7)+a.get(6)*b.get(8),a.get(1)*b.get(6)+a.get(4)*b.get(7)+a.get(7)*b.get(8),a.get(2)*
b.get(6)+a.get(5)*b.get(7)+a.get(8)*b.get(8)];c.set(a)};Ib.prototype.getString=function(){var a=this._e;return"/"+a[0]+"\t "+a[3]+"\t "+a[6]+"\\\n|"+a[1]+"\t "+a[4]+"\t "+a[7]+"|\n\\"+a[2]+"\t "+a[5]+"\t "+a[8]+"/\n"};Ib.prototype.transpose=function(){this.exchange(1,3);this.exchange(2,6);this.exchange(5,7);return this};Ib.VMmult=function(a,b,c){c[0]=b.get(0)*a[0]+b.get(1)*a[1]+b.get(2)*a[2];c[1]=b.get(3)*a[0]+b.get(4)*a[1]+b.get(5)*a[2];c[2]=b.get(6)*a[0]+b.get(7)*a[1]+b.get(8)*a[2]};var nc=function(){};
nc.dot=function(a,b){for(var c=0,d=0;d<a.length;d++)c+=a[d]*b[d];return c};nc.scale=function(a,b){for(var c=0;c<a.length;++c)a[c]*=b};nc.maxIndex=function(a){for(var b=0,c=1;c<a.length;++c)a[c]>a[b]&&(b=c);return b};nc.hermiteReduce=function(a){for(var b=[[1,0,0],[0,1,0],[0,0,1]],c=a.length,d=a.map(function(v){return[].concat($jscomp.arrayFromIterable(v))}),f,k=1;k<c;k++)for(var m=k-1;0<=m;m--){f=Math.round(a[k][m]/a[m][m]);for(var q=0;q<=m;q++)d[k][q]-=f*d[m][q];for(q=0;q<c;q++)b[k][q]-=f*b[m][q]}for(c=
0;3>c;c++)a[c]=d[c];return new Ib(b)};nc.doPSLQ=function(a,b){for(var c=a.length,d=[],f=[],k=0;k<c;++k){d[k]=a[k]/Math.sqrt(nc.dot(a,a));for(var m=0,q=k;q<c;++q)m+=Math.pow(a[q],2);f[k]=Math.sqrt(m)}nc.scale(f,1/f[0]);k=new Ib;a=new Ib;m=[];for(q=0;q<c;q++)m[q]=[];for(q=0;q<c;++q)for(var v=0;v<c-1;++v)m[q][v]=q>v?-d[q]*d[v]/f[v]/f[v+1]:q===v?f[q+1]/f[q]:0;q=nc.hermiteReduce(m);v=q.clone().inverse().transpose();Ib.VMmult(d,v,d);Ib.mult(q,k,k);Ib.mult(a,v,a);for(f=0;f<nc.MAX_ITER;++f){v=[m[0][0],m[1][1]];
q=0;Math.pow(this.GAMMA,2)*Math.abs(v[1])>Math.pow(this.GAMMA,1)*Math.abs(v[0])&&(q=1);var w=v=0,x=0;q<c-2&&(v=m[q+1][q],w=m[q+1][q+1],x=Math.sqrt(Math.pow(v,2)+Math.pow(w,2)));var B=d[q];d[q]=d[q+1];d[q+1]=B;B=[].concat($jscomp.arrayFromIterable(m[q]));m[q]=m[q+1];m[q+1]=B;k.swRow(q,q+1);a.swCol(q,q+1);B=Array(2);for(var E=0;3>E;E++)B[E]=[];if(q<c-2){for(E=0;E<c-1;++E)for(var J=0;J<c-1;++J)B[E][J]=E===q&&J===q?v/x:E===q&&J===q+1?-w/x:E===q+1&&J===q?w/x:E===q+1&&J===q+1?v/x:E===J&&J!==q||E===J&&J!==
q+1?1:0;m=[[m[0][0]*B[0][0]+m[0][1]*B[1][0],m[0][0]*B[0][1]+m[0][1]*B[1][1]],[m[1][0]*B[0][0]+m[1][1]*B[1][0],m[1][0]*B[0][1]+m[1][1]*B[1][1]],[m[2][0]*B[0][0]+m[2][1]*B[1][0],m[2][0]*B[0][1]+m[2][1]*B[1][1]]]}q=nc.hermiteReduce(m);v=q.clone().inverse().transpose();Ib.VMmult(d,v,d);Ib.mult(q,k,k);Ib.mult(a,v,a);q=[d[0],d[1],d[2],m[0][0],m[1][1]];for(v=0;v<q.length;++v)if(Math.abs(q[v])<=Math.pow(10,-b+5)){a.transpose();for(b=0;b<d.length;++b)d[b]=-Math.abs(d[b]);return a.getRow(nc.maxIndex(d))}}};
$jscomp.global.Object.defineProperties(nc,{MAX_ITER:{configurable:!0,enumerable:!0,get:function(){return 20}},GAMMA:{configurable:!0,enumerable:!0,get:function(){return 2/Math.sqrt(3)}}});var bd={},P={drawingstate:{}};P.drawingstate.linecolor="rgb(0,0,255)";P.drawingstate.linecolorraw=[0,0,1];P.drawingstate.pointcolor="rgb(0,255,0)";P.drawingstate.pointcolorraw=[0,1,0];P.drawingstate.textcolor="rgb(0,0,0)";P.drawingstate.textcolorraw=[0,0,0];P.drawingstate.textoutlinecolor="rgb(255,255,255)";P.drawingstate.textoutlinecolorraw=
[1,1,1];P.drawingstate.alpha=1;P.drawingstate.pointsize=4;P.drawingstate.linesize=1;P.drawingstate.textsize=null;P.drawingstate.textoutlinewidth=0;P.drawingstate.matrix={};P.drawingstate.matrix.a=25;P.drawingstate.matrix.b=0;P.drawingstate.matrix.c=0;P.drawingstate.matrix.d=25;P.drawingstate.matrix.tx=250.5;P.drawingstate.matrix.ty=250.5;P.drawingstate.matrix.det=P.drawingstate.matrix.a*P.drawingstate.matrix.d-P.drawingstate.matrix.b*P.drawingstate.matrix.c;P.drawingstate.matrix.sdet=Math.sqrt(P.drawingstate.matrix.det);
P.drawingstate.initialmatrix={};P.drawingstate.initialmatrix.a=P.drawingstate.matrix.a;P.drawingstate.initialmatrix.b=P.drawingstate.matrix.b;P.drawingstate.initialmatrix.c=P.drawingstate.matrix.c;P.drawingstate.initialmatrix.d=P.drawingstate.matrix.d;P.drawingstate.initialmatrix.tx=P.drawingstate.matrix.tx;P.drawingstate.initialmatrix.ty=P.drawingstate.matrix.ty;P.drawingstate.initialmatrix.det=P.drawingstate.matrix.det;P.drawingstate.initialmatrix.sdet=P.drawingstate.matrix.sdet;P.clone=function(a){if(null===
a||"object"!==typeof a)return a;var b=a.constructor(),c;for(c in a)b[c]=P.clone(a[c]);return b};bd.backup=P.clone(P.drawingstate);bd.stack=[];P.clone(P.drawingstate);P.reset=function(){P.drawingstate.matrix.a=P.drawingstate.initialmatrix.a;P.drawingstate.matrix.b=P.drawingstate.initialmatrix.b;P.drawingstate.matrix.c=P.drawingstate.initialmatrix.c;P.drawingstate.matrix.d=P.drawingstate.initialmatrix.d;P.drawingstate.matrix.tx=P.drawingstate.initialmatrix.tx;P.drawingstate.matrix.ty=P.drawingstate.initialmatrix.ty;
P.drawingstate.matrix.det=P.drawingstate.initialmatrix.det;P.drawingstate.matrix.sdet=P.drawingstate.initialmatrix.sdet};P.from=function(a,b,c){a/=c;b/=c;c=P.drawingstate.matrix;return[(a*c.a-b*c.b+c.tx)/yb,(a*c.c-b*c.d-c.ty)/yb]};P.to=function(a,b){var c=P.drawingstate.matrix;a=a*yb-c.tx;b=b*yb+c.ty;return[(a*c.d-b*c.b)/c.det,-(-a*c.c+b*c.a)/c.det,1]};P.toMat=function(){var a=P.drawingstate.matrix;return h.realMatrix([[a.d,-a.b,-a.tx*a.d-a.ty*a.b],[a.c,-a.a,-a.tx*a.c-a.ty*a.a],[0,0,a.det]])};P.dumpTrafo=
function(){function a(c){return Math.round(1E3*c)/1E3}var b=P.drawingstate.matrix;console.log("a:"+a(b.a)+" b:"+a(b.b)+" c:"+a(b.c)+" d:"+a(b.d)+" tx:"+a(b.ty)+" ty:"+a(b.tx))};P.setMat=function(a,b,c,d,f,k){var m=P.drawingstate.matrix;m.a=a;m.b=b;m.c=c;m.d=d;m.tx=f;m.ty=k;m.det=a*d-b*c;m.sdet=Math.sqrt(m.det)};P.scaleAndOrigin=function(a,b,c){P.setMat(a,0,0,a,b,c)};P.visibleRect=function(a,b,c,d){var f=c-a,k=b-d;f=pb*k<rb*f?pb/f:rb/k;P.setMat(f,0,0,f,(pb-f*(a+c))/2,(rb-f*(b+d))/2)};P.applyMat=function(a,
b,c,d,f,k){var m=P.drawingstate.matrix;P.setMat(m.a*a+m.c*b,m.b*a+m.d*b,m.a*c+m.c*d,m.b*c+m.d*d,m.a*f+m.c*k+m.tx,m.b*f+m.d*k+m.ty)};P.translate=function(a,b){P.applyMat(1,0,0,1,a,b)};P.rotate=function(a){var b=Math.cos(a);a=Math.sin(a);P.applyMat(b,a,-a,b,0,0)};P.scale=function(a){P.applyMat(a,0,0,a,0,0)};P.gsave=function(){bd.stack.push(P.clone(P.drawingstate))};P.grestore=function(){0!==bd.stack.length&&(P.drawingstate=bd.stack.pop())};P.greset=function(){P.drawingstate=P.clone(bd.backup);P.drawingstate.matrix.ty-=
rb;P.drawingstate.initialmatrix.ty-=rb;bd.stack=[]};P.createnewbackup=function(){P.drawingstate.initialmatrix.a=P.drawingstate.matrix.a;P.drawingstate.initialmatrix.b=P.drawingstate.matrix.b;P.drawingstate.initialmatrix.c=P.drawingstate.matrix.c;P.drawingstate.initialmatrix.d=P.drawingstate.matrix.d;P.drawingstate.initialmatrix.tx=P.drawingstate.matrix.tx;P.drawingstate.initialmatrix.ty=P.drawingstate.matrix.ty;P.drawingstate.initialmatrix.det=P.drawingstate.matrix.det;P.drawingstate.initialmatrix.sdet=
P.drawingstate.matrix.sdet;bd.backup=P.clone(P.drawingstate)};P.makecolor=function(a,b,c){a=Math.floor(255*a);b=Math.floor(255*b);c=Math.floor(255*c);return 1===P.drawingstate.alpha?"rgb("+a+","+b+","+c+")":"rgba("+a+","+b+","+c+","+P.drawingstate.alpha+")"};P.setcolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;P.drawingstate.linecolor=P.drawingstate.pointcolor=P.makecolor(b,c,a);P.drawingstate.linecolorraw=P.drawingstate.pointcolorraw=[b,c,a]};P.setlinecolor=
function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;P.drawingstate.linecolor=P.makecolor(b,c,a);P.drawingstate.linecolorraw=[b,c,a]};P.settextcolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;P.drawingstate.textcolor=P.makecolor(b,c,a);P.drawingstate.textcolorraw=[b,c,a]};P.settextoutlinecolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;P.drawingstate.textoutlinecolor=P.makecolor(b,
c,a);P.drawingstate.textoutlinecolorraw=[b,c,a]};P.setpointcolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;P.drawingstate.pointcolor=P.makecolor(b,c,a);P.drawingstate.pointcolorraw=[b,c,a]};P.setalpha=function(a){P.drawingstate.alpha=a.value.real;P.drawingstate.linecolor=P.makecolor(P.drawingstate.linecolorraw[0],P.drawingstate.linecolorraw[1],P.drawingstate.linecolorraw[2]);P.drawingstate.pointcolor=P.makecolor(P.drawingstate.pointcolorraw[0],P.drawingstate.pointcolorraw[1],
P.drawingstate.pointcolorraw[2]);P.drawingstate.textcolor=P.makecolor(P.drawingstate.textcolorraw[0],P.drawingstate.textcolorraw[1],P.drawingstate.textcolorraw[2]);P.drawingstate.textoutlinecolor=P.makecolor(P.drawingstate.textoutlinecolorraw[0],P.drawingstate.textoutlinecolorraw[1],P.drawingstate.textoutlinecolorraw[2])};P.setpointsize=function(a){P.drawingstate.pointsize=a.value.real};P.setlinesize=function(a){P.drawingstate.linesize=a.value.real};P.settextsize=function(a){P.drawingstate.textsize=
a.value.real};P.settextoutlinewidth=function(a){P.drawingstate.textoutlinewidth=a.value.real};var zb={clip:"none",pointColor:[1,0,0],lineColor:[0,0,1],pointSize:5,lineSize:1,alpha:1,overhangLine:1,overhangSeg:1,dimDependent:.7,fontFamily:"sans-serif",textColor:[0,0,0],textsize:20,noborder:!1,lineHeight:1.45};Z.defaultAppearance&&qf(Z.defaultAppearance);var of={},If={UL:0,UR:1,LR:2,LL:3},Ef=["in","out","good","backup","prover"],td=new Float64Array(0),Uc={};Ef.forEach(function(a){Uc[a]=td});var Nb=
td,Kc=td,sc=td,mc,tc,sd,zc,je,Ff=!1,Jf={toString:function(){return"RefineException"}},Kf=null,wa=null;Z.enableTraceLog&&(wa={logLength:Infinity,fullLog:[],currentMouseAndScripts:null,currentMover:null,currentStep:null,currentElement:null,currentParam:null,labelTracing2:p.wrap("tracing2"),labelTracing4:p.wrap("tracing4"),labelTracingSesq:p.wrap("tracingSesq"),postMouseHooks:[]},"number"===typeof Z.enableTraceLog&&(wa.logLength=Z.enableTraceLog),Vb.getTraceLog=vf,Vb.formatTraceLog=wf,Vb.addTraceHook=
wa.postMouseHooks.push.bind(wa.postMouseHooks));pc.stateSize=12;Ae.stateSize=24;jd.stateSize=24;var Yb=[];sb._helper={};sb._helper.duplicatePPLL=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return{P:"point",L:"line"}[a.kind]+" "+a.name+" is duplicate of "+b.name},apply:kd(a,b),holds:function(){return h.projectiveDistMinScal(a.homog,b.homog)<n.epsbig}}};sb._helper.duplicatePsLs=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return{Ps:"point set",
Ls:"line set"}[a.kind]+" "+a.name+" is duplicate of "+b.name},apply:kd(a,b),holds:function(){return sb._helper.isSetEq(a.results.value,b.results.value,h.projectiveDistMinScal)}}};sb._helper.duplicateCC=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Conic "+a.name+" is duplicate of "+b.name},apply:kd(a,b),holds:function(){return h.conicDist(a.matrix,b.matrix)<n.epsbig}}};sb._helper.duplicateCs=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Conic set"+
a.name+" is duplicate of "+b.name},apply:kd(a,b),holds:function(){return sb._helper.isSetEq(a.results,b.results,h.conicDist)}}};sb._helper.duplicateSS=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Segment "+a.name+" is duplicate of "+b.name},apply:kd(a,b),holds:function(){var c=a.startpos,d=a.endpos,f=b.startpos,k=b.endpos,m=h.projectiveDistMinScal(c,f);m+=h.projectiveDistMinScal(d,k);d=h.projectiveDistMinScal(d,f);d+=h.projectiveDistMinScal(c,k);return Math.min(m,
d)<n.epsbig}}};sb.P=function(a){G.points.forEach(function(b){a.name!==b.name&&(b=sb._helper.duplicatePPLL(a,b),b.holds()&&Yb.push(b))})};sb.Ps=function(a){G.sets.points.forEach(function(b){a.name!==b.name&&(b=sb._helper.duplicatePsLs(a,b),b.holds()&&Yb.push(b))})};sb.Ls=function(a){G.sets.lines.forEach(function(b){a.name!==b.name&&(b=sb._helper.duplicatePsLs(a,b),b.holds()&&Yb.push(b))})};sb.Cs=function(a){G.sets.conics.forEach(function(b){a.name!==b.name&&(b=sb._helper.duplicateCs(a,b),b.holds()&&
Yb.push(b))})};sb.L=function(a){G.lines.forEach(function(b){a.name!==b.name&&a.kind===b.kind&&(b=sb._helper.duplicatePPLL(a,b),b.holds()&&Yb.push(b))})};sb.S=function(a){G.lines.forEach(function(b){a.name!==b.name&&"S"===b.kind&&(b=sb._helper.duplicateSS(a,b),b.holds()&&Yb.push(b))})};sb.C=function(a){G.conics.forEach(function(b){a.name!==b.name&&(b=sb._helper.duplicateCC(a,b),b.holds()&&Yb.push(b))})};sb._helper.isSetEq=function(a,b,c){a=a.slice();b=b.slice();if(a.length!==b.length)return!1;if(0===
a.length&&0===b.length)return!0;var d=a.shift(),f=b.reduce(function(k,m,q,v){return c(m,d)<c(v[k],d)?q:k},0);return c(b[f],d)<n.epsbig?(b.splice(f,1),sb._helper.isSetEq(a,b,c)):!1};Gc.P=function(a){G.lines.forEach(function(b){b=ef(a,b);b.holds()&&Yb.push(b)});G.conics.forEach(function(b){b=ff(a,b);b.holds()&&Yb.push(b)})};Gc.L=function(a){G.points.forEach(function(b){b=ef(b,a);b.holds()&&Yb.push(b)})};Gc.S=Gc.L;Gc.C=function(a){G.points.forEach(function(b){b=ff(b,a);b.holds()&&Yb.push(b)})};var u=
{_helper:{},RandomLine:{}};u.RandomLine.kind="L";u.RandomLine.signature=[];u.RandomLine.updatePosition=function(a){a.homog=h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};u._helper.getRandMove=function(a){a=a.homog;var b=h.getRandComplexVec3(-.05,.05);return{type:"homog",value:h.add(a,b)}};u._helper.getRandPointMove=function(a){a=h.normalizeMax(a.homog);var b=a.value[2],c=n.abs(b).value.real,d=n.real(0);c<n.eps&&
(d=n.getRandComplex(-.05,.05),b=n.real(1));c=h.turnIntoCSList([n.getRandComplex(-.1,.1),n.getRandComplex(-.1,.1),d]);b=h.scalmult(b,c);b=h.add(a,b);return{type:"homog",value:b}};u.FreeLine={};u.FreeLine.kind="L";u.FreeLine.signature=[];u.FreeLine.isMovable=!0;u.FreeLine.initialize=function(a){a=u._helper.initializeLine(a);Ta(a)};u.FreeLine.getParamForInput=function(a,b,c){"mouse"===c?(a=h.cross(b,h.ez),a=h.cross(a,b)):a="homog"===c?b:h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(a)};
u.FreeLine.getParamFromState=function(a){return fb(3)};u.FreeLine.putParamToState=function(a,b){Ta(b)};u.FreeLine.updatePosition=function(a){var b=fb(3);Ta(b);a.homog=p.withUsage(b,"Line")};u.FreeLine.getRandomMove=u._helper.getRandMove;u.FreeLine.stateSize=6;u.RandomPoint={};u.RandomPoint.kind="P";u.RandomPoint.signature=[];u.RandomPoint.updatePosition=function(a){a.homog=h.realVector([100*Math.random(),100*Math.random(),100*Math.random()]);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,
"Point")};u.Join={};u.Join.kind="L";u.Join.signature=["P","P"];u.Join.updatePosition=function(a){a.homog=h.cross(G.csnames[a.args[0]].homog,G.csnames[a.args[1]].homog);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};u.Segment={};u.Segment.kind="S";u.Segment.signature=["P","P"];u.Segment.updatePosition=function(a){var b=G.csnames[a.args[0]],c=G.csnames[a.args[1]];u.Segment.setSegmentPos(a,h.cross(b.homog,c.homog),h.scalmult(c.homog.value[2],b.homog),h.scalmult(b.homog.value[2],
c.homog))};u.Segment.setSegmentPos=function(a,b,c,d){b=h.normalizeMax(b);a.homog=p.withUsage(b,"Line");b=h.turnIntoCSList([c,d]);b=h.normalizeMax(b);a.startpos=b.value[0];a.endpos=b.value[1];a.farpoint=h.sub(a.startpos,a.endpos);a.farpoint=h.sub(a.startpos,a.endpos)};u.Meet={};u.Meet.kind="P";u.Meet.signature=["L","L"];u.Meet.updatePosition=function(a){a.homog=h.cross(G.csnames[a.args[0]].homog,G.csnames[a.args[1]].homog);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Point")};u.Meet.visiblecheck=
function(a){var b=!0,c=G.csnames[a.args[0]],d=G.csnames[a.args[1]];"S"===c.kind&&(b=Ye(a,c));b&&"S"===d.kind&&(b=Ye(a,d));a.isshowing=b};u._helper.midpoint=function(a,b){return h.normalizeMax(h.add(h.scalmult(b.value[2],a),h.scalmult(a.value[2],b)))};u.Mid={};u.Mid.kind="P";u.Mid.signature=["P","P"];u.Mid.updatePosition=function(a){var b=u._helper.midpoint(G.csnames[a.args[0]].homog,G.csnames[a.args[1]].homog);a.homog=p.withUsage(b,"Point")};u.Perp={};u.Perp.kind="L";u.Perp.signature=["L","P"];u.Perp.updatePosition=
function(a){var b=G.csnames[a.args[0]].homog,c=G.csnames[a.args[1]].homog;b=h.turnIntoCSList([b.value[0],b.value[1],n.zero]);a.homog=h.cross(b,c);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};u.Para={};u.Para.kind="L";u.Para.signature=["L","P"];u.Para.updatePosition=function(a){var b=G.csnames[a.args[1]].homog;a.homog=h.cross(h.cross(h.linfty,G.csnames[a.args[0]].homog),b);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};u.Horizontal={};u.Horizontal.kind=
"L";u.Horizontal.signature=["P"];u.Horizontal.updatePosition=function(a){a.homog=h.cross(h.ex,G.csnames[a.args[0]].homog);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};u.HorizontalLine={};u.HorizontalLine.kind="L";u.HorizontalLine.signature=[];u.HorizontalLine.isMovable=!0;u.HorizontalLine.initialize=function(a){a=u._helper.initializeLine(a);a=h.turnIntoCSList([n.zero,a.value[1],a.value[2]]);a=h.normalizeMax(a);Ta(a)};u.HorizontalLine.getParamForInput=function(a,b,c){if("mouse"===
c)b=h.cross(b,h.ex);else if("homog"===c){if(0!==b.value[0].real||0!==b.value[0].imag)b=h.turnIntoCSList([n.zero,b.value[1],b.value[2]])}else b=h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(b)};u.HorizontalLine.getParamFromState=function(a){return fb(3)};u.HorizontalLine.putParamToState=function(a,b){Ta(b)};u.HorizontalLine.updatePosition=function(a){var b=fb(3);Ta(b);a.homog=p.withUsage(b,"Line")};u.HorizontalLine.getRandomMove=u._helper.getRandMove;u.HorizontalLine.stateSize=6;u.Vertical=
{};u.Vertical.kind="L";u.Vertical.signature=["P"];u.Vertical.updatePosition=function(a){a.homog=h.cross(h.ey,G.csnames[a.args[0]].homog);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};u.VerticalLine={};u.VerticalLine.kind="L";u.VerticalLine.signature=[];u.VerticalLine.isMovable=!0;u.VerticalLine.initialize=function(a){a=u._helper.initializeLine(a);a=h.turnIntoCSList([a.value[0],n.zero,a.value[2]]);a=h.normalizeMax(a);Ta(a)};u.VerticalLine.getParamForInput=function(a,b,c){if("mouse"===
c)b=h.cross(b,h.ey);else if("homog"===c){if(0!==b.value[1].real||0!==b.value[1].imag)b=h.turnIntoCSList([b.value[0],n.zero,b.value[2]])}else b=h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(b)};u.VerticalLine.getParamFromState=function(a){return fb(3)};u.VerticalLine.putParamToState=function(a,b){Ta(b)};u.VerticalLine.updatePosition=function(a){var b=fb(3);Ta(b);a.homog=p.withUsage(b,"Line")};u.VerticalLine.getRandomMove=u._helper.getRandMove;u.VerticalLine.stateSize=6;u.LineByFixedAngle=
{};u.LineByFixedAngle.kind="L";u.LineByFixedAngle.signature=["L","P"];u.LineByFixedAngle.initialize=function(a){var b=n._helper.input(a.angle),c=n.cos(b);b=n.sin(b);a.rot=h.turnIntoCSList([h.turnIntoCSList([b,c,n.zero]),h.turnIntoCSList([n.neg(c),b,n.zero]),h.turnIntoCSList([n.zero,n.zero,n.zero])])};u.LineByFixedAngle.updatePosition=function(a){var b=G.csnames[a.args[1]],c=h.productMV(a.rot,G.csnames[a.args[0]].homog);a.homog=h.cross(b.homog,c);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,
"Line")};u.Through={};u.Through.kind="L";u.Through.signature=["P"];u.Through.isMovable=!0;u.Through.initialize=function(a){a=a.dir?p.wrap(a.dir):h.realVector([a.pos[1],-a.pos[0],0]);Ta(a)};u.Through.getParamForInput=function(a,b,c){a="dir"===c||"mouse"===c?h.cross(G.csnames[a.args[0]].homog,b):"homog"===c?b:h.turnIntoCSList([n.zero,n.zero,n.zero]);a=h.cross(h.linfty,a);return h.normalizeMax(a)};u.Through.getParamFromState=function(a){return fb(3)};u.Through.putParamToState=function(a,b){Ta(b)};u.Through.updatePosition=
function(a){var b=fb(3);Ta(b);b=h.cross(G.csnames[a.args[0]].homog,b);b=h.normalizeMax(b);a.homog=p.withUsage(b,"Line")};u.Through.getRandomMove=u._helper.getRandMove;u.Through.stateSize=6;u.Through.set_angle=function(a,b){if("number"===b.ctype){var c=n.cos(b);b=n.sin(b);c=h.turnIntoCSList([c,b,n.real(0)]);Zb(a,c,"dir")}};u.Through.set_slope=function(a,b){"number"===b.ctype&&(b=h.turnIntoCSList([n.real(1),b,n.real(0)]),Zb(a,b,"dir"))};u.Free={};u.Free.kind="P";u.Free.signature=[];u.Free.isMovable=
!0;u.Free.initialize=function(a){a=u._helper.initializePoint(a);Ta(a)};u.Free.getParamForInput=function(a,b,c){if("mouse"===c&&ad&&0!==$b){b=h.normalizeZ(b);a=b.value[0].value.real;c=b.value[1].value.real;var d=Math.round(a/$b)*$b,f=Math.round(c/$b)*$b;Math.abs(d-a)<pd&&Math.abs(f-c)<pd&&(b=h.realVector([d,f,1]))}return h.normalizeMax(b)};u.Free.getParamFromState=function(a){return fb(3)};u.Free.putParamToState=function(a,b){Ta(b)};u.Free.updatePosition=function(a){var b=fb(3);Ta(b);a.homog=p.withUsage(b,
"Point")};u.Free.getRandomMove=u._helper.getRandPointMove;u.Free.stateSize=6;u._helper.projectPointToLine=function(a,b){var c=h.turnIntoCSList([b.value[0],b.value[1],n.zero]);a=h.cross(c,a);return h.normalizeMax(h.cross(a,b))};u.PointOnLine={};u.PointOnLine.kind="P";u.PointOnLine.signature=["L"];u.PointOnLine.isMovable=!0;u.PointOnLine.initialize=function(a){var b=u._helper.initializePoint(a);a=G.csnames[a.args[0]].homog;b=u._helper.projectPointToLine(b,a);b=h.normalizeMax(b);var c=h.cross(h.linfty,
b);h.normalizeMax(c);Ta(b);Ta(a);sd=!1};u.PointOnLine.updatePosition=function(a,b){var c=G.csnames[a.args[0]].homog;var d=fb(3);fb(3);if(!b){mc=a.stateIdx;var f=Nb;Nb=sc;b=fb(3);var k=fb(3);Nb=f;f=h.cross(k,c);h._helper.isAlmostZero(f)&&(f=h.cross(h.linfty,c));b=u._helper.CircleMP(f,b);b=u._helper.IntersectLC(c,b);f=u._helper.pointReflection(f,d);d=ze(b[0],b[1],d,f)[0]}d=h.normalizeMax(d);Ta(d);Ta(c);a.homog=p.withUsage(d,"Point")};u.PointOnLine.getParamForInput=function(a,b,c){a=G.csnames[a.args[0]].homog;
b=u._helper.projectPointToLine(b,a);"mouse"===c&&ad&&0!==$b&&(b=u._helper.snapPointToLine(b,a));return b};u.PointOnLine.getParamFromState=function(a){return fb(3)};u.PointOnLine.putParamToState=function(a,b){return Ta(b)};u.PointOnLine.getRandomMove=u._helper.getRandPointMove;u.PointOnLine.stateSize=12;u.PointOnCircle={};u.PointOnCircle.kind="P";u.PointOnCircle.signature=["C"];u.PointOnCircle.isMovable=!0;u.PointOnCircle.initialize=function(a){var b=G.csnames[a.args[0]];a=h.normalizeZ(u._helper.initializePoint(a));
var c=h.normalizeZ(u._helper.CenterOfCircle(b.matrix)),d=h.sub(a,c);d=h.turnIntoCSList([d.value[1],n.neg(d.value[0]),n.zero]);c=h.cross(a,c);b=u._helper.IntersectLC(c,b.matrix);c=h.projectiveDistMinScal(a,b[0]);h.projectiveDistMinScal(a,b[1])<c?(a=b[1],b=b[0]):(a=b[0],b=b[1]);Ta(d);Ta(a);Ta(b);sd=!1};u.PointOnCircle.putParamToState=function(a,b){Ta(b)};u.PointOnCircle.getParamFromState=function(a){return fb(3)};u.PointOnCircle.getParamForInput=function(a,b,c){c=h.normalizeZ(u._helper.CenterOfCircle(G.csnames[a.args[0]].matrix));
b=h.sub(b,c);mc=a.stateIdx;a=fb(3);var d=h.normalizeZ(fb(3));c=h.sub(d,c);0>n.sub(n.mult(a.value[0],c.value[1]),n.mult(a.value[1],c.value[0])).value.real&&(b=h.neg(b));return h.turnIntoCSList([b.value[1],n.neg(b.value[0]),n.zero])};u.PointOnCircle.parameterPath=function(a,b,c,d,f){d=h.normalizeAbs(d);f=h.normalizeAbs(f);var k=h.scalproduct(d,f);if(0<=k.value.real)return xe(a,b,c,d,f);a=h.turnIntoCSList([n.sub(d.value[1],f.value[1]),n.sub(f.value[0],d.value[0]),n.zero]);k=h.scalproduct(d,a);0>k.value.real&&
(a=h.neg(a));0>b?(b=2*b+1,c=b*b,k=.25/(1+c),c=n.complex(2*b*k+.25,(1-c)*k)):(b=2*b-1,c=b*b,k=.25/(1+c),c=n.complex(2*b*k+.75,(1-c)*k));var m=n.sub(n.real(1),c);b=n.mult(c,c);k=n.mult(m,m);c=n.mult(c,m);d=h.scalmult(k,d);d=h.add(d,h.scalmult(c,a));return d=h.add(d,h.scalmult(b,f))};u.PointOnCircle.updatePosition=function(a){var b=fb(3);Ta(b);var c=G.csnames[a.args[0]];b=h.productMV(c.matrix,b);c=u._helper.IntersectLC(b,c.matrix);c=pc(c[0],c[1]);b=h.normalizeMax(c.value[0]);a.homog=p.withUsage(b,"Point");
a.antipodalPoint=c.value[1]};u.PointOnCircle.getRandomMove=u._helper.getRandPointMove;u.PointOnCircle.stateSize=6+pc.stateSize;u.PointOnCircle.get_angle=function(a){var b=u._helper.CenterOfCircle(G.csnames[a.args[0]].matrix),c=h._helper.isAlmostFarpoint;if(c(a.homog)||c(b))return A;a=h.normalizeZ(a.homog);b=h.normalizeZ(b);b=h.sub(a,b);b=n.arctan2(b.value[0],b.value[1]);a=n.real(ee);b=n.mod(n.add(b,a),a);return p.withUsage(b,"Angle")};u.PointOnCircle.set_angle=function(a,b){if("number"===b.ctype){var c=
G.csnames[a.args[0]],d=u._helper.CenterOfCircle(c.matrix);if(!h._helper.isAlmostFarpoint(d)){d=h.normalizeZ(d);var f=n.cos(b);b=n.sin(b);var k=c.matrix;c=k.value[0].value[0];var m=k.value[0].value[2],q=k.value[1].value[2];k=k.value[2].value[2];n.mult(c,c);m=n.div(m,c);q=n.div(q,c);c=n.div(k,c);c=n.sqrt(n.sub(n.add(n.mult(m,m),n.mult(q,q)),c));f=h.turnIntoCSList([n.mult(f,c),n.mult(b,c),n.real(0)]);Zb(a,h.add(d,f),"homog")}}return A};u.OtherPointOnCircle={};u.OtherPointOnCircle.kind="P";u.OtherPointOnCircle.signature=
["P"];u.OtherPointOnCircle.signatureConstraints=function(a){return"PointOnCircle"===G.csnames[a.args[0]].type};u.OtherPointOnCircle.updatePosition=function(a){var b=G.csnames[a.args[0]].antipodalPoint;b=h.normalizeMax(b);a.homog=p.withUsage(b,"Point")};u.OtherPointOnCircle.get_angle=function(a){a=G.csnames[a.args[0]];var b=n.real(Math.PI);a=n.sub(u.PointOnCircle.get_angle(a),b);b=n.real(ee);a=n.mod(n.add(a,b),b);return p.withUsage(a,"Angle")};u.PointOnSegment={};u.PointOnSegment.kind="P";u.PointOnSegment.signature=
["S"];u.PointOnSegment.isMovable=!0;u.PointOnSegment.initialize=function(a){var b=u._helper.initializePoint(a);a=u.PointOnSegment.getParamForInput(a,b);Fc(a)};u.PointOnSegment.getParamForInput=function(a,b,c){a=G.csnames[a.args[0]];var d=a.homog;"mouse"===c&&ad&&0!==$b&&(b=u._helper.snapPointToLine(b,d));c=h.turnIntoCSList([d.value[0],d.value[1],n.zero]);d=h.sub(a.startpos,a.endpos);b=h.crossratio3(d,a.startpos,a.endpos,b,c);0>b.value.real&&(b=n.complex(0,b.value.imag));1<b.value.real&&(b=n.complex(1,
b.value.imag));return b};u.PointOnSegment.getParamFromState=function(a){return id()};u.PointOnSegment.putParamToState=function(a,b){Fc(b)};u.PointOnSegment.updatePosition=function(a){var b=id();Fc(b);var c=G.csnames[a.args[0]],d=c.startpos;c=h.sub(c.endpos,d);b=h.add(d,h.scalmult(b,c));b=h.normalizeMax(b);a.homog=p.withUsage(b,"Point")};u.PointOnSegment.getRandomMove=u._helper.getRandPointMove;u.PointOnSegment.stateSize=2;u._helper.projectPointToCircle=function(a,b){var c=u._helper.CenterOfCircle(a.matrix);
c=h.normalizeMax(c);c=h.normalizeMax(h.cross(b,c));a=u._helper.IntersectLC(c,a.matrix);c=h.projectiveDistMinScal(b,a[0]);b=h.projectiveDistMinScal(b,a[1]);return c<b?a[0]:a[1]};u.PointOnArc={};u.PointOnArc.kind="P";u.PointOnArc.signature=["C"];u.PointOnArc.signatureConstraints=function(a){return G.csnames[a.args[0]].isArc};u.PointOnArc.isMovable=!0;u.PointOnArc.initialize=function(a){var b=u._helper.initializePoint(a);a=u.PointOnArc.getParamForInput(a,b);Ta(a)};u.PointOnArc.getParamForInput=function(a,
b){a=G.csnames[a.args[0]];b=u._helper.projectPointToCircle(a,b);b=h.normalizeMax(h.crossratio3harm(a.startPoint,a.endPoint,a.viaPoint,b,h.ii));a=n.div(b.value[0],b.value[1]);0>a.value.real&&(b=-1>a.value.real?h.realVector([1,0]):h.realVector([0,1]));return b};u.PointOnArc.getParamFromState=function(a){return fb(2)};u.PointOnArc.putParamToState=function(a,b){Ta(b)};u.PointOnArc.updatePosition=function(a){var b=G.csnames[a.args[0]],c=b.startPoint,d=b.viaPoint,f=b.endPoint,k=h.ii,m=h.cross(c,k);d=h.cross(d,
k);var q=h.cross(f,k);q=h.turnIntoCSList([m,q]);m=h.transpose(q);q=h.conjugate(q);m=h.productMM(q,m);d=h.productMV(q,d);m=h.productMV(h.adjoint2(m),d);d=m.value[0];m=m.value[1];q=fb(2);Ta(q);c=h.normalizeMax(h.add(h.scalmult(n.mult(d,q.value[0]),c),h.scalmult(n.mult(m,q.value[1]),f)));b=u._helper.conicOtherIntersection(b.matrix,k,c);a.homog=p.withUsage(b,"Point")};u.PointOnArc.getRandomMove=u._helper.getRandPointMove;u.PointOnArc.stateSize=4;u._helper.CenterOfCircle=function(a){return h.turnIntoCSList([a.value[2].value[0],
a.value[2].value[1],n.neg(a.value[0].value[0])])};u._helper.CenterOfConic=function(a){a=h.adjoint3(a);return{ctype:"list",value:[a.value[2].value[0],a.value[2].value[1],a.value[2].value[2]]}};u.CenterOfConic={};u.CenterOfConic.kind="P";u.CenterOfConic.signature=["C"];u.CenterOfConic.updatePosition=function(a){var b=u._helper.CenterOfConic(G.csnames[a.args[0]].matrix);a.homog=b;a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Point")};u._helper.CircleMP=function(a,b){var c=a.value[0],d=
a.value[1];a=n.neg(a.value[2]);var f=n.zero;c=h.turnIntoCSList([h.turnIntoCSList([a,f,c]),h.turnIntoCSList([f,a,d]),h.turnIntoCSList([c,d,f])]);d=p.mult(p.mult(b,c),b);b=p.mult(p.mult(b,h.fund),b);d=p.mult(d,h.fund);b=p.mult(b,c);return h.sub(d,b)};u.CircleMP={};u.CircleMP.kind="C";u.CircleMP.signature=["P","P"];u.CircleMP.updatePosition=function(a){a.matrix=u._helper.CircleMP(G.csnames[a.args[0]].homog,G.csnames[a.args[1]].homog);a.matrix=h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Circle")};
u.CircleMr={};u.CircleMr.kind="C";u.CircleMr.signature=["P"];u.CircleMr.isMovable=!0;u.CircleMr.initialize=function(a){Fc(n.real(a.radius))};u.CircleMr.getParamForInput=function(a,b,c){if("radius"===c)return b;a=G.csnames[a.args[0]].homog;a=h.normalizeZ(a);b=h.normalizeZ(b);b=h.sub(a,b);return b=h.abs(b)};u.CircleMr.getParamFromState=function(a){return id()};u.CircleMr.putParamToState=function(a,b){Fc(b)};u.CircleMr.updatePosition=function(a){var b=id();Fc(b);var c=G.csnames[a.args[0]].homog,d=n.mult(c.value[2],
b);d=n.mult(d,d);if(!n._helper.isFinite(d)&&!n._helper.isNaN(d))return h.fund;c=u._helper.ScaledCircleMrr(c,d);a.matrix=p.withUsage(c,"Circle");a.radius=b};u.CircleMr.getRandomMove=function(a){a=a.radius;return{type:"radius",value:n.abs(a).value.real<n.eps?n.getRandComplex(.05,.1):n.mult(a,n.getRandReal(.95,1.05))}};u.CircleMr.stateSize=2;u.CircleMr.set_radius=function(a,b){"number"===b.ctype&&Zb(a,b,"radius")};u._helper.ScaledCircleMrr=function(a,b){var c=a.value[0],d=a.value[1];a=n.neg(a.value[2]);
a=h.scalmult(a,h.turnIntoCSList([c,d,a])).value;c=h.turnIntoCSList([c,d]);b=n.sub(h.scalproduct(c,c),b);b=u._helper.buildConicMatrix([a[2],n.zero,a[2],a[0],a[1],b]);return h.normalizeMax(b)};u.Compass={};u.Compass.kind="C";u.Compass.signature=["P","P","P"];u.Compass.updatePosition=function(a){var b=G.csnames[a.args[0]].homog,c=G.csnames[a.args[1]].homog,d=G.csnames[a.args[2]].homog,f=b.value[2],k=c.value[2],m=d.value[2];b=h.scalmult(n.mult(k,m),b);c=h.scalmult(n.mult(f,m),c);d=h.scalmult(n.mult(f,
k),d);b=h.sub(c,b);d=u._helper.ScaledCircleMrr(d,h.scalproduct(b,b));a.matrix=p.withUsage(d,"Circle")};u._helper.getConicType=function(a){if(1E-16>n.abs(h.det(a)).value.real)return"degenerate";var b=n.mult(a.value[0].value[0],a.value[1].value[1]);b=n.sub(b,n.pow(a.value[0].value[1],n.real(2)));b=b.value.real;return 1E-16>Math.abs(b)?"parabola":1E-16<b?"ellipsoid":"hyperbola"};u._helper.ConicBy5=function(a,b,c,d,f,k){a=h.turnIntoCSList([h.cross(c,d)]);var m=h.turnIntoCSList([h.cross(b,f)]);b=h.turnIntoCSList([h.cross(b,
c)]);d=h.turnIntoCSList([h.cross(d,f)]);return u._helper.conicFromTwoDegenerates(a,m,b,d,k)};u._helper.conicFromTwoDegenerates=function(a,b,c,d,f){a=p.mult(h.transpose(b),a);c=p.mult(h.transpose(d),c);a=h.add(a,h.transpose(a));c=h.add(c,h.transpose(c));d=p.mult(p.mult(f,a),f);f=p.mult(p.mult(f,c),f);c=p.mult(d,c);f=p.mult(f,a);return h.sub(c,f)};u.ConicBy5={};u.ConicBy5.kind="C";u.ConicBy5.signature=["P","P","P","P","P"];u.ConicBy5.updatePosition=function(a){var b=u._helper.ConicBy5(a,G.csnames[a.args[0]].homog,
G.csnames[a.args[1]].homog,G.csnames[a.args[2]].homog,G.csnames[a.args[3]].homog,G.csnames[a.args[4]].homog);a.matrix=b;a.matrix=h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Conic")};u.FreeConic={};u.FreeConic.kind="C";u.FreeConic.signature=[];u.FreeConic.initialize=function(a){var b=a.pos?u._helper.inputConic(a.pos):h.zeromatrix(n.real(3),n.real(3));u.FreeConic.putParamToState(a,b)};u.FreeConic.getParamForInput=function(a,b,c){return h.normalizeMax(b)};u.FreeConic.getParamFromState=function(a){return u._helper.buildConicMatrix(fb(6).value)};
u.FreeConic.putParamToState=function(a,b){for(a=0;3>a;++a)for(var c=0;c<=a;++c)Fc(b.value[a].value[c])};u.FreeConic.updatePosition=function(a){var b=fb(6);Ta(b);a.matrix=u._helper.buildConicMatrix(b.value);a.matrix=h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Conic")};u.FreeConic.set_matrix=function(a,b){h._helper.isNumberMatrixMN(b,3,3)&&Zb(a,h.add(b,h.transpose(b)),"matrix")};u.FreeConic.stateSize=12;u._helper.buildConicMatrix=function(a){var b=a[1],c=a[2],d=a[3],f=a[4],k=a[5];return h.turnIntoCSList([h.turnIntoCSList([a[0],
b,d]),h.turnIntoCSList([b,c,f]),h.turnIntoCSList([d,f,k])])};u._helper.flattenConicMatrix=function(a){return h.turnIntoCSList([a.value[0].value[0],a.value[0].value[1],a.value[1].value[1],a.value[0].value[2],a.value[1].value[2],a.value[2].value[2]])};u._helper.splitDegenConic=function(a){var b=h.adjoint3(a),c=0,d,f=n.abs2(b.value[0].value[0]).value.real;for(d=1;3>d;d++){var k=n.abs2(b.value[d].value[d]).value.real;k>f&&(c=d,f=k)}d=n.sqrt(n.mult(n.real(-1),b.value[c].value[c]));if(1E-16>n.abs2(d).value.real)return a=
h.turnIntoCSList([n.zero,n.zero,n.zero]),[a,a];c=n.real(c+1);k=h.column(b,c);k=h.scaldiv(d,k);d=k.value[0];f=k.value[1];k=k.value[2];d=h.turnIntoCSList([h.turnIntoCSList([n.real(0),k,n.mult(n.real(-1),f)]),h.turnIntoCSList([n.mult(n.real(-1),k),n.real(0),d]),h.turnIntoCSList([f,n.mult(n.real(-1),d),n.real(0)])]);a=h.add(a,d);var m=0;for(d=f=b=0;3>d;d++)for(c=0;3>c;c++)k=n.abs2(a.value[d].value[c]).value.real,k>f&&(m=d,b=c,f=k);d=a.value[m];a=h.transpose(a);a=a.value[b];d=h.normalizeMax(d);a=h.normalizeMax(a);
d=p.withUsage(d,"Line");a=p.withUsage(a,"Line");return[d,a]};u._helper.inputConic=function(a){var b="xx xy yy xz yz zz".split(" ").map(function(c){var d=n._helper.input(a[c]);c[0]!==c[1]&&(d=n.realmult(.5,d));return d});return u._helper.buildConicMatrix(b)};u.SelectConic={};u.SelectConic.kind="C";u.SelectConic.signature=["Cs"];u.SelectConic.initialize=function(a){if(void 0!==a.index)return a.index-1;var b=u._helper.inputConic(a.pos);a=G.csnames[a.args[0]].results;for(var c=h.conicDist(b,a[0]),d=0,
f=1;f<a.length;++f){var k=h.conicDist(b,a[f]);k<c&&(c=k,d=f)}return d};u.SelectConic.updatePosition=function(a){a.matrix=G.csnames[a.args[0]].results[a.param];a.matrix=h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Conic")};u._helper.ConicBy4p1l=function(a,b,c,d,f,k){var m=h.scalproduct(b,k),q=h.scalproduct(c,k),v=h.scalproduct(d,k),w=h.scalproduct(f,k),x=h.det3(c,d,f),B=h.det3(b,c,f),E=h.det3(b,d,f),J=h.det3(b,c,d),W=n.mult;q=n.sqrt(W(W(q,w),W(x,B)));m=n.sqrt(W(W(m,v),W(E,J)));v=h.cross(h.cross(b,
d),k);k=h.cross(h.cross(c,f),k);v=h.scalmult(q,v);m=h.scalmult(m,k);k=h.normalizeMax(h.add(v,m));m=h.normalizeMax(h.sub(v,m));m=pc(k,m);k=u._helper.ConicBy5(a,b,c,d,f,m.value[0]);a=u._helper.ConicBy5(a,b,c,d,f,m.value[1]);return[h.normalizeMax(k),h.normalizeMax(a)]};u.ConicBy4p1l={};u.ConicBy4p1l.kind="Cs";u.ConicBy4p1l.signature=["P","P","P","P","L"];u.ConicBy4p1l.updatePosition=function(a){var b=u._helper.ConicBy4p1l(a,G.csnames[a.args[0]].homog,G.csnames[a.args[1]].homog,G.csnames[a.args[2]].homog,
G.csnames[a.args[3]].homog,G.csnames[a.args[4]].homog);a.results=b};u.ConicBy4p1l.stateSize=pc.stateSize;u._helper.ConicBy3p2l=function(a,b,c,d,f){function k(Ca,Na,ua,Ha){return n.sub(n.mult(Ca,Ha),n.mult(Na,ua))}var m=h.cross(a,b),q=h.cross(d,f);d=h.cross(d,m);f=h.cross(f,m);m=h.turnIntoCSList([d,f,q]);c=h.productVM(c,h.adjoint3(m));q=h.adjoint3(h.turnIntoCSList([h.scalmult(c.value[0],d),h.scalmult(c.value[1],f),h.scalmult(c.value[2],q)]));c=h.transpose(q);d=n.mult;f=h.productMV(c,a);a=f.value[0];
f=f.value[1];m=h.productMV(c,b);b=m.value[0];m=m.value[1];var v=n.sqrt(d(a,f)),w=n.sqrt(d(b,m)),x,B=Array(4);for(x=0;4>x;++x){var E=(x&2)-1,J=d(n.real(((x&1)<<1)-1),v),W=d(n.real(E),w),R=k(f,J,m,W),ea=k(b,W,a,J);E=k(a,f,b,m);var X=n.add(n.add(k(b,m,a,f),k(m,W,f,J)),k(W,b,J,a));J=d(R,R);W=d(ea,ea);var oa=d(X,X),ja=d(R,ea);R=d(R,X);ea=d(ea,X);ja=n.sub(ja,d(n.real(.5),d(E,E)));E=h.turnIntoCSList([h.turnIntoCSList([J,ja,R]),h.turnIntoCSList([ja,W,ea]),h.turnIntoCSList([R,ea,oa])]);E=h.productMM(q,h.productMM(E,
c));E=h.turnIntoCSList([E.value[0].value[0],E.value[0].value[1],E.value[0].value[2],E.value[1].value[1],E.value[1].value[2],E.value[2].value[2]]);B[x]=E}return B};u.ConicBy3p2l={};u.ConicBy3p2l.kind="Cs";u.ConicBy3p2l.signature=["P","P","P","L","L"];u.ConicBy3p2l.updatePosition=function(a){var b=u._helper.ConicBy3p2l(G.csnames[a.args[0]].homog,G.csnames[a.args[1]].homog,G.csnames[a.args[2]].homog,G.csnames[a.args[3]].homog,G.csnames[a.args[4]].homog);b=cf(b);for(var c=Array(4),d=0;4>d;++d){var f=
b[d].value;c[d]=h.turnIntoCSList([h.turnIntoCSList([f[0],f[1],f[2]]),h.turnIntoCSList([f[1],f[3],f[4]]),h.turnIntoCSList([f[2],f[4],f[5]])])}a.results=c};u.ConicBy3p2l.stateSize=48;u.ConicBy2p3l={};u.ConicBy2p3l.kind="Cs";u.ConicBy2p3l.signature=["P","P","L","L","L"];u.ConicBy2p3l.updatePosition=function(a){var b=u._helper.ConicBy3p2l(G.csnames[a.args[2]].homog,G.csnames[a.args[3]].homog,G.csnames[a.args[4]].homog,G.csnames[a.args[0]].homog,G.csnames[a.args[1]].homog);b=cf(b);for(var c=Array(4),d=
0;4>d;++d){var f=b[d].value;f=h.turnIntoCSList([h.turnIntoCSList([f[0],f[1],f[2]]),h.turnIntoCSList([f[1],f[3],f[4]]),h.turnIntoCSList([f[2],f[4],f[5]])]);c[d]=h.normalizeMax(h.adjoint3(f))}a.results=c};u.ConicBy2p3l.stateSize=48;u.ConicBy1p4l={};u.ConicBy1p4l.kind="Cs";u.ConicBy1p4l.signature=["P","L","L","L","L"];u.ConicBy1p4l.updatePosition=function(a){var b=u._helper.ConicBy4p1l(a,G.csnames[a.args[1]].homog,G.csnames[a.args[2]].homog,G.csnames[a.args[3]].homog,G.csnames[a.args[4]].homog,G.csnames[a.args[0]].homog),
c=b[0];b=b[1];c=h.adjoint3(c);b=h.adjoint3(b);b=[c,b];a.results=b};u.ConicBy1p4l.stateSize=pc.stateSize;u.ConicParabolaPL={};u.ConicParabolaPL.kind="C";u.ConicParabolaPL.signature=["P","L"];u.ConicParabolaPL.updatePosition=function(a){var b=G.csnames[a.args[0]].homog.value,c=G.csnames[a.args[1]].homog.value,d=n.mult,f=n.neg,k=n.add,m=n.sub,q=b[0],v=b[1],w=b[2],x=c[0];b=c[1];c=c[2];var B=d(w,w),E=d(x,x),J=d(b,b),W=d(w,c),R=f(w);w=k(E,J);J=d(B,J);E=d(B,E);f=d(f(B),d(x,b));x=d(R,k(d(q,w),d(W,x)));b=
d(R,k(d(v,w),d(W,b)));d=m(d(k(d(q,q),d(v,v)),w),d(B,d(c,c)));d=u._helper.buildConicMatrix([J,f,E,x,b,d]);d=h.normalizeMax(d);a.matrix=p.withUsage(d,"Conic")};u.ConicBy2Foci1P={};u.ConicBy2Foci1P.kind="Cs";u.ConicBy2Foci1P.signature=["P","P","P"];u.ConicBy2Foci1P.updatePosition=function(a){var b=G.csnames[a.args[0]].homog,c=G.csnames[a.args[1]].homog,d=G.csnames[a.args[2]].homog,f=h.ii,k=h.jj,m=h.normalizeMax(h.cross(b,d)),q=h.normalizeMax(h.cross(c,d)),v=h.normalizeMax(h.cross(d,f));d=h.normalizeMax(h.cross(d,
k));q=u._helper.coHarmonic(v,d,m,q);m=h.normalizeMax(q[0]);q=h.normalizeMax(q[1]);f=h.turnIntoCSList([f]);v=h.turnIntoCSList([k]);d=h.turnIntoCSList([b]);var w=h.turnIntoCSList([c]);k=u._helper.conicFromTwoDegenerates(f,v,d,w,m);k=h.normalizeMax(k);f=u._helper.conicFromTwoDegenerates(f,v,d,w,q);f=h.normalizeMax(f);k=h.normalizeMax(h.adjoint3(k));f=h.normalizeMax(h.adjoint3(f));"ellipsoid"!==u._helper.getConicType(k)&&(m=k,k=f,f=m);h.almostequals(b,c).value&&(b=n.real(3),f=h.zeromatrix(b,b));a.results=
[k,f]};u.ConicBy2Pol1P={};u.ConicBy2Pol1P.kind="C";u.ConicBy2Pol1P.signature=["P","L","P","L","P"];u.ConicBy2Pol1P.updatePosition=function(a){var b=G.csnames[a.args[0]].homog,c=G.csnames[a.args[1]].homog,d=G.csnames[a.args[2]].homog,f=G.csnames[a.args[3]].homog,k=G.csnames[a.args[4]].homog,m=h.scalproduct,q=h.scalmult,v=h.sub,w=h.productMM,x=n.realmult,B=h.transpose,E=h.turnIntoCSList,J=v(q(m(c,b),k),q(x(2,m(c,k)),b)),W=v(q(m(f,d),k),q(x(2,m(f,k)),d)),R=E([h.cross(b,k)]);k=E([h.cross(d,k)]);W=w(B(R),
E([h.cross(b,W)]));E=w(B(k),E([h.cross(d,J)]));w=w(B(R),k);b=m(b,f);c=m(d,c);d=h.add(q(c,W),q(b,E));d=v(d,q(x(2,n.mult(b,c)),w));d=h.add(d,B(d));d=h.normalizeMax(d);d=p.withUsage(d,"Conic");a.matrix=d};u.ConicBy2Pol1L={};u.ConicBy2Pol1L.kind="C";u.ConicBy2Pol1L.signature=["P","L","P","L","L"];u.ConicBy2Pol1L.updatePosition=function(a){var b=G.csnames[a.args[0]].homog,c=G.csnames[a.args[1]].homog,d=G.csnames[a.args[2]].homog,f=G.csnames[a.args[3]].homog,k=G.csnames[a.args[4]].homog,m=h.scalproduct,
q=h.scalmult,v=h.productMM,w=n.mult,x=h.transpose,B=h.turnIntoCSList,E=m(c,b),J=m(c,d),W=m(f,b),R=m(f,d),ea=m(k,b);m=m(k,d);var X=B([h.sub(q(w(W,m),c),q(w(J,ea),f))]);b=h.add(v(x(B([q(w(W,J),k)])),B([h.sub(h.add(q(n.sub(w(E,m),w(J,ea)),f),q(n.sub(w(R,ea),w(W,m)),c)),q(h.det3(c,f,k),h.cross(b,d)))])),v(x(X),X));b=h.add(b,x(b));b=h.normalizeMax(b);b=p.withUsage(b,"Conic");a.matrix=b};u._helper.conic1Pol3Inc=function(a,b,c,d,f){var k=h.scalproduct,m=h.scalmult,q=h.productMM,v=h.cross,w=n.realmult,x=
n.mult,B=h.transpose,E=h.turnIntoCSList,J=h.det3,W=J(a,c,d),R=E([v(c,f)]),ea=E([v(a,f)]),X=E([v(c,d)]),oa=k(b,a),ja=k(b,c);b=k(b,f);v=E([v(d,h.sub(m(oa,f),m(w(2,b),a)))]);R=m(W,q(B(R),v));a=w(2,n.add(x(J(a,d,f),ja),x(W,b)));a=n.sub(x(J(c,d,f),oa),a);R=h.add(R,m(a,q(B(ea),X)));R=h.add(R,B(R));return R=h.normalizeMax(R)};u.ConicBy1Pol3P={};u.ConicBy1Pol3P.kind="C";u.ConicBy1Pol3P.signature=["P","L","P","P","P"];u.ConicBy1Pol3P.updatePosition=function(a){var b=u._helper.conic1Pol3Inc(G.csnames[a.args[0]].homog,
G.csnames[a.args[1]].homog,G.csnames[a.args[2]].homog,G.csnames[a.args[3]].homog,G.csnames[a.args[4]].homog);b=p.withUsage(b,"Conic");a.matrix=b};u.ConicBy1Pol3L={};u.ConicBy1Pol3L.kind="C";u.ConicBy1Pol3L.signature=["P","L","L","L","L"];u.ConicBy1Pol3L.updatePosition=function(a){var b=u._helper.conic1Pol3Inc(G.csnames[a.args[1]].homog,G.csnames[a.args[0]].homog,G.csnames[a.args[2]].homog,G.csnames[a.args[3]].homog,G.csnames[a.args[4]].homog);b=h.normalizeMax(h.adjoint3(b));b=p.withUsage(b,"Conic");
a.matrix=b};u.ConicBy1Pol2P1L={};u.ConicBy1Pol2P1L.kind="Cs";u.ConicBy1Pol2P1L.signature=["P","L","P","P","L"];u.ConicBy1Pol2P1L.updatePosition=function(a){var b=G.csnames[a.args[0]].homog,c=G.csnames[a.args[1]].homog,d=G.csnames[a.args[2]].homog,f=G.csnames[a.args[3]].homog,k=G.csnames[a.args[4]].homog,m=n.add,q=h.turnIntoCSList,v=h.cross,w=h.productMM,x=n.mult,B=n.realmult,E=h.scalmult,J=h.scalproduct,W=n.sub,R=h.transpose,ea=J(c,b),X=J(c,d),oa=J(c,f);c=J(k,b);var ja=J(k,d);J=J(k,f);k=q([v(b,d)]);
b=q([v(b,f)]);d=q([v(d,f)]);f=n.sqrt(x(x(ja,J),x(W(x(ea,ja),B(2,x(c,X))),W(x(ea,J),B(2,x(c,oa))))));q=w(R(k),b);f=E(f,h.add(q,R(q)));m=E(W(x(ea,x(ja,J)),m(x(c,x(X,J)),x(c,x(ja,oa)))),q);B=h.add(h.sub(E(oa,k),E(X,b)),E(B(.5,ea),d));m=h.add(m,E(x(c,c),w(R(d),B)));m=h.add(m,R(m));w=h.normalizeMax(h.add(f,m));x=h.normalizeMax(h.sub(f,m));a.results=jd(w,x).value};u.ConicBy1Pol2P1L.stateSize=jd.stateSize;u.ConicBy1Pol1P2L={};u.ConicBy1Pol1P2L.kind="Cs";u.ConicBy1Pol1P2L.signature=["P","L","P","L","L"];
u.ConicBy1Pol1P2L.updatePosition=function(a){var b=G.csnames[a.args[0]].homog,c=G.csnames[a.args[1]].homog,d=G.csnames[a.args[2]].homog,f=G.csnames[a.args[3]].homog,k=G.csnames[a.args[4]].homog,m=n.add,q=h.turnIntoCSList,v=h.cross,w=h.productMM,x=n.mult,B=n.realmult,E=h.scalmult,J=h.scalproduct,W=n.sub,R=h.transpose,ea=J(c,b),X=J(c,d),oa=J(f,b),ja=J(f,d),Ca=J(k,b),Na=J(k,d),ua=x(ea,ea),Ha=x(ea,X);J=x(X,X);var Ua=x(oa,oa),Ra=x(oa,ja),Ja=x(ja,ja),Ka=x(Ca,Ca),Xa=x(Ca,Na),ab=x(Na,Na),bb=x(x(ua,Ja),ab);
bb=W(bb,B(2,x(x(Ha,Ra),ab)));bb=W(bb,B(2,x(x(Ha,Ja),Xa)));bb=m(bb,B(.5,x(x(J,Ua),ab)));bb=m(bb,B(3,x(x(J,Ra),Xa)));bb=m(bb,B(.5,x(x(J,Ja),Ka)));Xa=x(x(ea,ja),Na);Xa=W(Xa,x(x(X,oa),Na));Xa=W(Xa,x(x(X,ja),Ca));Xa=x(Xa,x(J,Ca));ab=W(x(ea,ja),B(2,x(X,oa)));ab=x(ab,x(J,x(ja,Ca)));bb=w(R(q([c])),q([h.add(h.add(E(bb,c),E(Xa,f)),E(ab,k))]));Xa=q([f]);bb=h.add(bb,E(B(.5,x(x(J,J),Ka)),w(R(Xa),Xa)));bb=h.add(bb,E(J,w(R(q([k])),q([h.add(E(W(W(B(2,x(Ha,Ra)),x(ua,Ja)),B(.5,x(J,Ua))),k),E(x(h.det3(c,f,k),W(x(ea,
ja),x(X,oa))),v(b,d)))]))));bb=h.add(bb,R(bb));b=n.sqrt(x(x(ja,Na),x(W(x(ea,ja),B(2,x(X,oa))),W(x(ea,Na),B(2,x(X,Ca))))));c=w(R(q([c])),q([h.sub(E(W(x(X,m(x(oa,Na),x(ja,Ca))),x(ea,x(ja,Na))),c),E(J,h.add(E(Ca,f),E(oa,k))))]));c=h.add(c,E(x(ea,J),w(R(q([f])),q([k]))));c=E(b,c);c=h.add(c,R(c));f=h.normalizeMax(h.add(bb,c));k=h.normalizeMax(h.sub(bb,c));a.results=jd(f,k).value};u.ConicBy1Pol1P2L.stateSize=jd.stateSize;u._helper.coHarmonic=function(a,b,c,d){var f=h.realVector([100*Math.random(),100*Math.random(),
1]),k=h.det3(f,c,a),m=h.det3(f,c,b);c=h.det3(f,d,a);d=h.det3(f,d,b);d=n.sqrt(n.mult(d,m));k=n.sqrt(n.mult(c,k));a=p.mult(a,d);k=p.mult(b,k);b=h.add(a,k);a=h.sub(a,k);return[b,a]};u.ConicInSquare={};u.ConicInSquare.kind="C";u.ConicInSquare.signature=["P","P","P","P"];u.ConicInSquare.updatePosition=function(a){var b=M.basismap(G.csnames[a.args[0]].homog,G.csnames[a.args[1]].homog,G.csnames[a.args[2]].homog,G.csnames[a.args[3]].homog),c=n.one;c=u._helper.buildConicMatrix([c,c,c,n.real(-3),c,c]);b=h.adjoint3(b);
b=h.productMM(h.productMM(h.transpose(b),c),b);b=h.normalizeMax(b);a.matrix=p.withUsage(b,"Conic")};u.ConicBy5lines={};u.ConicBy5lines.kind="C";u.ConicBy5lines.signature=["L","L","L","L","L"];u.ConicBy5lines.updatePosition=function(a){var b=u._helper.ConicBy5(a,G.csnames[a.args[0]].homog,G.csnames[a.args[1]].homog,G.csnames[a.args[2]].homog,G.csnames[a.args[3]].homog,G.csnames[a.args[4]].homog);b=h.adjoint3(b);a.matrix=b;a.matrix=h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Conic")};u.ConicFromPrincipalDirections=
{};u.ConicFromPrincipalDirections.kind="C";u.ConicFromPrincipalDirections.signature=["P","P","P"];u.ConicFromPrincipalDirections.updatePosition=function(a){var b=G.csnames[a.args[0]].homog,c=G.csnames[a.args[1]].homog,d=G.csnames[a.args[2]].homog,f=u._helper.pointReflection(b,c),k=h.cross(c,b);b=h.turnIntoCSList([k.value[0],k.value[1],n.zero]);k=h.turnIntoCSList([k]);c=h.turnIntoCSList([h.cross(c,b)]);f=h.turnIntoCSList([h.cross(f,b)]);a.matrix=u._helper.conicFromTwoDegenerates(k,k,c,f,d);a.matrix=
h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Conic")};u.CircleBy3={};u.CircleBy3.kind="C";u.CircleBy3.signature=["P","P","P"];u.CircleBy3.updatePosition=function(a){var b=u._helper.ConicBy5(a,G.csnames[a.args[0]].homog,G.csnames[a.args[1]].homog,h.ii,h.jj,G.csnames[a.args[2]].homog);a.matrix=h.normalizeMax(b);a.matrix=p.withUsage(a.matrix,"Circle")};u.ArcBy3={};u.ArcBy3.kind="C";u.ArcBy3.signature=["P","P","P"];u.ArcBy3.updatePosition=function(a){u.CircleBy3.updatePosition(a);a.startPoint=
G.csnames[a.args[0]].homog;a.viaPoint=G.csnames[a.args[1]].homog;a.endPoint=G.csnames[a.args[2]].homog};u.ArcBy3.initialize=function(a){a.startPoint=G.csnames[a.args[0]].homog;a.viaPoint=G.csnames[a.args[1]].homog;a.endPoint=G.csnames[a.args[2]].homog;a.isArc=!0};u.PolarOfPoint={};u.PolarOfPoint.kind="L";u.PolarOfPoint.signature=["P","C"];u.PolarOfPoint.updatePosition=function(a){var b=p.mult(G.csnames[a.args[1]].matrix,G.csnames[a.args[0]].homog);b=h.normalizeMax(b);a.homog=p.withUsage(b,"Line")};
u.PolarOfLine={};u.PolarOfLine.kind="P";u.PolarOfLine.signature=["L","C"];u.PolarOfLine.updatePosition=function(a){var b=G.csnames[a.args[0]],c=h.adjoint3(G.csnames[a.args[1]].matrix);b=p.mult(c,b.homog);b=h.normalizeMax(b);a.homog=p.withUsage(b,"Point")};u.AngleBisector={};u.AngleBisector.kind="Ls";u.AngleBisector.signature=["L","L","P"];u.AngleBisector.updatePosition=function(a){var b=G.csnames[a.args[0]].homog,c=G.csnames[a.args[1]].homog,d=G.csnames[a.args[2]].homog,f=h.add,k=h.sub,m=h.abs,q=
h.cross,v=h.scalmult,w=h.normalizeMax,x=h._helper.isAlmostZero,B=h.linfty,E=v(m(q(q(B,c),B)),b);b=v(m(q(q(B,b),B)),c);k=k(E,b);f=f(E,b);x(k)&&(k=q(q(q(B,f),B),d));x(f)&&(f=q(q(q(B,k),B),d));a.results=pc(w(k),w(f))};u.AngleBisector.stateSize=pc.stateSize;u._helper.IntersectLC=function(a,b){var c=n,d=h.crossOperator(a),f=h.transpose(d);b=p.mult(f,p.mult(b,d));f=h.maxIndex(a,n.abs2);if(0===f){f=b.value[1].value[1];var k=b.value[1].value[2];var m=b.value[2].value[1];var q=b.value[2].value[2];a=a.value[0]}else 1===
f?(f=b.value[0].value[0],k=b.value[0].value[2],m=b.value[2].value[0],q=b.value[2].value[2],a=a.value[1]):(f=b.value[0].value[0],k=b.value[0].value[1],m=b.value[1].value[0],q=b.value[1].value[1],a=a.value[2]);c=c.div(c.sqrt(c.sub(c.mult(k,m),c.mult(f,q))),a);c=h.add(b,h.scalmult(c,d));f=h.maxIndex(c,h.abs2);d=c.value[f];d=h.normalizeMax(d);d=p.withUsage(d,"Point");c=h.transpose(c);f=h.maxIndex(c,h.abs2);c=c.value[f];c=h.normalizeMax(c);c=p.withUsage(c,"Point");return[d,c]};u.IntersectLC={};u.IntersectLC.kind=
"Ps";u.IntersectLC.signature=["L","C"];u.IntersectLC.updatePosition=function(a){var b=u._helper.IntersectLC(G.csnames[a.args[0]].homog,G.csnames[a.args[1]].matrix);a.results=pc(b[0],b[1])};u.IntersectLC.stateSize=pc.stateSize;u.OtherIntersectionCL={};u.OtherIntersectionCL.kind="P";u.OtherIntersectionCL.signature=["C","L","P"];u.OtherIntersectionCL.updatePosition=function(a){var b=G.csnames[a.args[2]].homog,c=u._helper.IntersectLC(G.csnames[a.args[1]].homog,G.csnames[a.args[0]].matrix),d=c[0];c=c[1];
var f=h.projectiveDistMinScal(d,b);b=h.projectiveDistMinScal(c,b);a.homog=f<b?c:d;a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Point")};u.IntersectCirCir={};u.IntersectCirCir.kind="Ps";u.IntersectCirCir.signature=["C","C"];u.IntersectCirCir.updatePosition=function(a){var b=G.csnames[a.args[0]].matrix,c=G.csnames[a.args[1]].matrix,d=h.scalmult(c.value[0].value[0],b.value[2]);c=h.scalmult(b.value[0].value[0],c.value[2]);d=h.sub(d,c);d=h.turnIntoCSList([d.value[0],d.value[1],n.realmult(.5,
d.value[2])]);d=h.normalizeMax(d);b=u._helper.IntersectLC(d,b);a.results=pc(b[0],b[1])};u.IntersectCirCir.stateSize=pc.stateSize;u.OtherIntersectionCC={};u.OtherIntersectionCC.kind="P";u.OtherIntersectionCC.signature=["C","C","P"];u.OtherIntersectionCC.updatePosition=function(a){var b=G.csnames[a.args[0]].matrix,c=G.csnames[a.args[1]].matrix,d=G.csnames[a.args[2]].homog,f=h.scalmult(c.value[0].value[0],b.value[2]);c=h.scalmult(b.value[0].value[0],c.value[2]);f=h.sub(f,c);f=h.turnIntoCSList([f.value[0],
f.value[1],n.realmult(.5,f.value[2])]);f=h.normalizeMax(f);f=u._helper.IntersectLC(f,b);b=f[0];f=f[1];c=h.projectiveDistMinScal(b,d);d=h.projectiveDistMinScal(f,d);a.homog=c<d?f:b;a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Point")};u._helper.IntersectConicConic=function(a,b){var c=a.value[0],d=a.value[1],f=a.value[2],k=b.value[0],m=b.value[1],q=b.value[2],v=h.det3(c,d,f),w=n.add(n.add(h.det3(c,d,q),h.det3(c,m,f)),h.det3(k,d,f));c=n.add(n.add(h.det3(c,m,q),h.det3(k,d,q)),h.det3(k,
m,f));k=h.det3(k,m,q);q=n.abs2(v).value.real;m=n.abs2(k).value.real;q<m&&(q=a,a=b,b=q,q=k,k=v,v=q,q=c,c=w,w=q,q=m);1E-24>q?(v=a,w=b):(w=n.solveCubic(v,w,c,k),c=n.abs2(n.sub(w[0],w[1])).value.real,k=n.abs2(n.sub(w[0],w[2])).value.real,m=n.abs2(n.sub(w[1],w[2])).value.real,c>k?(v=w[1],w=c>m?w[0]:w[2]):(v=w[2],w=k>m?w[0]:w[1]),v=h.add(h.scalmult(v,a),b),w=h.add(h.scalmult(w,a),b));b=u._helper.splitDegenConic(v);a=b[0];b=b[1];v=u._helper.splitDegenConic(w);c=v[0];w=v[1];v=h.cross(a,c);c=h.cross(b,c);
a=h.cross(a,w);b=h.cross(b,w);v=h.normalizeMax(v);c=h.normalizeMax(c);a=h.normalizeMax(a);b=h.normalizeMax(b);v=p.withUsage(v,"Point");c=p.withUsage(c,"Point");a=p.withUsage(a,"Point");b=p.withUsage(b,"Point");return[v,c,a,b]};u.IntersectConicConic={};u.IntersectConicConic.kind="Ps";u.IntersectConicConic.signature=["C","C"];u.IntersectConicConic.updatePosition=function(a){var b=u._helper.IntersectConicConic(G.csnames[a.args[0]].matrix,G.csnames[a.args[1]].matrix);b=Ae(b[0],b[1],b[2],b[3]);a.results=
b};u.IntersectConicConic.stateSize=Ae.stateSize;u.SelectP={};u.SelectP.kind="P";u.SelectP.signature=["Ps"];u.SelectP.initialize=function(a){if(void 0!==a.index)return a.index-1;var b=G.csnames[a.args[0]].results.value;a=u._helper.initializePoint(a);for(var c=h.projectiveDistMinScal(a,b[0]),d=0,f=1;f<b.length;++f){var k=h.projectiveDistMinScal(a,b[f]);k<c&&(c=k,d=f)}return d};u.SelectP.updatePosition=function(a){a.homog=G.csnames[a.args[0]].results.value[a.param]};u.SelectL={};u.SelectL.kind="L";u.SelectL.signature=
["Ls"];u.SelectL.initialize=function(a){if(void 0!==a.index)return a.index-1;var b=G.csnames[a.args[0]].results.value;a=u._helper.initializeLine(a);for(var c=h.projectiveDistMinScal(a,b[0]),d=0,f=1;f<b.length;++f){var k=h.projectiveDistMinScal(a,b[f]);k<c&&(c=k,d=f)}return d};u.SelectL.updatePosition=function(a){a.homog=G.csnames[a.args[0]].results.value[a.param];a.homog=p.withUsage(a.homog,"Line")};u._helper.moebiusStep=function(a,b,c){var d=n.add,f=n.sub,k=n.mult,m=a.value[0],q=a.value[1];a=a.value[2];
var v=b.value[0],w=b.value[1];b=b.value[2];var x=c.value[0],B=c.value[1],E=c.value[2];c=f(k(b,x),k(v,E));var J=f(k(b,B),k(w,E));x=f(k(m,E),k(a,x));B=f(k(q,E),k(a,B));return[f(k(m,c),k(q,J)),d(k(q,c),k(m,J)),k(a,c),k(a,J),f(k(v,x),k(w,B)),d(k(w,x),k(v,B)),k(b,x),k(b,B)]};u.TrMoebius={};u.TrMoebius.kind="Mt";u.TrMoebius.signature="PPPPPP".split("");u.TrMoebius.updatePosition=function(a){var b=n.neg,c=u._helper.moebiusStep(G.csnames[a.args[0]].homog,G.csnames[a.args[2]].homog,G.csnames[a.args[4]].homog),
d=u._helper.moebiusStep(G.csnames[a.args[1]].homog,G.csnames[a.args[3]].homog,G.csnames[a.args[5]].homog);d=h.normalizeMax(h.matrix([[d[0],b(d[1]),d[4],b(d[5])],[d[1],d[0],d[5],d[4]],[d[2],b(d[3]),d[6],b(d[7])],[d[3],d[2],d[7],d[6]]]));b=h.normalizeMax(h.matrix([[c[6],b(c[4])],[c[7],b(c[5])],[b(c[2]),c[0]],[b(c[3]),c[1]]]));b=h.normalizeMax(h.productMM(d,b));a.moebius={anti:!1,ar:b.value[0].value[0],ai:b.value[1].value[0],br:b.value[0].value[1],bi:b.value[1].value[1],cr:b.value[2].value[0],ci:b.value[3].value[0],
dr:b.value[2].value[1],di:b.value[3].value[1]};u._helper.moebiusPair(a)};u._helper.moebiusPair=function(a){var b=a.moebius,c=n.neg,d=b.anti?c:p.identity;b=h.normalizeMax(h.turnIntoCSList([h.matrix([[c(b.cr),d(b.ci),c(b.dr)],[b.ci,d(b.cr),b.di],[b.ar,c(d(b.ai)),b.br]]),h.matrix([[c(b.ci),c(d(b.cr)),c(b.di)],[c(b.cr),d(b.ci),c(b.dr)],[b.ai,d(b.ar),b.bi]])]));a.mat1=b.value[0];a.mat2=b.value[1]};u._helper.inverseMoebius=function(a){var b=n.neg,c=a.anti?b:p.identity;return{anti:a.anti,ar:a.dr,ai:c(a.di),
br:b(a.br),bi:b(c(a.bi)),cr:b(a.cr),ci:b(c(a.ci)),dr:a.ar,di:c(a.ai)}};u.TrInverseMoebius={};u.TrInverseMoebius.kind="Mt";u.TrInverseMoebius.signature=["Mt"];u.TrInverseMoebius.updatePosition=function(a){a.moebius=u._helper.inverseMoebius(G.csnames[a.args[0]].moebius);u._helper.moebiusPair(a)};u.TrMoebiusP={};u.TrMoebiusP.kind="P";u.TrMoebiusP.signature=["Mt","P"];u.TrMoebiusP.updatePosition=function(a){var b=G.csnames[a.args[0]],c=G.csnames[a.args[1]].homog,d=h.productMV(b.mat1,c);b=h.productMV(b.mat2,
c);a.homog=h.normalizeMax(h.cross(d,b));a.homog=p.withUsage(a.homog,"Point")};u._helper.TrMoebiusP=function(a,b){var c=h.productMV(b.mat1,a);a=h.productMV(b.mat2,a);return h.normalizeMax(h.cross(c,a))};u.TrMoebiusL={};u.TrMoebiusL.kind="C";u.TrMoebiusL.signature=["Mt","L"];u.TrMoebiusL.updatePosition=function(a){var b=G.csnames[a.args[0]],c=G.csnames[a.args[1]].homog,d=function(){var m=h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);return h.normalizeMax(m)},f=h.cross(d(),c),k=
h.cross(d(),c);c=h.cross(d(),c);f=u._helper.TrMoebiusP(f,b);k=u._helper.TrMoebiusP(k,b);b=u._helper.TrMoebiusP(c,b);a.matrix=h.normalizeMax(u._helper.ConicBy5(null,f,k,b,h.ii,h.jj));a.matrix=p.withUsage(a.matrix,"Circle")};u.TrMoebiusS={};u.TrMoebiusS.kind="C";u.TrMoebiusS.signature=["Mt","S"];u.TrMoebiusS.updatePosition=function(a){var b=G.csnames[a.args[0]],c=G.csnames[a.args[1]],d=c.startpos;c=c.endpos;var f=h.add(d,c);d=u._helper.TrMoebiusP(d,b);f=u._helper.TrMoebiusP(f,b);b=u._helper.TrMoebiusP(c,
b);a.startPoint=d;a.viaPoint=f;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(u._helper.ConicBy5(null,d,f,b,h.ii,h.jj));a.matrix=p.withUsage(a.matrix,"Circle")};u.TrMoebiusC={};u.TrMoebiusC.kind="C";u.TrMoebiusC.signature=["Mt","C"];u.TrMoebiusC.signatureConstraints=function(a){return"Circle"===G.csnames[a.args[1]].matrix.usage};u.TrMoebiusC.updatePosition=function(a){var b=G.csnames[a.args[0]],c=G.csnames[a.args[1]].matrix,d=function(){var k=h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-
.5]);return h.normalizeMax(k)},f=u._helper.IntersectLC(d(),c);d=u._helper.IntersectLC(d(),c);c=f[1];d=d[1];f=u._helper.TrMoebiusP(f[0],b);c=u._helper.TrMoebiusP(c,b);b=u._helper.TrMoebiusP(d,b);a.matrix=h.normalizeMax(u._helper.ConicBy5(null,f,c,b,h.ii,h.jj));a.matrix=p.withUsage(a.matrix,"Circle")};u.TrMoebiusArc={};u.TrMoebiusArc.kind="C";u.TrMoebiusArc.signature=["Mt","C"];u.TrMoebiusArc.signatureConstraints=function(a){return G.csnames[a.args[1]].isArc};u.TrMoebiusArc.updatePosition=function(a){var b=
G.csnames[a.args[0]],c=G.csnames[a.args[1]],d=c.viaPoint,f=c.endPoint;c=u._helper.TrMoebiusP(c.startPoint,b);d=u._helper.TrMoebiusP(d,b);b=u._helper.TrMoebiusP(f,b);a.startPoint=c;a.viaPoint=d;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(u._helper.ConicBy5(null,c,d,b,h.ii,h.jj));a.matrix=p.withUsage(a.matrix,"Circle")};u._helper.trBuildMatrix=function(a,b){var c=b(0);b=b(1);var d=h.productMM(b,h.adjoint3(c));a.matrix=h.normalizeMax(d);d=h.transpose(h.productMM(c,h.adjoint3(b)));a.dualMatrix=h.normalizeMax(d)};
u.TrProjection={};u.TrProjection.kind="Tr";u.TrProjection.signature="PPPPPPPP".split("");u.TrProjection.initialize=function(a){a.isEuclidean=0};u.TrProjection.updatePosition=function(a){u._helper.trBuildMatrix(a,function(b){return M.basismap(G.csnames[a.args[0+b]].homog,G.csnames[a.args[2+b]].homog,G.csnames[a.args[4+b]].homog,G.csnames[a.args[6+b]].homog)})};u.TrAffine={};u.TrAffine.kind="Tr";u.TrAffine.signature="PPPPPP".split("");u.TrAffine.initialize=function(a){a.isEuclidean=0};u.TrAffine.updatePosition=
function(a){var b=n.mult,c=h.scalmult,d=h.turnIntoCSList,f=h.transpose,k=h.normalizeMax,m=h.productMM,q=h.adjoint3,v=d([G.csnames[a.args[0]].homog,G.csnames[a.args[2]].homog,G.csnames[a.args[4]].homog]),w=d([G.csnames[a.args[1]].homog,G.csnames[a.args[3]].homog,G.csnames[a.args[5]].homog]),x=f(v);f=f(w);var B=x.value[2].value,E=f.value[2].value,J=[b(B[0],E[2]),b(B[1],E[0]),b(B[2],E[1])];x=q(x).value;a.matrix=k(m(f,d([c(b(J[0],E[1]),x[0]),c(b(J[1],E[2]),x[1]),c(b(J[2],E[0]),x[2])])));x=v.value;a.dualMatrix=
k(m(q(w),d([c(b(B[2],J[1]),x[0]),c(b(B[0],J[2]),x[1]),c(b(B[1],J[0]),x[2])])))};u.TrSimilarity={};u.TrSimilarity.kind="Tr";u.TrSimilarity.signature=["P","P","P","P"];u.TrSimilarity.initialize=function(a){a.isEuclidean=1};u.TrSimilarity.updatePosition=function(a){u._helper.trBuildMatrix(a,function(b){return M.basismap(G.csnames[a.args[0+b]].homog,G.csnames[a.args[2+b]].homog,h.ii,h.jj)})};u.TrTranslation={};u.TrTranslation.kind="Tr";u.TrTranslation.signature=["P","P"];u.TrTranslation.initialize=function(a){a.isEuclidean=
1};u.TrTranslation.updatePosition=function(a){var b=G.csnames[a.args[0]].homog,c=G.csnames[a.args[1]].homog,d=h.cross(b,c).value;b=n.mult(b.value[2],c.value[2]);c=h.turnIntoCSList;var f=n.neg,k=n.zero;d=c([c([b,k,d[1]]),c([k,b,f(d[0])]),c([k,k,b])]);d=h.normalizeMax(d);a.matrix=d;b=f(d.value[0].value[0]);d=c([c([b,k,k]),c([k,b,k]),c([d.value[0].value[2],d.value[1].value[2],b])]);a.dualMatrix=d};u.TrRotationPNumb={};u.TrRotationPNumb.kind="Tr";u.TrRotationPNumb.signature=["P","V"];u.TrRotationPNumb.updatePosition=
function(a){var b=G.csnames[a.args[0]].homog.value,c=G.csnames[a.args[1]].value,d=n.mult,f=n.add,k=n.sub,m=h.turnIntoCSList,q=h.normalizeMax,v=n.zero,w=b[0],x=b[1];b=b[2];var B=n.cos(c),E=n.sin(c),J=k(n.real(1),B);c=d(J,w);J=d(J,x);w=d(E,w);x=d(E,x);B=d(B,b);d=d(E,b);E=n.neg(d);a.matrix=q(m([m([B,E,f(c,x)]),m([d,B,k(J,w)]),m([v,v,b])]));a.dualMatrix=q(m([m([B,E,v]),m([d,B,v]),m([k(c,x),f(J,w),b])]))};u.TrReflectionP={};u.TrReflectionP.kind="Tr";u.TrReflectionP.signature=["P"];u.TrReflectionP.initialize=
function(a){a.isEuclidean=1};u.TrReflectionP.updatePosition=function(a){var b=G.csnames[a.args[0]].homog.value,c=n.realmult(-.5,b[2]),d=n.zero;b=h.turnIntoCSList([h.turnIntoCSList([c,d,b[0]]),h.turnIntoCSList([d,c,b[1]]),h.turnIntoCSList([d,d,n.neg(c)])]);b=h.normalizeMax(b);a.matrix=b;a.dualMatrix=h.transpose(b)};u.TrReflectionL={};u.TrReflectionL.kind="Tr";u.TrReflectionL.signature=["L"];u.TrReflectionL.initialize=function(a){a.isEuclidean=-1};u.TrReflectionL.updatePosition=function(a){var b=n.mult,
c=n.realmult,d=n.zero,f=G.csnames[a.args[0]].homog.value,k=f[0],m=f[1];f=f[2];var q=b(k,k),v=b(m,m),w=c(-.5,n.sub(q,v)),x=b(k,m);b=h.turnIntoCSList([h.turnIntoCSList([n.neg(w),x,b(k,f)]),h.turnIntoCSList([x,w,b(m,f)]),h.turnIntoCSList([d,d,c(-.5,n.add(q,v))])]);b=h.normalizeMax(b);a.matrix=b;a.dualMatrix=h.transpose(b)};u.TrReflectionS={};u.TrReflectionS.kind="Tr";u.TrReflectionS.signature=["S"];u.TrReflectionS.updatePosition=u.TrReflectionL.updatePosition;u.TrReflectionC={};u.TrReflectionC.kind=
"Mt";u.TrReflectionC.signature=["C"];u.TrReflectionC.signatureConstraints=function(a){return"Circle"===G.csnames[a.args[0]].matrix.usage};u.TrReflectionC.updatePosition=function(a){var b=G.csnames[a.args[0]].matrix,c=b.value[0].value[2],d=b.value[1].value[2],f=n.neg;a.moebius={anti:!0,ar:c,ai:d,br:b.value[2].value[2],bi:n.zero,cr:f(b.value[0].value[0]),ci:n.zero,dr:f(c),di:d};u._helper.moebiusPair(a)};u.TrInverse={};u.TrInverse.kind="Tr";u.TrInverse.signature=["Tr"];u.TrInverse.initialize=function(a){a.isEuclidean=
G.csnames[a.args[0]].isEuclidean};u.TrInverse.updatePosition=function(a){var b=G.csnames[a.args[0]];a.dualMatrix=h.transpose(b.matrix);a.matrix=h.transpose(b.dualMatrix)};u.TransformC={};u.TransformC.kind="C";u.TransformC.signature=["Tr","C"];u.TransformC.updatePosition=function(a){var b=G.csnames[a.args[0]].dualMatrix;b=h.productMM(h.productMM(b,G.csnames[a.args[1]].matrix),h.transpose(b));b=h.normalizeMax(b);a.matrix=p.withUsage(b,"Conic")};u.TransformArc={};u.TransformArc.kind="C";u.TransformArc.signature=
["Tr","C"];u.TransformArc.signatureConstraints=function(a){return G.csnames[a.args[0]].isArc};u.TransformArc.updatePosition=function(a){var b=G.csnames[a.args[0]].matrix,c=G.csnames[a.args[1]],d=c.viaPoint,f=c.endPoint;c=h.normalizeMax(h.productMV(b,c.startPoint));d=h.normalizeMax(h.productMV(b,d));b=h.normalizeMax(h.productMV(b,f));a.startPoint=c;a.viaPoint=d;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(u._helper.ConicBy5(null,c,d,b,h.ii,h.jj));a.matrix=p.withUsage(a.matrix,"Circle")};u.TransformP=
{};u.TransformP.kind="P";u.TransformP.signature=["Tr","P"];u.TransformP.updatePosition=function(a){a.homog=h.normalizeMax(h.productMV(G.csnames[a.args[0]].matrix,G.csnames[a.args[1]].homog));a.homog=p.withUsage(a.homog,"Point")};u.TransformL={};u.TransformL.kind="L";u.TransformL.signature=["Tr","L"];u.TransformL.updatePosition=function(a){a.homog=h.normalizeMax(h.productMV(G.csnames[a.args[0]].dualMatrix,G.csnames[a.args[1]].homog));a.homog=p.withUsage(a.homog,"Line")};u.TransformS={};u.TransformS.kind=
"S";u.TransformS.signature=["Tr","S"];u.TransformS.updatePosition=function(a){var b=G.csnames[a.args[0]],c=G.csnames[a.args[1]];u.Segment.setSegmentPos(a,h.productMV(b.dualMatrix,c.homog),h.productMV(b.matrix,c.startpos),h.productMV(b.matrix,c.endpos))};u.TransformPolygon={};u.TransformPolygon.kind="Poly";u.TransformPolygon.signature=["Tr","Poly"];u.TransformPolygon.updatePosition=function(a){var b=G.csnames[a.args[0]].matrix;a.vertices=h.turnIntoCSList(G.csnames[a.args[1]].vertices.value.map(function(c){c=
h.normalizeMax(h.productMV(b,c));return c=p.withUsage(c,"Point")}))};u.TrComposeTrTr={};u.TrComposeTrTr.kind="Tr";u.TrComposeTrTr.signature=["Tr","Tr"];u.TrComposeTrTr.initialize=function(a){a.isEuclidean=G.csnames[a.args[0]].isEuclidean*G.csnames[a.args[1]].isEuclidean};u.TrComposeTrTr.updatePosition=function(a){var b=G.csnames[a.args[0]],c=G.csnames[a.args[1]];a.matrix=h.normalizeMax(h.productMM(c.matrix,b.matrix));a.dualMatrix=h.normalizeMax(h.productMM(c.dualMatrix,b.dualMatrix))};u._helper.composeMtMt=
function(a,b,c){function d(B,E,J,W){return m(v(B,E),v(J,W))}function f(B,E,J,W,R,ea,X,oa){return m(d(B,E,J,W),d(R,ea,X,oa))}function k(B,E,J,W,R,ea,X,oa){return q(d(B,E,J,W),d(R,ea,X,oa))}var m=n.add,q=n.sub,v=n.mult,w=c.anti?k:f,x=c.anti?f:k;w=h.normalizeMax(h.turnIntoCSList([x(b.ar,c.ar,b.cr,c.br,b.ai,c.ai,b.ci,c.bi),w(b.ar,c.ai,b.cr,c.bi,b.ai,c.ar,b.ci,c.br),x(b.br,c.ar,b.dr,c.br,b.bi,c.ai,b.di,c.bi),w(b.br,c.ai,b.dr,c.bi,b.bi,c.ar,b.di,c.br),x(b.ar,c.cr,b.cr,c.dr,b.ai,c.ci,b.ci,c.di),w(b.ar,c.ci,
b.cr,c.di,b.ai,c.cr,b.ci,c.dr),x(b.br,c.cr,b.dr,c.dr,b.bi,c.ci,b.di,c.di),w(b.br,c.ci,b.dr,c.di,b.bi,c.cr,b.di,c.dr)])).value;a.moebius={anti:b.anti!==c.anti,ar:w[0],ai:w[1],br:w[2],bi:w[3],cr:w[4],ci:w[5],dr:w[6],di:w[7]};u._helper.moebiusPair(a)};u._helper.euc2moeb=function(a){var b=a.matrix.value;return{anti:0>a.isEuclidean,ar:b[0].value[0],ai:b[1].value[0],br:b[0].value[2],bi:b[1].value[2],cr:n.zero,ci:n.zero,dr:b[2].value[2],di:n.zero}};u.TrComposeMtMt={};u.TrComposeMtMt.kind="Mt";u.TrComposeMtMt.signature=
["Mt","Mt"];u.TrComposeMtMt.updatePosition=function(a){u._helper.composeMtMt(a,G.csnames[a.args[0]].moebius,G.csnames[a.args[1]].moebius)};u.TrComposeTrMt={};u.TrComposeTrMt.kind="Mt";u.TrComposeTrMt.signature=["Tr","Mt"];u.TrComposeTrMt.signatureConstraints=function(a){return!!G.csnames[a.args[0]].isEuclidean};u.TrComposeTrMt.updatePosition=function(a){u._helper.composeMtMt(a,u._helper.euc2moeb(G.csnames[a.args[0]]),G.csnames[a.args[1]].moebius)};u.TrComposeMtTr={};u.TrComposeMtTr.kind="Mt";u.TrComposeMtTr.signature=
["Mt","Tr"];u.TrComposeMtTr.signatureConstraints=function(a){return!!G.csnames[a.args[1]].isEuclidean};u.TrComposeMtTr.updatePosition=function(a){u._helper.composeMtMt(a,G.csnames[a.args[0]].moebius,u._helper.euc2moeb(G.csnames[a.args[1]]))};u._helper.pointReflection=function(a,b){return h.normalizeMax(h.sub(h.scalmult(n.realmult(2,b.value[2]),a),h.scalmult(a.value[2],b)))};u._helper.conicOtherIntersection=function(a,b,c){var d=h.productMV(a,c);a=h.scalproduct(c,d);d=h.scalproduct(b,d);d=n.realmult(-2,
d);b=h.scalmult(a,b);c=h.scalmult(d,c);c=h.add(b,c);return c=h.normalizeMax(c)};u.Dist={};u.Dist.kind="V";u.Dist.signature=["P","P"];u.Dist.updatePosition=function(a){var b=G.csnames[a.args[1]].homog;a.value=h.abs(h.sub(h.normalizeZ(G.csnames[a.args[0]].homog),h.normalizeZ(b)))};u.Angle={};u.Angle.kind="V";u.Angle.signature=["L","L","P"];u.Angle.initialize=function(a){void 0===a.angle&&(a.angle=.5*Math.PI);Fc(n._helper.input(a.angle))};u.Angle.updatePosition=function(a){var b=G.csnames[a.args[1]].homog,
c=G.csnames[a.args[2]].homog,d=h.cross(G.csnames[a.args[0]].homog,h.linfty);b=h.cross(b,h.linfty);c=h.crossratio3(d,b,h.ii,h.jj,c);c=n.mult(n.complex(0,.5),n.log(c));d=(id().value.real-c.value.real)/Math.PI;b=Math.round(d);!sd&&.01<Math.abs(b-d)&&Od();c=n.complex(b*Math.PI+c.value.real,c.value.imag);Fc(c);a.value=p.withUsage(c,"Angle")};u.Angle.stateSize=2;u.Text={};u.Text.kind="Text";u.Text.signature="**";u.Text.isMovable=!0;u.Text.updatePosition=kc;u.Text.initialize=function(a){a.text=String(a.text);
a.pos&&(a.homog=u._helper.initializePoint(a));a.dock&&(a.dock.offset=a.dock.offset&&2===a.dock.offset.length?h.realVector([+a.dock.offset[0],+a.dock.offset[1]]):h.realVector([0,0]))};u.Text.set_text=function(a,b){a.text=Ea(b)};u.Text.getParamForInput=function(a,b,c){return u.Free.getParamForInput(a,b,c)};u.Text.getParamFromState=function(a){return a.homog};u.Text.putParamToState=function(a,b){a.homog=b};u.Calculation={};u.Calculation.kind="Text";u.Calculation.signature="**";u.Calculation.isMovable=
!0;u.Calculation.updatePosition=kc;u.Calculation.initialize=function(a){u.Text.initialize(a);a.calculation=Bc(a.text)};u.Calculation.getText=function(a){return Ea(L(a.calculation))};u.Calculation.getParamForInput=u.Text.getParamForInput;u.Calculation.getParamFromState=u.Text.getParamFromState;u.Calculation.putParamToState=u.Text.putParamToState;u.Equation={};u.Equation.kind="Text";u.Equation.isMovable=!0;u.Equation.signature="**";u.Equation.updatePosition=kc;u.Equation.initialize=function(a){u.Text.initialize(a);
a.calculation=Bc(a.text)};u.Equation.getText=function(a){return a.text+" = "+Ea(L(a.calculation))};u.Equation.getParamForInput=u.Text.getParamForInput;u.Equation.getParamFromState=u.Text.getParamFromState;u.Equation.putParamToState=u.Text.putParamToState;u.Evaluate={};u.Evaluate.kind="Text";u.Evaluate.isMovable=!0;u.Evaluate.signature="**";u.Evaluate.updatePosition=kc;u.Evaluate.initialize=function(a){u.Text.initialize(a);a.calculation=Bc(a.text)};u.Evaluate.getText=function(a){L(a.calculation);return a.text};
u.Evaluate.getParamForInput=u.Text.getParamForInput;u.Evaluate.getParamFromState=u.Text.getParamFromState;u.Evaluate.putParamToState=u.Text.putParamToState;u.Plot={};u.Plot.kind="Text";u.Plot.isMovable=!0;u.Plot.signature="**";u.Plot.updatePosition=kc;u.Plot.initialize=function(a){u.Text.initialize(a);a.calculation=Bc("plot(("+a.text+"))")};u.Plot.getText=function(a){L(a.calculation);return a.text};u.Plot.getParamForInput=u.Text.getParamForInput;u.Plot.getParamFromState=u.Text.getParamFromState;u.Plot.putParamToState=
u.Text.putParamToState;u.Button={};u.Button.kind="Text";u.Button.signature="**";u.Button.isMovable=!0;u.Button.updatePosition=kc;u.Button.initialize=function(a){var b=document.createElement("button");Ad(a,"click",b)};u.Button.getParamForInput=u.Text.getParamForInput;u.Button.getParamFromState=u.Text.getParamFromState;u.Button.putParamToState=u.Text.putParamToState;u.Button.set_fillcolor=function(a,b){h._helper.isNumberVecN(b,3)&&(a.fillcolor=b.value.map(function(c){return c.value.real}),a.html.style.backgroundColor=
N.makeColor(a.fillcolor,a.fillalpha))};u.Button.set_color=function(a,b){h._helper.isNumberVecN(b,3)&&(a.color=b.value.map(function(c){return c.value.real}),a.html.style.color=N.makeColor(a.color,a.alpha))};u.ToggleButton={};u.ToggleButton.kind="Text";u.ToggleButton.signature="**";u.ToggleButton.isMovable=!0;u.ToggleButton.updatePosition=kc;u.ToggleButton.initialize=function(a){var b=void 0;void 0===b&&(b="CindyJSid");b+=++fa;var c=document.createElement("input"),d=document.createElement("label");
c.setAttribute("id",b);d.setAttribute("for",b);c.setAttribute("type","checkbox");a.pressed&&(c.checked=!0);a.checkbox=c;Ad(a,"change",c,d)};u.ToggleButton.get_text=function(a){return p.string(String(a.text))};u.ToggleButton.set_currenttext=function(a,b){a.html.value=a.text=Ea(b)};u.ToggleButton.getParamForInput=u.Text.getParamForInput;u.ToggleButton.getParamFromState=u.Text.getParamFromState;u.ToggleButton.putParamToState=u.Text.putParamToState;u.ToggleButton.set_fillcolor=u.Button.set_fillcolor;
u.ToggleButton.set_color=u.Button.set_color;u.ToggleButton.set_text=u.ToggleButton.set_currenttext;u.ToggleButton.get_val=u.ToggleButton.get_text;u.ToggleButton.set_val=u.ToggleButton.set_currenttext;u.EditableText={};u.EditableText.kind="Text";u.EditableText.isMovable=!0;u.EditableText.signature=[];u.EditableText.updatePosition=kc;u.EditableText.initialize=function(a){var b=document.createElement("input");b.setAttribute("type","text");b.className="CindyJS-editabletext";cc(a.minwidth)&&(b.style.width=
a.minwidth-3+"px");"string"===typeof a.text&&(b.value=a.text);b.addEventListener("keydown",function(c){13===c.keyCode&&(a.text=a.html.value,b.blur())});b.addEventListener("change",function(c){a.text=a.html.value});Ad(a,"change",b)};u.EditableText.getText=function(a){return!1};u.EditableText.getParamForInput=u.Text.getParamForInput;u.EditableText.getParamFromState=u.Text.getParamFromState;u.EditableText.putParamToState=u.Text.putParamToState;u.EditableText.set_fillcolor=u.Button.set_fillcolor;u.EditableText.set_color=
u.Button.set_color;u.EditableText.get_currenttext=function(a){return p.string(String(a.html.value))};u.EditableText.get_text=u.ToggleButton.get_text;u.EditableText.set_currenttext=u.ToggleButton.set_currenttext;u.EditableText.set_text=u.EditableText.set_currenttext;u.EditableText.get_val=u.EditableText.get_text;u.EditableText.set_val=u.EditableText.set_currenttext;u._helper.initializePoint=function(a){var b=0,c=0,d=0;if(a.pos){if("list"===a.pos.ctype&&h.isNumberVector(a.pos))return a.pos;2===a.pos.length&&
(b=a.pos[0],c=a.pos[1],d=1);3===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=a.pos[2])}a=h.turnIntoCSList([n._helper.input(b),n._helper.input(c),n._helper.input(d)]);return a=h.normalizeMax(a)};u._helper.initializeLine=function(a){var b=0,c=0,d=0;if(a.pos){if("list"===a.pos.ctype&&h.isNumberVector(a.pos))return a.pos;3===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=a.pos[2])}a=h.turnIntoCSList([n._helper.input(b),n._helper.input(c),n._helper.input(d)]);return a=h.normalizeMax(a)};u.Poly={};u.Poly.kind="Poly";
u.Poly.signature="P*";u.Poly.updatePosition=function(a){a.vertices=h.turnIntoCSList(a.args.map(function(b){return G.csnames[b].homog}))};var lb=null;u.IFS={};u.IFS.kind="IFS";u.IFS.signature="**";u.IFS.signatureConstraints=function(a){for(var b=0;b<a.args.length;++b){var c=G.csnames[a.args[b]].kind;if("Tr"!==c&&"Mt"!==c)return!1}return 0<a.args.length};u.IFS.initialize=function(a){if(lb)lb.dirty=!0;else if(a=Tb.getBaseDir(),!1!==a){lb={dirty:!1,params:{generation:0}};var b=lb.worker=new Worker(a+
"ifs.js");b.onmessage=function(c){lb.img&&"function"===typeof lb.img.close&&lb.img.close();if(!Gd){c=c.data;if(c.generation===lb.params.generation){if(c.buffer){lb.canvas||(lb.canvas=document.createElement("canvas"),lb.ctx=lb.canvas.getContext("2d"));lb.canvas.width=c.width;lb.canvas.height=c.height;var d=new Uint8ClampedArray(c.buffer,c.imgPtr,c.width*c.height*4);d=new ImageData(d,c.width,c.height);lb.ctx.putImageData(d,0,0);lb.img=lb.canvas}else lb.img=c.img;F()}else lb.img=null;c.buffer?b.postMessage({cmd:"next",
buffer:c.buffer},[c.buffer]):b.postMessage({cmd:"next"})}};Nc.push(b.terminate.bind(b))}};u.IFS.updatePosition=function(a){lb.dirty=!0};u.IFS.updateParameters=function(){if(lb.worker){var a={cmd:"init",generation:lb.params.generation,width:Math.round(4*pb),height:Math.round(4*rb)};a.systems=G.ifs.map(function(b){var c=0,d,f=b.ifs||[],k=b.args.map(function(B,E){B=f[E]||{};return{prob:B.prob||1,color:B.color||[0,0,0]}});for(d=0;d<k.length;++d)c+=k[d].prob;d=h.realMatrix([[1,0,0],[0,1,0],[0,0,4]]);var m=
h.productMM(P.toMat(),d);for(d=0;d<b.args.length;++d){var q=G.csnames[b.args[d]],v=q.kind,w=k[d];w.kind=v;w.prob/=c;if("Tr"===v)q=h.normalizeMax(h.productMM(h.adjoint3(m),h.productMM(q.matrix,m))),h._helper.isAlmostReal(q)?w.mat=q.value.map(function(B){return B.value.map(function(E){return E.value.real})}):w.kind="cplx";else if("Mt"===v){v=P.drawingstate.matrix;v={anti:0<v.det,ar:n.real(v.a),ai:n.real(v.c),br:n.real(v.tx),bi:n.real(-v.ty),cr:n.zero,ci:n.zero,dr:n.real(.25),di:n.zero};var x={};u._helper.composeMtMt(x,
q.moebius,v);v=u._helper.inverseMoebius(v);u._helper.composeMtMt(x,v,x.moebius);v=x.moebius;v=h.turnIntoCSList([v.ar,v.ai,v.br,v.bi,v.cr,v.ci,v.dr,v.di]);h._helper.isAlmostReal(v)?(v=v.value,w.moebius={ar:v[0].value.real,ai:v[1].value.real,br:v[2].value.real,bi:v[3].value.real,cr:v[4].value.real,ci:v[5].value.real,dr:v[6].value.real,di:v[7].value.real,sign:q.moebius.anti?-1:1}):w.kind="cplx"}}return{trafos:k}});p.deeplyEqual(a,lb.params)||(++a.generation,lb.img=null,lb.params=a,lb.mat=P.drawingstate.matrix,
lb.worker.postMessage(a))}};u.IFS.probSetter=function(a,b,c){"number"===c.ctype&&(b.ifs[a].prob=c.value.real,lb.dirty=!0)};(function(){for(var a=0;10>a;++a)u.IFS["set_prob"+a]=u.IFS.probSetter.bind(null,a)})();u._helper.snapPointToLine=function(a,b){if(n._helper.isAlmostZero(a.value[2]))return a;var c=u._helper.projectPointToLine(a,b);c=h.normalizeZ(c);var d=c.value[0].value.real;c=c.value[1].value.real;var f=Math.round(d/$b)*$b,k=Math.round(c/$b)*$b,m=h.realVector([f,k,1]);Math.abs(f-d)<pd&&Math.abs(k-
c)<pd&&n._helper.isAlmostZero(h.scalproduct(b,m))&&(a=u._helper.projectPointToLine(m,b));return a};var ie={CircleByRadius:"CircleMr",IntersectionCircleCircle:"IntersectCirCir",IntersectionConicConic:"IntersectConicConic",FreePoint:"Free",Orthogonal:"Perp",Parallel:"Para",Pole:"PolarOfLine",Polar:"PolarOfPoint",Arc:"ArcBy3",EuclideanMid:"Mid",AngularBisector:"AngleBisector",TransformConic:"TransformC",TransformSegment:"TransformS",TrMoebiusSegment:"TrMoebiusS",ReflectCC:"TrMoebiusC",ReflectCL:"TrMoebiusL",
ReflectCP:"TrMoebiusP",ReflectCArc:"TrMoebiusArc",ReflectCS:"TrMoebiusS",TrMoebiusCircle:"TrMoebiusC"},Df={CircleMFixedr:function(a){a.pinned=!0;a.type="CircleMr";return[a]},CircleByFixedRadius:function(a){a.pinned=!0;a.type="CircleMr";return[a]},IntersectionConicLine:function(a){a.args=[a.args[1],a.args[0]];a.type="IntersectLC";return[a]},angleBisector:function(a){var b={name:a.name+"_Intersection",type:"Meet",args:a.args,visible:!1};a.type="AngleBisector";a.args=[a.args[0],a.args[1],b.name];return[b,
a]},Transform:function(a){var b=G.csnames[a.args[1]];b={Tr:"Transform",Mt:"TrMoebius"}[G.csnames[a.args[0]].kind]+(b.isArc?"Arc":b.kind);if(u.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]},TrReflection:function(a){var b="TrReflection"+G.csnames[a.args[0]].kind;if(u.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]},TrCompose:function(a){var b="TrCompose"+a.args.map(function(c){return G.csnames[c].kind}).join("");if(u.hasOwnProperty(b))return a.type=
b,[a];console.log(b+" not implemented yet");return[]}},Mf="align alpha angle args arrow arrowposition arrowshape arrowsides arrowsize clip color dashtype drawtrace fillalpha fillcolor filled labeled labelpos name overhang pinned printname radius size text text_fontfamily textbold textitalics textsize tracedim tracelength traceskip tracing type visible".split(" ");Vb.saveState=function(){return{geometry:Ce()}};var ec={};var Of=[[],[.2],[.075,.225],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/
6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]];var pf=[0,.2,.3,.8,8/9,1,1];var Pf=[35/384,0,500/1113,125/192,-2187/6784,11/84,0];var Qf=[5179/57600,0,7571/16695,.6140625,-92097/339200,187/2100,.025];var uc,Rb=[],Gf=[],Bf=!1;ec.tick=function(a){a/=$c;for(var b=0;b<$c;b++)ec.tick1(a),nd+=a,L(Ba.simulationstep)};ec.tick1=function(a){for(var b=a,c=0;0<a&&c<.999*a||0>a&&c>.999*a;)b=ec.oneRKStep(b),c+=b,b=Math.min(2*b,a-c),b=Math.max(b,1E-16),
ec.restorePosition(),ec.doCollisions(),ec.calculateForces(),ec.moveToFinalPos();return!0};ec.restorePosition=function(){uc.forEach(function(a){Oa[a.type].restorePos(a,9)})};ec.doCollisions=function(){uc.forEach(function(a){Oa[a.type].doCollisions(a)})};ec.calculateForces=function(){uc.forEach(function(a){Oa[a.type].calculateForces(a)})};ec.moveToFinalPos=function(){uc.forEach(function(a){Oa[a.type].move(a)})};ec.oneRKStep=function(a){for(var b=function(x){uc.forEach(function(B){Oa[B.type].initRK(B,
x);Oa[B.type].storePosition(B)})},c=function(x){uc.forEach(function(B){Oa[B.type].setToTimestep(B,pf[x])})},d=function(x){uc.forEach(function(B){Oa[B.type].proceedMotion(B,pf[x],x,Of[x])})},f=function(){uc.forEach(function(x){Oa[x.type].resetForces(x)})},k=function(x){uc.forEach(function(B){Oa[B.type].calculateDelta(B,x)})},m=function(x){var B=0;uc.forEach(function(E){Oa[E.type].proceedMotion(E,pf[6],7,Pf);Oa[E.type].savePos(E,8);Oa[E.type].proceedMotion(E,pf[6],7,Qf);Oa[E.type].savePos(E,9);B+=Oa[E.type].sqDist(E,
8,9)});return B=Math.sqrt(B)/a},q=function(x){uc.forEach(function(B){Oa[B.type].recallPosition(B)})},v=!1;!v;){b(a);for(var w=0;7>w;w++)c(w),d(w),f(),ec.calculateForces(),k(w);m(a)>Oa.env.errorbound&&a>Oa.env.lowestdeltat?(a/=Oa.env.slowdownfactor,q()):v=!0}return a};var Oa={Mass:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.mass&&(a.mass=1);"undefined"===typeof a.charge&&(a.charge=0);"undefined"===typeof a.friction&&(a.friction=0);a.lnfrict=0;"undefined"===typeof a.limitspeed&&
(a.limitspeed=!1);"undefined"===typeof a.fixed&&(a.fixed=!1);"undefined"===typeof a.radius&&(a.radius=1);a.internalmove=!1;a.fx=0;a.fy=0;a.fz=0;a.vx=a.vx||0;a.vy=a.vy||0;a.vz=a.vz||0;a.mtype=0;a.env=Oa.env;a.deltat=0;a.mx=0;a.my=0;a.mz=0;a.mvx=0;a.mvy=0;a.mvz=0;a.dx=[0,0,0,0,0,0,0,0,0,0];a.dy=[0,0,0,0,0,0,0,0,0,0];a.dz=[0,0,0,0,0,0,0,0,0,0];a.dvx=[0,0,0,0,0,0,0,0,0,0];a.dvy=[0,0,0,0,0,0,0,0,0,0];a.dvz=[0,0,0,0,0,0,0,0,0,0];a.midx=0;a.midy=0;a.midz=0;a.lx=0;a.ly=0;a.lz=0},resetForces:function(a){a.fx=
0;a.fy=0;a.fz=0},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){var c=M.extractPoint(a.el.homog);a.x=c.x;a.y=c.y;a.z=0;a.xo=a.x;a.yo=a.y;a.zo=a.z;a.vxo=a.vx;a.vyo=a.vy;a.vzo=a.vz;a.deltat=b;a.fx=0;a.fy=0;a.fz=0},setVelocity:function(a,b,c,d){d||(d=0);a.vx=b;a.vy=c;a.vz=d},move:function(a){a.pos=[a.x,a.y,1];a.internalmove=!0;wb&&hb.down&&a.el===wb.mover||Zb(a.el,h.realVector(a.pos),"homog");a.el.sx=a.x;a.el.sy=a.y;a.internalmove=!1},proceedMotion:function(a,b,c,d){if(!a.fixed)for(a.x=
a.mx,a.y=a.my,a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz,b=0;b<c;b++)a.x+=d[b]*a.dx[b]*a.deltat,a.y+=d[b]*a.dy[b]*a.deltat,a.z+=d[b]*a.dz[b]*a.deltat,a.vx+=d[b]*a.dvx[b]*a.deltat,a.vy+=d[b]*a.dvy[b]*a.deltat,a.vz+=d[b]*a.dvz[b]*a.deltat},calculateForces:function(a){var b=Math.sqrt(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz);a.lnfrict=-Math.log((1-a.friction)*(1-a.env.friction)*(.1<b&&a.limitSpeed?.1/b:1));a.fx+=-a.vx*a.lnfrict*a.mass;a.fy+=-a.vy*a.lnfrict*a.mass;a.fz+=-a.vz*a.lnfrict*a.mass},calculateDelta:function(a,
b){a.dx[b]=a.vx;a.dy[b]=a.vy;a.dz[b]=a.vz;a.dvx[b]=a.fx/a.mass;a.dvy[b]=a.fy/a.mass;a.dvz[b]=a.fz/a.mass},savePos:function(a,b){a.dx[b]=a.x;a.dy[b]=a.y;a.dz[b]=a.z;a.dvx[b]=a.vx;a.dvy[b]=a.vy;a.dvz[b]=a.vz},restorePos:function(a,b){a.fixed||(a.x=a.dx[b],a.y=a.dy[b],a.z=a.dz[b],a.vx=a.dvx[b],a.vy=a.dvy[b],a.vz=a.dvz[b])},sqDist:function(a,b,c){var d=(a.dx[b]-a.dx[c])*(a.dx[b]-a.dx[c]);d+=(a.dy[b]-a.dy[c])*(a.dy[b]-a.dy[c]);d+=(a.dz[b]-a.dz[c])*(a.dz[b]-a.dz[c]);d+=(a.dvx[b]-a.dvx[c])*(a.dvx[b]-a.dvx[c]);
d+=(a.dvy[b]-a.dvy[c])*(a.dvy[b]-a.dvy[c]);return d+=(a.dvz[b]-a.dvz[c])*(a.dvz[b]-a.dvz[c])},kineticEnergy:function(a){return.5*a.mass*(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz)},storePosition:function(a){a.mx=a.x;a.my=a.y;a.mz=a.z;a.mvx=a.vx;a.mvy=a.vy;a.mvz=a.vz},recallPosition:function(a){a.fixed||(a.x=a.mx,a.y=a.my,a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz)},doCollisions:function(a){}},Sun:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.mass&&(a.mass=10);"undefined"===typeof a.friction&&
(a.friction=0);a.charge=0;a.x=0;a.y=0;a.z=0},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){b=M.extractPoint(a.el.homog);a.x=b.x;a.y=b.y;a.z=0},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateDelta:function(a,b){},calculateForces:function(a){for(var b=a.x,c=a.y,d=a.z,f=$jscomp.makeIterator(Rb),k=f.next();!k.done;k=f.next()){k=k.value;var m=k.behavior.x,q=k.behavior.y,v=k.behavior.z,w=Math.sqrt((b-m)*(b-m)+(c-
q)*(c-q)+(d-v)*(d-v));q=(c-q)*a.mass*k.behavior.mass/(w*w*w);v=(d-v)*a.mass*k.behavior.mass/(w*w*w);k.behavior.fx+=(b-m)*a.mass*k.behavior.mass/(w*w*w)*k.behavior.mass;k.behavior.fy+=q*k.behavior.mass;k.behavior.fz+=v*k.behavior.mass}},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Velocity:{reset:function(a){var b=G.csnames[a.geo[1]];console.log(b);
var c=M.extractPoint(b.homog);a=M.extractPoint(G.csnames[a.geo[2]].homog);b=b.behavior;Oa[b.type].setVelocity(b,a.x-c.x,a.y-c.y,0)},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){var b=G.csnames[a.geo[2]];if(!wb||!hb.down||b!==wb.mover){var c=G.csnames[a.geo[1]];a=M.extractPoint(c.homog);c=c.behavior;a=h.realVector([a.x+c.vx,a.y+c.vy,1]);Zb(b,a,"homog")}},proceedMotion:function(a,b,c,d){},calculateForces:function(a){},
calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Gravity:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.strength&&(a.strength=1);a.namea=b.args[0];a.nameb=b.args[1];a.ma=G.csnames[a.namea];a.mb=G.csnames[a.nameb]},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,
b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateDelta:function(a,b){},calculateForces:function(a){var b=M.extractPoint(a.ma.homog),c=M.extractPoint(a.mb.homog),d=(c.x-b.x)*a.strength;a=(c.y-b.y)*a.strength;b=$jscomp.makeIterator(Rb);for(c=b.next();!c.done;c=b.next())c=c.value,c.behavior.fx+=d*c.behavior.mass,c.behavior.fy+=a*c.behavior.mass,c.behavior.fz+=0*c.behavior.mass},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},
kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Spring:{reset:function(a,b){a.el=b;"undefined"===typeof a.strength&&(a.strength=1);"undefined"===typeof a.amplitude&&(a.amplitude=0);"undefined"===typeof a.phase&&(a.phase=0);"undefined"===typeof a.speed&&(a.speed=1);"undefined"===typeof a.l0&&(a.l0=0);"undefined"===typeof a.stype&&(a.stype=1);"undefined"===typeof a.readOnInit&&(a.readOnInit=!1);a.namea=b.args[0];a.nameb=b.args[1];a.ma=
G.csnames[a.namea];a.mb=G.csnames[a.nameb];b=M.extractPoint(a.ma.homog);var c=M.extractPoint(a.mb.homog);a.l0=Math.sqrt((b.x-c.x)*(b.x-c.x)+(b.y-c.y)*(b.y-c.y));a.env=Oa.env;a.ldiff=0},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){if(!a.ma.behavior||wb&&hb.down&&a.ma===wb.mover){var b=M.extractPoint(a.ma.homog);var c=b.x;var d=b.y}else c=a.ma.behavior.x,
d=a.ma.behavior.y;if(!a.mb.behavior||wb&&hb.down&&a.mb===wb.mover){var f=M.extractPoint(a.mb.homog);b=f.x;f=f.y}else b=a.mb.behavior.x,f=a.mb.behavior.y;var k=Math.sqrt((c-b)*(c-b)+(d-f)*(d-f)),m=a.l0;a.ldiff=k-m;var q=a.stype;1===q&&(m=0);var v=0;if(2===q||3===q)v=a.ma.behavior.mass*a.mb.behavior.mass*a.strength;2===q&&(v=-v);if(0===k||0!==q&&1!==q)if(a.ma.behavior&&a.mb.behavior&&0!==k){if(k*=k*k,2===q||3===q){var w=(c-b)*v/k;var x=(d-f)*v/k}}else w=x=0;else w=-(c-b)*a.strength*(k-m)/k*a.env.springstrength,
x=-(d-f)*a.strength*(k-m)/k*a.env.springstrength;a.ma.behavior&&(a.ma.behavior.fx+=w,a.ma.behavior.fy+=x);a.mb.behavior&&(a.mb.behavior.fx-=w,a.mb.behavior.fy-=x)},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},det:function(a,b,c,d,f,k){return c*k-f*d+f*b-a*k+a*d-c*b},Bouncer:{reset:function(a,b){a.el=b;"undefined"===typeof a.xdamp&&
(a.xdamp=0);"undefined"===typeof a.ydamp&&(a.ydamp=0);"undefined"===typeof a.motorchanger&&(a.motorchanger=!0);a.namea=b.args[0];a.nameb=b.args[1];a.ma=G.csnames[a.namea];a.mb=G.csnames[a.nameb];b=M.extractPoint(a.ma.homog);var c=M.extractPoint(a.mb.homog);a.x1o=1.01*b.x-.01*c.x;a.y1o=1.01*b.y-.01*c.y;a.x2o=1.01*c.x-.01*b.x;a.y2o=1.01*c.y-.01*b.y;a.env=Oa.env},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){a.deltat=b},setVelocity:function(a,b,c,d){},move:function(a){},
proceedMotion:function(a,b,c,d){},calculateForces:function(a){},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){var b=M.extractPoint(a.ma.homog),c=M.extractPoint(a.mb.homog),d=b.x;b=b.y;var f=c.x;c=c.y;var k=a.x1o,m=a.y1o,q=a.x2o,v=a.y2o,w=Math.sqrt((d-f)*(d-f)+(b-c)*(b-c)),x=(d-f)/w;w=(b-c)/w;for(var B=$jscomp.makeIterator(Rb),
E=B.next();!E.done;E=B.next()){E=E.value;var J=E.behavior.xo,W=E.behavior.yo,R=E.behavior.x,ea=E.behavior.y,X=n.mult(n.complex(k,m),n.complex(f,c)),oa=n.mult(n.complex(q,v),n.complex(d,b));X=n.sub(X,oa);oa=n.mult(n.complex(J,W),n.complex(d,b));X=n.add(X,oa);oa=n.mult(n.complex(J,W),n.complex(f,c));X=n.sub(X,oa);oa=n.sub(n.complex(k,m),n.complex(q,v));X=n.div(X,oa);0>Oa.det(d,b,f,c,R,ea)*Oa.det(d,b,f,c,X.value.real,X.value.imag)&&0>Oa.det(d,b,R,ea,X.value.real,X.value.imag)*Oa.det(f,c,R,ea,X.value.real,
X.value.imag)&&(W=E.behavior.mvx+a.deltat*(-X.value.real+E.behavior.xo),R=E.behavior.mvy+a.deltat*(-X.value.imag+E.behavior.yo),J=x*W+w*R,W=w*W-x*R,E.behavior.x=X.value.real,E.behavior.y=X.value.imag,E.behavior.vx=x*J*(1-a.xdamp),E.behavior.vy=w*J*(1-a.xdamp),E.behavior.vx+=-w*W*(1-a.ydamp),E.behavior.vy+=x*W*(1-a.ydamp))}a.x1o=d;a.y1o=b;a.x2o=f;a.y2o=c}},Environment:{init:function(a){"undefined"===typeof a.gravity&&(a.gravity=0);"undefined"===typeof a.friction&&(a.friction=0);"undefined"===typeof a.springstrength&&
(a.springstrength=1);"undefined"!==typeof a.accuracy&&($c=a.accuracy);"undefined"!==typeof a.deltat&&Za(a.deltat/.6);"undefined"===typeof a.charges&&(a.charges=!1);"undefined"===typeof a.balls&&(a.balls=!1);"undefined"===typeof a.newton&&(a.newton=!1);"undefined"===typeof a.ballInteractionBoosting&&(a.ballInteractionBoosting=1);Oa.env=a;a.errorbound=.001;a.lowestdeltat=1E-7;a.slowdownfactor=2},reset:function(a){},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,
b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){var b,c;if(a.newton)for(b=0;b<Rb.length-1;b++){var d=Rb[b];var f=d.behavior.x;var k=d.behavior.y;for(c=b+1;c<Rb.length;c++){var m=Rb[c];var q=m.behavior.x;var v=m.behavior.y;var w=Math.sqrt((f-q)*(f-q)+(k-v)*(k-v));q=(f-q)*d.behavior.mass*m.behavior.mass/(w*w*w);v=(k-v)*d.behavior.mass*m.behavior.mass/(w*w*w);d.behavior.fx-=q;d.behavior.fy-=v;m.behavior.fx+=q;m.behavior.fy+=v}}if(a.charges)for(b=
0;b<Rb.length-1;b++)for(d=Rb[b],f=d.behavior.x,k=d.behavior.y,c=b+1;c<Rb.length;c++)m=Rb[c],q=m.behavior.x,v=m.behavior.y,w=Math.sqrt((f-q)*(f-q)+(k-v)*(k-v)),q=(f-q)*d.behavior.charge*m.behavior.charge/(w*w*w),v=(k-v)*d.behavior.charge*m.behavior.charge/(w*w*w),d.behavior.fx+=q,d.behavior.fy+=v,m.behavior.fx-=q,m.behavior.fy-=v;if(a.balls)for(b=0;b<Rb.length-1;b++)if(d=Rb[b],0!==d.behavior.radius)for(f=d.behavior.x,k=d.behavior.y,c=b+1;c<Rb.length;c++)if(m=Rb[c],0!==m.behavior.radius){q=m.behavior.x;
v=m.behavior.y;var x=d.behavior.radius+m.behavior.radius;w=Math.sqrt((f-q)*(f-q)+(k-v)*(k-v));0===a.ballInteractionBoosting?(q=(f-q)/(w*w*w)*(w>x?0:(w-x)*(w-x)),v=(k-v)/(w*w*w)*(w>x?0:(w-x)*(w-x))):1===a.ballInteractionBoosting?(q=(f-q)/(w*w*w*w)*(w>x?0:(w-x)*(w-x)),v=(k-v)/(w*w*w*w)*(w>x?0:(w-x)*(w-x))):(q=(f-q)/(w*w*w*w*w)*(w>x?0:(w-x)*(w-x)),v=(k-v)/(w*w*w*w*w)*(w>x?0:(w-x)*(w-x)));d.behavior.fx+=q;d.behavior.fy+=v;m.behavior.fx-=q;m.behavior.fy-=v}for(b=0;b<Rb.length;b++)d=Rb[b],d.behavior.fx+=
0,d.behavior.fy+=-a.gravity*d.behavior.mass,d.behavior.fz+=0},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}}};return Vb};return H}(),createCindy=CindyJS;"undefined"!==typeof process&&"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"===typeof window&&(module.exports=CindyJS);
//# sourceMappingURL=Cindy.js.map

